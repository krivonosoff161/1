# üìä –ò–¢–û–ì–û–í–´–ô –ê–ù–ê–õ–ò–ó –¢–û–†–ì–û–í–û–ô –°–ï–°–°–ò–ò 10.01.2026

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2026-01-10  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –∑–∞–∫—Ä—ã–ª–æ—Å—å —Ç–æ–ª—å–∫–æ 3 –ø–æ–∑–∏—Ü–∏–∏, –∞ 4 –ø–æ–∑–∏—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º–∏

---

## üéØ –†–ï–ó–Æ–ú–ï –ü–†–û–ë–õ–ï–ú–´

**–°—Ç–∞—Ç—É—Å:** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê**

**–°—É—Ç—å:** TSL (Trailing Stop Loss) –ø–æ–ª—É—á–∞–µ—Ç `price=0.0000`, –∏–∑-–∑–∞ —á–µ–≥–æ:
- –†–∞—Å—á–µ—Ç PnL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –∑–Ω–∞—á–µ–Ω–∏–µ `4.0%` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É–±—ã—Ç–∫–∞
- Loss_cut –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
- –ü–æ–∑–∏—Ü–∏–∏ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —É–±—ã—Ç–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ä–æ–≥

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ü–û–ó–ò–¶–ò–ô

| –°–∏–º–≤–æ–ª | –†–∞–∑–º–µ—Ä | –í—Ö–æ–¥ | –¢–µ–∫—É—â–∞—è | –†–µ–∞–ª—å–Ω—ã–π PnL | TSL –≤–∏–¥–∏—Ç | –î–æ–ª–∂–Ω–∞ –∑–∞–∫—Ä—ã—Ç—å—Å—è? |
|--------|--------|------|---------|--------------|-----------|-------------------|
| XRPUSDT | 130 XRP | 2.0887 | 2.0915 | **-1.39%** | **+4.0%** (fallback) | ‚úÖ **–î–ê** |
| SOLUSDT | 1.86 SOL | 135.73 | 136.35 | **-4.57%** | **+4.0%** (fallback) | ‚úÖ **–î–ê** |
| ETHUSDT | 0.080 ETH | 3129.49 | 3131.69 | **-0.50%** | **+4.0%** (fallback) | ‚ùå –ù–µ—Ç (–Ω–µ –¥–æ—Å—Ç–∏–≥ –ø–æ—Ä–æ–≥) |
| BTCUSDT | 0.0027 BTC | 91955.6 | 91941.1 | **+0.15%** | **+4.0%** (fallback) | ‚ùå –ù–µ—Ç (–ø—Ä–∏–±—ã–ª—å) |

**–í—Å–µ –ø–æ–∑–∏—Ü–∏–∏ - SHORT** (—Ü–µ–Ω–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –≤—ã—à–µ –≤—Ö–æ–¥–Ω–æ–π —Ü–µ–Ω—ã)

---

## üîç –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø: TSL –ø–æ–ª—É—á–∞–µ—Ç `price=0.0000`

**–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç:**
```
üîç TSL_CHECK: XRP-USDT minutes=456.9216 | profit=4.0000 | price=0.0000 | sl=2.0970 | close=False
üîç TSL_CHECK: SOL-USDT minutes=408.4187 | profit=4.0000 | price=0.0000 | sl=136.2729 | close=False
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `current_price = 0.0000` –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ `should_close_position()`
- –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ —Ä–∞—Å—á–µ—Ç PnL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –∑–Ω–∞—á–µ–Ω–∏–µ `4.0%`
- –†–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫ `-1.39%` –∏ `-4.57%` **–ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è**

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
- `_get_current_price()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `0.0` –µ—Å–ª–∏ DataRegistry –∏ REST API callback –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- –ù–µ—Ç fallback –Ω–∞ `entry_price` –∏–ª–∏ `mark_price` –∏–∑ –ø–æ–∑–∏—Ü–∏–∏

---

### 2. ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –†–∞—Å—á–µ—Ç PnL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –ø—Ä–∏ price=0

**–õ–æ–≥–∏:**
```
üí∞ TrailingStopLoss: PnL calc (fallback): leverage=5.0, fees_adj=1.0000%, gross=5.0000%, net=4.0000%
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–≥–¥–∞ `current_price=0`, `get_profit_pct()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `4.0%`
- –≠—Ç–æ **–ù–ï —Ä–µ–∞–ª—å–Ω—ã–π PnL**, –∞ fallback –∑–Ω–∞—á–µ–Ω–∏–µ
- Loss_cut –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `4.0% > -0.4%` ‚Üí –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç (—Ö–æ—Ç—è —Ä–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫ `-1.39% < -0.4%`)

---

### 3. ‚è±Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç—ã –æ—á–µ–Ω—å –¥–æ–ª–≥–æ

**–í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏:**
- XRPUSDT: **456 –º–∏–Ω—É—Ç** (7.6 —á–∞—Å–æ–≤)
- SOLUSDT: **408 –º–∏–Ω—É—Ç** (6.8 —á–∞—Å–æ–≤)
- ETHUSDT: **500 –º–∏–Ω—É—Ç** (8.3 —á–∞—Å–∞)
- BTCUSDT: **504 –º–∏–Ω—É—Ç—ã** (8.4 —á–∞—Å–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–∑–∏—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã–ª–∏ –∑–∞–∫—Ä—ã—Ç—å—Å—è –ø–æ `max_holding_time` (25 –º–∏–Ω—É—Ç –¥–ª—è ranging)
- –ù–æ –∏–∑-–∑–∞ `price=0` –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ô –ê–ù–ê–õ–ò–ó

### –¶–µ–ø–æ—á–∫–∞ –≤—ã–∑–æ–≤–æ–≤:

1. **`periodic_check()`** ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 1-2 —Å–µ–∫—É–Ω–¥—ã
2. **`update_trailing_stop_loss()`** ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏
3. **`_get_current_price()`** ‚Üí –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É –∏–∑ DataRegistry/REST API
4. **–ï—Å–ª–∏ —Ü–µ–Ω–∞ = 0** ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `0.0`
5. **`should_close_position(current_price=0)`** ‚Üí –ø–æ–ª—É—á–∞–µ—Ç `price=0`
6. **`get_profit_pct(price=0)`** ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç fallback `4.0%`
7. **Loss_cut –ø—Ä–æ–≤–µ—Ä–∫–∞:** `4.0% > -0.4%` ‚Üí **–ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º** ‚ùå

### –ü–æ—á–µ–º—É —Ü–µ–Ω–∞ = 0?

**–í –ª–æ–≥–∞—Ö —Ç–∞–∫–∂–µ –≤–∏–¥–Ω–æ:**
```
‚ö†Ô∏è TSL: Using REST API callback for BTC-USDT: 90579.00000000
‚ö†Ô∏è TSL: Using REST API callback for ETH-USDT: 3088.88000000
```

**–í—ã–≤–æ–¥:** REST API callback —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ü–µ–Ω—É, –Ω–æ –æ–Ω–∞ **–ù–ï –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è** –≤ `should_close_position()`!

**–í–æ–∑–º–æ–∂–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞:** –¶–µ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ, –Ω–æ –Ω–µ –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `should_close_position()`.

---

## üéØ –†–ï–®–ï–ù–ò–ï

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É —Ü–µ–Ω—ã –≤ `should_close_position()`

**–§–∞–π–ª:** `trailing_sl_coordinator.py:578`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
async def update_trailing_stop_loss(self, symbol: str, current_price: float):
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É
    current_price = await self._get_current_price(symbol)
    
    # ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–ê: –ï—Å–ª–∏ current_price=0, –ø–µ—Ä–µ–¥–∞–µ–º 0 –≤ should_close_position()
    should_close, reason = tsl.should_close_position(
        current_price,  # –ú–æ–∂–µ—Ç –±—ã—Ç—å 0!
        ...
    )
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
async def update_trailing_stop_loss(self, symbol: str, current_price: float):
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É
    current_price = await self._get_current_price(symbol)
    
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ï—Å–ª–∏ —Ü–µ–Ω–∞ = 0, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback
    if current_price <= 0:
        # Fallback 1: mark_price –∏–∑ –ø–æ–∑–∏—Ü–∏–∏
        position = self.active_positions_ref.get(symbol)
        if position:
            mark_price = position.get("mark_price") or position.get("markPx")
            if mark_price:
                current_price = float(mark_price)
                logger.warning(f"‚ö†Ô∏è TSL: –ò—Å–ø–æ–ª—å–∑—É–µ–º mark_price –¥–ª—è {symbol}: {current_price}")
        
        # Fallback 2: entry_price –∏–∑ TSL
        if current_price <= 0:
            tsl = self.trailing_sl_by_symbol.get(symbol)
            if tsl and hasattr(tsl, "entry_price") and tsl.entry_price > 0:
                current_price = tsl.entry_price
                logger.warning(f"‚ö†Ô∏è TSL: –ò—Å–ø–æ–ª—å–∑—É–µ–º entry_price –¥–ª—è {symbol}: {current_price}")
    
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º
    if current_price <= 0:
        logger.error(f"‚ùå TSL: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É –¥–ª—è {symbol}, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É")
        return
    
    should_close, reason = tsl.should_close_position(
        current_price,  # –¢–µ–ø–µ—Ä—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ > 0
        ...
    )
```

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å `get_profit_pct()` –ø—Ä–∏ price=0

**–§–∞–π–ª:** `trailing_stop_loss.py:522`

**–ü—Ä–æ–±–ª–µ–º–∞:**
```python
def get_profit_pct(self, current_price: float, ...):
    if current_price <= 0:
        # Fallback - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ!
        return 0.04  # 4%
```

**–†–µ—à–µ–Ω–∏–µ:**
```python
def get_profit_pct(self, current_price: float, ...):
    if current_price <= 0:
        # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º entry_price –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞
        if hasattr(self, "entry_price") and self.entry_price > 0:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º entry_price –∫–∞–∫ —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥)
            # –≠—Ç–æ –¥–∞—Å—Ç PnL = 0%, —á—Ç–æ –ª—É—á—à–µ —á–µ–º fallback 4%
            current_price = self.entry_price
            logger.warning(f"‚ö†Ô∏è TSL: current_price=0, –∏—Å–ø–æ–ª—å–∑—É–µ–º entry_price –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ PnL")
        else:
            # –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ entry_price —Ç–æ–∂–µ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
            logger.error(f"‚ùå TSL: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Ü–µ–Ω—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ PnL")
            return 0.0  # –ù–µ –∑–Ω–∞–µ–º PnL, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º
    
    # –ù–æ—Ä–º–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç PnL
    ...
```

---

## üìã –ß–ï–ö–õ–ò–°–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `_get_current_price()` - –¥–æ–±–∞–≤–∏—Ç—å fallback –Ω–∞ mark_price –∏ entry_price
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `update_trailing_stop_loss()` - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–Ω—ã –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `should_close_position()`
- [ ] –ò—Å–ø—Ä–∞–≤–∏—Ç—å `get_profit_pct()` - –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback –ø—Ä–∏ price=0
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback —Ü–µ–Ω–∞
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö

---

## üéØ –í–´–í–û–î–´

### –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:

**TSL –ø–æ–ª—É—á–∞–µ—Ç `price=0.0000`, –∏–∑-–∑–∞ —á–µ–≥–æ:**
1. –†–∞—Å—á–µ—Ç PnL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback `4.0%` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —É–±—ã—Ç–∫–∞
2. Loss_cut –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç (`4.0% > -0.4%` –≤–º–µ—Å—Ç–æ `-1.39% < -0.4%`)
3. –ü–æ–∑–∏—Ü–∏–∏ –æ—Å—Ç–∞—é—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç—ã–º–∏, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —É–±—ã—Ç–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ø–æ—Ä–æ–≥

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:

1. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** –¶–µ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ REST API callback, –Ω–æ –Ω–µ –¥–æ–∂–∏–¥–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
2. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ fallback:** –ù–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ü–µ–Ω—ã (mark_price, entry_price)
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π fallback:** –ü—Ä–∏ price=0 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `4.0%` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞

### –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:

1. –î–æ–±–∞–≤–∏—Ç—å fallback –Ω–∞ `mark_price` –∏ `entry_price` –≤ `_get_current_price()`
2. –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ü–µ–Ω—ã –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `should_close_position()`
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç PnL –ø—Ä–∏ price=0 (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å entry_price –≤–º–µ—Å—Ç–æ fallback)

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –°–ï–°–°–ò–ò

- **–û—Ç–∫—Ä—ã—Ç–æ –ø–æ–∑–∏—Ü–∏–π:** 4
- **–ó–∞–∫—Ä—ã—Ç–æ –ø–æ–∑–∏—Ü–∏–π:** 3 (–¥–æ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞)
- **–û—Å—Ç–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—ã—Ö:** 4
- **–í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏:** 6.8-8.4 —á–∞—Å–∞
- **–†–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫:** -1.39% (XRP), -4.57% (SOL), -0.50% (ETH)
- **TSL –≤–∏–¥–∏—Ç:** +4.0% (fallback –¥–ª—è –≤—Å–µ—Ö)

---

## üîß –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É —Ü–µ–Ω—ã –≤ TSL
2. **–ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å fallback –Ω–∞ mark_price –∏ entry_price
3. **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ:** –£–ª—É—á—à–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å —Ü–µ–Ω–æ–π
