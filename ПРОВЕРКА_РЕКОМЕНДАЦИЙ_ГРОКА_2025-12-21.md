# ‚úÖ –ü–†–û–í–ï–†–ö–ê –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –ì–†–û–ö–ê (2025-12-21)

## üéØ –û–ë–ó–û–†

Grok –¥–∞–ª —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –±–æ—Ç–∞ –ø–æ—Å–ª–µ –∞–Ω–∞–ª–∏–∑–∞ 6 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã. –ù–∏–∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ —Å—Ç–∞—Ç—É—Å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è.

---

## üìä –¢–†–ï–ô–î–ï–†: –ü–ê–†–ê–ú–ï–¢–†–´

### 1. Signal Strength Threshold

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –¢–µ–∫—É—â–∏–π: `0.26-1.0` (—Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: `0.7-0.9`
- –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç: Winrate +10-15%

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `min_signal_strength: 0.25` (—Å—Ç—Ä–æ–∫–∞ 34 –≤ config_futures.yaml)
- `min_signal_strength: 0.3` –¥–ª—è ranging (—Å—Ç—Ä–æ–∫–∞ 1857)
- `min_signal_strength: 0.4` –¥–ª—è trending (—Å—Ç—Ä–æ–∫–∞ 1851)
- `min_signal_strength: 0.25` –¥–ª—è choppy (—Å—Ç—Ä–æ–∫–∞ 1863)

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**
- –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (0.25-0.4) —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–µ
- Grok –ø—Ä–∞–≤: –ø—Ä–∏ winrate 15.62% –Ω—É–∂–Ω—ã –±–æ–ª–µ–µ —Å–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ü–æ–¥–Ω—è—Ç—å –¥–æ 0.7-0.9 –¥–ª—è ranging

**–î–µ–π—Å—Ç–≤–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –≤ `config_futures.yaml`:
```yaml
min_signal_strength: 0.7  # –ë—ã–ª–æ 0.25
by_regime:
  ranging:
    min_signal_strength: 0.7  # –ë—ã–ª–æ 0.3
```

---

### 2. ADX Threshold –¥–ª—è Ranging

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –¢–µ–∫—É—â–∏–π: `20-25` (—Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–π)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: `20-25` (–Ω–æ Grok –≥–æ–≤–æ—Ä–∏—Ç —á—Ç–æ —Ç–µ–∫—É—â–∏–π —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∏–π)
- –ü—Ä–æ–±–ª–µ–º–∞: –ü—É—Å–∫–∞–µ—Ç —Å–ª–∞–±—ã–µ —Ç—Ä–µ–Ω–¥—ã

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `ranging_adx_threshold: 15.0` (—Å—Ç—Ä–æ–∫–∞ 222)
- `adx_threshold: 15.0` –¥–ª—è ranging (—Å—Ç—Ä–æ–∫–∞ 349)
- `adx_threshold: 18.0` –¥–ª—è trending (—Å—Ç—Ä–æ–∫–∞ 287)
- `adx_threshold: 12.0` –¥–ª—è choppy (—Å—Ç—Ä–æ–∫–∞ 410)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**
- –¢–µ–∫—É—â–∏–π 15.0 –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∑–∫–∏–π –¥–ª—è ranging
- Grok —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç 20-25, –Ω–æ —ç—Ç–æ —É–∂–µ –µ—Å—Ç—å –≤ trending (18.0)
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ü–æ–¥–Ω—è—Ç—å ranging –¥–æ 20-25

**–î–µ–π—Å—Ç–≤–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –≤ `config_futures.yaml`:
```yaml
adaptive_regime:
  detection:
    ranging_adx_threshold: 20.0  # –ë—ã–ª–æ 15.0
  ranging:
    modules:
      adx_filter:
        adx_threshold: 20.0  # –ë—ã–ª–æ 15.0
```

---

### 3. TP/SL –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ (RR)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –¢–µ–∫—É—â–∏–π: `TP 3-5% : SL 0.8-1%` (RR 1:1.5-2.5)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: `TP 2-4% : SL 0.6-0.8%` (RR 1:2.5-3.3)
- –ü—Ä–æ–±–ª–µ–º–∞: RR –Ω–µ —Å–ø–∞—Å–∞–µ—Ç –ø—Ä–∏ winrate 15-18%

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `tp_percent: 2.0` (—Å—Ç—Ä–æ–∫–∞ 52) - ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û
- `sl_percent: 0.8` (—Å—Ç—Ä–æ–∫–∞ 53) - ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û
- –î–ª—è ranging: `tp_percent: 2.0`, `sl_percent: 0.8` (—Å—Ç—Ä–æ–∫–∏ 299-300) - ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û**
- –¢–µ–∫—É—â–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º Grok
- TP 2.0% : SL 0.8% = RR 1:2.5 ‚úÖ

**–î–µ–π—Å—Ç–≤–∏–µ:** –ù–∏—á–µ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

---

### 4. Partial TP Trigger

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: `trigger 1.2% –ø–æ—Å–ª–µ minholding 0.2-0.5 –º–∏–Ω`

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `trigger_percent: 2.0` –¥–ª—è ranging (—Å—Ç—Ä–æ–∫–∞ 90) - ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û
- `trigger_percent: 1.8` –¥–ª—è trending (—Å—Ç—Ä–æ–∫–∞ 87) - ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û
- `trigger_percent: 1.2` –¥–ª—è choppy (—Å—Ç—Ä–æ–∫–∞ 93) - ‚úÖ –£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û
- `min_holding_minutes: 0.5` –¥–ª—è ranging (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –¢–†–ï–ë–£–ï–¢ –ü–†–û–í–ï–†–ö–ò**
- Trigger —É–∂–µ —É–≤–µ–ª–∏—á–µ–Ω (2.0% –¥–ª—è ranging)
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å min_holding_minutes

**–î–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å min_holding_minutes –≤ –∫–æ–Ω—Ñ–∏–≥–µ

---

### 5. Max Holding Time

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –¢–µ–∫—É—â–∏–π: `28 –º–∏–Ω soft` (–º—è–≥–∫–æ–µ —É—Å–ª–æ–≤–∏–µ)
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: `20-25 –º–∏–Ω hard` (–∂–µ—Å—Ç–∫–∏–π —Å—Ç–æ–ø) + `timeoutloss 1.5-2%` –¥–ª—è –∂–µ—Å—Ç–∫–æ–≥–æ –≤—ã—Ö–æ–¥–∞
- –ü—Ä–æ–±–ª–µ–º–∞: Max holding –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∂–µ—Å—Ç–∫–∏–π —Å—Ç–æ–ø

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- `max_holding_minutes: 28` –¥–ª—è ranging (—Å—Ç—Ä–æ–∫–∞ 301)
- –í –∫–æ–¥–µ: max_holding –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 1964 –≤ exit_analyzer.py)

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**
- Grok –ø—Ä–∞–≤: max_holding –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∂–µ—Å—Ç–∫–∏–º —Å—Ç–æ–ø–æ–º
- –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞: –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –µ—Å–ª–∏ PnL < 0
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –°–¥–µ–ª–∞—Ç—å –∂–µ—Å—Ç–∫–∏–π —Å—Ç–æ–ø + –¥–æ–±–∞–≤–∏—Ç—å timeoutloss

**–î–µ–π—Å—Ç–≤–∏–µ:** 
1. –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `exit_analyzer.py` - —Å–¥–µ–ª–∞—Ç—å max_holding –∂–µ—Å—Ç–∫–∏–º —Å—Ç–æ–ø–æ–º
2. –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `timeout_loss_percent: 1.5` –≤ –∫–æ–Ω—Ñ–∏–≥
3. –ó–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é –ø–æ max_holding –µ—Å–ª–∏ —É–±—ã—Ç–æ–∫ >= timeout_loss_percent

---

### 6. Margin Safety Threshold

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –¢–µ–∫—É—â–∏–π: `1.3` (ranging) —Ä–∏—Å–∫—É–µ—Ç –ø—Ä–∏ equity ~25 USDT
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: `1.5-1.8`

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è margin safety threshold

**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–¢–†–ï–ë–£–ï–¢ –ü–†–û–í–ï–†–ö–ò**
- –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∫–æ–¥–µ/–∫–æ–Ω—Ñ–∏–≥–µ

**–î–µ–π—Å—Ç–≤–∏–µ:** –ù–∞–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ

---

## üíª –ö–û–î–ï–†: –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### 7. –ë–∞–≥–∏ —Å datetime –∏ str vs int

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –§–∏–∫—Å: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `dt = datetime.now()` –≤–Ω–µ if/try –∏ `float(arg)` –≤ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è—Ö

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ **–£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û**: datetime –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ `dt`
- ‚úÖ **–£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û**: –¥–æ–±–∞–≤–ª–µ–Ω–æ —è–≤–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ `float()` –≤–æ –≤—Å–µ—Ö –º–µ—Ç–æ–¥–∞—Ö

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–£–ñ–ï –ò–°–ü–†–ê–í–õ–ï–ù–û**

**–î–µ–π—Å—Ç–≤–∏–µ:** –ù–∏—á–µ–≥–æ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è

---

### 8. profit_too_low_vs_peak

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –ü—Ä–æ–±–ª–µ–º–∞: –î–µ—Ä–∂–∏—Ç –ø–æ–∑–∏—Ü–∏–∏ –≤ drawdown (peak vs current), –ø–æ–∫–∞ net –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å –Ω–∞ absolute threshold (0.3-0.5%) –∏–ª–∏ % –æ—Ç peak (70%), –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ä–µ–∂–∏–º–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ö–æ–¥: `if pnl_percent < peak_profit_pct * 0.7:` (—Å—Ç—Ä–æ–∫–∞ 1734 –≤ exit_analyzer.py)
- –ü—Ä–æ–±–ª–µ–º–∞: –ë–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã—Ö–æ–¥ –µ—Å–ª–∏ —Ç–µ–∫—É—â–∞—è –ø—Ä–∏–±—ã–ª—å < 70% –æ—Ç peak

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**
- Grok –ø—Ä–∞–≤: —ç—Ç–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—ã—Ö–æ–¥—ã –∏ –∫–æ–º–∏—Å—Å–∏–∏ —Å—ä–µ–¥–∞—é—Ç –ø—Ä–∏–±—ã–ª—å
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –î–æ–±–∞–≤–∏—Ç—å absolute threshold (0.3-0.5%) –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–ª—è –º–∞–ª—ã—Ö –ø—Ä–∏–±—ã–ª–µ–π

**–î–µ–π—Å—Ç–≤–∏–µ:** –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É –≤ `exit_analyzer.py`:
```python
# –í–º–µ—Å—Ç–æ —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ peak, –¥–æ–±–∞–≤–∏—Ç—å absolute threshold
if pnl_percent > 0.5 and peak_profit_pct > 0:  # –¢–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∏–±—ã–ª–µ–π > 0.5%
    if pnl_percent < peak_profit_pct * 0.7:
        # –ë–ª–æ–∫–∏—Ä—É–µ–º –≤—ã—Ö–æ–¥
```

---

### 9. –¶–∏–∫–ª TCC 27-28 —Å–µ–∫—É–Ω–¥

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –ü—Ä–æ–±–ª–µ–º–∞: `signals 19-21–∫ –º—Å` - –æ—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: –í—ã–Ω–µ—Å—Ç–∏ MTF/correlation –≤ background (asyncio), —É–±—Ä–∞—Ç—å DEBUG –≤ prod
- –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç: <10—Å (—Ä–µ–∞–∫—Ü–∏—è –Ω–∞ 1m –±–∞—Ä—ã)

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –¶–∏–∫–ª –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –¥–æ–ª–≥–∏–π (27-28 —Å–µ–∫)
- –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò** (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- –≠—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–µ–∞–∫—Ü–∏—é
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ

**–î–µ–π—Å—Ç–≤–∏–µ:** –û—Ç–ª–æ–∂–∏—Ç—å –Ω–∞ –ø–æ—Ç–æ–º (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

---

### 10. Margin Ratio –î—É–±–ª–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è Grok:**
- –ü—Ä–æ–±–ª–µ–º–∞: –î—É–±–ª–∏ (0.10 vs 38) - –¥–≤–µ —Ä–∞–∑–Ω—ã–µ –º–æ–¥–µ–ª–∏ equity/margin
- –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–π: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ position equity, –Ω–µ profile

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- –ü—Ä–æ–±–ª–µ–º–∞ –æ–ø–∏—Å–∞–Ω–∞ –≤ –∞–Ω–∞–ª–∏–∑–µ Grok
- –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ margin_calculator.py –∏ liquidation_guard.py

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø** (—Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- –≠—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–∞—Å—á–µ—Ç–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å

**–î–µ–π—Å—Ç–≤–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ `margin_calculator.py` –∏ `liquidation_guard.py`

---

## üìã –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –î–µ–π—Å—Ç–≤–∏–µ |
|---|----------|--------|-----------|----------|
| 1 | Signal strength 0.7-0.9 | ‚ùå –¢—Ä–µ–±—É–µ—Ç | üî¥ –í—ã—Å–æ–∫–∏–π | –ò–∑–º–µ–Ω–∏—Ç—å –≤ config |
| 2 | ADX threshold 20-25 | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | üü† –°—Ä–µ–¥–Ω–∏–π | –ò–∑–º–µ–Ω–∏—Ç—å –≤ config |
| 3 | TP/SL RR | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | - | - |
| 4 | Partial TP trigger | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | üü° –ù–∏–∑–∫–∏–π | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å min_holding |
| 5 | Max holding hard stop | ‚ùå –¢—Ä–µ–±—É–µ—Ç | üî¥ –í—ã—Å–æ–∫–∏–π | –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É + –¥–æ–±–∞–≤–∏—Ç—å timeoutloss |
| 6 | Margin safety 1.5-1.8 | ‚è≥ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | üü† –°—Ä–µ–¥–Ω–∏–π | –ù–∞–π—Ç–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å |
| 7 | datetime/str vs int | ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | - | - |
| 8 | profit_too_low_vs_peak | ‚ùå –¢—Ä–µ–±—É–µ—Ç | üî¥ –í—ã—Å–æ–∫–∏–π | –ò–∑–º–µ–Ω–∏—Ç—å –ª–æ–≥–∏–∫—É |
| 9 | –¶–∏–∫–ª TCC –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è | ‚ö†Ô∏è –û—Ç–ª–æ–∂–∏—Ç—å | üü° –ù–∏–∑–∫–∏–π | –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ |
| 10 | Margin ratio –¥—É–±–ª–∏ | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç | üü† –°—Ä–µ–¥–Ω–∏–π | –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å |

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö–†–ò–¢–ò–ß–ù–û - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)

1. **Signal strength 0.7-0.9** - –ü–æ–¥–Ω—è—Ç—å –ø–æ—Ä–æ–≥ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è winrate
2. **Max holding hard stop** - –°–¥–µ–ª–∞—Ç—å –∂–µ—Å—Ç–∫–∏–π —Å—Ç–æ–ø + timeoutloss
3. **profit_too_low_vs_peak** - –î–æ–±–∞–≤–∏—Ç—å absolute threshold –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–ª—è –º–∞–ª—ã—Ö –ø—Ä–∏–±—ã–ª–µ–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–ê–ñ–ù–û - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏)

4. **ADX threshold 20-25** - –ü–æ–¥–Ω—è—Ç—å –¥–ª—è ranging
5. **Margin safety 1.5-1.8** - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
6. **Margin ratio –¥—É–±–ª–∏** - –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥–µ–ª—å

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û - –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)

7. **Partial TP min_holding** - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ
8. **–¶–∏–∫–ª TCC –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ

---

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:** 2025-12-21  
**–°—Ç–∞—Ç—É—Å:** ‚è≥ –¢—Ä–µ–±—É—é—Ç—Å—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ 1 –∏ 2

