# ‚úÖ –û–¢–ß–ï–¢: –£–ë–ò–†–ê–ù–ò–ï FALLBACK –†–ï–ñ–ò–ú–û–í - 26.12.2025

## üéØ –ü–†–û–ë–õ–ï–ú–ê

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ —É–∫–∞–∑–∞–ª:**
- –ü–æ—á–µ–º—É –º—ã —Å–¥–µ–ª–∞–ª–∏ fallback –æ–¥–Ω–∏–º —Ä–µ–∂–∏–º–æ–º (RANGING)?
- –û–Ω –∂–µ –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å!
- –ü–æ—á–µ–º—É –Ω–µ —Å–¥–µ–ª–∞—Ç—å –±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –∫–∞–∂–¥–æ–º —Ä–µ–∂–∏–º–µ?
- –ß—Ç–æ–±—ã –±–æ—Ç —Ä–∞–±–æ—Ç–∞–ª –≤—Å–µ –≤—Ä–µ–º—è –≤ –æ–¥–Ω–æ–º –∏–∑ —Ä–µ–∂–∏–º–æ–≤, –Ω–µ –±—ã–ª–æ —Ö–∞—Ä–¥–∫–æ–¥–∞?
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –Ω–∞ –∫–∞–∂–¥—É—é –ø–∞—Ä—É –∏ –Ω–∞ –∫–∞–∂–¥—ã–π —Ä–µ–∂–∏–º –ø–µ—Ä–µ–∫–ª—é—á–∞–ª–∏—Å—å –±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏?
- –ß—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ fallback?

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï: –°–ò–°–¢–ï–ú–ê –°–ö–û–†–ò–ù–ì–ê –ë–ï–ó FALLBACK

### –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (–ü–†–û–ë–õ–ï–ú–ê):

```python
# –ü—Ä–æ–≤–µ—Ä—è–µ–º CHOPPY
if (—É—Å–ª–æ–≤–∏—è):
    return CHOPPY

# –ü—Ä–æ–≤–µ—Ä—è–µ–º TRENDING
if (—É—Å–ª–æ–≤–∏—è):
    return TRENDING

# –ü—Ä–æ–≤–µ—Ä—è–µ–º RANGING
if (—É—Å–ª–æ–≤–∏—è):
    return RANGING

# FALLBACK - –≤—Å–µ–≥–¥–∞ RANGING
return RANGING, 0.5, "No clear regime detected ‚Üí default to RANGING"
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ —É—Å–ª–æ–≤–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è fallback –Ω–∞ RANGING, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å.

---

### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ (–†–ï–®–ï–ù–ò–ï):

```python
# –í—ã—á–∏—Å–ª—è–µ–º score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
choppy_score = calculate_choppy_score(indicators)
trending_score = calculate_trending_score(indicators)
ranging_score = calculate_ranging_score(indicators)

# –í—ã–±–∏—Ä–∞–µ–º —Ä–µ–∂–∏–º —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º score (–ë–ï–ó FALLBACK)
best_regime = max([CHOPPY, TRENDING, RANGING], key=lambda r: scores[r])
return best_regime, confidence, reason
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –í—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω –∏–∑ —Ä–µ–∂–∏–º–æ–≤ (TRENDING, RANGING, CHOPPY)
- ‚úÖ –ù–µ—Ç fallback - —Ä–µ–∂–∏–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ë–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Ç–æ—Ä–≥–æ–≤–ª–∏

---

## üìä –ù–û–í–ê–Ø –°–ò–°–¢–ï–ú–ê –°–ö–û–†–ò–ù–ì–ê

### CHOPPY Score (–º–∞–∫—Å 1.0):

1. **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (–º–∞–∫—Å 40%):**
   - `vol > high_volatility_threshold` ‚Üí –¥–æ 40%
   - –ß–µ–º –≤—ã—à–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, —Ç–µ–º –≤—ã—à–µ score

2. **–†–∞–∑–≤–æ—Ä–æ—Ç—ã (–º–∞–∫—Å 30%):**
   - `reversals > 5` ‚Üí –¥–æ 30% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ —Å 8)
   - –ß–µ–º –±–æ–ª—å—à–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤, —Ç–µ–º –≤—ã—à–µ score

3. **–û–±—ä–µ–º (–º–∞–∫—Å 30%):**
   - `volume_ratio > 1.1` ‚Üí –¥–æ 30% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ —Å 1.2)
   - –ß–µ–º –≤—ã—à–µ –æ–±—ä–µ–º, —Ç–µ–º –≤—ã—à–µ score

**–ò—Ç–æ–≥–æ:** `choppy_score = vol_score + reversal_score + volume_score`

---

### TRENDING Score (–º–∞–∫—Å 1.0):

1. **Trend Deviation (–º–∞–∫—Å 30%):**
   - `trend_dev > trend_strength_percent` ‚Üí –¥–æ 30%
   - `trend_dev > trend_strength_percent * 0.5` ‚Üí –¥–æ 15% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ)
   - –ß–µ–º –±–æ–ª—å—à–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ, —Ç–µ–º –≤—ã—à–µ score

2. **ADX (–º–∞–∫—Å 30%):**
   - `adx > trending_adx_threshold` ‚Üí –¥–æ 30%
   - `adx > trending_adx_threshold * 0.7` ‚Üí –¥–æ 15% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ)
   - –ß–µ–º –≤—ã—à–µ ADX, —Ç–µ–º –≤—ã—à–µ score

3. **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç—å (–º–∞–∫—Å 20%):**
   - `has_direction` (trend_direction –∏–ª–∏ |+DI - -DI| > 3.0) ‚Üí 20% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ —Å 5.0)
   - –ï—Å—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç—å ‚Üí +20%

4. **–û–±—ä–µ–º (–º–∞–∫—Å 20%, –æ–ø—Ü–∏–æ–Ω–∞–ª–µ–Ω):**
   - `volume_ratio > 0.9` ‚Üí –¥–æ 20% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ)
   - –ß–µ–º –≤—ã—à–µ –æ–±—ä–µ–º, —Ç–µ–º –≤—ã—à–µ score

**–ò—Ç–æ–≥–æ:** `trending_score = trend_dev_score + adx_score + direction_score + volume_score`

---

### RANGING Score (–º–∞–∫—Å 1.0):

1. **–£–∑–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω (–º–∞–∫—Å 40%):**
   - `range_width < 5.0%` ‚Üí –¥–æ 40% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ —Å 3.0%)
   - `range_width < 10.0%` ‚Üí –¥–æ 20% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ)
   - –ß–µ–º —É–∂–µ –¥–∏–∞–ø–∞–∑–æ–Ω, —Ç–µ–º –≤—ã—à–µ score

2. **–°–ª–∞–±—ã–π —Ç—Ä–µ–Ω–¥ (–º–∞–∫—Å 30%):**
   - `trend_dev < trend_strength_percent` ‚Üí –¥–æ 30%
   - –ß–µ–º —Å–ª–∞–±–µ–µ —Ç—Ä–µ–Ω–¥, —Ç–µ–º –≤—ã—à–µ score

3. **–ù–∏–∑–∫–∏–π ADX (–º–∞–∫—Å 30%):**
   - `adx < ranging_adx_threshold` ‚Üí –¥–æ 30%
   - `adx < ranging_adx_threshold * 1.5` ‚Üí –¥–æ 15% (—Ä–∞—Å—à–∏—Ä–µ–Ω–æ)
   - –ß–µ–º –Ω–∏–∂–µ ADX, —Ç–µ–º –≤—ã—à–µ score

**–ò—Ç–æ–≥–æ:** `ranging_score = range_score + trend_weak_score + adx_low_score`

---

## üîß –ò–ó–ú–ï–ù–ï–ù–ò–Ø –í –ö–û–î–ï

### –§–∞–π–ª: `src/strategies/scalping/futures/adaptivity/regime_manager.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. ‚úÖ –£–±—Ä–∞–Ω–∞ fallback –ª–æ–≥–∏–∫–∞ `return RANGING, 0.5, "No clear regime detected"`
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
3. ‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ (–±–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ —É—Å–ª–æ–≤–∏—è)
4. ‚úÖ –í—Å–µ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ä–µ–∂–∏–º —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º score
5. ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–∫–∞–∑–æ–º scores –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –æ–¥–∏–Ω –∏–∑ —Ä–µ–∂–∏–º–æ–≤ (TRENDING, RANGING, CHOPPY)
- ‚úÖ –ù–µ—Ç fallback - —Ä–µ–∂–∏–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ë–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–ª—É—á–∞–∏

---

## üìã –ü–†–ò–ú–ï–†–´ –†–ê–ë–û–¢–´

### –ü—Ä–∏–º–µ—Ä 1: –°–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥
```
ADX: 25.0, Trend Dev: 2.5%, Volatility: 1.5%, Reversals: 3, Volume: 1.3x
Scores: CHOPPY=0.15, TRENDING=0.85, RANGING=0.20
‚Üí –í—ã–±—Ä–∞–Ω: TRENDING (confidence: 85%)
```

### –ü—Ä–∏–º–µ—Ä 2: –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
```
ADX: 12.0, Trend Dev: 0.5%, Volatility: 3.0%, Reversals: 12, Volume: 1.5x
Scores: CHOPPY=0.90, TRENDING=0.10, RANGING=0.30
‚Üí –í—ã–±—Ä–∞–Ω: CHOPPY (confidence: 90%)
```

### –ü—Ä–∏–º–µ—Ä 3: –ë–æ–∫–æ–≤–æ–π —Ä—ã–Ω–æ–∫
```
ADX: 15.0, Trend Dev: 0.8%, Volatility: 1.2%, Reversals: 4, Volume: 1.0x
Scores: CHOPPY=0.10, TRENDING=0.25, RANGING=0.75
‚Üí –í—ã–±—Ä–∞–Ω: RANGING (confidence: 75%)
```

### –ü—Ä–∏–º–µ—Ä 4: –ù–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π (—Ä–∞–Ω—å—à–µ –±—ã–ª fallback)
```
ADX: 16.0, Trend Dev: 1.2%, Volatility: 1.8%, Reversals: 6, Volume: 1.1x
Scores: CHOPPY=0.35, TRENDING=0.45, RANGING=0.55
‚Üí –í—ã–±—Ä–∞–Ω: RANGING (confidence: 55%) - –ù–ï FALLBACK, –∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ scores!
```

---

## üéØ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ô –°–ò–°–¢–ï–ú–´

1. ‚úÖ **–ù–µ—Ç fallback** - –≤—Å–µ–≥–¥–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ä–µ–∂–∏–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
2. ‚úÖ **–ë–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –∫–∞–∂–¥—ã–π —Ä–µ–∂–∏–º –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –±–æ–ª—å—à–µ —Å–ª—É—á–∞–µ–≤
3. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ** - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
4. ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - —Ä–µ–∂–∏–º –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, –∞ –Ω–µ —Ö–∞—Ä–¥–∫–æ–¥–∞
5. ‚úÖ **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç scores –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞

---

## üìã –°–¢–ê–¢–£–°

**‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û**

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**
1. ‚úÖ –ö–†–ò–¢–ò–ß–ù–û: –£–±—Ä–∞–Ω–∞ fallback –ª–æ–≥–∏–∫–∞
2. ‚úÖ –ö–†–ò–¢–ò–ß–ù–û: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞
3. ‚úÖ –ö–†–ò–¢–ò–ß–ù–û: –†–∞—Å—à–∏—Ä–µ–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 26.12.2025  
**–í–µ—Ä—Å–∏—è:** 1.2.4



