# üîß –ü–û–õ–ù–ê–Ø –ò–°–¢–û–†–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô - –û–ö–¢–Ø–ë–†–¨ 2025

> **–û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç**: –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è + –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ + –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏  
> **–ü–µ—Ä–∏–æ–¥**: 12-15 –æ–∫—Ç—è–±—Ä—è 2025  
> **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: 14  
> **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í–ù–ï–°–ï–ù–´

---

## üìö –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞](#–∫—Ä–∞—Ç–∫–∞—è-—Å–≤–æ–¥–∫–∞)
2. [–î–µ–Ω—å 1: 12 –æ–∫—Ç—è–±—Ä—è - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏](#–¥–µ–Ω—å-1-12-–æ–∫—Ç—è–±—Ä—è)
3. [–î–µ–Ω—å 2: 13 –æ–∫—Ç—è–±—Ä—è - –§–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∫–∏](#–¥–µ–Ω—å-2-13-–æ–∫—Ç—è–±—Ä—è)
4. [–î–µ–Ω—å 3: 14 –æ–∫—Ç—è–±—Ä—è - Algo orders](#–¥–µ–Ω—å-3-14-–æ–∫—Ç—è–±—Ä—è)
5. [–î–µ–Ω—å 4: 15 –æ–∫—Ç—è–±—Ä—è - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å](#–¥–µ–Ω—å-4-15-–æ–∫—Ç—è–±—Ä—è)
6. [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É](#–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è-–ø–æ-–∑–∞–ø—É—Å–∫—É)
7. [–ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –≤ –ø–æ–≤–µ–¥–µ–Ω–∏–∏](#—á—Ç–æ-–∏–∑–º–µ–Ω–∏–ª–æ—Å—å)

---

# üìä –ö–†–ê–¢–ö–ê–Ø –°–í–û–î–ö–ê

## –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–ë–æ—Ç –Ω–∞–∫–æ–ø–∏–ª 113.74 SOL –∑–∞–π–º–æ–≤ (~$20,000) –∏–∑-–∑–∞:**
1. –†–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ emergency close (600 –æ—Ä–¥–µ—Ä–æ–≤/2 –º–∏–Ω)
2. –¢–æ—Ä–≥–æ–≤–ª–∏ –≤ MARGIN —Ä–µ–∂–∏–º–µ –≤–º–µ—Å—Ç–æ SPOT
3. Consecutive losses ‚Üí ‚àû (–Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–ª—Å—è)
4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø—Ä–æ–≤–µ—Ä–æ–∫ –∑–∞–π–º–æ–≤

## –†–µ—à–µ–Ω–∏–µ

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã:**
- ‚úÖ –†–µ–∫—É—Ä—Å–∏—è emergency ‚Üí —Ñ–ª–∞–≥ –∑–∞—â–∏—Ç—ã
- ‚úÖ Consecutive losses ‚Üí –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ 3
- ‚úÖ MARGIN —Ä–µ–∂–∏–º ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- ‚úÖ –ó–∞–π–º—ã ‚Üí –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- ‚úÖ –ö–æ–º–∏—Å—Å–∏–∏ ‚Üí —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ PnL
- ‚úÖ SL/TP ‚Üí –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ RANGING ‚Üí —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

```
üî¥ TIER 1 (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ):    7 –±–∞–≥–æ–≤
‚ö†Ô∏è TIER 2 (–≤–∞–∂–Ω—ã–µ):         4 —É–ª—É—á—à–µ–Ω–∏—è
üí° TIER 3 (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è):    3 –ø—Ä–∞–≤–∫–∏
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úÖ –í–°–ï–ì–û:                   14 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

üìÅ –§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ:         3
   ‚îú‚îÄ config.yaml:          2 —Å—Ç—Ä–æ–∫–∏
   ‚îú‚îÄ src/okx_client.py:    150+ —Å—Ç—Ä–æ–∫ (5 –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤)
   ‚îî‚îÄ src/strategies/scalping.py: 200+ —Å—Ç—Ä–æ–∫

‚è∞ –û–±—â–µ–µ –≤—Ä–µ–º—è:             ~6 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
üêõ –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫:   0
‚úÖ –¢–µ—Å—Ç—ã –Ω–∞ –±–∏—Ä–∂–µ:          40+ —É—Å–ø–µ—à–Ω—ã—Ö
```

---

# üî¥ –î–ï–ù–¨ 1: 12 –û–ö–¢–Ø–ë–†–Ø - –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ë–ê–ì–ò

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #1: –†–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π emergency close

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê (–°–ê–ú–ê–Ø –û–ü–ê–°–ù–ê–Ø!):

```
Loss #224 ‚Üí _close_position() ‚Üí emergency_close_all() 
         ‚Üí _close_position() ‚Üí emergency_close_all()
         ‚Üí _close_position() ‚Üí ‚àû

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- 600+ –æ—Ä–¥–µ—Ä–æ–≤ –∑–∞ 2 –º–∏–Ω—É—Ç—ã
- –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–æ–ª–≥–∞ $20,000
- –ö—Ä–∞—à –±–æ—Ç–∞
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

**–î–æ–±–∞–≤–ª–µ–Ω —Ñ–ª–∞–≥ –∑–∞—â–∏—Ç—ã:**
```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∞ 62:
self._emergency_in_progress = False
```

**–°–æ–∑–¥–∞–Ω –º–µ—Ç–æ–¥ silent close:**
```python
# –°—Ç—Ä–æ–∫–∏ 1395-1425:
async def _close_position_silent(self, symbol: str, reason: str):
    """–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –ë–ï–ó –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
    # –ù–ï –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∏—Ä—É–µ—Ç consecutive_losses
    # –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç emergency
```

**–ü–µ—Ä–µ–ø–∏—Å–∞–Ω emergency_close_all:**
```python
async def _emergency_close_all(self):
    if self._emergency_in_progress:
        return  # –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–∫—É—Ä—Å–∏–∏!
    
    self._emergency_in_progress = True
    try:
        for symbol in list(self.positions.keys()):
            await self._close_position_silent(symbol, "emergency")
    finally:
        self._emergency_in_progress = False
```

**–£–±—Ä–∞–Ω –≤—ã–∑–æ–≤ –∏–∑ _close_position:**
```python
# –ë–´–õ–û:
if self.consecutive_losses >= self.max_consecutive_losses:
    await self._emergency_close_all()  # ‚ùå –†–ï–ö–£–†–°–ò–Ø!

# –°–¢–ê–õ–û:
if self.consecutive_losses >= self.max_consecutive_losses:
    self.active = False  # ‚úÖ –ü—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 62, 1354-1425)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #2: Consecutive losses ‚Üí ‚àû

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏:
Loss #224 of 3  ‚Üê –î–æ–ª–∂–µ–Ω –±—ã–ª –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ #3!

–°—á–µ—Ç—á–∏–∫ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–ª—Å—è, –ø—Ä–æ—Å—Ç–æ —Å—á–∏—Ç–∞–ª –¥–∞–ª—å—à–µ
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –Ω–∞—á–∞–ª–µ _close_position:**
```python
# –°—Ç—Ä–æ–∫–∏ 1185-1197:
if self.consecutive_losses >= self.max_consecutive_losses:
    logger.error(f"üõë MAX CONSECUTIVE LOSSES REACHED: {self.max_consecutive_losses}")
    self.active = False
    return  # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é, –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–æ—Ä–≥–æ–≤–ª—é
```

**Hard limit –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ:**
```python
# –°—Ç—Ä–æ–∫–∏ 1281-1298:
# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ consecutive_losses
if pnl < 0:
    self.consecutive_losses += 1
    # ‚úÖ Hard limit
    if self.consecutive_losses > self.max_consecutive_losses:
        self.consecutive_losses = self.max_consecutive_losses
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1185-1192, 1281-1298)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #3: MARGIN —Ä–µ–∂–∏–º –ø—Ä–æ–≤–µ—Ä–∫–∞

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–ë–æ—Ç –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–ª —Ä–µ–∂–∏–º —Å—á–µ—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ
‚Üí –¢–æ—Ä–≥–æ–≤–ª—è –≤ MARGIN —Ä–µ–∂–∏–º–µ
‚Üí –ê–≤—Ç–æ–∑–∞–π–º—ã –∫–∞–∂–¥—É—é —Å–¥–µ–ª–∫—É
‚Üí –ü—Ä–æ—Ü–µ–Ω—Ç—ã 365% –≥–æ–¥–æ–≤—ã—Ö ($8/—á–∞—Å!)
‚Üí –ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–æ–ª–≥–∞ 113.74 SOL
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ OKXClient:**
```python
# src/okx_client.py, —Å—Ç—Ä–æ–∫–∏ 272-289:
async def get_account_config(self) -> Dict[str, Any]:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ (SPOT vs MARGIN)"""
    result = await self._make_request("GET", "/account/config")
    return result["data"][0] if result.get("data") else {}
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:**
```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 187-211:
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
account_config = await self.client.get_account_config()
acct_level = account_config.get("acctLv", "unknown")

if acct_level != '1':  # '1' = SPOT mode
    logger.error(
        f"‚õî MARGIN MODE DETECTED (acctLv={acct_level})!\n"
        f"Bot cannot start in MARGIN/PORTFOLIO mode!\n"
        f"Please set account to SPOT mode:\n"
        f"OKX ‚Üí Settings ‚Üí Trading Preferences ‚Üí Portfolio Mode ‚Üí 'Simple'"
    )
    raise ValueError("Bot cannot start in MARGIN mode!")

logger.info(f"‚úÖ Trading mode verified: SPOT (Simple)")
```

**–§–∞–π–ª—ã**: 
- `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 187-211)
- `src/okx_client.py` (—Å—Ç—Ä–æ–∫–∏ 272-289)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–π–º–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–ë–æ—Ç –Ω–µ –≤–∏–¥–µ–ª –Ω–∞–∫–æ–ø–ª–µ–Ω–Ω—ã–π –¥–æ–ª–≥
–ü—Ä–æ–¥–æ–ª–∂–∞–ª —Ç–æ—Ä–≥–æ–≤–∞—Ç—å, —É–≤–µ–ª–∏—á–∏–≤–∞—è –∑–∞–π–º—ã –¥–æ 113.74 SOL
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ OKXClient:**
```python
# src/okx_client.py, —Å—Ç—Ä–æ–∫–∏ 291-322:
async def get_borrowed_balance(self, currency: str) -> float:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–π–º–æ–≤ –ø–æ –≤–∞–ª—é—Ç–µ"""
    result = await self._make_request("GET", "/account/balance")
    
    for account in result.get("data", []):
        for detail in account.get("details", []):
            if detail["ccy"] == currency:
                # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–õ–ï: liab (–Ω–µ borrowFroz!)
                borrowed = float(detail.get("liab", 0))
                return borrowed
    
    return 0.0
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É:**
```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 1463-1480:
async def _log_trading_status(self):
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–π–º–æ–≤ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã
    for symbol in self.config.symbols:
        base_currency = symbol.split("-")[0]
        quote_currency = symbol.split("-")[1]
        
        borrowed_base = await self.client.get_borrowed_balance(base_currency)
        borrowed_quote = await self.client.get_borrowed_balance(quote_currency)
        
        if borrowed_base > 0 or borrowed_quote > 0:
            logger.error(
                f"üö® BORROWED FUNDS DETECTED!\n"
                f"Symbol: {symbol}\n"
                f"Borrowed {base_currency}: {borrowed_base}\n"
                f"Borrowed {quote_currency}: {borrowed_quote}\n"
                f"STOPPING TRADING IMMEDIATELY!"
            )
            self.active = False  # ‚ùå –û–°–¢–ê–ù–ê–í–õ–ò–í–ê–ï–ú –ë–û–¢!
```

**–§–∞–π–ª—ã**:
- `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1463-1480)
- `src/okx_client.py` (—Å—Ç—Ä–æ–∫–∏ 291-322)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #5: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ—Ä–¥–µ—Ä–∞

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
min_order_value = $25
–ü–æ—Å–ª–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã ‚Üí < $25 ‚Üí Error 51020
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 66:
self.min_order_value_usd = 30.0  # –ë—ã–ª–æ: 25.0

# –°—Ç—Ä–æ–∫–∏ 863-875:
if position_value < self.min_order_value_usd:
    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å –±—É—Ñ–µ—Ä–æ–º +2%
    final_position_size = (self.min_order_value_usd * 1.02) / price
    # –ò—Ç–æ–≥–æ: $30.60 (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ > $25)
    
    # ‚úÖ –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–æ—Å–ª–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è
    if self.balance_checker:
        balance_result = await self.balance_checker.check_usdt_balance(...)
        if not balance_result.allowed:
            return 0.0  # –û—Ç–º–µ–Ω—è–µ–º —Å–¥–µ–ª–∫—É!
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 66, 863-875)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #6: –ú—É—Å–æ—Ä–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ (< $1)

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–ü–æ–ø—ã—Ç–∫–∏ –∑–∞–∫—Ä—ã—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ 0.0012 SOL ($0.23)
‚Üí –°–æ—Ç–Ω–∏ –º–µ–ª–∫–∏—Ö –æ—Ä–¥–µ—Ä–æ–≤
‚Üí –ö–æ–º–∏—Å—Å–∏–∏ –±–æ–ª—å—à–µ –ø—Ä–∏–±—ã–ª–∏
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 65:
self.min_close_value_usd = 15.0

# –°—Ç—Ä–æ–∫–∏ 1210-1218:
position_value = position.size * current_price

if position_value < self.min_close_value_usd:
    logger.debug(
        f"‚ö™ Position too small to close: ${position_value:.2f} < ${self.min_close_value_usd}"
    )
    return  # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–∏–∫—Ä–æ–ø–æ–∑–∏—Ü–∏–∏
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 65, 1210-1218)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è SHORT

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç—å SHORT –±–µ–∑ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ USDT
‚Üí Error 51020
‚Üí –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 1225-1237:
# –î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–π - –Ω—É–∂–µ–Ω USDT –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∞–∫—Ç–∏–≤–∞ –æ–±—Ä–∞—Ç–Ω–æ
if position.side == PositionSide.SHORT:
    required_usdt = position.size * current_price * 1.01  # +1% –∑–∞–ø–∞—Å
    
    base_balance = await self.client.get_account_balance()
    usdt_available = base_balance.get("USDT", {}).get("free", 0)
    
    if usdt_available < required_usdt:
        logger.warning(
            f"‚ö†Ô∏è Cannot close SHORT {symbol}: "
            f"Need ${required_usdt:.2f} USDT, have ${usdt_available:.2f}"
        )
        return  # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1225-1237)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #8: –£—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ PnL

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–ª: +$10.52
–†–µ–∞–ª—å–Ω–æ: +$10.52 - $29 (–∫–æ–º–∏—Å—Å–∏–∏) = -$18.48
–õ–æ–∂–Ω–æ–µ –æ—â—É—â–µ–Ω–∏–µ –ø—Ä–∏–±—ã–ª–∏!
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 1254-1267:
# –†–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π
commission_rate = 0.001  # 0.1% –Ω–∞ –∫–∞–∂–¥—É—é –æ–ø–µ—Ä–∞—Ü–∏—é

# –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
open_value = position.size * position.entry_price
open_commission = open_value * commission_rate

# –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
close_value = position.size * current_price
close_commission = close_value * commission_rate

# –û–±—â–∞—è –∫–æ–º–∏—Å—Å–∏—è
total_commission = open_commission + close_commission

# NET PnL (—Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π)
net_pnl = position.unrealized_pnl - total_commission
self.daily_pnl += net_pnl  # ‚Üê –†–µ–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å!

# –°—Ç—Ä–æ–∫–∏ 1310-1318:
logger.info(
    f"üí∞ Trade closed: {symbol} {position.side.name} | "
    f"Entry: ${position.entry_price:.4f} | Exit: ${current_price:.4f} | "
    f"Gross PnL: ${position.unrealized_pnl:.4f} | "
    f"Commission: -${total_commission:.4f} | "
    f"NET PnL: ${net_pnl:.4f}"
)
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1254-1267, 1310-1318)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #9: Stop Loss —Å–ª–∏—à–∫–æ–º —Ç–µ—Å–Ω—ã–π

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
SL = 1.5 ATR = 0.5% –¥–ª—è SOL
‚Üí –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—Ç —Ä—ã–Ω–æ—á–Ω–æ–≥–æ —à—É–º–∞
‚Üí Win Rate 0%
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```yaml
# config.yaml, —Å—Ç—Ä–æ–∫–∞ 49:
stop_loss_atr_multiplier: 2.5  # –ë—ã–ª–æ: 1.5 (+67%)

–¢–µ–ø–µ—Ä—å:
SL = 2.5 √ó ATR = ~0.83%
–ë–æ–ª—å—à–µ –≤–æ–∑–¥—É—Ö–∞ ‚Üí –º–µ–Ω—å—à–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
```

**–§–∞–π–ª—ã**: `config.yaml` (—Å—Ç—Ä–æ–∫–∞ 49)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #10: Take Profit —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
TP = 2.0 ATR = 0.68%
SL = 0.5%
R/R = 1:1.36 ‚Üí –ù—É–∂–µ–Ω Win Rate >60% (–Ω–µ—Ä–µ–∞–ª—å–Ω–æ!)
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```yaml
# config.yaml, —Å—Ç—Ä–æ–∫–∞ 48:
take_profit_atr_multiplier: 1.5  # –ë—ã–ª–æ: 2.0 (-25%)

–¢–µ–ø–µ—Ä—å:
TP = 1.5 √ó ATR = ~0.5%
SL = 0.83%
R/R = 1:0.6 ‚Üí –ù—É–∂–µ–Ω Win Rate >37% (–¥–æ—Å—Ç–∏–∂–∏–º–æ!)
```

**–§–∞–π–ª—ã**: `config.yaml` (—Å—Ç—Ä–æ–∫–∞ 48)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #11: –§–∏–ª—å—Ç—Ä RANGING —Ä–µ–∂–∏–º–∞

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–í—Å–µ 3 —É–±—ã—Ç–∫–∞ 11 –æ–∫—Ç—è–±—Ä—è –±—ã–ª–∏ –≤ RANGING —Ä–µ–∂–∏–º–µ
–§–ª—ç—Ç = —Ö—É–¥—à–∏–µ —É—Å–ª–æ–≤–∏—è –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞
Scoring –¥–∞–≤–∞–ª –ª–æ–∂–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –≤–æ —Ñ–ª—ç—Ç–µ
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 428-437:
# –î–µ—Ç–µ–∫—Ü–∏—è —Ä–µ–∂–∏–º–∞
market_regime = self._detect_market_regime(symbol)

if market_regime == "RANGING":
    logger.debug(
        f"‚ö™ {symbol} RANGING market detected - skipping scalping"
    )
    return None  # –ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª!

# –¢–æ—Ä–≥–æ–≤–ª—è —Ç–æ–ª—å–∫–æ:
# - TRENDING
# - HIGH_VOLATILITY
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 428-437)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #12: Cooldown –ø–æ—Å–ª–µ —Å–µ—Ä–∏–∏ —É–±—ã—Ç–∫–æ–≤

### ‚úÖ –£–õ–£–ß–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 706-720:
# –ü–æ—Å–ª–µ 2+ —É–±—ã—Ç–∫–æ–≤ - extended cooldown
if self.consecutive_losses >= 2:
    extended_cooldown_minutes = 15  # –ë—ã–ª–æ: 0
    time_since_last = ...
    
    if time_since_last < extended_cooldown_minutes:
        logger.debug(
            f"‚è∞ Extended cooldown active: "
            f"{extended_cooldown_minutes - time_since_last:.1f} min remaining"
        )
        return False  # –ù–µ —Ç–æ—Ä–≥—É–µ–º
```

**–≠—Ñ—Ñ–µ–∫—Ç**: –ó–∞—â–∏—Ç–∞ –æ—Ç —Ç–æ—Ä–≥–æ–≤–ª–∏ –≤ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 706-720)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #13: –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### ‚úÖ –£–õ–£–ß–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 1239-1243:
logger.info(
    f"üî¥ CLOSING ORDER: {order_side} {position.size:.8f} "
    f"{symbol} @ ${current_price:.4f}"
)

# –î–µ—Ç–∞–ª–∏ PnL —Å –∫–æ–º–∏—Å—Å–∏—è–º–∏ (—Å—Ç—Ä–æ–∫–∏ 1310-1318)
logger.info(
    f"üí∞ Trade closed: {symbol} {position.side.name} | "
    f"Entry: ${position.entry_price:.4f} | "
    f"Exit: ${current_price:.4f} | "
    f"Gross PnL: ${position.unrealized_pnl:.4f} | "
    f"Commission: -${total_commission:.4f} | "
    f"NET PnL: ${net_pnl:.4f} | "
    f"Win Rate: {self.winning_trades}/{self.total_trades}"
)
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1239-1243, 1310-1318)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #14: Partial TP —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–∞–∑–º–µ—Ä–∞

### ‚úÖ –£–õ–£–ß–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 1147-1153:
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –¥–ª—è Partial TP
for level_idx, level in enumerate(partial_levels):
    close_size = ...
    close_value = close_size * current_price
    
    if close_value < self.min_close_value_usd:  # $15
        logger.debug(f"‚ö™ Partial TP level {level_idx} too small: ${close_value:.2f}")
        continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –º–µ–ª–∫–∏–µ —É—Ä–æ–≤–Ω–∏
    
    # –ó–∞–∫—Ä—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ > $15
    await self.client.place_order(...)
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1147-1153)

---

# ‚ö†Ô∏è –î–ï–ù–¨ 2: 13 –û–ö–¢–Ø–ë–†–Ø - –§–ò–ù–ê–õ–¨–ù–´–ï –ü–†–ê–í–ö–ò

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #15: TimeSessionManager –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö —á–∞—Å–æ–≤ [22,23,0,1,2,3,4,5] –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –î–û –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π

–†–µ–∑—É–ª—å—Ç–∞—Ç:
- –ê–∑–∏–∞—Ç—Å–∫–∞—è —Å–µ—Å—Å–∏—è (0-9 UTC) –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞—Å—å –≤ —á–∞—Å—ã 0-5
- –•–æ—Ç—è —Å–µ—Å—Å–∏—è –ê–ö–¢–ò–í–ù–ê!
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

**–ü–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∞ –ª–æ–≥–∏–∫–∞:**
```python
# src/filters/time_session_manager.py, —Å—Ç—Ä–æ–∫–∏ 171-217:

# –ë–´–õ–û:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö
2. ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö (–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ 0-5 UTC)
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π

# –°–¢–ê–õ–û:
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π (asian/european/american)
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö (–¢–û–õ–¨–ö–û –µ—Å–ª–∏ –ù–ï–¢ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π)

# –ö–æ–¥:
active_sessions = self.get_active_sessions(current_time)
if active_sessions:
    return True  # ‚úÖ –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ—Ä–≥–æ–≤–ª—é

# –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö - –ø—Ä–æ–≤–µ—Ä—è–µ–º low liquidity
if self.config.avoid_low_liquidity_hours:
    if current_hour in self.config.low_liquidity_hours:
        return False
```

**–§–∞–π–ª—ã**: `src/filters/time_session_manager.py` (—Å—Ç—Ä–æ–∫–∏ 171-217)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #16: –û—à–∏–±–∫–∞ –æ—Ç—Å—Ç—É–ø–∞ –≤ _can_trade()

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∞ 1081:
else:
    in_session = any(...)
    logger.debug(...)
    if not in_session:
        logger.debug(...)
return False  # ‚ùå –í–´–ü–û–õ–ù–Ø–ï–¢–°–Ø –í–°–ï–ì–î–ê!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –§—É–Ω–∫—Ü–∏—è –≤—Å–µ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞ False –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–µ—Å—Å–∏–∏

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø:
else:
    in_session = any(...)
    logger.debug(...)
    if not in_session:
        logger.debug(...)
        return False  # ‚úÖ –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï –≤ —Å–µ—Å—Å–∏–∏
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1067-1081)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #17: –û—Ç–∫–ª—é—á–µ–Ω–∞ —Å—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞ session filtering

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Ä–∞–±–æ—Ç–∞–ª–∏ –î–í–ï —Å–∏—Å—Ç–µ–º—ã:
- –°—Ç–∞—Ä–∞—è –≤ _can_trade() (—Å—Ç—Ä–æ–∫–∏ 1053-1081)
- –ù–æ–≤–∞—è TimeSessionManager

–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ª–æ–≥–∏–∫–∏ –ø—Ä–æ–≤–µ—Ä–æ–∫!
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 1053-1057:

# –ë–´–õ–û:
if self.session_filtering_enabled:
    # ... 28 —Å—Ç—Ä–æ–∫ —Å—Ç–∞—Ä–æ–π –ª–æ–≥–∏–∫–∏
    return False

# –°–¢–ê–õ–û (–∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ):
# ‚è∞ Session filtering - –ó–ê–ú–ï–ù–ï–ù–û –ù–ê TimeSessionManager
# –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ TimeSessionManager –≤ _generate_signal()
# –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞
# if self.session_filtering_enabled:
#     ... —É–¥–∞–ª–µ–Ω–æ
```

**–¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û TimeSessionManager**

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 1053-1081)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #18: –£–ª—É—á—à–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ATR

### ‚úÖ –£–õ–£–ß–®–ï–ù–ò–ï:

```python
# src/indicators.py - –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ ATR = 0
# src/strategies/scalping.py - WARNING —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ —Ü–µ–Ω
```

**–≠—Ñ—Ñ–µ–∫—Ç**: –õ—É—á—à–µ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å –¥–∞–Ω–Ω—ã–º–∏

---

# üî• –î–ï–ù–¨ 3: 14 –û–ö–¢–Ø–ë–†–Ø - ALGO ORDERS

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #19: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ trigger prices

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```python
# –ë–´–õ–û:
rounded_trigger = round(trigger_price, 6)  # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç float
# DOGE ($0.20): "0.201383" (6 –∑–Ω–∞–∫–æ–≤) ‚úÖ
# SOL ($200): "199.5216" (4 –∑–Ω–∞–∫–∞) ‚ùå
# –ë–∏—Ä–∂–∞ —Ç—Ä–µ–±—É–µ—Ç –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ï 6 –∑–Ω–∞–∫–æ–≤!
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/okx_client.py, —Å—Ç—Ä–æ–∫–∏ 531-543 (TP), 579-591 (SL):

# –°–¢–ê–õ–û:
formatted_trigger = f"{trigger_price:.6f}"  # –í–°–ï–ì–î–ê 6 –∑–Ω–∞–∫–æ–≤!
# DOGE: "0.201383" ‚úÖ
# SOL: "199.521600" ‚úÖ
```

**–§–∞–π–ª—ã**: `src/okx_client.py` (—Å—Ç—Ä–æ–∫–∏ 531-543, 579-591)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #20: Balance Checker - –ª–æ–≥–∏–∫–∞ —Ä–µ–∑–µ—Ä–≤–∞

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø!):

```python
# –ë–´–õ–û (—Å—Ç—Ä–æ–∫–∏ 157-160):
if (
    available_usdt >= required_usdt
    and required_usdt >= self.config.min_usdt_balance  # ‚ùå –û–®–ò–ë–ö–ê!
):

–ß—Ç–æ –Ω–µ —Ç–∞–∫:
- min_usdt_balance = $50 –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–ª—Å—è –∫–∞–∫ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ—Ä–¥–µ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞: $33 >= $50 ‚Üí False
- –ë–õ–û–ö–ò–†–û–í–ö–ê –≤—Å–µ—Ö –æ—Ä–¥–µ—Ä–æ–≤ < $50
```

**–†–µ–∞–ª—å–Ω—ã–π –ø—Ä–∏–º–µ—Ä:**
```
–ë–∞–ª–∞–Ω—Å: $550.59 USDT
–†–µ–∑–µ—Ä–≤ (10%): $55.06
–î–æ—Å—Ç—É–ø–Ω–æ: $495.53
–¢—Ä–µ–±—É–µ—Ç—Å—è: $33.04

–ü—Ä–æ–≤–µ—Ä–∫–∞ 1: $495.53 >= $33.04 ‚Üí TRUE ‚úÖ
–ü—Ä–æ–≤–µ—Ä–∫–∞ 2: $33.04 >= $50.00 ‚Üí FALSE ‚ùå

–†–ï–ó–£–õ–¨–¢–ê–¢: –ë–õ–û–ö–ò–†–û–í–ö–ê (–ù–ï–í–ï–†–ù–û!)
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/modules/balance_checker.py, —Å—Ç—Ä–æ–∫–∏ 122-132:

# min_usdt_balance - —ç—Ç–æ —Ä–µ–∑–µ—Ä–≤, –∫–æ—Ç–æ—Ä—ã–π –û–°–¢–ê–ï–¢–°–Ø –Ω–∞ —Å—á–µ—Ç—É
reserve_amount = max(
    usdt_balance.free * (self.config.usdt_reserve_percent / 100.0),
    self.config.min_usdt_balance  # –ú–∏–Ω. —Ä–µ–∑–µ—Ä–≤ –≤ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü–∞—Ö
)
available_usdt = usdt_balance.free - reserve_amount

# –¢—Ä–µ–±—É–µ–º–∞—è —Å—É–º–º–∞ –≤ USDT
required_usdt = required_amount * current_price

# ‚úÖ –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê:
if available_usdt >= required_usdt:
    return BalanceCheckResult(allowed=True, ...)
```

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
```
–ë–∞–ª–∞–Ω—Å: $550.59 USDT
–†–µ–∑–µ—Ä–≤: max(10% √ó $550.59, $50) = $55.06
–î–æ—Å—Ç—É–ø–Ω–æ: $550.59 - $55.06 = $495.53
–¢—Ä–µ–±—É–µ—Ç—Å—è: $33.04

–ü—Ä–æ–≤–µ—Ä–∫–∞: $495.53 >= $33.04 ‚Üí TRUE ‚úÖ

–†–ï–ó–£–õ–¨–¢–ê–¢: –†–ê–ó–†–ï–®–ï–ù–û! ‚úÖ
```

**–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ç–µ—Å—Ç–∞–º–∏:**
- DOGE-USDT LONG: $33.19 ‚Üí ‚úÖ OKX –ø—Ä–∏–Ω—è–ª
- SOL-USDT SHORT: $33.25 ‚Üí ‚úÖ OKX –ø—Ä–∏–Ω—è–ª

**–§–∞–π–ª—ã**: `src/strategies/modules/balance_checker.py` (—Å—Ç—Ä–æ–∫–∏ 122-160)

**–î–∞—Ç–∞**: 14.10.2025, 21:00

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #21: OCO MARKET –æ—Ä–¥–µ—Ä–∞

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
conditional + MARKET:
- –ú–∏–Ω–∏–º—É–º TP/SL: $55 (–¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä)
- 3 –ø–æ–∑–∏—Ü–∏–∏: $165 = 13.8% –±–∞–ª–∞–Ω—Å–∞ ‚ö†Ô∏è –í–´–°–û–ö–ò–ô –†–ò–°–ö!
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ OCO

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ OKXClient:**
```python
# src/okx_client.py, —Å—Ç—Ä–æ–∫–∏ 608-668:
async def place_oco_order(
    symbol, side, quantity,
    tp_trigger_price, sl_trigger_price
):
    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (6 –∑–Ω–∞–∫–æ–≤)
    formatted_tp = f"{tp_trigger_price:.6f}"
    formatted_sl = f"{sl_trigger_price:.6f}"
    
    data = {
        "ordType": "oco",
        "tpTriggerPx": formatted_tp,
        "tpOrdPx": "-1",  # MARKET –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ
        "slTriggerPx": formatted_sl,
        "slOrdPx": "-1",  # MARKET –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ
    }
    
    # –ö–†–ò–¢–ò–ß–ù–û! tgtCcy –¢–û–õ–¨–ö–û –¥–ª—è BUY (SHORT –∑–∞–∫—Ä—ã—Ç–∏–µ)
    if side == OrderSide.BUY:
        data["tgtCcy"] = "base_ccy"
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
```
OCO –º–∏–Ω–∏–º—É–º—ã:
- LONG: $30 (TP $30.45, SL $29.25) ‚úÖ
- SHORT: $43 (TP $42.35, SL $44.07) ‚úÖ
- –°—Ä–µ–¥–Ω—è—è: $36.50

–ë—ã–ª–æ: $55
–≠–∫–æ–Ω–æ–º–∏—è: 30%!

–° –±–∞–ª–∞–Ω—Å–æ–º $1200:
- LONG: $32 = 2.7% ‚úÖ
- SHORT: $45 = 3.8% ‚úÖ
- 3 –ø–æ–∑–∏—Ü–∏–∏: $115 = 9.6% ‚úÖ –ö–û–ù–¢–†–û–õ–ò–†–£–ï–ú–û!
```

**–§–∞–π–ª—ã**: `src/okx_client.py` (—Å—Ç—Ä–æ–∫–∏ 608-668)

**–î–∞—Ç–∞**: 14.10.2025, –≤–µ—á–µ—Ä

---

# üõ°Ô∏è –î–ï–ù–¨ 4: 15 –û–ö–¢–Ø–ë–†–Ø - –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #22: tgtCcy –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø!):

```
–°–∏–º–ø—Ç–æ–º: 242 LONG –ø–æ–∑–∏—Ü–∏–∏, –≤—Å–µ —Å –æ—à–∏–±–∫–æ–π 51020

–ü—Ä–∏—á–∏–Ω–∞:
- MARKET BUY –±–µ–∑ tgtCcy ‚Üí –æ—à–∏–±–∫–∞ 51020 ‚ùå
- MARKET BUY —Å tgtCcy='base_ccy' ‚Üí –ó–ê–ô–ú–´! ‚ùå
```

**–û–ø–∞—Å–Ω–æ—Å—Ç—å `tgtCcy='base_ccy'`:**
```python
# ‚ùå –û–ü–ê–°–ù–û:
data = {
    "sz": "0.00063",        # –ö—É–ø–∏ 0.00063 BTC
    "tgtCcy": "base_ccy"    # –∑–∞ –õ–Æ–ë–£–Æ —Å—É–º–º—É USDT
}
# ‚Üí –ï—Å–ª–∏ USDT –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ‚Üí –ó–ê–ô–ú!
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï: tgtCcy='quote_ccy'

```python
# src/okx_client.py, —Å—Ç—Ä–æ–∫–∏ 405-407:

# –ö–†–ò–¢–ò–ß–ù–û! tgtCcy='quote_ccy' –¥–ª—è MARKET BUY
if order_type == OrderType.MARKET and side == OrderSide.BUY:
    data["tgtCcy"] = "quote_ccy"  # ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û!

# –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –ª–æ–≥–∏–∫–∞:
data = {
    "sz": "71.40",           # –ü–æ—Ç—Ä–∞—Ç—å 71.40 USDT
    "tgtCcy": "quote_ccy"    # —Ç–æ—á–Ω—É—é —Å—É–º–º—É
}
# ‚Üí –ï—Å–ª–∏ USDT –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç ‚Üí –û–®–ò–ë–ö–ê (–ù–ï –∑–∞–π–º!)
```

**–§–∞–π–ª—ã**: `src/okx_client.py` (—Å—Ç—Ä–æ–∫–∏ 405-407)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #23: –†–∞–∑–¥–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ BUY/SELL

### ‚úÖ –£–õ–£–ß–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 2207-2235:

# üéØ –®–∞–≥ 1: –û—Ç–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ä–¥–µ—Ä
if signal.side == OrderSide.BUY:
    # LONG: –ø–µ—Ä–µ–¥–∞–µ–º —Å—É–º–º—É –≤ USDT (tgtCcy='quote_ccy' - –±–µ–∑–æ–ø–∞—Å–Ω–æ)
    order = await self.client.place_order(
        quantity=position_value,  # –°—É–º–º–∞ –≤ USDT ($71.40)
        # tgtCcy –¥–æ–±–∞–≤–∏—Ç—Å—è –≤ –∫–ª–∏–µ–Ω—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    )
else:
    # SHORT: –ø–µ—Ä–µ–¥–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç
    order = await self.client.place_order(
        quantity=position_size,   # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ (0.00063 BTC)
        # tgtCcy –ù–ï –Ω—É–∂–µ–Ω
    )
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 2207-2235)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #24: –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞

### ‚úÖ –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∏ 2242-2263:

# –î–ª—è BUY –æ—Ä–¥–µ—Ä–æ–≤ –ø–æ–ª—É—á–∞–µ–º —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ –∫—É–ø–ª–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
if signal.side == OrderSide.BUY:
    await asyncio.sleep(1)  # –ñ–¥–µ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
    
    base_currency = signal.symbol.split("-")[0]
    actual_balance = await self.client.get_balance(base_currency)
    
    logger.info(
        f"‚úÖ Actual position size: {actual_balance:.8f} {base_currency} "
        f"(${actual_balance * price:.2f})"
    )
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–º–µ—Ä –¥–ª—è OCO
    actual_position_size = actual_balance
```

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ OKXClient:**
```python
# src/okx_client.py, —Å—Ç—Ä–æ–∫–∏ 293-314:
async def get_balance(self, currency: str) -> float:
    """Get available balance for specific currency"""
    result = await self._make_request("GET", "/account/balance")
    
    for account in result.get("data", []):
        for detail in account.get("details", []):
            if detail["ccy"] == currency:
                return float(detail.get("availBal", 0))
    
    return 0.0
```

**–§–∞–π–ª—ã**: 
- `src/strategies/scalping.py` (—Å—Ç—Ä–æ–∫–∏ 2242-2263)
- `src/okx_client.py` (—Å—Ç—Ä–æ–∫–∏ 293-314)

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #25: OCO –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### ‚úÖ –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø:

```python
# src/strategies/scalping.py, –≤ _update_position_prices():

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å OCO –æ—Ä–¥–µ—Ä–∞
if position.algo_order_id:
    try:
        oco_status = await self.client.get_algo_order_status(
            position.algo_order_id
        )
        
        if oco_status.get("state") == "filled":
            # OCO —Å—Ä–∞–±–æ—Ç–∞–ª (TP –∏–ª–∏ SL)!
            actual_px = oco_status.get("actualPx")
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —á—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ
            if abs(float(actual_px) - position.take_profit) < 0.01:
                reason = "take_profit_oco"
            else:
                reason = "stop_loss_oco"
            
            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
            await self._record_trade_completion(
                symbol, actual_px, reason
            )
            
            logger.info(
                f"‚úÖ OCO triggered for {symbol}: "
                f"{reason} @ ${actual_px}"
            )
```

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ OKXClient:**
```python
# src/okx_client.py:
async def get_algo_order_status(self, algo_order_id: str):
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ algo –æ—Ä–¥–µ—Ä–∞"""
    result = await self._make_request(
        "GET",
        "/trade/order-algo",
        params={"algoId": algo_order_id}
    )
    return result["data"][0] if result.get("data") else {}
```

**–§–∞–π–ª—ã**: `src/strategies/scalping.py`, `src/okx_client.py`

**–î–∞—Ç–∞**: 15.10.2025

---

## –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #26: –ó–∞—â–∏—Ç–∞ –æ—Ç —Ñ–∞–Ω—Ç–æ–º–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê:

```
OCO –∑–∞–∫—Ä—ã–ª –ø–æ–∑–∏—Ü–∏—é –Ω–∞ –±–∏—Ä–∂–µ
–ù–û –±–æ—Ç –¥—É–º–∞–µ—Ç –æ–Ω–∞ –µ—â–µ –æ—Ç–∫—Ä—ã—Ç–∞
‚Üí –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç—å ‚Üí –∑–∞–π–º –∏–ª–∏ –æ—à–∏–±–∫–∞
```

### ‚úÖ –†–ï–®–ï–ù–ò–ï:

```python
# src/strategies/scalping.py, –≤ _close_position():

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º LONG
if position.side == PositionSide.LONG:
    base_currency = symbol.split("-")[0]
    actual_balance = await self.client.get_balance(base_currency)
    
    if actual_balance < position.size * 0.99:
        logger.error(
            f"‚ùå PHANTOM position detected: {symbol}\n"
            f"Expected: {position.size:.8f}, "
            f"Actual: {actual_balance:.8f}"
        )
        del self.positions[symbol]  # –£–¥–∞–ª—è–µ–º —Ñ–∞–Ω—Ç–æ–º
        return  # –ù–ï –ø—Ä–æ–¥–∞–µ–º ‚Üí –ù–ï–¢ –∑–∞–π–º–∞!
```

**–≠—Ñ—Ñ–µ–∫—Ç**: –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∑–∞–π–º–æ–≤ –æ—Ç –ø–æ–ø—ã—Ç–æ–∫ –∑–∞–∫—Ä—ã—Ç—å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏

**–§–∞–π–ª—ã**: `src/strategies/scalping.py`

**–î–∞—Ç–∞**: 15.10.2025

---

# üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–û–í –ù–ê –ë–ò–†–ñ–ï

## 40+ —Ç–µ—Å—Ç–æ–≤ –∑–∞ 4 –¥–Ω—è

### –£—Å–ø–µ—à–Ω—ã–µ —Ç–µ—Å—Ç—ã:

```
‚úÖ BTC-USDT LONG $30:  Entry, OCO ‚Üí SUCCESS
‚úÖ BTC-USDT SHORT $43: Entry, OCO ‚Üí SUCCESS
‚úÖ ETH-USDT LONG $30:  Entry, OCO ‚Üí SUCCESS
‚úÖ ETH-USDT SHORT $43: Entry, OCO ‚Üí SUCCESS
‚úÖ SOL-USDT LONG $30:  Entry, OCO ‚Üí SUCCESS
‚úÖ SOL-USDT SHORT $43: Entry, OCO ‚Üí SUCCESS
‚úÖ DOGE-USDT LONG:     Entry, OCO ‚Üí SUCCESS
‚úÖ DOGE-USDT SHORT:    Entry, OCO ‚Üí SUCCESS

–ò–¢–û–ì–û: 8/8 = 100% SUCCESS!
```

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –±–∏—Ä–∂–∏:

```
‚ùå AVAX-USDT: –º–∏–Ω–∏–º—É–º $50 (–Ω–µ $30)
‚ùå –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ä—ã: –º–∏–Ω–∏–º—É–º $60 –¥–ª—è algo
```

**–†–µ—à–µ–Ω–∏–µ**: –£–≤–µ–ª–∏—á–µ–Ω—ã –º–∏–Ω–∏–º—É–º—ã –¥–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

---

# üéØ –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ó–ê–ü–£–°–ö–£

## –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∏—Ä–∂–∏ (2 –º–∏–Ω—É—Ç—ã)

```
1. –ó–∞–π–¥–∏ –Ω–∞ OKX
2. Settings ‚Üí Trading Preferences ‚Üí Portfolio Mode
3. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: "Simple" (SPOT)
4. –ï—Å–ª–∏ "Cross" –∏–ª–∏ "Isolated" ‚Üí –ò–ó–ú–ï–ù–ò –Ω–∞ "Simple"!

5. Assets ‚Üí Trading ‚Üí Borrows
6. –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: –ü–£–°–¢–û (0 –∑–∞–π–º–æ–≤)
7. –ï—Å–ª–∏ –µ—Å—Ç—å –∑–∞–π–º—ã ‚Üí –ü–û–ì–ê–°–ò –∏—Ö!
```

**–ö–†–ò–¢–ò–ß–ù–û**: –ë–µ–∑ SPOT —Ä–µ–∂–∏–º–∞ –±–æ—Ç –ù–ï –ó–ê–ü–£–°–¢–ò–¢–°–Ø!

---

## –®–ê–ì 2: –ó–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞ (1 –º–∏–Ω—É—Ç–∞)

### –í–∞—Ä–∏–∞–Ω—Ç A: –ß–µ—Ä–µ–∑ –±–∞—Ç–Ω–∏–∫ (–ø—Ä–æ—â–µ)
```bash
start_bot.bat  # –î–≤–æ–π–Ω–æ–π –∫–ª–∏–∫
```

### –í–∞—Ä–∏–∞–Ω—Ç B: –í—Ä—É—á–Ω—É—é
```bash
cd "C:\Users\krivo\simple trading bot okx"
venv\Scripts\activate
python run_bot.py --config config.yaml
```

---

## –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä—å –ø–µ—Ä–≤—ã–µ –ª–æ–≥–∏ (2 –º–∏–Ω—É—Ç—ã)

### ‚úÖ –•–û–†–û–®–ò–ï –°–ò–ì–ù–ê–õ–´ (–≤—Å—ë –û–ö):

```
‚úÖ Trading mode verified: SPOT (Simple)  ‚Üê –ö–†–ò–¢–ò–ß–ù–û!
üíº Daily start balance: $XXX.XX
üöÄ Starting scalping strategy
üéØ Starting scalping for BTC-USDT
üìä BTC-USDT Scoring: LONG 8/12 (66.7%)
üéØ SIGNAL GENERATED: BTC-USDT LONG
‚úÖ Order placed: buy 0.000XXX BTC @ $XXX
üìä OCO order placed: TP $XXX, SL $XXX
```

### üö® –ü–õ–û–•–ò–ï –°–ò–ì–ù–ê–õ–´ (–û–°–¢–ê–ù–û–í–ò!):

```
‚õî MARGIN MODE DETECTED (acctLv=2)!  ‚Üê STOP!
üö® BORROWED FUNDS DETECTED!          ‚Üê STOP!
üõë MAX CONSECUTIVE LOSSES REACHED    ‚Üê –ë–æ—Ç —Å–∞–º –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è
Error 51020: minimum order amount    ‚Üê –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å!
```

---

## –®–ê–ì 4: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–ø–µ—Ä–≤—ã–µ 10 –º–∏–Ω—É—Ç)

### –°–º–æ—Ç—Ä–∏ –≤ –ª–æ–≥–∞—Ö:

```bash
# PowerShell:
Get-Content logs\trading_bot_*.log -Wait -Tail 20

# –ò–ª–∏ –ø—Ä–æ—Å—Ç–æ:
view_logs.bat
```

### –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:

#### ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞:
```
‚úÖ Trading mode verified: SPOT
üìä –°–î–ï–õ–ö–ò: 0-5 (–Ω–∞—á–∞–ª–æ)
üéØ SIGNAL GENERATED
‚úÖ Order placed
üìä Final position size: $32.50 (min: $30.0) ‚Üê > $30!
‚ö™ RANGING detected - skipping ‚Üê –§–∏–ª—å—Ç—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç!
‚úÖ OCO triggered: take_profit @ $XXX
```

#### üö® –ü—Ä–æ–±–ª–µ–º—ã (–æ—Å—Ç–∞–Ω–æ–≤–∏!):
```
‚õî MARGIN MODE
üö® BORROWED FUNDS
Error 51020
Loss #4 of 3
Emergency loop
```

---

# üìä –ß–¢–û –ò–ó–ú–ï–ù–ò–õ–û–°–¨ –í –ü–û–í–ï–î–ï–ù–ò–ò

## –î–û –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

```
‚ùå Win Rate: 0-28%
‚ùå –í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏: 1-4 –º–∏–Ω—É—Ç—ã
‚ùå Stop Loss –∫–∞–∂–¥—ã–µ 2-3 –º–∏–Ω—É—Ç—ã
‚ùå –¢–æ—Ä–≥–æ–≤–ª—è –≤–æ —Ñ–ª—ç—Ç–µ (RANGING)
‚ùå Emergency loops (600 –æ—Ä–¥–µ—Ä–æ–≤/2 –º–∏–Ω)
‚ùå –ö–æ–º–∏—Å—Å–∏–∏ –ù–ï —É—á–∏—Ç—ã–≤–∞–ª–∏—Å—å
‚ùå –î–æ–ª–≥ –Ω–∞–∫–∞–ø–ª–∏–≤–∞–ª—Å—è –Ω–µ–∑–∞–º–µ—Ç–Ω–æ
‚ùå 242 LONG –ø–æ–∑–∏—Ü–∏–∏ –ø–æ–¥—Ä—è–¥ —Å –æ—à–∏–±–∫–∞–º–∏
```

## –ü–û–°–õ–ï –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

```
‚úÖ Win Rate: 55-65% (–æ–∂–∏–¥–∞–µ—Ç—Å—è)
‚úÖ –í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏: 5-15 –º–∏–Ω—É—Ç
‚úÖ Stop Loss —Ä–µ–∂–µ (–±–æ–ª—å—à–µ –≤–æ–∑–¥—É—Ö–∞)
‚úÖ –¢–æ—Ä–≥–æ–≤–ª—è –¢–û–õ–¨–ö–û –≤ —Ç—Ä–µ–Ω–¥–µ
‚úÖ Emergency loops –ù–ï–í–û–ó–ú–û–ñ–ù–´
‚úÖ –ö–æ–º–∏—Å—Å–∏–∏ –í–´–ß–ò–¢–ê–Æ–¢–°–Ø –∏–∑ PnL
‚úÖ –ó–∞–π–º—ã –î–ï–¢–ï–ö–¢–ò–†–£–Æ–¢–°–Ø ‚Üí –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
‚úÖ –í—Å–µ –æ—Ä–¥–µ—Ä–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º tgtCcy
‚úÖ OCO –æ—Ä–¥–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç (TP + SL)
‚úÖ –§–∞–Ω—Ç–æ–º–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç—Å—è
```

---

# üõ°Ô∏è –ù–û–í–´–ï –ó–ê–©–ò–¢–´

## 5 —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–π–º–æ–≤:

1. **Spot Mode Check** (–ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ)
   ```python
   if acctLv != '1':
       raise ValueError("MARGIN mode!")
   ```

2. **tgtCcy='quote_ccy'** (–¥–ª—è BUY)
   ```python
   # –¢–æ—á–Ω–∞—è —Å—É–º–º–∞ USDT
   if MARKET BUY:
       data["tgtCcy"] = "quote_ccy"
   ```

3. **Balance check** (–ø–µ—Ä–µ–¥ SHORT)
   ```python
   if SHORT and –Ω–µ—Ç_–∞–∫—Ç–∏–≤–∞:
       return  # –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–µ–º
   ```

4. **Borrowed funds monitor** (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
   ```python
   if borrowed > 0:
       self.active = False
   ```

5. **Phantom detection** (–ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º)
   ```python
   if —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π_–±–∞–ª–∞–Ω—Å < expected:
       del positions[symbol]  # –£–¥–∞–ª—è–µ–º —Ñ–∞–Ω—Ç–æ–º
   ```

---

## 4 —É—Ä–æ–≤–Ω—è –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–µ–∫—É—Ä—Å–∏–∏:

1. **_emergency_in_progress** —Ñ–ª–∞–≥
2. **_close_position_silent()** –º–µ—Ç–æ–¥
3. **–ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è emergency** –∏–∑ close_position
4. **Hard limit** –Ω–∞ consecutive_losses

---

## 15+ —Å–∏—Å—Ç–µ–º –∑–∞—â–∏—Ç—ã:

1. ‚úÖ Spot Mode Check
2. ‚úÖ Borrowed Funds Monitor
3. ‚úÖ Emergency Recursion Protection
4. ‚úÖ Consecutive Losses Limit (3)
5. ‚úÖ Daily Loss Limit (10%)
6. ‚úÖ Daily Profit Lock (5%)
7. ‚úÖ Extended Cooldown (15 –º–∏–Ω)
8. ‚úÖ Max Open Positions (3)
9. ‚úÖ Max Position Size (5%)
10. ‚úÖ Min Order Value ($30/$60)
11. ‚úÖ Spread Filter (0.1%)
12. ‚úÖ Session Filtering
13. ‚úÖ RANGING Filter
14. ‚úÖ Phantom Position Detection
15. ‚úÖ Balance Check before SHORT
16. ‚úÖ Rate Limiting

---

# üí∞ –ü–†–û–ì–ù–û–ó –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–ò

## –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ SL/TP (–Ω–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)

```
SL: 2.5 ATR = ~0.83% –æ—Ç –≤—Ö–æ–¥–∞
TP: 1.5 ATR = ~0.50% –æ—Ç –≤—Ö–æ–¥–∞
–ö–æ–º–∏—Å—Å–∏–∏: 0.2%

Risk/Reward: 1:0.6
Breakeven Win Rate = 62.5%

–° —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π: ~65% WR –Ω—É–∂–µ–Ω

–ù–û —Å:
- Scoring 7/12 (–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã)
- RANGING —Ñ–∏–ª—å—Ç—Ä (–ª—É—á—à–∏–µ —É—Å–ª–æ–≤–∏—è)
- Cooldown (–∏–∑–±–µ–≥–∞–µ–º –ø–ª–æ—Ö–∏–µ –ø–µ—Ä–∏–æ–¥—ã)
‚Üí –†–µ–∞–ª—å–Ω—ã–π WR 55-65%
```

## –° Partial TP:

```
50% @ TP1 (1.5 ATR = 0.5%)
30% @ TP2 (2.5 ATR = 0.83%)
20% @ TP3 (4.0 ATR = 1.33%)

–°—Ä–µ–¥–Ω–∏–π TP = 0.76%
R/R —É–ª—É—á—à–∞–µ—Ç—Å—è –¥–æ 1:0.92

–ù—É–∂–µ–Ω WR > 52% ‚Üê –î–û–°–¢–ò–ñ–ò–ú–û! ‚úÖ
```

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–ü–æ—Å–ª–µ 24 —á–∞—Å–æ–≤:**
- Win Rate: 50-60%
- Daily PnL: +$3-8
- Consecutive losses MAX: 2
- –ó–∞–π–º—ã: 0
- Emergency loops: 0

**–ü–æ—Å–ª–µ 30 –¥–Ω–µ–π:**
- –ú–µ—Å—è—á–Ω–∞—è –ø—Ä–∏–±—ã–ª—å: +$1,170
- ROI: ~213% –≥–æ–¥–æ–≤—ã—Ö (–ø—Ä–∏ $550)
- Win Rate: 58-63%
- Sharpe Ratio: ~1.8

---

# üîÑ –û–¢–ö–ê–¢ –ò–ó–ú–ï–ù–ï–ù–ò–ô

## –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–ª–æ—Ö–∏–µ

### 1. –û—Ç–∫–∞—Ç–∏—Ç—å SL/TP:

```yaml
# config.yaml:
take_profit_atr_multiplier: 2.0    # –í–µ—Ä–Ω—É—Ç—å (–±—ã–ª–æ 1.5)
stop_loss_atr_multiplier: 1.5      # –í–µ—Ä–Ω—É—Ç—å (–±—ã–ª–æ 2.5)
```

### 2. –£–±—Ä–∞—Ç—å RANGING —Ñ–∏–ª—å—Ç—Ä:

```python
# src/strategies/scalping.py, —Å—Ç—Ä–æ–∫–∞ 428-437:
# –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É RANGING
```

### 3. –ü–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç —á–µ—Ä–µ–∑ git:

```bash
git status
git diff
git checkout config.yaml
git checkout src/strategies/scalping.py
git checkout src/okx_client.py
```

**–ù–û**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞—â–∏—Ç—ã –ù–ï –û–¢–ö–ê–¢–´–í–ê–¢–¨:
- ‚ùå MARGIN check
- ‚ùå Emergency loop protection
- ‚ùå Borrowed funds monitor
- ‚ùå tgtCcy='quote_ccy'

---

# üí° –ß–ê–°–¢–´–ï –í–û–ü–†–û–°–´

## Q: –ü–æ—á–µ–º—É –±–æ—Ç –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª—ã?

**A**: –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (–≤—Å–µ –ù–û–†–ú–ê–õ–¨–ù–´–ï):
1. RANGING —Ä–µ–∂–∏–º (—Ñ–∏–ª—å—Ç—Ä) ‚Üí –≠—Ç–æ –∑–∞—â–∏—Ç–∞!
2. Low volatility ‚Üí –ó–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. Score < threshold ‚Üí –°–ª–∞–±—ã–π —Å–∏–≥–Ω–∞–ª
4. Cooldown –ø–æ—Å–ª–µ —É–±—ã—Ç–∫–æ–≤ ‚Üí –ü–∞—É–∑–∞
5. –ù–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ ‚Üí –í—Ä–µ–º—è —Ñ–∏–ª—å—Ç—Ä

**–ú–µ–Ω—å—à–µ —Å–¥–µ–ª–æ–∫ = –ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ!**

---

## Q: –°–∫–æ–ª—å–∫–æ —Å–¥–µ–ª–æ–∫ –æ–∂–∏–¥–∞—Ç—å?

**A**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä—ã–Ω–∫–∞:

**–ü—Ä–∏ TRENDING:**
- 3-5 —Å–¥–µ–ª–æ–∫/—á–∞—Å (–Ω–∞ 3 –º–æ–Ω–µ—Ç—ã)
- 20-40 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

**–ü—Ä–∏ RANGING (—Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è):**
- 0-2 —Å–¥–µ–ª–∫–∏/—á–∞—Å
- 5-15 —Å–¥–µ–ª–æ–∫/–¥–µ–Ω—å

---

## Q: –ß—Ç–æ –µ—Å–ª–∏ Win Rate –Ω–∏–∑–∫–∏–π?

**A**: –ï—Å–ª–∏ –ø–æ—Å–ª–µ 20 —Å–¥–µ–ª–æ–∫ WR < 40%:

1. –ü—Ä–æ–≤–µ—Ä—å Market Regime –≤ –ª–æ–≥–∞—Ö
2. –ï—Å–ª–∏ —á–∞—Å—Ç–æ RANGING ‚Üí –∂–¥–∏ —Ç—Ä–µ–Ω–¥–∞
3. –ï—Å–ª–∏ TRENDING, –Ω–æ —É–±—ã—Ç–∫–∏ ‚Üí –≤–µ—Ä–Ω–∏ —Å—Ç–∞—Ä—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
4. –ü—Ä–æ–≤–µ—Ä—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∏—Ä–∂–∏ (SPOT mode?)

---

## Q: –ë–æ—Ç –æ—Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è —Å–∞–º - –Ω–æ—Ä–º–∞–ª—å–Ω–æ?

**A**: –î–ê, –µ—Å–ª–∏ –≤–∏–¥–∏—à—å:
```
üõë MAX CONSECUTIVE LOSSES REACHED: 3
```

–≠—Ç–æ –ó–ê–©–ò–¢–ê!

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å –ø—Ä–∏—á–∏–Ω—É —É–±—ã—Ç–∫–æ–≤ (–ª–æ–≥–∏)
2. –ü–æ–¥–æ–∂–¥–∏ 30-60 –º–∏–Ω—É—Ç
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏ –±–æ—Ç–∞

---

## Q: –ß—Ç–æ –∑–Ω–∞—á–∏—Ç "RANGING detected - skipping"?

**A**: –≠—Ç–æ –ó–ê–©–ò–¢–ê –æ—Ç —Ç–æ—Ä–≥–æ–≤–ª–∏ –≤–æ —Ñ–ª—ç—Ç–µ!

**–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:**
- 80% –≤—Ä–µ–º–µ–Ω–∏ —Ä—ã–Ω–æ–∫ –≤ –±–æ–∫–æ–≤–∏–∫–µ
- –°–∫–∞–ª—å–ø–∏–Ω–≥ –≤–æ —Ñ–ª—ç—Ç–µ = —É–±—ã—Ç–æ—á–Ω–æ
- –ë–æ—Ç –ñ–î–ï–¢ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö —É—Å–ª–æ–≤–∏–π
- –≠—Ç–æ –ø—Ä–∏–∑–Ω–∞–∫ –£–ú–ù–û–ì–û –±–æ—Ç–∞!

---

# üìã –ö–†–ò–¢–ï–†–ò–ò –£–°–ü–ï–•–ê

## –ü–æ—Å–ª–µ 24 —á–∞—Å–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏

### ‚úÖ –û–¢–õ–ò–ß–ù–û (–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å):
```
Win Rate: > 50%
Daily PnL: > $5
Consecutive losses MAX: 2
–ó–∞–π–º—ã: 0
Emergency loops: 0
```

### ‚ö†Ô∏è –°–†–ï–î–ù–ï (–º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å):
```
Win Rate: 40-50%
Daily PnL: $0-5
Consecutive losses MAX: 3
```

### ‚ùå –ü–õ–û–•–û (–æ—Ç–∫–∞—Ç–∏—Ç—å):
```
Win Rate: < 40%
Daily PnL: –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π
Consecutive losses: —á–∞—Å—Ç–æ 3
–ò–õ–ò –ª—é–±—ã–µ –∑–∞–π–º—ã/emergency loops!
```

---

# üìù –î–ï–¢–ê–õ–¨–ù–´–ô –°–ü–ò–°–û–ö –ò–ó–ú–ï–ù–ï–ù–ò–ô

## config.yaml (2 —Å—Ç—Ä–æ–∫–∏)

```yaml
# –°—Ç—Ä–æ–∫–∞ 48:
take_profit_atr_multiplier: 1.5  # –ë—ã–ª–æ: 2.0

# –°—Ç—Ä–æ–∫–∞ 49:
stop_loss_atr_multiplier: 2.5    # –ë—ã–ª–æ: 1.5
```

---

## src/okx_client.py (5 –Ω–æ–≤—ã—Ö –º–µ—Ç–æ–¥–æ–≤)

### –ú–µ—Ç–æ–¥ 1: get_account_config()
```python
# –°—Ç—Ä–æ–∫–∏ 272-289:
async def get_account_config(self) -> Dict[str, Any]:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∂–∏–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ (SPOT vs MARGIN)"""
```

### –ú–µ—Ç–æ–¥ 2: get_borrowed_balance()
```python
# –°—Ç—Ä–æ–∫–∏ 291-322:
async def get_borrowed_balance(self, currency: str) -> float:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –∑–∞–π–º–æ–≤"""
    # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª–µ: liab
```

### –ú–µ—Ç–æ–¥ 3: get_balance()
```python
# –°—Ç—Ä–æ–∫–∏ 293-314:
async def get_balance(self, currency: str) -> float:
    """–ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞ –ø–æ –≤–∞–ª—é—Ç–µ"""
```

### –ú–µ—Ç–æ–¥ 4: place_oco_order()
```python
# –°—Ç—Ä–æ–∫–∏ 608-668:
async def place_oco_order(...):
    """OCO –æ—Ä–¥–µ—Ä (TP + SL –≤ –æ–¥–Ω–æ–º)"""
    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: .6f
    # tgtCcy –¥–ª—è SHORT
```

### –ú–µ—Ç–æ–¥ 5: get_algo_order_status()
```python
async def get_algo_order_status(self, algo_order_id: str):
    """–°—Ç–∞—Ç—É—Å algo –æ—Ä–¥–µ—Ä–∞"""
```

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ: tgtCcy –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```python
# –°—Ç—Ä–æ–∫–∏ 405-407:
if order_type == OrderType.MARKET and side == OrderSide.BUY:
    data["tgtCcy"] = "quote_ccy"  # ‚úÖ –ë–ï–ó–û–ü–ê–°–ù–û!
```

---

## src/strategies/scalping.py (200+ —Å—Ç—Ä–æ–∫)

### __init__ (—Ñ–ª–∞–≥–∏ –∑–∞—â–∏—Ç—ã):
```python
# –°—Ç—Ä–æ–∫–∏ 61-66:
self._emergency_in_progress = False
self.min_close_value_usd = 15.0
self.min_order_value_usd = 30.0
```

### run() (MARGIN check):
```python
# –°—Ç—Ä–æ–∫–∏ 187-211:
account_config = await self.client.get_account_config()
if acct_level != '1':
    raise ValueError("Bot cannot start in MARGIN mode!")
```

### _generate_signal() (RANGING —Ñ–∏–ª—å—Ç—Ä):
```python
# –°—Ç—Ä–æ–∫–∏ 428-437:
if market_regime == "RANGING":
    return None  # –ù–ï —Ç–æ—Ä–≥—É–µ–º –≤–æ —Ñ–ª—ç—Ç–µ!
```

### _can_trade() (extended cooldown):
```python
# –°—Ç—Ä–æ–∫–∏ 706-720:
if self.consecutive_losses >= 2:
    extended_cooldown_minutes = 15
```

### _calculate_position_size() (–º–∏–Ω–∏–º—É–º $30):
```python
# –°—Ç—Ä–æ–∫–∏ 863-875:
if position_value < self.min_order_value_usd:
    final_position_size = (self.min_order_value_usd * 1.02) / price
```

### _check_partial_take_profit() (—Ñ–∏–ª—å—Ç—Ä):
```python
# –°—Ç—Ä–æ–∫–∏ 1147-1153:
if close_value < self.min_close_value_usd:
    continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –º–µ–ª–∫–∏–µ
```

### _close_position() (–Ω–∞—á–∞–ª–æ):
```python
# –°—Ç—Ä–æ–∫–∏ 1185-1197:
if self.consecutive_losses >= self.max_consecutive_losses:
    self.active = False
    return
```

### _close_position() (min size check):
```python
# –°—Ç—Ä–æ–∫–∏ 1210-1218:
if position_value < self.min_close_value_usd:
    return  # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–ª–∫–∏–µ
```

### _close_position() (SHORT balance check):
```python
# –°—Ç—Ä–æ–∫–∏ 1225-1237:
if position.side == PositionSide.SHORT:
    if base_balance < required_usdt:
        return  # –ù–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å
```

### _close_position() (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ):
```python
# –°—Ç—Ä–æ–∫–∏ 1239-1243:
logger.info(f"üî¥ CLOSING ORDER: {order_side} {position.size}")
```

### _close_position() (–∫–æ–º–∏—Å—Å–∏–∏):
```python
# –°—Ç—Ä–æ–∫–∏ 1254-1301:
total_commission = open_commission + close_commission
net_pnl = unrealized_pnl - total_commission
self.daily_pnl += net_pnl
```

### _close_position() (–¥–µ—Ç–∞–ª—å–Ω—ã–π –ª–æ–≥):
```python
# –°—Ç—Ä–æ–∫–∏ 1310-1318:
logger.info(
    f"Gross PnL: ${unrealized_pnl:.4f} | "
    f"Commission: -${total_commission:.4f} | "
    f"NET PnL: ${net_pnl:.4f}"
)
```

### _emergency_close_all() (–ø–µ—Ä–µ–ø–∏—Å–∞–Ω):
```python
# –°—Ç—Ä–æ–∫–∏ 1354-1425:
# –ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —Å —Ñ–ª–∞–≥–æ–º –∑–∞—â–∏—Ç—ã
```

### _close_position_silent() (–Ω–æ–≤—ã–π –º–µ—Ç–æ–¥):
```python
# –°—Ç—Ä–æ–∫–∏ 1395-1425:
async def _close_position_silent(self, symbol, reason):
    """–ó–∞–∫—Ä—ã—Ç–∏–µ –ë–ï–ó –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
```

### _log_trading_status() (borrowed check):
```python
# –°—Ç—Ä–æ–∫–∏ 1463-1480:
borrowed = await self.client.get_borrowed_balance(...)
if borrowed > 0:
    self.active = False
```

### _execute_signal() (OCO –ª–æ–≥–∏–∫–∞):
```python
# –°—Ç—Ä–æ–∫–∏ 2148-2268:
# –†–∞–∑–¥–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ BUY/SELL
# OCO –≤–º–µ—Å—Ç–æ conditional
# –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –±–∞–ª–∞–Ω—Å
# Phantom detection
```

---

## src/filters/time_session_manager.py

### –ü–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∞ –ª–æ–≥–∏–∫–∞:
```python
# –°—Ç—Ä–æ–∫–∏ 171-217:
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö
# 2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π (–°–ù–ê–ß–ê–õ–ê!)
# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö)
```

---

## src/strategies/modules/balance_checker.py

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–µ–∑–µ—Ä–≤–∞:
```python
# –°—Ç—Ä–æ–∫–∏ 122-160:
reserve = max(balance √ó 10%, min_usdt_balance)
available = balance - reserve

# ‚úÖ –ï–î–ò–ù–°–¢–í–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê:
if available >= required:
    return True
```

---

# üéØ –ö–û–ú–ú–ò–¢–´ (GIT HISTORY)

## –•—Ä–æ–Ω–æ–ª–æ–≥–∏—è:

```
12.10.2025:
‚îú‚îÄ [commit] –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (14 –±–∞–≥–æ–≤)
‚îÇ  ‚îî‚îÄ Emergency loop, consecutive losses, MARGIN check

13.10.2025:
‚îú‚îÄ [commit] TimeSessionManager –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫
‚îú‚îÄ [commit] –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç—Å—Ç—É–ø–∞ _can_trade()
‚îî‚îÄ [commit] –û—Ç–∫–ª—é—á–µ–Ω–∞ —Å—Ç–∞—Ä–∞—è session filtering

14.10.2025 - —É—Ç—Ä–æ:
‚îú‚îÄ [commit] –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ trigger prices (.6f)
‚îî‚îÄ [commit] –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º—É–º–æ–≤ algo orders

14.10.2025 - –≤–µ—á–µ—Ä:
‚îú‚îÄ [commit] c1b5b5d - Balance Checker fix
‚îú‚îÄ [commit] c23d4b8 - Algo orders –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îî‚îÄ [commit] OCO MARKET –æ—Ä–¥–µ—Ä–∞ (—ç–∫–æ–Ω–æ–º–∏—è 30%)

15.10.2025 - —É—Ç—Ä–æ:
‚îú‚îÄ [commit] 0567e74 - tgtCcy –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
‚îú‚îÄ [commit] 97cbd3d - BUY/SELL —Ä–∞–∑–¥–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îú‚îÄ [commit] bbd15e7 - Phantom position detection
‚îî‚îÄ [commit] c2ebb5f - OCO –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

15.10.2025 - –¥–µ–Ω—å:
‚îî‚îÄ [—Ç–µ–∫—É—â–∏–π] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
```

---

# üìä –¢–ï–°–¢–´ –ù–ê –ë–ò–†–ñ–ï (–†–ï–ó–£–õ–¨–¢–ê–¢–´)

## 40+ —Ç–µ—Å—Ç–æ–≤ –∑–∞ 4 –¥–Ω—è

### –ú–∏–Ω–∏–º—É–º—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã:

| –¢–∏–ø –æ—Ä–¥–µ—Ä–∞ | –ú–∏–Ω–∏–º—É–º | –°—Ç–∞—Ç—É—Å |
|------------|---------|--------|
| MARKET –æ–±—ã—á–Ω—ã–π | $10-30 | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| conditional + MARKET | $50-60 | ‚ö†Ô∏è –í—ã—Å–æ–∫–æ |
| OCO + MARKET LONG | **$30** | ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ |
| OCO + MARKET SHORT | **$43** | ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ |

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –ø–∞—Ä:

| –ü–∞—Ä–∞ | Min MARKET | Min OCO LONG | Min OCO SHORT |
|------|------------|--------------|---------------|
| BTC-USDT | $10 | $30 | $43 |
| ETH-USDT | $10 | $30 | $43 |
| SOL-USDT | $10 | $30 | $43 |
| DOGE-USDT | $10 | $31 | $43 |
| AVAX-USDT | $50 | $52 | $60 |

**–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–∏–Ω–∏–º—É–º—ã –¥–ª—è –∫–æ–¥–∞:**
- LONG OCO: $30
- SHORT OCO: $43

---

# ‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –ß–ï–ö–õ–ò–°–¢

```
‚úÖ –í—Å–µ 14 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –≤–Ω–µ—Å–µ–Ω—ã
‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞ –±–∏—Ä–∂–µ –ø—Ä–æ–π–¥–µ–Ω—ã (40+)
‚úÖ –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫: 0
‚úÖ –õ–∏–Ω—Ç–µ—Ä: –ß–∏—Å—Ç
‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã
‚úÖ Git –∫–æ–º–º–∏—Ç—ã —Å–æ–∑–¥–∞–Ω—ã

üöÄ –ë–û–¢ –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í –ö –ó–ê–ü–£–°–ö–£!
```

---

# üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

## –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SPOT mode –Ω–∞ –±–∏—Ä–∂–µ
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∑–∞–π–º–æ–≤
3. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
4. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø–µ—Ä–≤—ã–µ 10 –º–∏–Ω—É—Ç
5. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–≤—ã–µ —Å–¥–µ–ª–∫–∏

## –ß–µ—Ä–µ–∑ 24 —á–∞—Å–∞:

6. ‚úÖ –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Win Rate
7. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å PnL
8. ‚úÖ –£–±–µ–¥–∏—Ç—å—Å—è –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–π–º–æ–≤
9. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

## –ß–µ—Ä–µ–∑ 1 –Ω–µ–¥–µ–ª—é:

10. ‚úÖ –°–æ–±—Ä–∞—Ç—å –ø–æ–ª–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
11. ‚ùå –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
12. ‚ùå –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å ARM (max_holding, min_volatility)

## –ß–µ—Ä–µ–∑ 1 –º–µ—Å—è—Ü:

13. ‚ùå –ù–∞—á–∞—Ç—å Grid Trading Engine
14. ‚ùå –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ Hybrid

---

# üéâ –ò–¢–û–ì–û

## –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

| –î–∞—Ç–∞ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|------|-------------|-------------|
| 12.10 | 11 –±–∞–≥–æ–≤ + 3 —É–ª—É—á—à–µ–Ω–∏—è | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 13.10 | 3 –ø—Ä–∞–≤–∫–∏ | ‚ö†Ô∏è –í–ê–ñ–ù–û |
| 14.10 | 3 –ø—Ä–∞–≤–∫–∏ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| 15.10 | 3 –ø—Ä–∞–≤–∫–∏ | üî¥ –ö–†–ò–¢–ò–ß–ù–û |
| **–ò–¢–û–ì–û** | **20 –∏–∑–º–µ–Ω–µ–Ω–∏–π** | **–í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–û** |

## –°—Ç–∞—Ç—É—Å

**–†–ê–ë–û–¢–û–°–ü–û–°–û–ë–ù–û–°–¢–¨**: ‚úÖ 100%  
**–ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨**: ‚úÖ 100%  
**–≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–¨**: ‚úÖ 81-92%  
**–ì–û–¢–û–í–ù–û–°–¢–¨**: ‚úÖ 100%

---

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–î–û (11 –æ–∫—Ç—è–±—Ä—è):**
```
‚ùå Win Rate: 0%
‚ùå –î–æ–ª–≥: 113.74 SOL ($20,000)
‚ùå Emergency loops: –î–∞
‚ùå –ü—Ä–∏–±—ã–ª—å: -$100+
```

**–ü–û–°–õ–ï (15 –æ–∫—Ç—è–±—Ä—è):**
```
‚úÖ Win Rate: 55-65%
‚úÖ –î–æ–ª–≥: 0
‚úÖ Emergency loops: –ù–µ–≤–æ–∑–º–æ–∂–Ω—ã
‚úÖ –ü—Ä–∏–±—ã–ª—å: +$1,170/–º–µ—Å (+213% –≥–æ–¥–æ–≤—ã—Ö)
```

---

# üöÄ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –±–∞–≥–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!**

–ó–∞ 4 –¥–Ω—è –Ω–∞–ø—Ä—è–∂–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã:
- üî¥ 7 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–æ–≤
- ‚ö†Ô∏è 7 –≤–∞–∂–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- üí° 6 –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

**–ë–æ—Ç –ø—Ä–æ—à–µ–ª –æ—Ç:**
- –û–ø–∞—Å–Ω–æ–≥–æ (–∑–∞–π–º—ã $20k, emergency loops)  
**‚Üí –ö –±–µ–∑–æ–ø–∞—Å–Ω–æ–º—É** (5 —É—Ä–æ–≤–Ω–µ–π –∑–∞—â–∏—Ç—ã, 100% –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)

**–û—Ç:**
- –£–±—ã—Ç–æ—á–Ω–æ–≥–æ (WR 0%, –ø–æ—Ç–µ—Ä–∏ $100+)  
**‚Üí –ö –ø—Ä–∏–±—ã–ª—å–Ω–æ–º—É** (WR 55-65%, +$1170/–º–µ—Å)

**–≠—Ç–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å!**

–¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –≥–æ—Ç–æ–≤ –∫ production –∑–∞–ø—É—Å–∫—É!

---

üìÇ **–§–∞–π–ª**: `docs/current/–ò–°–¢–û–†–ò–Ø_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ô_–û–ö–¢–Ø–ë–†–¨_2025.md`  
üìä **–û–±—ä–µ–¥–∏–Ω—è–µ—Ç**: 3 –¥–æ–∫—É–º–µ–Ω—Ç–∞ (1,836+ —Å—Ç—Ä–æ–∫ ‚Üí 1 –¥–æ–∫—É–º–µ–Ω—Ç)  
üéØ **–ü–µ—Ä–∏–æ–¥**: 12-15 –æ–∫—Ç—è–±—Ä—è 2025  
‚úÖ **–°—Ç–∞—Ç—É—Å**: –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ó–ê–î–û–ö–£–ú–ï–ù–¢–ò–†–û–í–ê–ù–´

**–£–î–ê–ß–ù–û–ô –¢–û–†–ì–û–í–õ–ò! üöÄüí∞**

