# ‚úÖ –ü–†–û–í–ï–†–ö–ê –ù–û–í–´–• –õ–û–ì–û–í –ü–û–°–õ–ï –û–¢–ö–†–´–¢–ò–Ø –ü–û–ó–ò–¶–ò–ò

## üìã –°–¢–ê–¢–£–°

**–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 2025-12-21 13:51:23-13:51:29  
**–°–∏–º–≤–æ–ª:** DOGE-USDT  
**–°—Ç–æ—Ä–æ–Ω–∞:** SHORT  
**–†–∞–∑–º–µ—Ä:** 1890 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤  
**Entry price:** $0.131950

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ù–û–í–´–• –õ–û–ì–û–í

### 1. ‚úÖ Leverage –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ - –†–ê–ë–û–¢–ê–ï–¢!

**–ù–∞–π–¥–µ–Ω–æ –≤ –ª–æ–≥–∞—Ö:**

```
2025-12-21 13:51:23.021 | INFO | üìä [ADAPTIVE_LEVERAGE] DOGE-USDT: –†–∞—Å—á–µ—Ç leverage | 
   strength=0.86, regime=ranging, volatility=0.0007, 
   regime_multiplier=1.00, volatility_multiplier=1.30, 
   adjusted_strength=1.00, category=very_strong, 
   requested_leverage=30x (–¥–æ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è)

2025-12-21 13:51:23.481 | WARNING | ============================================================
2025-12-21 13:51:23.482 | WARNING | ‚ö†Ô∏è [ADAPTIVE_LEVERAGE] DOGE-USDT: –õ–µ–≤–µ—Ä–∏–¥–∂ –∏–∑–º–µ–Ω–µ–Ω –±–∏—Ä–∂–µ–π!
2025-12-21 13:51:23.483 | WARNING |    –ó–∞—è–≤–ª–µ–Ω–Ω—ã–π: 30x
2025-12-21 13:51:23.483 | WARNING |    –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π: 20x
2025-12-21 13:51:23.484 | WARNING |    –ü—Ä–∏—á–∏–Ω–∞: –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –Ω–∞ OKX
2025-12-21 13:51:23.484 | WARNING | ============================================================

2025-12-21 13:51:23.485 | INFO | ‚úÖ [ADAPTIVE_LEVERAGE] DOGE-USDT: –§–ò–ù–ê–õ–¨–ù–´–ô leverage=20x | 
   category=very_strong, adjusted_strength=1.00
```

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ **–û–¢–õ–ò–ß–ù–û!** –í—Å–µ –¥–µ—Ç–∞–ª–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- ‚úÖ –†–∞—Å—á–µ—Ç leverage —Å –¥–µ—Ç–∞–ª—è–º–∏ (strength, regime, volatility, multipliers, category)
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ leverage –±–∏—Ä–∂–µ–π (–∑–∞—è–≤–ª–µ–Ω–Ω—ã–π ‚Üí —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π)
- ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π leverage —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π

---

### 2. ‚úÖ Margin ratio –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ - –†–ê–ë–û–¢–ê–ï–¢!

**–ù–∞–π–¥–µ–Ω–æ –≤ –ª–æ–≥–∞—Ö:**

```
2025-12-21 13:51:29.522 | INFO | üìä [MARGIN_RATIO] –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏: safe=False | 
   margin_ratio=0.25 (threshold=1.80) | 
   available_margin=$12.43, margin_used=$49.88 | 
   equity=$12.45, pnl=$-0.02 | 
   liq_price=$0.1570 (distance=18.99%)
```

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ **–û–¢–õ–ò–ß–ù–û!** –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:
- ‚úÖ margin_ratio —Å threshold
- ‚úÖ available_margin –∏ margin_used
- ‚úÖ equity –∏ pnl
- ‚úÖ liquidation_price —Å distance

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** `margin_ratio=0.25` –Ω–∏–∑–∫–∏–π, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏ (–∫–∞–∫ —É–∫–∞–∑–∞–Ω–æ –≤ –∫–æ–¥–µ: "–≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ–∑–∏—Ü–∏—è —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞").

---

## ‚è≥ –û–ñ–ò–î–ê–ï–ú–´–ï –õ–û–ì–ò (–∫–æ–≥–¥–∞ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä–æ–µ—Ç—Å—è)

### 3. Pre-close state logging
**–û–∂–∏–¥–∞–µ—Ç—Å—è:**
```
üìä [PRE_CLOSE] DOGE-USDT: –ü—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç—å
   –ü—Ä–∏—á–∏–Ω–∞: {reason}
   Side: SHORT
   Size: 1890 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
   Entry price: $0.131950
   –í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏: X.XX –º–∏–Ω
   Unrealized PnL: $X.XX USDT
   Margin used: $X.XX USDT
   Regime: ranging
   Leverage: 20x
   Signal strength: 0.86
```

### 4. Exchange-side closure detection
**–û–∂–∏–¥–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä–æ–µ—Ç—Å—è –Ω–∞ –±–∏—Ä–∂–µ):**
```
üö® –û–ë–ù–ê–†–£–ñ–ï–ù–û –ó–ê–ö–†–´–¢–ò–ï –ù–ê –ë–ò–†–ñ–ï: DOGE-USDT
   ‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ, –Ω–æ –ù–ï —á–µ—Ä–µ–∑ –±–æ—Ç–∞!
   üìä –õ–æ–∫–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è:
      Side: SHORT
      Size: 1890 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
      Entry price: $0.131950
      Entry time: 2025-12-21 13:51:29
      –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: XXX —Å–µ–∫ (X.XX –º–∏–Ω)
   üîç –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
      - Trailing Stop Loss –Ω–∞ –±–∏—Ä–∂–µ (TSL)
      - Liquidation (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)
      - ADL (Auto-Deleveraging)
      - Manual close (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–∫—Ä—ã–ª –≤—Ä—É—á–Ω—É—é)
```

### 5. Race condition –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
**–û–∂–∏–¥–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –±—É–¥–µ—Ç race condition):**
```
‚ö†Ô∏è [RACE_CONDITION] DOGE-USDT: –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é —Å size=0!
   –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è: {reason}
   –°—Ç–∞—Ç—É—Å: –ü–æ–∑–∏—Ü–∏—è —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ
   –î–µ–π—Å—Ç–≤–∏–µ: –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```

### 6. Partial TP logging
**–û–∂–∏–¥–∞–µ—Ç—Å—è (–µ—Å–ª–∏ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç Partial TP):**
```
üìä PARTIAL TP: DOGE-USDT SHORT
   ‚úÇÔ∏è –ó–∞–∫—Ä—ã—Ç–æ: X.XXXXXX –º–æ–Ω–µ—Ç (X.XXXXXX –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤) = XX.X%
   üì¶ –û—Å—Ç–∞–ª–æ—Å—å: X.XXXXXX –º–æ–Ω–µ—Ç (X.XXXXXX –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤) = XX.X%
   üíµ PnL –∑–∞–∫—Ä—ã—Ç–æ–π —á–∞—Å—Ç–∏: $+X.XXXX USDT (gross=$+X.XXXX, commission=$X.XXXX)
   üìä Entry price: $0.131950
   üìä Exit price: $X.XXXXXX
   ‚è±Ô∏è  –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: XXX —Å–µ–∫ (X.XX –º–∏–Ω)
```

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –û—Ü–µ–Ω–∫–∞ |
|-------------|--------|--------|
| Leverage –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 10/10 |
| Margin ratio –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 10/10 |
| Pre-close state logging | ‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è | - |
| Exchange-side closure detection | ‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è | - |
| Race condition –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è | - |
| Partial TP logging | ‚è≥ –û–∂–∏–¥–∞–µ—Ç—Å—è | - |

---

## üéØ –í–´–í–û–î–´

1. ‚úÖ **Leverage –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ! –í—Å–µ –¥–µ—Ç–∞–ª–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.
2. ‚úÖ **Margin ratio –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ! –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ª–æ–≥–∏—Ä—É—é—Ç—Å—è.
3. ‚è≥ **–û—Å—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏** - –ø–æ—è–≤—è—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏ –∏–ª–∏ –ø—Ä–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö.

**–ì–æ—Ç–æ–≤–æ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:** –î–∞, –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç!

