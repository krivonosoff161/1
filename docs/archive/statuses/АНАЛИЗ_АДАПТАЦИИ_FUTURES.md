# –ê–Ω–∞–ª–∏–∑ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ Futures –±–æ—Ç–∞

## ü§î –°–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### ‚úÖ –ü–†–û - –ß—Ç–æ —É–ø—Ä–æ—Å—Ç–∏—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é:

1. **–ú–æ–¥—É–ª–∏ –£–ñ–ï —Å—É—â–µ—Å—Ç–≤—É—é—Ç** –≤ `src/strategies/modules/`:
   - `adaptive_regime_manager.py` ‚úÖ
   - `correlation_filter.py` ‚úÖ
   - `multi_timeframe.py` ‚úÖ
   - `pivot_points.py` ‚úÖ
   - `volume_profile_filter.py` ‚úÖ
   - `balance_checker.py` ‚úÖ

2. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞**:
   - Spot –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ –∂–µ –º–æ–¥—É–ª–∏
   - Futures –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—É –∂–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ config_futures.yaml

3. **WebSocket –£–ñ–ï –ø–æ–¥–∫–ª—é—á–µ–Ω**:
   - –†–µ–∞–ª—å–Ω—ã–µ —Ç–∏–∫–∏ –ø–æ—Å—Ç—É–ø–∞—é—Ç
   - –î–∞–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

### ‚ö†Ô∏è –ö–û–ù–¢–†–ê - –†–∏—Å–∫–∏:

1. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** –º–µ–∂–¥—É Spot –∏ Futures
2. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞** –µ—Å–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –º–æ–¥—É–ª–∏
3. **–ü—É—Ç–∞–Ω–∏—Ü–∞** –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º–æ–¥—É–ª–µ–π

---

## üéØ –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### **–í–ê–†–ò–ê–ù–¢ 1: Shared –º–æ–¥—É–ª–∏ (–†–ï–ö–û–ú–ï–ù–î–£–Æ) ‚úÖ**

**–ü—Ä–∏–Ω—Ü–∏–ø**: –ò—Å–ø–æ–ª—å–∑—É–µ–º –û–ë–©–ò–ï –º–æ–¥—É–ª–∏ –¥–ª—è Spot –∏ Futures

```
src/strategies/modules/  ‚Üê –û–ë–©–ò–ï –ú–û–î–£–õ–ò
‚îú‚îÄ‚îÄ adaptive_regime_manager.py  ‚úÖ
‚îú‚îÄ‚îÄ correlation_filter.py  ‚úÖ
‚îú‚îÄ‚îÄ multi_timeframe.py  ‚úÖ
‚îú‚îÄ‚îÄ pivot_points.py  ‚úÖ
‚îú‚îÄ‚îÄ volume_profile_filter.py  ‚úÖ
‚îî‚îÄ‚îÄ balance_checker.py  ‚úÖ

src/strategies/scalping/
‚îú‚îÄ‚îÄ spot/
‚îÇ   ‚îî‚îÄ‚îÄ orchestrator.py  ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—â–∏–µ –º–æ–¥—É–ª–∏
‚îî‚îÄ‚îÄ futures/
    ‚îî‚îÄ‚îÄ orchestrator.py  ‚Üê –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –û–¢–î–ï–õ–¨–ù–´–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
```python
# –í futures/orchestrator.py
from src.strategies.modules.adaptive_regime_manager import AdaptiveRegimeManager

# –°–æ–∑–¥–∞–µ–º ARM —Å Futures-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
arm_config = {
    "trending": {
        "tp_atr_multiplier": 0.8,  # –ú–µ–Ω—å—à–µ –¥–ª—è Futures
        "sl_atr_multiplier": 0.6,
        "min_score_threshold": 4  # –ù–∏–∂–µ –¥–ª—è Futures
    },
    "ranging": {
        "tp_atr_multiplier": 0.6,
        "sl_atr_multiplier": 0.5,
        "min_score_threshold": 3
    }
}

self.arm = AdaptiveRegimeManager(arm_config)
```

**–ü–ª—é—Å—ã**:
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ –û–¥–∏–Ω –º–æ–¥—É–ª—å = –æ–¥–∏–Ω –±–∞–≥-—Ñ–∏–∫—Å
- ‚úÖ –†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è Spot/Futures
- ‚úÖ –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

**–ú–∏–Ω—É—Å—ã**:
- ‚ö†Ô∏è –ù—É–∂–Ω–æ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–æ–¥—É–ª–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã
- ‚ö†Ô∏è Futures-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –ª–æ–≥–∏–∫—É –¥–æ–±–∞–≤–∏—Ç—å –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

---

### **–í–ê–†–ò–ê–ù–¢ 2: Futures-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–æ–¥—É–ª–∏ (–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–Æ) ‚ùå**

```
src/strategies/modules/
‚îú‚îÄ‚îÄ adaptive_regime_manager.py  ‚Üê –û–±—â–∏–π
‚îî‚îÄ‚îÄ futures/
    ‚îî‚îÄ‚îÄ futures_adaptive_regime_manager.py  ‚Üê –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

src/strategies/scalping/futures/
‚îî‚îÄ‚îÄ modules/
    ‚îú‚îÄ‚îÄ futures_regime.py  ‚Üê –ï—â–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
    ‚îî‚îÄ‚îÄ futures_balance.py  ‚Üê –ï—â–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
```

**–ú–∏–Ω—É—Å—ã**:
- ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- ‚ùå –û–¥–∏–Ω –±–∞–≥ –Ω—É–∂–Ω–æ —Ñ–∏–∫—Å–∏—Ç—å –≤ 2-—Ö –º–µ—Å—Ç–∞—Ö
- ‚ùå –†–∏—Å–∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- ‚ùå –°–ª–æ–∂–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

---

### **–í–ê–†–ò–ê–ù–¢ 3: –ì–∏–±—Ä–∏–¥ (–ö–û–ú–ü–†–û–ú–ò–°–°) ‚ö†Ô∏è**

```
src/strategies/modules/  ‚Üê –û–±—â–∏–µ –º–æ–¥—É–ª–∏
‚îú‚îÄ‚îÄ adaptive_regime_manager.py  ‚úÖ
‚îî‚îÄ‚îÄ futures/  ‚Üê Futures-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ú–ï–¢–û–î–´
    ‚îî‚îÄ‚îÄ futures_regime_extensions.py  ‚ö†Ô∏è
```

**–ü–ª—é—Å—ã**:
- ‚úÖ –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –Ω–µ –¥—É–±–ª–∏—Ä—É–µ—Ç—Å—è
- ‚úÖ Futures-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–µ —Ä–∞—Å—à–∏—Ä—è–µ—Ç—Å—è

**–ú–∏–Ω—É—Å—ã**:
- ‚ö†Ô∏è –°–ª–æ–∂–Ω–µ–µ –ø–æ–Ω—è—Ç—å, –≥–¥–µ —á—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è
- ‚ö†Ô∏è –†–∏—Å–∫ –∑–∞–ø—É—Ç–∞—Ç—å—Å—è

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: –í–∞—Ä–∏–∞–Ω—Ç 1 (Shared –º–æ–¥—É–ª–∏)

### –ü–æ—á–µ–º—É?

1. **–ú–æ–¥—É–ª–∏ –£–ñ–ï —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã**:
   - `AdaptiveRegimeManager` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥
   - –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
   - –õ–æ–≥–∏–∫–∞ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ Spot/Futures

2. **–†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥**:
   ```yaml
   # config_spot.yaml
   adaptive_regime:
     trending:
       tp_atr_multiplier: 1.2  # –°–ø–æ—Ç
       
   # config_futures.yaml
   adaptive_regime:
     trending:
       tp_atr_multiplier: 0.8  # –§—å—é—á–∏ - –¥—Ä—É–≥–æ–π –ø–∞—Ä–∞–º–µ—Ç—Ä!
   ```

3. **WebSocket –¥–∞–Ω–Ω—ã–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ**:
   - OHLCV —Å–≤–µ—á–∏ –¥–ª—è Spot –∏ Futures
   - –¢–∏–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ
   - –ú–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å —Ç–µ–º–∏ –∂–µ –¥–∞–Ω–Ω—ã–º–∏

---

## üìã –ü–ª–∞–Ω –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–¥—É–ª–∏ –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å

```bash
# –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
- adaptive_regime_manager.py - —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –¥–ª—è Futures?
- correlation_filter.py - –Ω—É–∂–Ω—ã –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è?
- multi_timeframe.py - —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ —Å SWAP?
- pivot_points.py - –Ω—É–∂–Ω—ã –ª–∏ Futures-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã?
- volume_profile_filter.py - —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏?
```

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config_futures.yaml

```yaml
# config_futures.yaml
adaptive_regime:
  trending:
    tp_atr_multiplier: 0.8  # Futures - –º–µ–Ω—å—à–µ
    sl_atr_multiplier: 0.6
    min_score_threshold: 4
  ranging:
    tp_atr_multiplier: 0.6
    sl_atr_multiplier: 0.5
    min_score_threshold: 3
  choppy:
    tp_atr_multiplier: 0.7
    sl_atr_multiplier: 0.5
    min_score_threshold: 4

balance_profiles:
  small:
    threshold: 1500.0
    base_position_usd: 50.0  # –ú–µ–Ω—å—à–µ –¥–ª—è Futures
    min_position_usd: 10.0
    max_position_usd: 100.0
  medium:
    threshold: 3000.0
    base_position_usd: 200.0
    ...
```

### –®–∞–≥ 3: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ orchestrator

```python
# –í futures/orchestrator.py

# 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º ARM
self.arm = AdaptiveRegimeManager(config.adaptive_regime)

# 2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
self.mtf_filter = MultiTimeframeFilter(config.multi_timeframe)
self.correlation_filter = CorrelationFilter(config.correlation_filter)
self.pivot_filter = PivotPointsFilter(config.pivot_points)
self.volume_filter = VolumeProfileFilter(config.volume_profile)

# 3. –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤ —Ç–æ—Ä–≥–æ–≤–ª–µ
async def _generate_signal(self, symbol, price):
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞
    regime = self.arm.detect_regime()
    
    # –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    tp_multiplier = self.arm.get_tp_multiplier(regime)
    sl_multiplier = self.arm.get_sl_multiplier(regime)
    
    # –ü—Ä–∏–º–µ–Ω—è–µ–º —Ñ–∏–ª—å—Ç—Ä—ã
    if not self.mtf_filter.check(signal):
        return None
    if not self.correlation_filter.check(signal):
        return None
    
    # –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º —Ä–∞–∑–º–µ—Ä –ø–æ–¥ –±–∞–ª–∞–Ω—Å
    position_size = self._calculate_adaptive_position_size(balance, regime)
```

### –®–∞–≥ 4: –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞

```python
def _calculate_adaptive_position_size(self, balance: float, regime: str):
    # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å –±–∞–ª–∞–Ω—Å–∞
    if balance < 1500:
        profile = "small"
        base_usd = 50.0
    elif balance < 3000:
        profile = "medium"
        base_usd = 200.0
    else:
        profile = "large"
        base_usd = 500.0
    
    # –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º –ø–æ–¥ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞
    multiplier = self.arm.get_position_size_multiplier(regime)
    usd_size = base_usd * multiplier
    
    return usd_size
```

---

## ‚ö†Ô∏è –†–∏—Å–∫–∏ –∏ –∫–∞–∫ –∏–∑–±–µ–∂–∞—Ç—å

### –†–∏—Å–∫ 1: –ó–∞–ø—É—Ç–∞—Ç—å—Å—è –≤ –º–æ–¥—É–ª—è—Ö

**–†–µ—à–µ–Ω–∏–µ**:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ –º–æ–¥—É–ª–∏
- ‚úÖ –†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
- ‚úÖ –ß–µ—Ç–∫–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å Spot –∏ Futures –∫–æ–Ω—Ñ–∏–≥–∏

### –†–∏—Å–∫ 2: –ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–†–µ—à–µ–Ω–∏–µ**:
- ‚úÖ –°–æ–∑–¥–∞—Ç—å `futures_modules_config.yaml`
- ‚úÖ –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å, –∫–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —á–µ–≥–æ

### –†–∏—Å–∫ 3: WebSocket –¥–∞–Ω–Ω—ã–µ

**–†–µ—à–µ–Ω–∏–µ**:
- ‚úÖ –¢–∏–∫–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –¥–ª—è Spot –∏ Futures
- ‚úÖ –ú–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å OHLCV
- ‚úÖ –ù–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å WebSocket

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

### **–ü–õ–ê–ù: Shared –º–æ–¥—É–ª–∏ + Futures-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã**

```
‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –û–ë–©–ò–ï –º–æ–¥—É–ª–∏ –∏–∑ src/strategies/modules/
‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –†–ê–ó–ù–´–ï –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config_futures.yaml
‚úÖ –ù–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
‚úÖ WebSocket –¥–∞–Ω–Ω—ã–µ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ - –º–æ–¥—É–ª–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã
```

### –°–ª–æ–∂–Ω–æ—Å—Ç—å: 3/10
- –õ–µ–≥–∫–æ, –µ—Å–ª–∏ –º–æ–¥—É–ª–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã
- –°–ª–æ–∂–Ω–µ–µ, –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–æ—Ä–∞–±–æ—Ç–∫–∏

### –í—Ä–µ–º—è: 2-4 —á–∞—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª–µ–π: 30 –º–∏–Ω
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞: 30 –º–∏–Ω
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: 1-2 —á–∞—Å–∞
- –¢–µ—Å—Ç—ã: 1 —á–∞—Å

### –†–∏—Å–∫ –ø—É—Ç–∞–Ω–∏—Ü—ã: –ù–∏–∑–∫–∏–π
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—â–∏–µ –º–æ–¥—É–ª–∏
- –ï—Å–ª–∏ —á—ë—Ç–∫–æ —Ä–∞–∑–¥–µ–ª–∏—Ç—å Spot/Futures –∫–æ–Ω—Ñ–∏–≥–∏

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

**–•–æ—á–µ—à—å, —á—Ç–æ–±—ã —è:**
1. –ü—Ä–æ–≤–µ—Ä–∏–ª –º–æ–¥—É–ª–∏ –Ω–∞ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å?
2. –î–æ–±–∞–≤–∏–ª –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config_futures.yaml?
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–ª ARM –≤ futures/orchestrator.py?

**–ò–ª–∏ —Å–Ω–∞—á–∞–ª–∞ –∏–∑—É—á–∏–º, –∫–∞–∫ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ Spot?**


