# üîç –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´ –ó–ê–ö–†–´–¢–ò–Ø –ü–û–ó–ò–¶–ò–ô –° –ú–ò–ù–£–°–û–ú

**–î–∞—Ç–∞:** 2025-11-12  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç –æ—Ç–∫—Ä—ã–ª –∏ –∑–∞–∫—Ä—ã–ª –¥–≤–µ –ø–æ–∑–∏—Ü–∏–∏ —Å –º–∏–Ω—É—Å–æ–º

---

## üêõ –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´

### 1. ‚ùå Timeout Loss (timeout_loss_percent: 0.5%, timeout_minutes: 3)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –≤ —É–±—ã—Ç–∫–µ -0.5% —á–µ—Ä–µ–∑ 3 –º–∏–Ω—É—Ç—ã, –æ–Ω–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- **3 –º–∏–Ω—É—Ç—ã - —ç—Ç–æ —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ!**
- –ü–æ–∑–∏—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç–∞ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ, –Ω–µ –¥–∞–≤ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ `timeout_loss_percent` —Å 0.5% –¥–æ 1.0%
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ `timeout_minutes` —Å 3 –¥–æ 5 –º–∏–Ω—É—Ç

---

### 2. ‚ùå Loss Cut (loss_cut_percent: 1.5%)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è —Å—Ä–∞–∑—É —É—Ö–æ–¥–∏—Ç –≤ –º–∏–Ω—É—Å -1.5%, –æ–Ω–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—á–µ–º—É –ø–æ–∑–∏—Ü–∏—è —Å—Ä–∞–∑—É —É—Ö–æ–¥–∏—Ç –≤ –º–∏–Ω—É—Å

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –ö–æ–º–∏—Å—Å–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç–µ –ø—Ä–∏–±—ã–ª–∏
- –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ —Å –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª—å—é, –∫–æ–º–∏—Å—Å–∏—è –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –µ–µ —É–±—ã—Ç–æ—á–Ω–æ–π
- –ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏

---

### 3. ‚ùå Trailing Stop Loss –¥–ª—è SHORT

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–π —Å—Ç–æ–ø —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `entry_price * (1 - trail%)` (–Ω–∏–∂–µ entry)
- –ï—Å–ª–∏ —Ü–µ–Ω–∞ —Å—Ä–∞–∑—É –∏–¥–µ—Ç –í–í–ï–†–• (–ø—Ä–æ—Ç–∏–≤ SHORT), —Å—Ç–æ–ø –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ü–æ–∑–∏—Ü–∏—è –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å—Å—è —Å —É–±—ã—Ç–∫–æ–º, –µ—Å–ª–∏ —Ü–µ–Ω–∞ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –≤—ã—à–µ —Å—Ç–æ–ø–∞

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: `lowest_price = entry_price`, —Å—Ç–æ–ø = `entry_price * (1 - trail%)` (–Ω–∏–∂–µ entry)
- –ï—Å–ª–∏ —Ü–µ–Ω–∞ —Ä–∞—Å—Ç–µ—Ç: `lowest_price` –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (–æ—Å—Ç–∞–µ—Ç—Å—è `entry_price`), —Å—Ç–æ–ø –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ `entry_price * (1 - trail%)`
- –ï—Å–ª–∏ —Ü–µ–Ω–∞ –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –≤—ã—à–µ —Å—Ç–æ–ø–∞, –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –î–ª—è SHORT —Å—Ç–æ–ø –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –í–´–®–ï entry_price –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–æ—Å—Ç–∞
- –ù–æ —Ç–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–æ–ø –ù–ò–ñ–ï entry_price
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–∞–∫—Ä—ã—Ç–∏—é –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è, –µ—Å–ª–∏ —Ü–µ–Ω–∞ –∏–¥–µ—Ç –ø—Ä–æ—Ç–∏–≤ –ø–æ–∑–∏—Ü–∏–∏

---

### 4. ‚ùå –ö–æ–º–∏—Å—Å–∏—è –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ø—Ä–∏–±—ã–ª–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–º–∏—Å—Å–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç–µ –ø—Ä–∏–±—ã–ª–∏ (`include_fees=True`)
- –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ —Å –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª—å—é, –∫–æ–º–∏—Å—Å–∏—è –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –µ–µ —É–±—ã—Ç–æ—á–Ω–æ–π
- `profit_pct` –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–∑-–∑–∞ –∫–æ–º–∏—Å—Å–∏–∏

**–ü—Ä–∏–º–µ—Ä:**
- –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ —Å –ø—Ä–∏–±—ã–ª—å—é +0.05% (gross)
- –ö–æ–º–∏—Å—Å–∏—è 0.09% (–Ω–∞ –∫—Ä—É–≥)
- `profit_pct` (net) = +0.05% - 0.09% = -0.04% (—É–±—ã—Ç–æ–∫!)
- –ü–æ–∑–∏—Ü–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–∫—Ä—ã—Ç–∞ –∫–∞–∫ —É–±—ã—Ç–æ—á–Ω–∞—è

---

### 5. ‚ùå –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è (min_holding_minutes: 0.5)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–∑–∏—Ü–∏—è –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–æ 0.5 –º–∏–Ω—É—Ç—ã (30 —Å–µ–∫—É–Ω–¥)
- –ù–û! Loss Cut –∏ Timeout Loss –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –í–°–ï–ì–î–ê, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è

**–õ–æ–≥–∏–∫–∞:**
```python
# ‚úÖ –≠–¢–ê–ü 4.4: –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é, –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
if effective_min_holding is not None and minutes_in_position < effective_min_holding:
    # –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: –∂—ë—Å—Ç–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —É–±—ã—Ç–∫–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤—Å–µ–≥–¥–∞
    if self.loss_cut_percent is not None and profit_pct <= -self.loss_cut_percent:
        return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
    return False  # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è —Å—Ä–∞–∑—É —É—Ö–æ–¥–∏—Ç –≤ –º–∏–Ω—É—Å -1.5%, –æ–Ω–∞ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–æ 0.5 –º–∏–Ω—É—Ç—ã
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–∞–∫—Ä—ã—Ç–∏—é –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. –£–≤–µ–ª–∏—á–µ–Ω timeout –¥–ª—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

**–ö–æ–Ω—Ñ–∏–≥:**
```yaml
trailing_sl:
  timeout_loss_percent: 1.0  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –±—ã–ª–æ 0.5%
  timeout_minutes: 5  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –±—ã–ª–æ 3
```

---

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã fallback –∑–Ω–∞—á–µ–Ω–∏—è Trailing Stop Loss

**–ö–æ–¥:**
```python
params: Dict[str, Any] = {
    "initial_trail": 0.005,  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: 0.5% (–±—ã–ª–æ 0.05 = 5%)
    "max_trail": 0.01,  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: 1% (–±—ã–ª–æ 0.2 = 20%)
    "min_trail": 0.003,  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: 0.3% (–±—ã–ª–æ 0.02 = 2%)
}
```

---

### 3. –í—ã–Ω–µ—Å–µ–Ω—ã –º–Ω–æ–∂–∏—Ç–µ–ª–∏ —Ä–µ–∂–∏–º–æ–≤ –≤ –∫–æ–Ω—Ñ–∏–≥

**–ö–æ–Ω—Ñ–∏–≥:**
```yaml
trailing_sl:
  by_regime:
    trending:
      regime_multiplier: 1.5  # ‚úÖ –ù–û–í–û–ï
      trend_strength_boost: 1.3  # ‚úÖ –ù–û–í–û–ï
    ranging:
      regime_multiplier: 1.0  # ‚úÖ –ù–û–í–û–ï
      trend_strength_boost: 1.0  # ‚úÖ –ù–û–í–û–ï
    choppy:
      regime_multiplier: 0.8  # ‚úÖ –ù–û–í–û–ï
      trend_strength_boost: 1.0  # ‚úÖ –ù–û–í–û–ï
```

---

## üîç –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è SHORT –ø–æ–∑–∏—Ü–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –î–ª—è SHORT —Å—Ç–æ–ø –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –í–´–®–ï entry_price –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–æ—Å—Ç–∞
- –ù–æ —Ç–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–æ–ø –ù–ò–ñ–ï entry_price

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É `get_stop_loss()` –¥–ª—è SHORT
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å—Ç–æ–ø –≤—Å–µ–≥–¥–∞ –í–´–®–ï entry_price –¥–ª—è SHORT –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

---

### 2. –£–≤–µ–ª–∏—á–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –¥–ª—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Loss Cut –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –í–°–ï–ì–î–ê, –¥–∞–∂–µ –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ—à–ª–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- –≠—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∑–∞–∫—Ä—ã—Ç–∏—é –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á–∏—Ç—å `min_holding_minutes` –¥–ª—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –ò–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å Loss Cut –¥–ª—è –ø–æ–∑–∏—Ü–∏–π –º–ª–∞–¥—à–µ `min_holding_minutes`

---

### 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–∏—Å—Å–∏—é –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ø—Ä–∏–±—ã–ª–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–º–∏—Å—Å–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç–µ –ø—Ä–∏–±—ã–ª–∏
- –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ —Å –Ω–µ–±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª—å—é, –∫–æ–º–∏—Å—Å–∏—è –º–æ–∂–µ—Ç —Å–¥–µ–ª–∞—Ç—å –µ–µ —É–±—ã—Ç–æ—á–Ω–æ–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–∏—Å—Å–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –∫–æ–º–∏—Å—Å–∏—é —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏, –∞ –Ω–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏

---

## üìã –ò–¢–û–ì–û–í–´–ô –°–ü–ò–°–û–ö –ü–†–û–ë–õ–ï–ú

1. ‚úÖ **Timeout Loss** - —É–≤–µ–ª–∏—á–µ–Ω–æ timeout_loss_percent –∏ timeout_minutes
2. ‚úÖ **Fallback –∑–Ω–∞—á–µ–Ω–∏—è Trailing Stop Loss** - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã
3. ‚úÖ **–ú–Ω–æ–∂–∏—Ç–µ–ª–∏ —Ä–µ–∂–∏–º–æ–≤** - –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ –∫–æ–Ω—Ñ–∏–≥
4. ‚ö†Ô∏è **–õ–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è SHORT –ø–æ–∑–∏—Ü–∏–π** - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
5. ‚ö†Ô∏è **–ö–æ–º–∏—Å—Å–∏—è –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ø—Ä–∏–±—ã–ª–∏** - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
6. ‚ö†Ô∏è **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –¥–ª—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π** - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

---

## üîß –ü–†–ò–û–†–ò–¢–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

1. **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è SHORT –ø–æ–∑–∏—Ü–∏–π
2. **–í–ê–ñ–ù–û:** –£–≤–µ–ª–∏—á–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –¥–ª—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
3. **–í–ê–ñ–ù–û:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–º–∏—Å—Å–∏—é –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ø—Ä–∏–±—ã–ª–∏

