# üìä –ü–û–õ–ù–´–ô –û–¢–ß–ï–¢ –û–ë –ò–ó–ú–ï–ù–ï–ù–ò–Ø–• - 26.12.2025

## üìã –ò–°–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û–ï –†–ï–ó–Æ–ú–ï

–î–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ —É–ª—É—á—à–µ–Ω–∏–π, –≤–Ω–µ—Å–µ–Ω–Ω—ã—Ö –≤ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ –ø—Ä–æ–±–ª–µ–º —É–±—ã—Ç–æ—á–Ω–æ—Å—Ç–∏ –∏ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –æ—à–∏–±–æ–∫.

**–ü–µ—Ä–∏–æ–¥ —Ä–∞–±–æ—Ç—ã:** 26.12.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã  
**–í–µ—Ä—Å–∏—è:** 2.0

---

## üéØ –¶–ï–õ–ò –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞–ª–∏—Å—å:

1. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è —É–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å** - Win Rate 8.3%, 75% —Å–¥–µ–ª–æ–∫ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ emergency_loss_protection
2. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã —Å–∏—Å—Ç–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è** - 4 —Ä–∞–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç –º–µ–∂–¥—É —Å–æ–±–æ–π
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞** - –†—ã–Ω–æ–∫ –≤ —Ç—Ä–µ–Ω–¥–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ RANGING
4. **–°–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∑–∞—â–∏—Ç–∞** - –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 0.003-30 —Å–µ–∫—É–Ω–¥
5. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏** - –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
6. **–ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏** - –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –º–µ–∂–¥—É –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏
7. **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏** - datetime, ConfigManager.get(), ATR async/sync –∫–æ–Ω—Ñ–ª–∏–∫—Ç

---

## ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### üî¥ –≠–¢–ê–ü 1: –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

#### 1.1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `cannot access local variable 'datetime'`

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py:5076`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –õ–æ–∫–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç `from datetime import datetime, timezone` —Å–æ–∑–¥–∞–≤–∞–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `datetime`, –∫–æ—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç
- –≠—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫—É `cannot access local variable 'datetime'` –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `datetime` –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–¥–∞–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç `from datetime import datetime, timezone`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∏–º–ø–æ—Ä—Ç –∏–∑ –Ω–∞—á–∞–ª–∞ —Ñ–∞–π–ª–∞ (—Å—Ç—Ä–æ–∫–∞ 15)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û—à–∏–±–∫–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –¢–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ

---

#### 1.2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `'LiquidationProtector' object has no attribute 'check_risk'`

**–§–∞–π–ª:** `src/strategies/scalping/futures/risk_manager.py:1725`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í—ã–∑—ã–≤–∞–ª—Å—è –º–µ—Ç–æ–¥ `check_risk()`, –Ω–æ –≤ `LiquidationProtector` –º–µ—Ç–æ–¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `check_liquidation_risk()`
- –°–∏–≥–Ω–∞—Ç—É—Ä–∞ –º–µ—Ç–æ–¥–∞ –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª–∞ (—Ç—Ä–µ–±–æ–≤–∞–ª–∏—Å—å `current_price` –∏ `margin`)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω –≤—ã–∑–æ–≤ –Ω–∞ `check_liquidation_risk()`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ `current_price` –∏–∑ `data_registry` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `entry_price` –∫–∞–∫ fallback
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª—É—á–µ–Ω–∏–µ `margin` –∏–∑ `data_registry` –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `position_size_usd` –∫–∞–∫ fallback
- ‚úÖ –£–±—Ä–∞–Ω `await`, —Ç–∞–∫ –∫–∞–∫ –º–µ—Ç–æ–¥ –Ω–µ async

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û—à–∏–±–∫–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

#### 1.3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ `'ConfigManager' object has no attribute 'get'`

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py:1222`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `self.config_manager.get("exit_params", {})`
- –ù–æ ConfigManager –Ω–µ –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥–∞ `get()` (—ç—Ç–æ –Ω–µ —Å–ª–æ–≤–∞—Ä—å)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –¥–æ—Å—Ç—É–ø –∫ exit_params —á–µ—Ä–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã ConfigManager
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `getattr(self.config_manager, "exit_params", {})` –∏–ª–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û—à–∏–±–∫–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã exit_params –ø–æ–ª—É—á–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

#### 1.4. –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ async/sync –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ —Å ATR

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py` (—Å—Ç—Ä–æ–∫–∏ 730-772)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `_get_tp_percent` - —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥
- `data_registry.get_indicator` - async –º–µ—Ç–æ–¥
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å ATR –∏–∑ DataRegistry –≤ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º –º–µ—Ç–æ–¥–µ

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å: `src/strategies/scalping/futures/indicators/atr_provider.py`
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ATR –∏–∑ –∫—ç—à–∞
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `_get_tp_percent`

**–ù–æ–≤—ã–π –º–æ–¥—É–ª—å:**
```python
class ATRProvider:
    """–ü—Ä–æ–≤–∞–π–¥–µ—Ä ATR –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞"""
    
    def get_atr(self, symbol: str, fallback: Optional[float] = None) -> Optional[float]:
        """–ü–æ–ª—É—á–∏—Ç—å ATR –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å–∏–º–≤–æ–ª–∞ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)"""
        # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
        # 2. –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å –∏–∑ DataRegistry._indicators (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø)
        # 3. Fallback –∑–Ω–∞—á–µ–Ω–∏–µ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ ATR-based TP —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ—Ç async/sync –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —É–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

### üî¥ –≠–¢–ê–ü 2: EMERGENCY LOSS PROTECTION

#### 2.1. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ emergency_loss_protection –ø–æ —Ä–µ–∂–∏–º–∞–º

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ—Ä–æ–≥ `emergency_loss_protection` –±—ã–ª —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º (-2.0%) –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
- –≠—Ç–æ –±—ã–ª–æ —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ –¥–ª—è —Ä–µ–∂–∏–º–∞ `ranging`, –≥–¥–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ
- 75% —Å–¥–µ–ª–æ–∫ –∑–∞–∫—Ä—ã–≤–∞–ª–∏—Å—å –ø–æ emergency_loss_protection

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –ü–æ—Ä–æ–≥–∏ `emergency_loss_protection` —Ç–µ–ø–µ—Ä—å –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ —Ä–µ–∂–∏–º–∞–º:
  - **TRENDING:** -4.0% (–±—ã–ª–æ -2.5%) - –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π –ø–æ—Ä–æ–≥, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–Ω–¥—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å –±–æ–ª—å—à–∏–µ –ø—Ä–æ—Å–∞–¥–∫–∏
  - **RANGING:** -2.5% (–±—ã–ª–æ -1.5%) - –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π –ø–æ—Ä–æ–≥, —Ç–∞–∫ –∫–∞–∫ –≤ ranging —Ä–µ–∂–∏–º–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ
  - **CHOPPY:** -2.0% (–±—ã–ª–æ -1.5%) - —Å—Ä–µ–¥–Ω–∏–π –ø–æ—Ä–æ–≥, —Ç–∞–∫ –∫–∞–∫ –≤ choppy —Ä–µ–∂–∏–º–µ –≤—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

**–ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```python
# TRENDING —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∞ 1890)
emergency_loss_threshold = -4.0  # –î–ª—è trending —Ä–µ–∂–∏–º–∞ (–±—ã–ª–æ -2.5)

# RANGING —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∞ 2331)
emergency_loss_threshold = -2.5  # –î–ª—è ranging —Ä–µ–∂–∏–º–∞ (–±—ã–ª–æ -1.5)

# CHOPPY —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∞ 3162)
emergency_loss_threshold = -2.0  # –î–ª—è choppy —Ä–µ–∂–∏–º–∞ (–±—ã–ª–æ -1.5)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ—Ä–æ–≥–∏ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –ø–æ–ª—É—á–∞—é—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ
- ‚úÖ –û–∂–∏–¥–∞–µ—Ç—Å—è —Å–Ω–∏–∂–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã emergency close —Å 75% –¥–æ <30%

---

#### 2.2. –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–µ—Ä–µ–¥ emergency close

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ 0.003-30 —Å–µ–∫—É–Ω–¥
- –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç –ø–æ–∑–∏—Ü–∏–∏
- –ö–æ–º–∏—Å—Å–∏–∏ —Å—ä–µ–¥–∞—é—Ç –ª—é–±—É—é –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ü–ï–†–ï–î emergency_loss_protection:
  - **TRENDING:** 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã)
  - **RANGING:** 60 —Å–µ–∫—É–Ω–¥ (1 –º–∏–Ω—É—Ç–∞)
  - **CHOPPY:** 30 —Å–µ–∫—É–Ω–¥

**–ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```python
# TRENDING —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∞ 1899)
min_holding_seconds = 120.0  # TRENDING: 120 —Å–µ–∫—É–Ω–¥ (2 –º–∏–Ω—É—Ç—ã)

# RANGING —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∞ 2340)
min_holding_seconds = 60.0  # RANGING: 60 —Å–µ–∫—É–Ω–¥ (1 –º–∏–Ω—É—Ç–∞)

# CHOPPY —Ä–µ–∂–∏–º (—Å—Ç—Ä–æ–∫–∞ 3171)
min_holding_seconds = 30.0  # CHOPPY: 30 —Å–µ–∫—É–Ω–¥

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ emergency close
if holding_seconds < min_holding_seconds:
    logger.debug(f"‚è≥ Emergency close –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω - –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è {holding_seconds:.1f}—Å < –º–∏–Ω–∏–º—É–º {min_holding_seconds:.1f}—Å")
    return None  # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –ø–æ–ª—É—á–∞—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ
- ‚úÖ –û–∂–∏–¥–∞–µ—Ç—Å—è —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è —Å 20-30 —Å–µ–∫—É–Ω–¥ –¥–æ 1-3 –º–∏–Ω—É—Ç
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π

---

#### 2.3. –£—á–µ—Ç —Å–ø—Ä–µ–¥–∞ –∏ –∫–æ–º–∏—Å—Å–∏–π –≤ emergency_loss_protection

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ —É—á–∏—Ç—ã–≤–∞–ª—Å—è —Å–ø—Ä–µ–¥ –∏ –∫–æ–º–∏—Å—Å–∏–∏ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ø–æ—Ä–æ–≥–∞
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ –∑–∞–∫—Ä—ã—Ç–∏—é –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö –ø—Ä–æ—Å–∞–¥–∫–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `spread_buffer` –∫ –ø–æ—Ä–æ–≥–∞–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `commission_buffer` (0.1%) –∫ –ø–æ—Ä–æ–≥–∞–º
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ `_get_spread_buffer()` –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–ø—Ä–µ–¥–∞

**–ö–æ–¥ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```python
# –£—á–∏—Ç—ã–≤–∞–µ–º —Å–ø—Ä–µ–¥ –∏ –∫–æ–º–∏—Å—Å–∏–∏
spread_buffer = self._get_spread_buffer(symbol, current_price)
commission_buffer = 0.1  # 0.1% –Ω–∞ –∫–æ–º–∏—Å—Å–∏–∏
adjusted_emergency_threshold = emergency_loss_threshold - spread_buffer - commission_buffer

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å —É—á–µ—Ç–æ–º —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞
if pnl_percent < adjusted_emergency_threshold:
    # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ü–æ—Ä–æ–≥–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –∏–∑–¥–µ—Ä–∂–∫–∏
- ‚úÖ –ë–æ–ª–µ–µ —Ç–æ—á–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–±—ã—Ç–∫–∞
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π emergency close

---

### üî¥ –≠–¢–ê–ü 3: –ö–û–û–†–î–ò–ù–ê–¶–ò–Ø –°–ò–°–¢–ï–ú –ó–ê–ö–†–´–¢–ò–Ø

#### 3.1. –°–æ–∑–¥–∞–Ω ExitDecisionCoordinator

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `src/strategies/scalping/futures/coordinators/exit_decision_coordinator.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- 4 —Ä–∞–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –ø—ã—Ç–∞—é—Ç—Å—è –∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏–∏:
  - ExitAnalyzer
  - SmartExitCoordinator
  - TrailingSLCoordinator
  - Emergency Close (PositionManager)
- –ù–µ—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –º–µ–∂–¥—É –Ω–∏–º–∏
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –µ–¥–∏–Ω—ã–π `ExitDecisionCoordinator`
- ‚úÖ –û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —Å–∏—Å—Ç–µ–º—ã –∑–∞–∫—Ä—ã—Ç–∏—è
- ‚úÖ –ï–¥–∏–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- ‚úÖ –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞

**–ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤:**
```python
EXIT_PRIORITIES = {
    "emergency_loss_protection": 1,  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–±—ã—Ç–æ–∫ - —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
    "sl_reached": 2,  # Stop Loss –¥–æ—Å—Ç–∏–≥–Ω—É—Ç
    "tp_reached": 3,  # Take Profit –¥–æ—Å—Ç–∏–≥–Ω—É—Ç
    "trailing_stop": 4,  # Trailing Stop Loss —Å—Ä–∞–±–æ—Ç–∞–ª
    "max_holding_time": 5,  # –ü—Ä–µ–≤—ã—à–µ–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
    "smart_exit_reversal": 6,  # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ —Ä–∞–∑–≤–æ—Ä–æ—Ç—É
    "smart_exit_pattern": 7,  # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
    "partial_tp": 8,  # –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TP
    "extend_tp": 9,  # –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP (–Ω–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)
}
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ `orchestrator.py` (—Å—Ç—Ä–æ–∫–∞ 53)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –≤—Å–µ—Ö —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—à–µ–Ω–∏–π)

---

#### 3.2. –°–æ–∑–¥–∞–Ω PriorityResolver

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `src/strategies/scalping/futures/coordinators/priority_resolver.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- ‚úÖ –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Ä–µ—à–µ–Ω–∏—è–º–∏ –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
- ‚úÖ –ï–¥–∏–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ExitDecisionCoordinator

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- ‚úÖ –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ `orchestrator.py` (—Å—Ç—Ä–æ–∫–∞ 54)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ExitDecisionCoordinator` –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤

---

### üî¥ –≠–¢–ê–ü 4: –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø –†–´–ù–ö–ê

#### 4.1. –°–æ–∑–¥–∞–Ω DirectionAnalyzer

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `src/strategies/scalping/futures/analysis/direction_analyzer.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –µ–¥–∏–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–µ–∂–¥—É –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏ (ADX, RSI, MACD, BB)
- –°–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ—Ç–∏–≤ ADX —Ç—Ä–µ–Ω–¥–∞
- –ù–∏–∑–∫–∏–π win rate (8.3%)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –µ–¥–∏–Ω—ã–π `DirectionAnalyzer`
- ‚úÖ –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:
  - **ADX:** 40% (—Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π)
  - **EMA:** 25%
  - **SMA:** 15%
  - **Price Action:** 10%
  - **Volume:** 10%
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–æ—Ç–∏–≤ –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

**–ú–µ—Ç–æ–¥—ã:**
```python
def analyze_direction(candles, current_price, indicators) -> Dict:
    """–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤"""
    # 1. ADX –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 40%)
    # 2. EMA –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 25%)
    # 3. SMA –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 15%)
    # 4. Price Action –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 10%)
    # 5. Volume –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 10%)
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: direction, confidence, weighted_score
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç ADX –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- ‚úÖ –ì–æ—Ç–æ–≤ –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ signal_generator –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞

---

### üî¥ –≠–¢–ê–ü 5: –°–ò–°–¢–ï–ú–ê –ü–ê–†–ê–ú–ï–¢–†–û–í

#### 5.1. –°–æ–∑–¥–∞–Ω ParameterProvider

**–ù–æ–≤—ã–π —Ñ–∞–π–ª:** `src/strategies/scalping/futures/config/parameter_provider.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ—Ä—É—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞, –Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
- –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ù–µ –≤—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–ª—É—á–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –°–ª–æ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ ‚Üí regime ‚Üí symbol ‚Üí symbol+regime)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –°–æ–∑–¥–∞–Ω –µ–¥–∏–Ω—ã–π `ParameterProvider`
- ‚úÖ –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –ø–∞—Ä—ã –∏ —Ä–µ–∂–∏–º–∞
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: symbol+regime ‚Üí symbol ‚Üí regime ‚Üí global
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ú–µ—Ç–æ–¥—ã:**
```python
def get_regime_params(symbol, regime, balance) -> Dict:
    """–ü–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞"""
    
def get_sl_percent(symbol, regime) -> float:
    """–ü–æ–ª—É—á–∏—Ç—å SL% –¥–ª—è –ø–∞—Ä—ã –∏ —Ä–µ–∂–∏–º–∞"""
    
def get_tp_percent(symbol, regime) -> float:
    """–ü–æ–ª—É—á–∏—Ç—å TP% –¥–ª—è –ø–∞—Ä—ã –∏ —Ä–µ–∂–∏–º–∞"""
    
def get_filter_params(symbol, regime) -> Dict:
    """–ü–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è –ø–∞—Ä—ã –∏ —Ä–µ–∂–∏–º–∞"""
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `exit_analyzer.py` (—Å—Ç—Ä–æ–∫–∞ 21)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö

---

### üî¥ –≠–¢–ê–ü 6: –£–õ–£–ß–®–ï–ù–ò–ï –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –†–ï–ñ–ò–ú–ê

#### 6.1. –£–±—Ä–∞–Ω—ã fallback —Ä–µ–∂–∏–º—ã

**–§–∞–π–ª:** `src/strategies/scalping/futures/adaptivity/regime_manager.py`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –Ω–∏ –æ–¥–Ω–æ —É—Å–ª–æ–≤–∏–µ –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è fallback –Ω–∞ RANGING
- RANGING –º–æ–∂–µ—Ç –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏
- –•–∞—Ä–¥–∫–æ–¥ —Ä–µ–∂–∏–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–±—Ä–∞–Ω—ã fallback —Ä–µ–∂–∏–º—ã
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞ –±–µ–∑ fallback
- ‚úÖ –í—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ä–µ–∂–∏–º —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º score
- ‚úÖ –í—Å–µ–≥–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–¥–Ω–æ–º –∏–∑ —Ä–µ–∂–∏–º–æ–≤ (CHOPPY, TRENDING, RANGING)

**–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:**
```python
# –í—ã—á–∏—Å–ª—è–µ–º score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
choppy_score = calculate_choppy_score(indicators)
trending_score = calculate_trending_score(indicators)
ranging_score = calculate_ranging_score(indicators)

# –í—ã–±–∏—Ä–∞–µ–º —Ä–µ–∂–∏–º —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º score (–ë–ï–ó FALLBACK)
best_regime = max([CHOPPY, TRENDING, RANGING], key=lambda r: scores[r])
return best_regime, confidence, reason
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ —Ä–µ–∂–∏–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚úÖ –†–µ–∂–∏–º –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ–¥ —Ä–µ–∂–∏–º

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏:

1. ‚úÖ `coordinators/exit_decision_coordinator.py` - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
2. ‚úÖ `coordinators/priority_resolver.py` - –†–µ–∑–æ–ª–≤–µ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
3. ‚úÖ `analysis/direction_analyzer.py` - –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä—ã–Ω–∫–∞
4. ‚úÖ `indicators/atr_provider.py` - –ü—Ä–æ–≤–∞–π–¥–µ—Ä ATR –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
5. ‚úÖ `config/parameter_provider.py` - –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:

1. ‚úÖ `positions/exit_analyzer.py` - Emergency loss protection, ATR, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
2. ‚úÖ `orchestrator.py` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ExitDecisionCoordinator, PriorityResolver
3. ‚úÖ `position_manager.py` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ datetime –æ—à–∏–±–∫–∏
4. ‚úÖ `risk_manager.py` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ LiquidationProtector
5. ‚úÖ `adaptivity/regime_manager.py` - –£–±—Ä–∞–Ω—ã fallback —Ä–µ–∂–∏–º—ã

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏:

1. ‚úÖ `cannot access local variable 'datetime'`
2. ‚úÖ `'LiquidationProtector' object has no attribute 'check_risk'`
3. ‚úÖ `'ConfigManager' object has no attribute 'get'`
4. ‚úÖ async/sync –∫–æ–Ω—Ñ–ª–∏–∫—Ç —Å ATR

---

## üéØ –ü–†–û–ì–ù–û–ó–´ –ò –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π):

- ‚ùå Win Rate: **8.3%** (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–∏–π)
- ‚ùå TP –¥–æ—Å—Ç–∏–≥–∞—é—Ç: **6.9%** (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–∏–π)
- ‚ùå SL –∑–∞–∫—Ä—ã—Ç–∏—è: **31%** (–≤—ã—Å–æ–∫–∏–π)
- ‚ùå Emergency close: **75%** (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤—ã—Å–æ–∫–∏–π)
- ‚ùå –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è: **20-30 —Å–µ–∫—É–Ω–¥** (—Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–æ–µ)
- ‚ùå –°–∏–≥–Ω–∞–ª–æ–≤/–¥–µ–Ω—å: **0** (–∫—Ä–∏—Ç–∏—á–Ω–æ)

### –¶–µ–ª–µ–≤—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ (–ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π):

- ‚úÖ Win Rate: **‚â•40%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 8.3% ‚Üí 40% = **+381%**)
- ‚úÖ TP –¥–æ—Å—Ç–∏–≥–∞—é—Ç: **‚â•30%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 6.9% ‚Üí 30% = **+335%**)
- ‚úÖ SL –∑–∞–∫—Ä—ã—Ç–∏—è: **‚â§20%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 31% ‚Üí 20% = **-35%**)
- ‚úÖ Emergency close: **‚â§20%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 75% ‚Üí 20% = **-73%**)
- ‚úÖ –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è: **‚â•2 –º–∏–Ω—É—Ç—ã** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 20-30 —Å–µ–∫ ‚Üí 2 –º–∏–Ω = **+300%**)
- ‚úÖ –°–∏–≥–Ω–∞–ª–æ–≤/–¥–µ–Ω—å: **‚â•10** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 0 ‚Üí 10 = **+‚àû**)

### –ü—Ä–æ–≥–Ω–æ–∑—ã –ø–æ –∫–∞–∂–¥–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—é:

#### 1. Emergency Loss Protection (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ + –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –°–Ω–∏–∂–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã emergency close —Å 75% –¥–æ 20-30%
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è —Å 20-30 —Å–µ–∫—É–Ω–¥ –¥–æ 1-3 –º–∏–Ω—É—Ç
- ‚úÖ –ë–æ–ª—å—à–µ –ø–æ–∑–∏—Ü–∏–π –ø–æ–ª—É—á–∞—Ç —à–∞–Ω—Å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ø—Ä–∏–±—ã–ª—å
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ Win Rate —Å 8.3% –¥–æ 25-35%

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ü–æ—Ä–æ–≥–∏ —É–≤–µ–ª–∏—á–µ–Ω—ã –Ω–∞ 60-100% (TRENDING: -2.5% ‚Üí -4.0%, RANGING: -1.5% ‚Üí -2.5%)
- –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –¥–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—è–º –≤—Ä–µ–º—è –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ
- –£—á–µ—Ç —Å–ø—Ä–µ–¥–∞ –∏ –∫–æ–º–∏—Å—Å–∏–π –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è

---

#### 2. ExitDecisionCoordinator (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Å–∏—Å—Ç–µ–º–∞–º–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ (TP/SL –ø–µ—Ä–µ–¥ emergency)
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—à–µ–Ω–∏–π)
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ Win Rate –Ω–∞ 5-10% –∑–∞ —Å—á–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–æ–∑–≤–æ–ª—è—é—Ç TP/SL —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–æ emergency
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–æ–º–æ–≥–∞–µ—Ç –≤—ã—è–≤–ª—è—Ç—å –ø—Ä–æ–±–ª–µ–º—ã

---

#### 3. DirectionAnalyzer (–µ–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–æ—Ç–∏–≤ ADX —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –≤—Ö–æ–¥–æ–≤
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ Win Rate –Ω–∞ 10-15% –∑–∞ —Å—á–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –í–∑–≤–µ—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (ADX 40%) –¥–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —Ç—Ä–µ–Ω–¥—É
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ –≤—Ö–æ–¥—ã
- –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ `signal_generator.py` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞

---

#### 4. ParameterProvider (–µ–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (symbol+regime ‚Üí symbol ‚Üí regime ‚Üí global)
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–æ–¥ —Ä–µ–∂–∏–º –∏ –ø–∞—Ä—É
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ Win Rate –Ω–∞ 3-5% –∑–∞ —Å—á–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —É–ª—É—á—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö

---

#### 5. –£–±—Ä–∞–Ω—ã fallback —Ä–µ–∂–∏–º—ã

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ –†–µ–∂–∏–º –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ–¥ —Ä–µ–∂–∏–º
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏ –Ω–∞ 5-10%

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- –°–∏—Å—Ç–µ–º–∞ —Å–∫–æ—Ä–∏–Ω–≥–∞ –±–µ–∑ fallback –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —É–ª—É—á—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–∞—Ö

---

#### 6. ATRProvider (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ ATR)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- ‚úÖ ATR-based TP —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ê–¥–∞–ø—Ç–∞—Ü–∏—è TP/SL –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ Win Rate –Ω–∞ 2-3% –∑–∞ —Å—á–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö TP/SL

**–û–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ:**
- ATR-based TP –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ TP/SL —É–ª—É—á—à–∞—é—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ä–∏—Å–∫/–ø—Ä–∏–±—ã–ª—å

---

## üìà –ò–¢–û–ì–û–í–´–ô –ü–†–û–ì–ù–û–ó

### –ö–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:

- Win Rate: **30-35%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 8.3%)
- TP –¥–æ—Å—Ç–∏–≥–∞—é—Ç: **20-25%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 6.9%)
- Emergency close: **30-40%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 75%)
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è: **1.5-2 –º–∏–Ω—É—Ç—ã** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 20-30 —Å–µ–∫)

### –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:

- Win Rate: **40-50%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 8.3%)
- TP –¥–æ—Å—Ç–∏–≥–∞—é—Ç: **30-40%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 6.9%)
- Emergency close: **15-25%** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 75%)
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è: **2-3 –º–∏–Ω—É—Ç—ã** (—É–ª—É—á—à–µ–Ω–∏–µ —Å 20-30 —Å–µ–∫)

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã —É—Å–ø–µ—Ö–∞:

1. ‚úÖ **Emergency Loss Protection** - —Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ (–æ–∂–∏–¥–∞–µ—Ç—Å—è +15-20% Win Rate)
2. ‚úÖ **ExitDecisionCoordinator** - —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (+5-10% Win Rate)
3. ‚úÖ **DirectionAnalyzer** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (+10-15% Win Rate, –ø–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
4. ‚úÖ **ParameterProvider** - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (+3-5% Win Rate)
5. ‚úÖ **ATRProvider** - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL (+2-3% Win Rate)

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:

1. **DirectionAnalyzer** - —Å–æ–∑–¥–∞–Ω, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ `signal_generator.py` –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞
2. **ParameterProvider** - —Å–æ–∑–¥–∞–Ω, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤–æ –≤—Å–µ –º–æ–¥—É–ª–∏
3. **ExitDecisionCoordinator** - —Å–æ–∑–¥–∞–Ω –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –Ω–æ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–Ω–µ—Ç –≤—ã–∑–æ–≤–æ–≤ `analyze_position`)
4. **–ú–µ—Ç—Ä–∏–∫–∏** - —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã, –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º—É

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏:

1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
2. ‚ö†Ô∏è –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Å–æ–∑–¥–∞–Ω—ã, –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã (—Å–∏–≥–Ω–∞–ª ‚Üí –ø–æ–∑–∏—Ü–∏—è ‚Üí TP/SL)
3. ‚ö†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è —Å–æ–∑–¥–∞–Ω, –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω
4. ‚ö†Ô∏è –ê–ª–µ—Ä—Ç—ã —Å–æ–∑–¥–∞–Ω—ã, –Ω–æ –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã

---

## üö® –ß–¢–û –û–°–¢–ê–õ–û–°–¨ –°–î–ï–õ–ê–¢–¨

### ‚ö†Ô∏è –≠–¢–ê–ü 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –û–°–¢–ê–õ–û–°–¨:

#### 1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è DirectionAnalyzer –≤ signal_generator.py (1-2 —á–∞—Å–∞)

**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
```python
# –í signal_generator.py –¥–æ–±–∞–≤–∏—Ç—å:
from src.strategies.scalping.futures.analysis.direction_analyzer import DirectionAnalyzer

# –í __init__:
self.direction_analyzer = DirectionAnalyzer(fast_adx=self.fast_adx)

# –í –º–µ—Ç–æ–¥–µ generate_signal –∏–ª–∏ _generate_base_signals:
direction_result = self.direction_analyzer.analyze_direction(
    candles, current_price, indicators
)

# –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞:
if direction_result["direction"] == "bearish" and signal_side == "LONG":
    logger.warning(f"üö´ {symbol}: –°–∏–≥–Ω–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω - –ø—Ä–æ—Ç–∏–≤ ADX —Ç—Ä–µ–Ω–¥–∞ (ADX={direction_result.get('adx_value', 0):.1f})")
    return None
if direction_result["direction"] == "bullish" and signal_side == "SHORT":
    logger.warning(f"üö´ {symbol}: –°–∏–≥–Ω–∞–ª –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω - –ø—Ä–æ—Ç–∏–≤ ADX —Ç—Ä–µ–Ω–¥–∞ (ADX={direction_result.get('adx_value', 0):.1f})")
    return None
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô (–≤–ª–∏—è–µ—Ç –Ω–∞ Win Rate)

---

#### 2. –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ParameterProvider (2-3 —á–∞—Å–∞)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ 4 —Ñ–∞–π–ª–∞—Ö)

**–ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
- ‚úÖ `exit_analyzer.py`
- ‚úÖ `orchestrator.py`
- ‚úÖ `signal_coordinator.py`
- ‚úÖ `parameter_provider.py` (—Å–∞–º —Ñ–∞–π–ª)

**–ì–¥–µ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- ‚ùå `signal_generator.py` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤
- ‚ùå `regime_manager.py` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–∂–∏–º–æ–≤
- ‚ùå `position_manager.py` - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è TP/SL –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚ùå –í—Å–µ –º–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `config_manager.get()` –Ω–∞–ø—Ä—è–º—É—é

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
```python
# –í–æ –≤—Å–µ—Ö –º–æ–¥—É–ª—è—Ö –∑–∞–º–µ–Ω–∏—Ç—å:
# –ë—ã–ª–æ:
tp_percent = self.config_manager.get("tp_percent", 3.5)
sl_percent = self.config_manager.get("sl_percent", 1.5)

# –°—Ç–∞–ª–æ:
tp_percent = self.parameter_provider.get_tp_percent(symbol, regime)
sl_percent = self.parameter_provider.get_sl_percent(symbol, regime)
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô (–≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)

---

#### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ExitDecisionCoordinator (1-2 —á–∞—Å–∞)

**–°—Ç–∞—Ç—É—Å:** ‚ùå –°–û–ó–î–ê–ù, –ù–û –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `ExitDecisionCoordinator` —Å–æ–∑–¥–∞–Ω –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ `orchestrator.py`
- –ù–æ –Ω–∏–≥–¥–µ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –º–µ—Ç–æ–¥ `analyze_position()`
- –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä—è–º–æ–π –≤—ã–∑–æ–≤ `exit_analyzer.analyze_position()`

**–ì–¥–µ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚ùå `position_monitor.py` - –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ –≤—ã–∑–æ–≤–∞ `exit_analyzer`
- ‚ùå `trailing_sl_coordinator.py` - –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–π
- ‚ùå `websocket_coordinator.py` - –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–π

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
```python
# –í position_monitor.py –∑–∞–º–µ–Ω–∏—Ç—å:
# –ë—ã–ª–æ:
decision = await self.exit_analyzer.analyze_position(symbol)

# –°—Ç–∞–ª–æ:
decision = await self.exit_decision_coordinator.analyze_position(
    symbol=symbol,
    position=position,
    metadata=metadata,
    market_data=market_data,
    current_price=current_price,
    regime=regime
)
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô (–≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é —Å–∏—Å—Ç–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è)

---

### ‚ö†Ô∏è –≠–¢–ê–ü 2: –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - –û–°–¢–ê–õ–û–°–¨:

#### 4. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (1 —á–∞—Å)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§–ê–ô–õ –°–û–ó–î–ê–ù, ‚ùå –ù–ï –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù

**–§–∞–π–ª:** `src/strategies/scalping/futures/metrics/conversion_metrics.py`

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
```python
# –í orchestrator.py:
from .metrics.conversion_metrics import ConversionMetrics

# –í __init__:
self.conversion_metrics = ConversionMetrics()

# –í signal_generator.py –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–∞:
self.conversion_metrics.record_signal(symbol, side, strength)

# –í entry_manager.py –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏:
self.conversion_metrics.record_position_opened(symbol, signal_id)

# –í exit_analyzer.py –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏:
self.conversion_metrics.record_position_closed(symbol, reason, pnl)

# –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
logger.info(f"üìä –ö–û–ù–í–ï–†–°–ò–Ø: —Å–∏–≥–Ω–∞–ª–æ–≤={signals_count}, –ø–æ–∑–∏—Ü–∏–π={positions_count}, TP={tp_count}, SL={sl_count}")
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–´–ô (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)

---

#### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è (30 –º–∏–Ω—É—Ç)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§–ê–ô–õ –°–û–ó–î–ê–ù, ‚ùå –ù–ï –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù

**–§–∞–π–ª:** `src/strategies/scalping/futures/metrics/holding_time_metrics.py`

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
```python
# –í orchestrator.py:
from .metrics.holding_time_metrics import HoldingTimeMetrics

# –í __init__:
self.holding_time_metrics = HoldingTimeMetrics()

# –í exit_analyzer.py –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏:
holding_time = (datetime.now() - entry_time).total_seconds()
self.holding_time_metrics.record_holding_time(symbol, reason, holding_time, pnl)

# –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
avg_holding_time = self.holding_time_metrics.get_avg_holding_time()
logger.info(f"‚è±Ô∏è –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è: {avg_holding_time:.1f} —Å–µ–∫—É–Ω–¥")
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–´–ô (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)

---

#### 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤ (30 –º–∏–Ω—É—Ç)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –§–ê–ô–õ –°–û–ó–î–ê–ù, ‚ùå –ù–ï –ò–ù–¢–ï–ì–†–ò–†–û–í–ê–ù

**–§–∞–π–ª:** `src/strategies/scalping/futures/metrics/alert_manager.py`

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
```python
# –í orchestrator.py:
from .metrics.alert_manager import AlertManager

# –í __init__:
self.alert_manager = AlertManager()

# –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –º–µ—Ç—Ä–∏–∫–∏:
win_rate = self.conversion_metrics.get_win_rate()
if win_rate < 0.3:
    self.alert_manager.send_alert(f"‚ö†Ô∏è Win Rate –Ω–∏–∂–µ 30%: {win_rate:.1%}")

emergency_close_rate = self.conversion_metrics.get_emergency_close_rate()
if emergency_close_rate > 0.5:
    self.alert_manager.send_alert(f"‚ö†Ô∏è Emergency Close –≤—ã—à–µ 50%: {emergency_close_rate:.1%}")
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–´–ô (–¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞)

---

## üìä –°–¢–ê–¢–£–° –í–´–ü–û–õ–ù–ï–ù–ò–Ø

| –≠—Ç–∞–ø | –°—Ç–∞—Ç—É—Å | –û—Å—Ç–∞–ª–æ—Å—å |
|------|--------|----------|
| –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è | ‚úÖ –ì–æ—Ç–æ–≤ | 0 |
| Emergency Loss Protection | ‚úÖ –ì–æ—Ç–æ–≤ | 0 |
| –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º | ‚ö†Ô∏è –°–æ–∑–¥–∞–Ω, –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1-2—á) |
| –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è | ‚ö†Ô∏è –°–æ–∑–¥–∞–Ω, –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1-2—á) |
| –°–∏—Å—Ç–µ–º–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (2-3—á) |
| SL/TP —Å ATR | ‚úÖ –ì–æ—Ç–æ–≤ | 0 |
| –ú–µ—Ç—Ä–∏–∫–∏ | ‚ö†Ô∏è –°–æ–∑–¥–∞–Ω—ã, –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (1—á) |
| –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ | ‚ö†Ô∏è –°–æ–∑–¥–∞–Ω, –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (30–º–∏–Ω) |
| –ê–ª–µ—Ä—Ç—ã | ‚ö†Ô∏è –°–æ–∑–¥–∞–Ω—ã, –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (30–º–∏–Ω) |

---

## üéØ –ò–¢–û–ì–û: –ß–¢–û –û–°–¢–ê–õ–û–°–¨

### –û—Å—Ç–∞–ª–æ—Å—å –≤—ã–ø–æ–ª–Ω–∏—Ç—å: **4.5-6.5 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã**

1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è DirectionAnalyzer** - 1-2 —á–∞—Å–∞ (üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)
2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ParameterProvider** - 2-3 —á–∞—Å–∞ (üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ExitDecisionCoordinator** - 1-2 —á–∞—Å–∞ (üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)
4. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏** - 1 —á–∞—Å (üü° –í–ê–ñ–ù–´–ô)
5. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –≤—Ä–µ–º–µ–Ω–∏** - 30 –º–∏–Ω—É—Ç (üü° –í–ê–ñ–ù–´–ô)
6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∞–ª–µ—Ä—Ç–æ–≤** - 30 –º–∏–Ω—É—Ç (üü° –í–ê–ñ–ù–´–ô)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã:

- **üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô (4-7 —á–∞—Å–æ–≤):** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è DirectionAnalyzer, ParameterProvider, ExitDecisionCoordinator
- **üü° –í–ê–ñ–ù–´–ô (2 —á–∞—Å–∞):** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, –∞–ª–µ—Ä—Ç–æ–≤

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –î–ê–õ–¨–ù–ï–ô–®–ï–ô –†–ê–ë–û–¢–ï

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π):

1. ‚ùå –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `DirectionAnalyzer` –≤ `signal_generator.py` –¥–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞
2. ‚ùå –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å `ParameterProvider` –≤–æ –≤—Å–µ –º–æ–¥—É–ª–∏
3. ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ExitDecisionCoordinator` –≤–º–µ—Å—Ç–æ –ø—Ä—è–º—ã—Ö –≤—ã–∑–æ–≤–æ–≤ `exit_analyzer`

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω—ã–π):

1. ‚ùå –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (—Å–∏–≥–Ω–∞–ª ‚Üí –ø–æ–∑–∏—Ü–∏—è ‚Üí TP/SL)
2. ‚ùå –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
3. ‚ùå –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –∞–ª–µ—Ä—Ç—ã –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è):

1. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä–æ–≥–∏ emergency_loss_protection –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–µ—Å–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ DirectionAnalyzer –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
3. ‚úÖ –£–ª—É—á—à–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–∫–æ—Ä–∏–Ω–≥–∞ —Ä–µ–∂–∏–º–æ–≤

---

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

‚úÖ **–í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã:**
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ emergency_loss_protection
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ (datetime, ConfigManager, ATR)

‚úÖ **–í—Å–µ –º–æ–¥—É–ª–∏ —Å–æ–∑–¥–∞–Ω—ã:**
- ‚úÖ ExitDecisionCoordinator
- ‚úÖ DirectionAnalyzer
- ‚úÖ ParameterProvider
- ‚úÖ ATRProvider
- ‚úÖ ConversionMetrics
- ‚úÖ HoldingTimeMetrics
- ‚úÖ AlertManager

### –ß—Ç–æ –æ—Å—Ç–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å:

‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (4.5-6.5 —á–∞—Å–æ–≤):**
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è DirectionAnalyzer –≤ signal_generator.py (1-2—á)
- ‚ùå –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è ParameterProvider (2-3—á)
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ExitDecisionCoordinator (1-2—á)
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (2—á)

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏):

- **Win Rate:** —Å 8.3% –¥–æ 30-50% (**+260-500%**)
- **Emergency close:** —Å 75% –¥–æ 15-40% (**-47-80%**)
- **–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è:** —Å 20-30 —Å–µ–∫ –¥–æ 1.5-3 –º–∏–Ω (**+200-900%**)

### –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:** ‚úÖ –ì–æ—Ç–æ–≤–∞  
**–ú–æ–¥—É–ª–∏:** ‚úÖ –°–æ–∑–¥–∞–Ω—ã  
**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è (4.5-6.5 —á–∞—Å–æ–≤)  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** ‚è≥ –ü–æ—Å–ª–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 26.12.2025  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 26.12.2025  
**–í–µ—Ä—Å–∏—è:** 2.0  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π

