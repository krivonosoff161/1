# üìã –ü–û–õ–ù–´–ô –ü–õ–ê–ù –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò –ü–†–û–ë–õ–ï–ú–´ –ó–ê–ö–†–´–¢–ò–ô

**–°—Ç–∞—Ç—É—Å:** üî¥ –ì–û–¢–û–í–û –ö –†–ï–ê–õ–ò–ó–ê–¶–ò–ò  
**–í—Ä–µ–º—è:** ~1 —á–∞—Å (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è + —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)  
**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 100% –≤–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã + —Ä–µ—à–µ–Ω–∏–µ

---

## üìä –ß–¢–û –ú–´ –ó–ù–ê–ï–ú

‚úÖ **–°–æ–∑–¥–∞–Ω–æ:**
- `src/strategies/modules/debug_logger.py` - –º–æ–¥—É–ª—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `docs/guides/DEBUGGING_WITH_DEBUG_LOGGER.md` - –ø–æ–ª–Ω—ã–π –≥–∞–π–¥
- `docs/guides/INTEGRATION_DEBUG_LOGGER_STEP_BY_STEP.md` - –ø–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

‚úÖ **–ü—Ä–∞–≤–∏–ª–∞ —Å–æ–±–ª—é–¥–µ–Ω—ã:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫: ‚úÖ `src/strategies/modules/` (–ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- Docstrings: ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- Type hints: ‚úÖ –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è loguru
- CSV —ç–∫—Å–ø–æ—Ä—Ç: ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω

---

## üéØ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

### –§–ê–ó–ê 1: –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø (20 –º–∏–Ω—É—Ç)

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –°–ª–µ–¥–æ–≤–∞—Ç—å `INTEGRATION_DEBUG_LOGGER_STEP_BY_STEP.md`
2. 8 —à–∞–≥–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
   - [x] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤ orchestrator
   - [x] –ü–µ—Ä–µ–¥–∞—á–∞ –≤ tsl_manager
   - [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ tsl_manager
   - [x] –ü–µ—Ä–µ–¥–∞—á–∞ –≤ trailing_stop_loss
   - [x] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ trailing_stop_loss
   - [x] 3 –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ should_close_position()
   - [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ orchestrator (–æ—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ)
   - [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
python -m py_compile src/strategies/modules/debug_logger.py
python -c "from src.strategies.modules.debug_logger import DebugLogger; print('‚úÖ')"
```

---

### –§–ê–ó–ê 2: –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (30 –º–∏–Ω—É—Ç)

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞: `python run.py`
2. –î–∞—Ç—å –µ–º—É –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å 20-30 –º–∏–Ω—É—Ç
3. –û—Ç–∫—Ä—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–π (~5-10)
4. –î–∞—Ç—å –∑–∞–∫—Ä—ã—Ç—å—Å—è –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–º –ø—É—Ç–µ–º

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–æ–Ω—Å–æ–ª—å –∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è –ª–æ–≥–∞–º–∏ üîç
- CSV —Ñ–∞–π–ª —Å–æ–∑–¥–∞—Å—Ç—Å—è –≤ `logs/debug/debug_YYYYMMDD_HHMMSS.csv`
- –ö–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–æ

**–ö–æ–Ω—Å–æ–ª—å –±—É–¥–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å:**
```
09:35:04 üîÑ TICK: BTC-USDT regime=ranging price=84329.1
09:35:04 ‚öôÔ∏è  CONFIG: BTC-USDT min_hold=40.0 timeout=90 loss_cut=1.5
09:35:04 ‚ú® TSL CREATE: BTC-USDT entry=84329.1 min_hold=40.0 timeout=90
09:35:04 üì§ OPEN: BTC-USDT side=long price=84329.1 size=0.0017 regime=ranging

09:36:05 üîç TSL CHECK: BTC-USDT minutes=1.0 profit=-0.5% close=False
09:36:05 üîç TSL CHECK: BTC-USDT check=min_holding_BLOCKED
09:36:05 üîç TSL CHECK: BTC-USDT check=loss_cut profit=-0.5% close=False

09:39:51 ‚ùå CLOSE: BTC-USDT exit=84066.7 pnl_pct=-2.06% time_min=4.78 reason=loss_cut
```

---

### –§–ê–ó–ê 3: –ê–ù–ê–õ–ò–ó CSV (10 –º–∏–Ω—É—Ç)

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**

1. **–û—Ç–∫—Ä—ã—Ç—å CSV –≤ Excel:**
   ```
   logs/debug/debug_20251122_093500.csv
   ```

2. **–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ "close":**
   - –ù–∞–π—Ç–∏ –≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å `event_type = close`
   - –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å `reason` - –ø–æ—á–µ–º—É –∑–∞–∫—Ä—ã–ª–∏?

3. **–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ:**
   ```
   timestamp,event_type,symbol,data
   09:35:04,open,BTC-USDT,side=long|price=84329.1
   09:36:05,tsl_check,BTC-USDT,check=min_holding_BLOCKED|minutes=1.0|min_hold=40.0
   09:39:51,close,BTC-USDT,reason=loss_cut|time_min=4.78|pnl_pct=-2.06%
   ```

4. **–ö–ª—é—á–µ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã:**
   - [ ] –ü–æ—á–µ–º—É `time_min=4.78` –≤–º–µ—Å—Ç–æ 40+?
   - [ ] `reason=loss_cut` - —ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π –≤–∏–Ω–æ–≤–Ω–∏–∫?
   - [ ] `pnl_pct=-2.06%` > `loss_cut=0.3%`?
   - [ ] –ï—Å—Ç—å –ª–∏ —Å–æ–±—ã—Ç–∏—è `check=min_holding_BLOCKED`?

5. **–í—ã–≤–æ–¥—ã:**
   - –ï—Å–ª–∏ –º–Ω–æ–≥–æ `min_holding_BLOCKED` - –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
   - –ï—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ `loss_cut` - —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞ ‚ùå
   - –ï—Å–ª–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –∑–∞ 4-8 —Å–µ–∫—É–Ω–¥ - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¢–ü ‚ùå

---

### –§–ê–ó–ê 4: –î–ê–ô –ú–ù–ï CSV - –ù–ê–ô–î–£ –†–ï–®–ï–ù–ò–ï

**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:**
1. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å CSV —Ñ–∞–π–ª
2. –î–∞—Ç—å –º–Ω–µ —É–≤–∏–¥–µ—Ç—å –ø–æ–ª–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π
3. –Ø –Ω–∞–π–¥—É –¢–û–ß–ù–£–Æ –ø—Ä–∏—á–∏–Ω—É
4. –ò—Å–ø—Ä–∞–≤–∏–º –∫–æ–¥ –≤–º–µ—Å—Ç–µ

**–ü—Ä–∏–º–µ—Ä—ã –∞–Ω–∞–ª–∏–∑–∞:**

**–í–∞—Ä–∏–∞–Ω—Ç A: min_holding –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç**
```
CSV –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- OPEN –≤ 09:35:04
- CLOSE –≤ 09:35:08 (4 —Å–µ–∫—É–Ω–¥—ã!) ‚Üê –ù–ï–¢ min_holding_BLOCKED!
‚Üí –ü—Ä–æ–±–ª–µ–º–∞: min_holding –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ TSL
```

**–í–∞—Ä–∏–∞–Ω—Ç B: loss_cut —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–µ–Ω**
```
CSV –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- min_holding_BLOCKED –≤ 09:36:05 (1 –º–∏–Ω—É—Ç–∞)
- –ù–æ –ø–æ—Ç–æ–º loss_cut –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –≤ 09:39:51
- profit = -2.06% > loss_cut –æ—Ç —Ü–µ–Ω—ã = 0.3%
‚Üí –ü—Ä–æ–±–ª–µ–º–∞: loss_cut –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å
```

**–í–∞—Ä–∏–∞–Ω—Ç C: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ position_manager**
```
CSV –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:
- –ù–µ—Ç events –æ—Ç TSL
- –ù–æ CLOSE —Å–æ–±—ã—Ç–∏–µ –µ—Å—Ç—å —Å reason=unknown
‚Üí –ü—Ä–æ–±–ª–µ–º–∞: position_manager –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
```

---

## üìù –ß–ï–ö–õ–ò–°–¢

### –î–æ –∑–∞–ø—É—Å–∫–∞:
- [ ] –ü—Ä–æ—á–∏—Ç–∞–ª `INTEGRATION_DEBUG_LOGGER_STEP_BY_STEP.md`
- [ ] –í—Å–µ 8 —à–∞–≥–æ–≤ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- [ ] –°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–æ–≤–µ—Ä–µ–Ω (py_compile)
- [ ] –ò–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç

### –í–æ –≤—Ä–µ–º—è –∑–∞–ø—É—Å–∫–∞:
- [ ] –ë–æ—Ç –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –ö–æ–Ω—Å–æ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç DEBUG –ª–æ–≥–∏ üîç
- [ ] –û—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ–∑–∏—Ü–∏–∏
- [ ] –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è

### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:
- [ ] CSV —Ñ–∞–π–ª —Å–æ–∑–¥–∞–Ω –≤ `logs/debug/`
- [ ] CSV —Å–æ–¥–µ—Ä–∂–∏—Ç 10+ —Å–æ–±—ã—Ç–∏–π
- [ ] CSV —á–∏—Ç–∞–µ—Ç—Å—è –≤ Excel
- [ ] –î–∞–Ω–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω—ã

### –ê–Ω–∞–ª–∏–∑:
- [ ] –í—Å–µ "close" —Å–æ–±—ã—Ç–∏—è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- [ ] –í—ã—è–≤–ª–µ–Ω –ø–∞—Ç—Ç–µ—Ä–Ω –∑–∞–∫—Ä—ã—Ç–∏–π
- [ ] –ü–æ–Ω—è–ª –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º—ã
- [ ] –ì–æ—Ç–æ–≤ –¥–∞—Ç—å –º–Ω–µ CSV

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### ‚úÖ –ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

```
–ü–æ–∑–∏—Ü–∏—è BTC –∑–∞ 4:47 –º–∏–Ω—É—Ç:
1. OPEN –≤ 09:35:04
2. min_holding_BLOCKED –≤ 09:36:05 (1 –º–∏–Ω < 40 –º–∏–Ω) ‚úÖ
3. loss_cut –ø—Ä–æ–≤–µ—Ä–∫–∞: -0.5% < -0.3%? –ù–ï–¢ ‚úÖ
4. timeout –ø—Ä–æ–≤–µ—Ä–∫–∞: –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª ‚úÖ
5. –ù–æ –∑–∞—Ç–µ–º —á—Ç–æ-—Ç–æ –∑–∞–∫—Ä—ã–ª–æ? ‚Üê –ù–ê–ô–¢–ò!

CSV –ø–æ–∫–∞–∂–µ—Ç —Ç–æ—á–Ω–æ –ß–¢–û –∏ –ö–û–ì–î–ê.
```

---

## üéØ –ò–¢–û–ì

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–æ–≥–æ –ø–ª–∞–Ω–∞:

1. ‚úÖ **–ü–æ–ª–Ω–∞—è –≤–∏–¥–∏–º–æ—Å—Ç—å** - –∑–Ω–∞–µ–º –í–°–ï —Å–æ–±—ã—Ç–∏—è
2. ‚úÖ **–¢–æ—á–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞** - –∑–Ω–∞–µ–º –¢–û–ß–ù–£–Æ –ø—Ä–∏—á–∏–Ω—É
3. ‚úÖ **–ì–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ** - –∑–Ω–∞–µ–º —á—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å
4. ‚úÖ **–ë—ã—Å—Ç—Ä—ã–π —Ñ–∏–∫—Å** - –∏—Å–ø—Ä–∞–≤–∏–º –≤ 10 –º–∏–Ω—É—Ç

---

## üöÄ –ö–û–ú–ê–ù–î–´

```bash
# 1. –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø
# –°–ª–µ–¥—É–π—Ç–µ docs/guides/INTEGRATION_DEBUG_LOGGER_STEP_BY_STEP.md
# ~20 –º–∏–Ω—É—Ç

# 2. –ó–ê–ü–£–°–ö
python run.py
# –î–∞—Ç—å 20-30 –º–∏–Ω—É—Ç

# 3. –ü–†–û–í–ï–†–ö–ê
ls -la logs/debug/
head -20 logs/debug/debug_*.csv

# 4. –ê–ù–ê–õ–ò–ó
# –û—Ç–∫—Ä—ã—Ç—å CSV –≤ Excel –∏–ª–∏ LibreOffice
# –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å "close" —Å–æ–±—ã—Ç–∏—è
# –î–∞—Ç—å –º–Ω–µ CSV —Ñ–∞–π–ª
```

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–Å –ì–û–¢–û–í–û  
**–ù–∞—á–∏–Ω–∞–π—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é!** üöÄ

**–í–æ–ø—Ä–æ—Å—ã?** –ß–∏—Ç–∞–π—Ç–µ –≥–∞–π–¥—ã! üìñ

