# âš ï¸ ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð° Ñ€Ð°Ð·Ð¼ÐµÑ‰ÐµÐ½Ð¸Ñ Ð»Ð¸Ð¼Ð¸Ñ‚Ð½Ñ‹Ñ… Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð² (29.11.2025)

## ðŸ” ÐžÐ±Ð½Ð°Ñ€ÑƒÐ¶ÐµÐ½Ð½Ð°Ñ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð°

### ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð¸Ð· Ð»Ð¾Ð³Ð¾Ð²:

**Ð’Ñ€ÐµÐ¼Ñ:** 17:36:02  
**Ð¡Ð¸Ð¼Ð²Ð¾Ð»:** BTC-USDT  
**Ð¢Ð¸Ð¿:** SELL (SHORT)  
**Ð Ð°Ð·Ð¼ÐµÑ‰ÐµÐ½Ð½Ñ‹Ð¹ Ð¾Ñ€Ð´ÐµÑ€:** $90,619.35  
**Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ñ†ÐµÐ½Ð° Ð² Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ Ñ€Ð°Ð·Ð¼ÐµÑ‰ÐµÐ½Ð¸Ñ:** ~$90,100  
**Ð Ð°Ð·Ð½Ð¸Ñ†Ð°:** ~$519 (0.57% Ð²Ñ‹ÑˆÐµ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ñ†ÐµÐ½Ñ‹!)

**ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹:**
- best_bid = $90,619.40
- best_ask = $90,619.50
- offset = 0.08%
- Ð ÐµÐ¶Ð¸Ð¼ = ranging
- min_sell = $90,619.35

**Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:** ÐžÑ€Ð´ÐµÑ€ Ð²Ð¸ÑÐµÐ» 127 ÑÐµÐºÑƒÐ½Ð´ Ð¸ Ð±Ñ‹Ð» Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½ (Ð»Ð¸Ð¼Ð¸Ñ‚ 120 ÑÐµÐºÑƒÐ½Ð´)

## âŒ ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°

### Ð”Ð»Ñ SELL Ð¾Ñ€Ð´ÐµÑ€Ð°:
- **ÐžÐ¶Ð¸Ð´Ð°ÐµÑ‚ÑÑ:** Ð¦ÐµÐ½Ð° Ð´Ð¾Ð»Ð¶Ð½Ð° Ð±Ñ‹Ñ‚ÑŒ **ÐÐ˜Ð–Ð•** Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ñ†ÐµÐ½Ñ‹ (Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð±Ñ‹ÑÑ‚Ñ€Ð¾ Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÑŒÑÑ)
- **Ð ÐµÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ:** Ð¦ÐµÐ½Ð° Ð±Ñ‹Ð»Ð° **Ð’Ð«Ð¨Ð•** Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ñ†ÐµÐ½Ñ‹ Ð½Ð° ~$519

### ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°:
1. **best_bid = $90,619.40** - ÑÑ‚Ð¾ Ñ†ÐµÐ½Ð° Ð¸Ð· ÑÑ‚Ð°ÐºÐ°Ð½Ð° Ð² Ð¼Ð¾Ð¼ÐµÐ½Ñ‚ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð´Ð°Ð½Ð½Ñ‹Ñ…
2. **Ð¢ÐµÐºÑƒÑ‰Ð°Ñ Ñ†ÐµÐ½Ð° = ~$90,100** - ÑÑ‚Ð¾ Ñ€ÐµÐ°Ð»ÑŒÐ½Ð°Ñ Ñ€Ñ‹Ð½Ð¾Ñ‡Ð½Ð°Ñ Ñ†ÐµÐ½Ð°
3. **ÐžÑ€Ð´ÐµÑ€ Ñ€Ð°Ð·Ð¼ÐµÑ‰ÐµÐ½ Ð¿Ð¾:** `best_bid * (1 - 0.08%) = $90,619.40 * 0.9992 = $90,547.58`
4. **ÐÐ¾ Ð·Ð°Ñ‚ÐµÐ¼ ÑÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½ Ð´Ð¾:** `min_sell = $90,619.35`

**ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°:** `min_sell_price` Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚ `best_bid`, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ ÑƒÑÑ‚Ð°Ñ€ÐµÐ²ÑˆÐ¸Ð¼ Ð¸Ð»Ð¸ Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼!

## ðŸ” ÐÐ½Ð°Ð»Ð¸Ð· ÐºÐ¾Ð´Ð°

### `_calculate_limit_price` Ð´Ð»Ñ SELL:
```python
if best_bid > 0:
    limit_price = best_bid * (1 - offset_percent / 100.0)
else:
    limit_price = current_price * (1 - offset_percent / 100.0)

# Ð—Ð°Ñ‚ÐµÐ¼ ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€ÑƒÐµÑ‚ÑÑ:
limit_price = max(limit_price, min_sell_price)
```

### `get_price_limits` Ð² `futures_client.py`:
```python
# min_sell_price Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚ best_bid
min_sell_price = best_bid - (spread * 0.5)  # 50% Ð¾Ñ‚ ÑÐ¿Ñ€ÐµÐ´Ð° Ð½Ð¸Ð¶Ðµ best_bid
# Ð˜Ð»Ð¸
min_sell_price = best_bid * 0.999  # 0.1% Ð½Ð¸Ð¶Ðµ best_bid
```

## âš ï¸ ÐšÐ¾Ñ€Ð½ÐµÐ²Ð°Ñ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ð°

1. **best_bid Ð¼Ð¾Ð¶ÐµÑ‚ Ð±Ñ‹Ñ‚ÑŒ ÑƒÑÑ‚Ð°Ñ€ÐµÐ²ÑˆÐ¸Ð¼** - Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· ÑÑ‚Ð°ÐºÐ°Ð½Ð° Ð¼Ð¾Ð³ÑƒÑ‚ Ð±Ñ‹Ñ‚ÑŒ Ð½ÐµÐ°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ð¼Ð¸
2. **min_sell_price Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð¾Ñ‚ best_bid** - ÐµÑÐ»Ð¸ best_bid ÑƒÑÑ‚Ð°Ñ€ÐµÐ», min_sell_price Ñ‚Ð¾Ð¶Ðµ Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹
3. **ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° `limit_price = max(limit_price, min_sell_price)`** - Ð¿Ð¾Ð´Ð½Ð¸Ð¼Ð°ÐµÑ‚ Ñ†ÐµÐ½Ñƒ Ð´Ð¾ Ð½ÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ð³Ð¾ min_sell_price

## âœ… Ð ÐµÑˆÐµÐ½Ð¸Ðµ

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 1: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ current_price Ð²Ð¼ÐµÑÑ‚Ð¾ best_bid
```python
# Ð”Ð»Ñ SELL: Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ current_price - offset
if current_price > 0:
    limit_price = current_price * (1 - offset_percent / 100.0)
else:
    limit_price = best_bid * (1 - offset_percent / 100.0)
```

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 2: ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ best_bid
```python
# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼, Ñ‡Ñ‚Ð¾ best_bid Ð½Ðµ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð°Ð»ÐµÐºÐ¾ Ð¾Ñ‚ current_price
if abs(best_bid - current_price) / current_price > 0.01:  # > 1%
    logger.warning(f"âš ï¸ best_bid ({best_bid}) ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð´Ð°Ð»ÐµÐºÐ¾ Ð¾Ñ‚ current_price ({current_price}), Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ current_price")
    limit_price = current_price * (1 - offset_percent / 100.0)
else:
    limit_price = best_bid * (1 - offset_percent / 100.0)
```

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 3: Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ best_bid Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð¾Ð½ Ð°ÐºÑ‚ÑƒÐ°Ð»ÐµÐ½
```python
# Ð”Ð»Ñ SELL: Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ best_bid Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐµÑÐ»Ð¸ Ð¾Ð½ Ð±Ð»Ð¸Ð·Ð¾Ðº Ðº current_price
spread_pct = abs(best_bid - current_price) / current_price if current_price > 0 else 1.0
if spread_pct < 0.005:  # Ð¡Ð¿Ñ€ÐµÐ´ < 0.5%
    limit_price = best_bid * (1 - offset_percent / 100.0)
else:
    # best_bid ÑƒÑÑ‚Ð°Ñ€ÐµÐ», Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÐ¼ current_price
    limit_price = current_price * (1 - offset_percent / 100.0)
```

## ðŸŽ¯ Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ñ

**Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 3** - Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÑ‚ÑŒ Ð°ÐºÑ‚ÑƒÐ°Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ best_bid Ð¿ÐµÑ€ÐµÐ´ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼. Ð­Ñ‚Ð¾ Ð³Ð°Ñ€Ð°Ð½Ñ‚Ð¸Ñ€ÑƒÐµÑ‚, Ñ‡Ñ‚Ð¾ Ð¾Ñ€Ð´ÐµÑ€ Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°Ð·Ð¼ÐµÑ‰ÐµÐ½ Ð±Ð»Ð¸Ð·ÐºÐ¾ Ðº Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¹ Ñ€Ñ‹Ð½Ð¾Ñ‡Ð½Ð¾Ð¹ Ñ†ÐµÐ½Ðµ.

## ðŸ“Š ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚

ÐŸÐ¾ÑÐ»Ðµ Ð¸ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ:
- SELL Ð¾Ñ€Ð´ÐµÑ€Ð° Ð±ÑƒÐ´ÑƒÑ‚ Ñ€Ð°Ð·Ð¼ÐµÑ‰Ð°Ñ‚ÑŒÑÑ **ÐÐ˜Ð–Ð•** Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ñ†ÐµÐ½Ñ‹
- BUY Ð¾Ñ€Ð´ÐµÑ€Ð° Ð±ÑƒÐ´ÑƒÑ‚ Ñ€Ð°Ð·Ð¼ÐµÑ‰Ð°Ñ‚ÑŒÑÑ **Ð’Ð«Ð¨Ð•** Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¹ Ñ†ÐµÐ½Ñ‹
- ÐžÑ€Ð´ÐµÑ€Ð° Ð±ÑƒÐ´ÑƒÑ‚ Ð¸ÑÐ¿Ð¾Ð»Ð½ÑÑ‚ÑŒÑÑ Ð±Ñ‹ÑÑ‚Ñ€ÐµÐµ
- ÐœÐµÐ½ÑŒÑˆÐµ Ð¾Ñ‚Ð¼ÐµÐ½ Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð² Ð¿Ð¾ Ñ‚Ð°Ð¹Ð¼Ð°ÑƒÑ‚Ñƒ

