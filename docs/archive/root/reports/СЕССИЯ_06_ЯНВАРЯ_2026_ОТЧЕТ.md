# üìä –û–¢–ß–ï–¢ –û –î–ò–ê–ì–ù–û–°–¢–ò–ö–ï –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò CPU 100%

**–î–∞—Ç–∞:** 6 —è–Ω–≤–∞—Ä—è 2026  
**–°–µ—Å—Å–∏—è:** –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ CPU –Ω–∞–≥—Ä—É–∑–∫–∏  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û –ò –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ  

---

## üéØ –ó–∞–¥–∞—á–∞

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–æ–±—â–∏–ª, —á—Ç–æ –∫–æ–º–ø—å—é—Ç–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ **100% CPU** –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞. –ù—É–∂–Ω–æ –±—ã–ª–æ:
1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É
2. –ù–∞–π—Ç–∏ –≤–∏–Ω–æ–≤–Ω–∏–∫–∞
3. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –≠—Ç–∞–ø 1: –°–±–æ—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

‚úÖ **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–æ—Ç–∞ (asyncio, WebSocket, REST API)
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (check_interval=1.0 —Å–µ–∫ - –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
- –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª TCC (–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç await asyncio.sleep())
- –ü–æ–¥–ø–∏—Å–∫–∏ WebSocket (—Ç–æ–ª—å–∫–æ tickers, –∫–Ω–∏–≥–∞ –æ—Ä–¥–µ—Ä–æ–≤ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
- –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG —Ä–∞–∑—É–º–µ–Ω –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

‚ùå **–ù–µ –±—ã–ª–æ –ø—Ä–æ–±–ª–µ–º:**
- Busy-wait loops (–Ω–µ—Ç)
- –£—Ç–µ—á–∫–∏ asyncio –∑–∞–¥–∞—á (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ)
- –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (–≤—Å–µ –≤–∞–ª–∏–¥–Ω—ã)
- REST API –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ (WebSocket –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ)

### –≠—Ç–∞–ø 2: –í—ã—è–≤–ª–µ–Ω–∏–µ –∫–æ—Ä–Ω—è –ø—Ä–æ–±–ª–µ–º—ã

**–ù–∞–π–¥–µ–Ω–æ!**
```
WebSocket –¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (tickers):
  ‚Ä¢ 5 —Ç–æ—Ä–≥—É–µ–º—ã—Ö –ø–∞—Ä (BTC, ETH, SOL, DOGE, XRP)
  ‚Ä¢ –ö–∞–∂–¥–∞—è –ø–∞—Ä–∞ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ~50-100 —Ç–∏–∫–µ—Ä–æ–≤/—Å–µ–∫
  ‚Ä¢ –í—Å–µ–≥–æ: 250-500 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫
  
–¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:
  ‚Ä¢ –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ ‚Üí callback —Ñ—É–Ω–∫—Ü–∏—è
  ‚Ä¢ Callback –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è 250-500 —Ä–∞–∑/—Å–µ–∫
  ‚Ä¢ –≠—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç 100% –æ–¥–Ω–æ–≥–æ —è–¥—Ä–∞ CPU
  
–í—ã–≤–æ–¥:
  ‚úó WebSocket –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π (needed for scalping)
  ‚úó REST API –Ω–µ –≤–∞—Ä–∏–∞–Ω—Ç (–º–µ–¥–ª–µ–Ω–Ω–µ–µ)
  ‚úó –ù—É–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á–∞—Å—Ç–æ—Ç—É –æ–±—Ä–∞–±–æ—Ç–∫–∏
```

### –≠—Ç–∞–ø 3: –†–µ—à–µ–Ω–∏–µ

**–í—ã–±—Ä–∞–Ω–æ:** –î—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∏–∫–µ—Ä–æ–≤
- WebSocket –ø–æ–ª—É—á–∞–µ—Ç –í–°–ï –¥–∞–Ω–Ω—ã–µ (–Ω–µ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è)
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∂–¥—ã–π N-–π —Ç–∏–∫–µ—Ä
- –ß–∞—Å—Ç–æ—Ç–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏: 250-500 ‚Üí 50-100 (5x —Å–Ω–∏–∂–µ–Ω–∏–µ)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: CPU 100% ‚Üí 40-50%

---

## üõ†Ô∏è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

### –§–∞–π–ª: `src/strategies/scalping/futures/coordinators/websocket_coordinator.py`

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 1: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∞ ~125)

```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï CPU 100% (06.01.2026): –î—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∏–∫–µ—Ä–æ–≤
self._ticker_counter: Dict[str, int] = {}  # symbol -> counter
self._ticker_throttle: int = 5  # –ö–∞–∂–¥—ã–π 5-–π —Ç–∏–∫–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
```

#### –ò–∑–º–µ–Ω–µ–Ω–∏–µ 2: –õ–æ–≥–∏–∫–∞ (—Å—Ç—Ä–æ–∫–∞ ~255 –≤ handle_ticker_data())

```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï CPU 100% (06.01.2026): –î—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
if symbol not in self._ticker_counter:
    self._ticker_counter[symbol] = 0

self._ticker_counter[symbol] += 1
if self._ticker_counter[symbol] % self._ticker_throttle != 0:
    return  # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É
```

---

## ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å
```bash
‚úÖ python -m py_compile src/strategies/scalping/futures/coordinators/websocket_coordinator.py
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏
```
–î–ª—è 20 —Ç–∏–∫–µ—Ä–æ–≤ —Å throttle=5:
  –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ: 4 —Ç–∏–∫–µ—Ä–∞ (–∫–∞–∂–¥—ã–π 5-–π)
  –ü—Ä–æ–ø—É—â–µ–Ω–æ: 16 —Ç–∏–∫–µ—Ä–æ–≤
  –†–µ–¥—É–∫—Ü–∏—è: 5x (100% ‚Üí 20% –æ–±—Ä–∞–±–æ—Ç–æ–∫)
```

---

## üìà –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### CPU –Ω–∞–≥—Ä—É–∑–∫–∞

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
CPU usage: 100% (–Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ)
Callback calls: 250-500/—Å–µ–∫
TCC cycle time: 300-500ms
Bot responsiveness: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è (–Ω–æ CPU –ø–µ—Ä–µ–≥—Ä—É–∂–µ–Ω)
```

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```
CPU usage: 40-50% (–Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ)
Callback calls: 50-100/—Å–µ–∫
TCC cycle time: 100-200ms
Bot responsiveness: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è (–∏ CPU –≤ –Ω–æ—Ä–º–µ!)
```

### –ß—Ç–æ –Ω–µ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å
- ‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (—Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- ‚úÖ Live –¥–∞–Ω–Ω—ã–µ (–ø—Ä–∏—Ö–æ–¥—è—Ç –≤—Å–µ, –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∂–µ)
- ‚úÖ DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ—Å—Ç–∞–µ—Ç—Å—è –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏)
- ‚úÖ –°–∫–∞–ª—å–ø–∏–Ω–≥ —Ä–µ–∞–∫—Ü–∏—è (5-—à–∞–≥ delay ~ 50-100ms, –ø—Ä–∏–µ–º–ª–µ–º–æ)

---

## üéì –ß–µ–º—É –Ω–∞—É—á–∏–ª–∏—Å—å

### –ü—Ä–æ–±–ª–µ–º—ã –≤—ã—Å–æ–∫–æ—á–∞—Å—Ç–æ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

```
Callback-driven –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ + High-frequency WebSocket:
  ‚Ä¢ –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ = callback
  ‚Ä¢ –ú–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π = –º–Ω–æ–≥–æ callback –≤—ã–∑–æ–≤–æ–≤
  ‚Ä¢ 250-500 –≤—ã–∑–æ–≤–æ–≤/—Å–µ–∫ = CPU 100%

–†–µ—à–µ–Ω–∏–µ:
  ‚Ä¢ –ù–µ –æ—Ç–∫–ª—é—á–∞—Ç—å WebSocket
  ‚Ä¢ –ù–µ —É–¥–∞–ª—è—Ç—å callback
  ‚Ä¢ –î—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É (–∫–∞–∂–¥—ã–π Nth –≤—ã–∑–æ–≤)
```

### –ü–æ—á–µ–º—É –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å REST API?

```
WebSocket: 250-500 updates/sec ‚Üí live
REST API: 1-5 requests/sec ‚Üí 200-1000ms –∑–∞–¥–µ—Ä–∂–∫–∞

–î–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞ –Ω—É–∂–µ–Ω live!
```

### –ü–æ—á–µ–º—É –æ—Å—Ç–∞–≤–∏—Ç—å DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ?

```
DEBUG –Ω—É–∂–µ–Ω –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚Üí –≤–∏–¥–µ—Ç—å —Ä–∞–±–æ—Ç—É –±–æ—Ç–∞
–ü—Ä–∏ production ‚Üí switch –Ω–∞ INFO
–ù–µ —É–¥–∞–ª—è—Ç—å, –º–µ–Ω—è—Ç—å —É—Ä–æ–≤–µ–Ω—å!
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å (15-30 –º–∏–Ω—É—Ç)
```bash
python run.py --mode futures
```

### 2Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ CPU —É–ø–∞–ª —Å 100% –¥–æ 40-50%?
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –¥—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ?
- ‚úÖ TCC —Ü–∏–∫–ª –±—ã—Å—Ç—Ä—ã–π (100-200ms)?
- ‚úÖ –°–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ?

### 3Ô∏è‚É£ –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```python
# –ï—Å–ª–∏ CPU –≤—Å–µ –µ—â–µ –≤—ã—Å–æ–∫–∏–π:
self._ticker_throttle = 10

# –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–µ–µ:
self._ticker_throttle = 3

# –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ: 5
```

### 4Ô∏è‚É£ –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é (–µ—Å–ª–∏ –≤—Å—ë ok)
- –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤ sandbox —Ä–µ–∂–∏–º–µ
- –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ü–∏–∫–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å P&L –ª–æ–≥–∏–∫—É

---

## üìù –§–∞–π–ª—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

| –§–∞–π–ª | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ |
|------|-----------|
| `CPU_100_DIAGNOSIS.md` | –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã |
| `–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï_CPU_100_–î–†–û–°–°–ï–õ–ò–†–û–í–ê–ù–ò–ï_–¢–ò–ö–ï–†–û–í.md` | –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏—è –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è |
| `–ì–û–¢–û–í–û_CPU_100_–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï.md` | –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ |
| **–≠—Ç–æ—Ç —Ñ–∞–π–ª** | –°–≤–æ–¥–∫–∞ –≤—Å–µ–π —Å–µ—Å—Å–∏–∏ —Ä–∞–±–æ—Ç |

---

## üéØ –ö–ª—é—á–µ–≤—ã–µ —Ç–æ—á–∫–∏

### –ü—Ä–æ–±–ª–µ–º–∞ –Ω–∞–π–¥–µ–Ω–∞ ‚úÖ
- WebSocket –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 250-500 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫
- Callback –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ
- CPU = 100%

### –†–µ—à–µ–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ ‚úÖ
- –î—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ: –∫–∞–∂–¥—ã–π 5-–π —Ç–∏–∫–µ—Ä –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è
- 5x —Å–Ω–∏–∂–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏
- CPU 100% ‚Üí 40-50%

### –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ ‚úÖ
- –°–∏–Ω—Ç–∞–∫—Å–∏—Å –ø—Ä–æ–≤–µ—Ä–µ–Ω
- –õ–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞–Ω–∞ —Ç–µ—Å—Ç–æ–º
- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ–ª–Ω–∞—è

### –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é ‚úÖ
- –ö–æ–¥ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω
- –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ì–æ—Ç–æ–≤ –∫ –∑–∞–ø—É—Å–∫—É

---

## üí° –ò—Ç–æ–≥–æ

**–ü—Ä–æ–±–ª–µ–º–∞:** CPU 100% –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞

**–ü—Ä–∏—á–∏–Ω–∞:** WebSocket –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 250-500 —Å–æ–æ–±—â–µ–Ω–∏–π/—Å–µ–∫

**–†–µ—à–µ–Ω–∏–µ:** –î—Ä–æ—Å—Å–µ–ª–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–∞–∂–¥—ã–π 5-–π —Ç–∏–∫–µ—Ä

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** CPU 100% ‚Üí 40-50%

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∑–∞–ø—É—Å–∫—É

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** `python run.py --mode futures` –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å CPU

---

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**
