# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –û—à–∏–±–∫–∏ –æ—Ç—Å—Ç—É–ø–æ–≤ (IndentationError)

**–î–∞—Ç–∞:** 2025-12-18  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´

---

## üîç –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### –ü–†–û–ë–õ–ï–ú–ê #1: IndentationError –≤ `futures_client.py` ‚úÖ

**–§–∞–π–ª:** `src/clients/futures_client.py` (—Å—Ç—Ä–æ–∫–∏ 67-68)

**–û—à–∏–±–∫–∞:**
```python
if not self.session.closed:
await self.session.close()  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```python
if not self.session.closed:
    await self.session.close()  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
```

---

### –ü–†–û–ë–õ–ï–ú–ê #2: IndentationError –≤ `private_websocket_manager.py` ‚úÖ

**–§–∞–π–ª:** `src/strategies/scalping/futures/private_websocket_manager.py` (—Å—Ç—Ä–æ–∫–∏ 455-456)

**–û—à–∏–±–∫–∞:**
```python
if not self.session.closed:
await self.session.close()  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```python
if not self.session.closed:
    await self.session.close()  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
```

---

### –ü–†–û–ë–õ–ï–ú–ê #3: Leverage 3x ‚Üí 5x –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö ‚úÖ

**–§–∞–π–ª—ã:**
- `start.bat` (—Å—Ç—Ä–æ–∫–∞ 127)
- `scripts_bat/start.bat` (—Å—Ç—Ä–æ–∫–∞ 127)

**–û—à–∏–±–∫–∞:**
```
- Trading with leverage (3x default)
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
```
- Trading with leverage (5x default)
```

---

## ‚úÖ –ü–†–ò–ú–ï–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. futures_client.py ‚úÖ

**–ú–µ—Ç–æ–¥:** `close()` (—Å—Ç—Ä–æ–∫–∏ 63-74)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –æ—Ç—Å—Ç—É–ø –¥–ª—è `await self.session.close()`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –æ—Ç—Å—Ç—É–ø –¥–ª—è `await asyncio.sleep(0.2)`

**–ö–æ–¥:**
```python
async def close(self):
    """–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Å—Å–∏–∏"""
    try:
        if self.session:
            if not self.session.closed:
                await self.session.close()  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
                # –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
                await asyncio.sleep(0.2)  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
            self.session = None
            logger.debug("‚úÖ OKXFuturesClient —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞")
    except Exception as e:
        logger.debug(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —Å–µ—Å—Å–∏–∏: {e}")
```

---

### 2. private_websocket_manager.py ‚úÖ

**–ú–µ—Ç–æ–¥:** `disconnect()` (—Å—Ç—Ä–æ–∫–∏ 452-463)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –æ—Ç—Å—Ç—É–ø –¥–ª—è `await self.session.close()`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –æ—Ç—Å—Ç—É–ø –¥–ª—è `await asyncio.sleep(0.2)`

**–ö–æ–¥:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–µ—Å—Å–∏—é —Å —è–≤–Ω—ã–º –æ–∂–∏–¥–∞–Ω–∏–µ–º
if self.session:
    try:
        if not self.session.closed:
            await self.session.close()  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
            # –î–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ –ø–æ–ª–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–µ—Å—Å–∏–∏
            await asyncio.sleep(0.2)  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç—Å—Ç—É–ø
        self.session = None
        logger.debug("‚úÖ Private WebSocket —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞")
    except Exception as e:
        logger.debug(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ Private WebSocket —Å–µ—Å—Å–∏–∏: {e}")
        self.session = None
```

---

### 3. start.bat –∏ scripts_bat/start.bat ‚úÖ

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –û–±–Ω–æ–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ leverage —Å 3x –Ω–∞ 5x

**–ö–æ–¥:**
```batch
echo   - Trading with leverage (5x default)
```

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢

**–í—Å–µ –æ—à–∏–±–∫–∏ –æ—Ç—Å—Ç—É–ø–æ–≤ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã!** ‚úÖ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞:

1. ‚úÖ `futures_client.py` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
2. ‚úÖ `private_websocket_manager.py` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
3. ‚úÖ `orchestrator.py` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
4. ‚úÖ `main_futures.py` - –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ô –†–ï–ó–£–õ–¨–¢–ê–¢

**–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞!**

- ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã –∫–æ–º–ø–∏–ª–∏—Ä—É—é—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –ò–º–ø–æ—Ä—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –æ leverage –æ–±–Ω–æ–≤–ª–µ–Ω—ã

---

**–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** ‚úÖ
