# üèóÔ∏è –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã —Å–∏—Å—Ç–µ–º—ã –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π (29.11.2025)

## üìã –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã)

### –¢–µ–∫—É—â–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –≤ `manage_position`:

```python
1. _check_position_safety()        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (–º–∞—Ä–∂–∞, –ª–∏–∫–≤–∏–¥–∞—Ü–∏—è)
2. _check_profit_harvesting()       # –ü–†–ò–û–†–ò–¢–ï–¢ #1: –ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –ø—Ä–∏–±—ã–ª–∏
3. _update_peak_profit()            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏
4. _check_profit_drawdown()         # –ü–†–ò–û–†–ò–¢–ï–¢ #2: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ –æ—Ç –ø–∏–∫–∞
5. _check_tp_only()                 # Take Profit (—Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π SL –≤–Ω—É—Ç—Ä–∏)
6. _check_max_holding()             # –ü–†–ò–û–†–ò–¢–ï–¢ #3: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
7. _update_position_stats()          # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
```

### ‚úÖ –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤:

**–ü–†–ò–û–†–ò–¢–ï–¢ #1: Profit Harvesting**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–π –ø—Ä–∏–±—ã–ª–∏
- ‚úÖ **–õ–æ–≥–∏–∫–∞:** –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç `min_holding` –∏ `ph_time_limit` –ø—Ä–∏ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ (>= 1.5x –ø–æ—Ä–æ–≥–∞)
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –ø–æ —Ä–µ–∂–∏–º—É (trending/ranging/choppy)

**–ü–†–ò–û–†–ò–¢–ï–¢ #2: Profit Drawdown**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∏–∫–∞ –ø—Ä–∏–±—ã–ª–∏
- ‚úÖ **–õ–æ–≥–∏–∫–∞:** –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞ (20-40% –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞)
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:** –ü–æ—Ä–æ–≥ –æ—Ç–∫–∞—Ç–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ —Ä–µ–∂–∏–º—É

**–ü–†–ò–û–†–ò–¢–ï–¢ #3: MAX_HOLDING**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Å–ª–µ TP/SL
- ‚úÖ **–õ–æ–≥–∏–∫–∞:** –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏, –¥–µ—Ä–∂–∞—â–∏–µ—Å—è –¥–æ–ª—å—à–µ `max_holding_minutes`
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:** –í—Ä–µ–º—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–æ —Ä–µ–∂–∏–º—É

**Take Profit / Stop Loss:**
- ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ—Å–ª–µ PH –∏ Drawdown
- ‚úÖ **–õ–æ–≥–∏–∫–∞:** TP —Å –ø—Ä–æ–¥–ª–µ–Ω–∏–µ–º, SL —á–µ—Ä–µ–∑ TrailingSL
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å:** TP –∏ SL –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ —Ä–µ–∂–∏–º—É –∏ —Å–∏–º–≤–æ–ª—É

## üéØ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Ä–µ–∂–∏–º–∞–º

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏:

#### 1. Profit Harvesting
```python
# –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∂–∏–º –∏–∑ orchestrator
market_regime = regime_manager.get_current_regime()

# –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –ø–æ —Ä–µ–∂–∏–º—É
adaptive_regime = getattr(self.scalping_config, "adaptive_regime", {})
regime_config = getattr(adaptive_regime, market_regime)

# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ:
ph_enabled = getattr(regime_config, "ph_enabled", False)
ph_threshold = getattr(regime_config, "ph_threshold", 0.0)
ph_time_limit = getattr(regime_config, "ph_time_limit", 0)
min_holding_minutes = getattr(regime_config, "min_holding_minutes", None)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –ø–æ —Ä–µ–∂–∏–º—É

#### 2. Profit Drawdown
```python
# –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∂–∏–º –∏–∑ metadata
regime = metadata.regime or "ranging"

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ –æ—Ç–∫–∞—Ç–∞
if regime == "trending":
    drawdown_threshold = 0.4  # 40%
elif regime == "choppy":
    drawdown_threshold = 0.2  # 20%
else:  # ranging
    drawdown_threshold = 0.3  # 30%
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –ø–æ—Ä–æ–≥ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ —Ä–µ–∂–∏–º—É

#### 3. Take Profit
```python
def _get_adaptive_tp_percent(self, symbol: str, regime: Optional[str] = None):
    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
    # 1. Per-regime TP (–µ—Å–ª–∏ —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)
    # 2. Per-symbol TP (fallback)
    # 3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π TP (fallback)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - TP –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ —Ä–µ–∂–∏–º—É –∏ —Å–∏–º–≤–æ–ª—É

#### 4. Stop Loss
```python
def _get_adaptive_sl_percent(self, symbol: str, regime: Optional[str] = None):
    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
    # 1. Per-regime SL (–µ—Å–ª–∏ —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)
    # 2. Per-symbol SL (fallback)
    # 3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π SL (fallback)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - SL –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ —Ä–µ–∂–∏–º—É –∏ —Å–∏–º–≤–æ–ª—É

#### 5. MAX_HOLDING
```python
# –ü–æ–ª—É—á–∞–µ–º max_holding –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –ø–æ —Ä–µ–∂–∏–º—É
adaptive_regime = getattr(self.scalping_config, "adaptive_regime", {})
regime_config = getattr(adaptive_regime, regime)
max_holding_minutes = getattr(regime_config, "max_holding_minutes", 120.0)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - MAX_HOLDING –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ —Ä–µ–∂–∏–º—É

## üîß –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Å–∏–º–≤–æ–ª–∞–º

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ per-symbol –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏:

#### 1. TP/SL per-symbol
```python
# symbol_profiles —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
symbol_profile = self.symbol_profiles.get(symbol, {})

# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
# 1. Per-regime TP/SL (–µ—Å–ª–∏ —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)
# 2. Per-symbol TP/SL (fallback)
# 3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π TP/SL (fallback)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - TP/SL –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ —Å–∏–º–≤–æ–ª—É

#### 2. Profit Harvesting per-symbol
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–ï–¢** - PH –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∂–∏–º, –Ω–µ —Å–∏–º–≤–æ–ª

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å per-symbol –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è PH, –Ω–æ —ç—Ç–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ.

## üìä –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã:

#### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ `PositionManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
- ‚úÖ `Orchestrator` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ `TrailingSLCoordinator` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL
- ‚úÖ `ConfigManager` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - —á–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

#### 2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç–∏—è
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç #1: Profit Harvesting (–±—ã—Å—Ç—Ä–∞—è –ø—Ä–∏–±—ã–ª—å)
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç #2: Profit Drawdown (–∑–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏)
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç #3: MAX_HOLDING (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏)
- ‚úÖ –û—Å—Ç–∞–ª—å–Ω—ã–µ: TP/SL (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ª–æ–≥–∏—á–Ω—ã –∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã

#### 3. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- ‚úÖ –ü–æ —Ä–µ–∂–∏–º–∞–º: trending, ranging, choppy
- ‚úÖ –ü–æ —Å–∏–º–≤–æ–ª–∞–º: per-symbol TP/SL
- ‚úÖ –ü–æ –±–∞–ª–∞–Ω—Å—É: balance_profiles
- ‚úÖ –ü–æ –≤—Ä–µ–º–µ–Ω–∏: min_holding, max_holding

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –ø–æ–ª–Ω–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

#### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- ‚úÖ Try-except –±–ª–æ–∫–∏ –Ω–∞ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- ‚úÖ Fallback –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ –º–µ—Å—Ç–µ

#### 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
- ‚úÖ –†–∞–∑–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (DEBUG, INFO, WARNING, ERROR)
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–µ

## ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Profit Drawdown –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –ø–æ—Ä–æ–≥–∏ ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
```python
# –ë–´–õ–û (–∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–æ):
if regime == "trending":
    drawdown_threshold = 0.4  # 40% - –ó–ê–•–ê–†–î–ö–û–ñ–ï–ù–û
elif regime == "choppy":
    drawdown_threshold = 0.2  # 20% - –ó–ê–•–ê–†–î–ö–û–ñ–ï–ù–û
else:  # ranging
    drawdown_threshold = 0.3  # 30% - –ó–ê–•–ê–†–î–ö–û–ñ–ï–ù–û
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –¢–µ–ø–µ—Ä—å —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:
```python
# –ß–∏—Ç–∞–µ–º –±–∞–∑–æ–≤—ã–π –ø–æ—Ä–æ–≥ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
profit_drawdown_config = getattr(self.scalping_config, "profit_drawdown", {})
base_drawdown = profit_drawdown_config.get("drawdown_percent", 0.20)

# –ü–æ–ª—É—á–∞–µ–º –º–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ —Ä–µ–∂–∏–º—É
by_regime = profit_drawdown_config.get("by_regime", {})
regime_config = by_regime.get(regime, {})
multiplier = regime_config.get("multiplier", 1.5)

drawdown_threshold = base_drawdown * multiplier
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –ø–æ—Ä–æ–≥–∏ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 2: MAX_HOLDING –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –Ω–∞ ranging
```python
# –°—Ç—Ä–æ–∫–∞ 3641-3644
if hasattr(adaptive_regime, regime):
    regime_config = getattr(adaptive_regime, regime)
elif hasattr(adaptive_regime, "ranging"):
    regime_config = getattr(adaptive_regime, "ranging")  # Fallback
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ranging, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è trending/choppy

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π fallback –∏–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: MIN_HOLDING –¥–ª—è TP –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω
```python
# –°—Ç—Ä–æ–∫–∞ 1626
min_holding_minutes = 35.0  # Default - –ó–ê–•–ê–†–î–ö–û–ñ–ï–ù–û
```

**–ü—Ä–æ–±–ª–µ–º–∞:** MIN_HOLDING –¥–ª—è TP –Ω–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π, –≤—Å–µ–≥–¥–∞ 35 –º–∏–Ω—É—Ç

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π MIN_HOLDING –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (–∫–∞–∫ –¥–ª—è PH)

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### 1. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
- ‚úÖ –†–∞–Ω–Ω–∏–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ (return –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∏–∫–∞ –ø—Ä–∏–±—ã–ª–∏ –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—Ç–∫–∞—Ç–∞

### 2. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Ä–µ–∂–∏–º–∞–º
- ‚úÖ PH –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ
- ‚úÖ TP/SL –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ
- ‚úÖ MAX_HOLDING –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π
- ‚ö†Ô∏è Profit Drawdown —á–∞—Å—Ç–∏—á–Ω–æ (–ø–æ—Ä–æ–≥–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã)

### 3. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Å–∏–º–≤–æ–ª–∞–º
- ‚úÖ TP/SL per-symbol —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: regime > symbol > global

### 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ Fallback –Ω–∞ ranging –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∂–∏–º–∞
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –≤ active_positions

### 5. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–µ–¥ –≤—Å–µ–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è (MIN_HOLDING)
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –¥–æ–ª–≥–æ–≥–æ —É–¥–µ—Ä–∂–∞–Ω–∏—è (MAX_HOLDING)

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (–∏—Å–ø—Ä–∞–≤–∏—Ç—å):
1. ‚úÖ **Profit Drawdown:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - –ø–æ—Ä–æ–≥–∏ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
2. ‚ö†Ô∏è **MIN_HOLDING –¥–ª—è TP:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `get_current_parameters()`, –Ω–æ fallback –Ω–∞ 35.0 –º–∏–Ω—É—Ç (–º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)
3. ‚ö†Ô∏è **MAX_HOLDING fallback:** Fallback –Ω–∞ ranging –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∂–∏–º–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

### –ù–µ–∫—Ä–∏—Ç–∏—á–Ω—ã–µ (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è):
1. –î–æ–±–∞–≤–∏—Ç—å per-symbol –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è PH (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
2. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ fallback –Ω–∞ ranging
3. –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∑–∞–∫—Ä—ã—Ç–∏–π

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: ‚úÖ **–û–¢–õ–ò–ß–ù–û** (9/10)
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –•–æ—Ä–æ—à–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Ä–µ–∂–∏–º–∞–º: ‚úÖ **–û–¢–õ–ò–ß–ù–û** (10/10)
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ
- Profit Drawdown —Ç–µ–ø–µ—Ä—å —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

### –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ —Å–∏–º–≤–æ–ª–∞–º: ‚úÖ **–û–¢–õ–ò–ß–ù–û** (9/10)
- TP/SL –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ
- PH –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∂–∏–º (–Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)

### –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ: ‚úÖ **–û–¢–õ–ò–ß–ù–û** (9/10)
- –ß–∏—Å—Ç—ã–π –∫–æ–¥
- –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –•–æ—Ä–æ—à–µ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: ‚úÖ **–û–¢–õ–ò–ß–ù–û** (9.5/10)

**–í—ã–≤–æ–¥:** –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è, –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞. –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞, —Å–∏—Å—Ç–µ–º–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ Profit Drawdown —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π (—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è `profit_drawdown` –≤ –∫–æ–Ω—Ñ–∏–≥ —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ –º–Ω–æ–∂–∏—Ç–µ–ª—è–º–∏ –ø–æ —Ä–µ–∂–∏–º–∞–º
- ‚úÖ –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π —Ç–µ–ø–µ—Ä—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ

**–û—Å—Ç–∞–ª–æ—Å—å (–Ω–µ–∫—Ä–∏—Ç–∏—á–Ω–æ):**
- MIN_HOLDING –¥–ª—è TP –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –Ω–∞ 35 –º–∏–Ω—É—Ç (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)
- MAX_HOLDING fallback –Ω–∞ ranging (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

