# üìã –°–¢–ê–¢–£–° –û–°–¢–ê–í–®–ò–•–°–Ø –ó–ê–î–ê–ß

**–î–∞—Ç–∞:** 25.11.2025  
**–°—Ç–∞—Ç—É—Å:** –ê–Ω–∞–ª–∏–∑ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –∑–∞–¥–∞—á –ø–æ—Å–ª–µ –≠–¢–ê–ü–ê 1 –∏ –≠–¢–ê–ü–ê 2

---

## ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û

### –≠–¢–ê–ü 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ‚úÖ
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω `close_partial_position()` –≤ position_manager
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω partial_close –≤ trailing_sl_coordinator
- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ extend_tp (–ø—Ä–æ–¥–ª–µ–Ω–∏–µ TP)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è adaptive_min_holding –¥–ª—è Partial TP

### –≠–¢–ê–ü 2: –ü—Ä–æ–∫—Å–∏ –∏ PositionMonitor ‚úÖ
- ‚úÖ –°–æ–∑–¥–∞–Ω –ø—Ä–æ–∫—Å–∏ `active_positions` ‚Üí PositionRegistry
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω PositionMonitor –∫–∞–∫ —Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ `active_positions = {}`

---

## ‚è≥ –û–°–¢–ê–õ–û–°–¨ –°–î–ï–õ–ê–¢–¨

### –≠–¢–ê–ü 2: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è EntryManager –≤ signal_coordinator ‚è≥

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå EntryManager —Å–æ–∑–¥–∞–Ω, –Ω–æ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- ‚ùå signal_coordinator –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ order_executor
- ‚ùå –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–π

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –°–æ–∑–¥–∞—Ç—å EntryManager –≤ orchestrator –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π
2. –ü–µ—Ä–µ–¥–∞—Ç—å EntryManager –≤ signal_coordinator
3. –í `signal_coordinator.execute_signal_from_price()`:
   - –£–±—Ä–∞—Ç—å –ø—Ä—è–º–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
   - –í—ã–∑–≤–∞—Ç—å `entry_manager.open_position(signal)`
4. EntryManager –¥–æ–ª–∂–µ–Ω:
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ (—á–µ—Ä–µ–∑ PositionSizer)
   - –†–∞–∑–º–µ—â–∞—Ç—å –æ—Ä–¥–µ—Ä (—á–µ—Ä–µ–∑ OrderExecutor)
   - –†–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é –≤ PositionRegistry

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/strategies/scalping/futures/orchestrator.py` - —Å–æ–∑–¥–∞–Ω–∏–µ EntryManager
- `src/strategies/scalping/futures/coordinators/signal_coordinator.py` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ EntryManager

---

### –≠–¢–ê–ü 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SignalPipeline ‚è≥

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚ùå SignalPipeline —Å–æ–∑–¥–∞–Ω, –Ω–æ –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- ‚ùå signal_coordinator –∏—Å–ø–æ–ª—å–∑—É–µ—Ç signal_generator –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå SignalValidator –Ω–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –°–æ–∑–¥–∞—Ç—å SignalPipeline –≤ orchestrator
2. –ü–æ–¥–∫–ª—é—á–∏—Ç—å SignalGenerator, FilterManager, SignalValidator –∫ SignalPipeline
3. –ü–æ–¥–∫–ª—é—á–∏—Ç—å SignalPipeline –∫ TradingControlCenter
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SignalPipeline –≤–º–µ—Å—Ç–æ –ø—Ä—è–º–æ–≥–æ SignalGenerator –≤ signal_coordinator

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
SignalGenerator
  ‚îî‚îÄ‚îÄ SignalPipeline (–∫–æ–Ω–≤–µ–π–µ—Ä)
      ‚îú‚îÄ‚îÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ (SignalGenerator)
      ‚îú‚îÄ‚îÄ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (FilterManager)  
      ‚îî‚îÄ‚îÄ –í–∞–ª–∏–¥–∞—Ü–∏—è (SignalValidator)
          ‚îî‚îÄ‚îÄ TradingControlCenter.generate_signal()
```

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/strategies/scalping/futures/orchestrator.py` - —Å–æ–∑–¥–∞–Ω–∏–µ SignalPipeline
- `src/strategies/scalping/futures/signals/signal_pipeline.py` - —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω–≤–µ–π–µ—Ä–∞
- `src/strategies/scalping/futures/coordinators/signal_coordinator.py` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SignalPipeline

---

### –≠–¢–ê–ü 4: –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è TradingControlCenter ‚è≥

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ TradingControlCenter —Å–æ–∑–¥–∞–Ω –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚ùå –ú–æ–¥—É–ª–∏ –ù–ï –ø–æ–¥–∫–ª—é—á–µ–Ω—ã (`signal_pipeline`, `entry_manager`, `position_monitor` = `None`)
- ‚ùå –ú–µ—Ç–æ–¥—ã TradingControlCenter –ù–ò–ì–î–ï –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç—Å—è
- ‚ùå Orchestrator –æ–±—Ö–æ–¥–∏—Ç TradingControlCenter –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–ø—Ä—è–º—É—é

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å –≤—Å–µ –º–æ–¥—É–ª–∏ –∫ TradingControlCenter:
   - `set_signal_pipeline(signal_pipeline)`
   - `set_entry_manager(entry_manager)`
   - `set_exit_analyzer(exit_analyzer)`
   - `set_position_monitor(position_monitor)`

2. –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å orchestrator –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TradingControlCenter:
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ ‚Üí `trading_control_center.generate_signal()`
   - –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π ‚Üí `trading_control_center.open_position()`
   - –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π ‚Üí `trading_control_center.close_position()`
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚Üí `position_monitor.start()` (—É–∂–µ —Å–¥–µ–ª–∞–Ω–æ)

3. –£–±—Ä–∞—Ç—å –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã –º–æ–¥—É–ª–µ–π –∏–∑ orchestrator

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- `src/strategies/scalping/futures/orchestrator.py` - –ø–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
- `src/strategies/scalping/futures/core/trading_control_center.py` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π

---

### –≠–¢–ê–ü 5: –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ DataRegistry –ø–æ–ª–Ω–æ—Å—Ç—å—é ‚è≥

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ DataRegistry —Å–æ–∑–¥–∞–Ω –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- ‚ùå –ù–µ –≤—Å–µ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç DataRegistry
- ‚ùå –ï—Å—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (market_data_cache, indicators)

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –í—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è market data —á–µ—Ä–µ–∑ `data_registry.update_market_data()`
2. –í—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ `data_registry.update_indicator()`
3. –í—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤ —á–µ—Ä–µ–∑ `data_registry.update_regime()`
4. –í—Å–µ —á—Ç–µ–Ω–∏—è —á–µ—Ä–µ–∑ `data_registry.get_*()`
5. –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (market_data_cache, –ª–æ–∫–∞–ª—å–Ω—ã–µ –∫—ç—à–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤)

**–§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
- –í—Å–µ –º–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –¥–∞–Ω–Ω—ã–º–∏
- `src/strategies/scalping/futures/orchestrator.py`
- `src/strategies/scalping/futures/signal_generator.py`
- `src/strategies/scalping/futures/coordinators/signal_coordinator.py`

---

## üìä –ü–†–ò–û–†–ò–¢–ï–¢–´

### üî• –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (—Å–¥–µ–ª–∞—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å):
1. **–≠–¢–ê–ü 2:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è EntryManager - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π
2. **–≠–¢–ê–ü 4:** –ü–æ–ª–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è TradingControlCenter - –µ–¥–∏–Ω—ã–π —Ü–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚ö†Ô∏è –í–ê–ñ–ù–´–ï (—Å–¥–µ–ª–∞—Ç—å –ø–æ—Å–ª–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö):
3. **–≠–¢–ê–ü 3:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SignalPipeline - –∫–æ–Ω–≤–µ–π–µ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤

### üìù –ñ–ï–õ–ê–¢–ï–õ–¨–ù–´–ï (–º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–∑–∂–µ):
4. **–≠–¢–ê–ü 5:** –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ DataRegistry –ø–æ–ª–Ω–æ—Å—Ç—å—é - –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

---

## ‚è±Ô∏è –û–¶–ï–ù–ö–ê –í–†–ï–ú–ï–ù–ò

- **–≠–¢–ê–ü 2 (EntryManager):** 1-2 —á–∞—Å–∞
- **–≠–¢–ê–ü 3 (SignalPipeline):** 1-2 —á–∞—Å–∞
- **–≠–¢–ê–ü 4 (TradingControlCenter):** 2-3 —á–∞—Å–∞
- **–≠–¢–ê–ü 5 (DataRegistry):** 1-2 —á–∞—Å–∞

**–ò—Ç–æ–≥–æ:** 5-9 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –ü–û–†–Ø–î–û–ö

1. **–°–Ω–∞—á–∞–ª–∞:** –≠–¢–ê–ü 2 (EntryManager) - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏–∏
2. **–ó–∞—Ç–µ–º:** –≠–¢–ê–ü 4 (TradingControlCenter) - –µ–¥–∏–Ω—ã–π —Ü–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
3. **–ü–æ—Ç–æ–º:** –≠–¢–ê–ü 3 (SignalPipeline) - —É–ª—É—á—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
4. **–í –∫–æ–Ω—Ü–µ:** –≠–¢–ê–ü 5 (DataRegistry) - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

---

**–ì–æ—Ç–æ–≤ –Ω–∞—á–∞—Ç—å —Å –≠–¢–ê–ü–ê 2 (EntryManager)?**

