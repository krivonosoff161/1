# üìã –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å–≤–µ—á–µ–π (–∫–∞–∫ –≤—ã –æ–ø–∏—Å–∞–ª–∏)

**–î–∞—Ç–∞:** 26.11.2025  
**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (—Ç—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

---

## üîç –û–¶–ï–ù–ö–ê –°–õ–û–ñ–ù–û–°–¢–ò

### **–°–ª–æ–∂–Ω–æ—Å—Ç—å: ‚ö†Ô∏è –°–†–ï–î–ù–Ø–Ø (–Ω–µ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç–∏)**

**–ü–æ—á–µ–º—É —Å—Ä–µ–¥–Ω—è—è:**
- ‚úÖ –õ–æ–≥–∏–∫–∞ –ø–æ–Ω—è—Ç–Ω–∞ –∏ –ø—Ä–æ—Å—Ç–∞
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥—É–ª—è–º–∏
- ‚ö†Ô∏è –ù—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ asyncio.Lock
- ‚ö†Ô∏è –í–∞–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å WebSocket –¥–∞–Ω–Ω—ã–µ

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- CandleBuffer: ~30 –º–∏–Ω—É—Ç
- CandleManager: ~1-2 —á–∞—Å–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebSocket: ~1 —á–∞—Å
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å DataRegistry: ~1 —á–∞—Å
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: ~1 —á–∞—Å

**–ò—Ç–æ–≥–æ: ~4-5 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã**

---

## üèóÔ∏è –ê–†–•–ò–¢–ï–ö–¢–£–†–ê: –û—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ –ò–õ–ò —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö?

### **‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥**

**–ù–µ —Å–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏, –∞ —Ä–∞—Å—à–∏—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ:**

1. **–†–∞—Å—à–∏—Ä—è–µ–º DataRegistry** (—É–∂–µ –µ—Å—Ç—å):
   - –î–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å CandleBuffer
   - –•—Ä–∞–Ω–∏–º CandleBuffer –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –∏ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞

2. **–°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å CandleBuffer** (–Ω–µ–±–æ–ª—å—à–æ–π –∫–ª–∞—Å—Å):
   - –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π –±—É—Ñ–µ—Ä –¥–ª—è —Å–≤–µ—á–µ–π
   - –ú–µ—Ç–æ–¥—ã add/update/remove
   - ~100-200 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

3. **–†–∞—Å—à–∏—Ä—è–µ–º WebSocketCoordinator** (—É–∂–µ –µ—Å—Ç—å):
   - –î–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏–∫—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π —Å–≤–µ—á–∏
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç CandleBuffer –≤ DataRegistry

4. **–†–∞—Å—à–∏—Ä—è–µ–º SignalGenerator** (—É–∂–µ –µ—Å—Ç—å):
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–µ—á–∏ –∏–∑ DataRegistry –≤–º–µ—Å—Ç–æ –∑–∞–ø—Ä–æ—Å–æ–≤ API
   - –£–±–∏—Ä–∞–µ–º `_get_market_data()` –∑–∞–ø—Ä–æ—Å—ã –∫ API

---

## üì¶ –°–¢–†–£–ö–¢–£–†–ê –ú–û–î–£–õ–ï–ô

### **1. –ù–æ–≤—ã–π –º–æ–¥—É–ª—å: `CandleBuffer` (–Ω–µ–±–æ–ª—å—à–æ–π –∫–ª–∞—Å—Å)**

**–ü—É—Ç—å:** `src/strategies/scalping/futures/core/candle_buffer.py`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –•—Ä–∞–Ω–∏—Ç N —Å–≤–µ—á–µ–π –≤ —Å–ø–∏—Å–∫–µ (—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –±—É—Ñ–µ—Ä)
- –ú–µ—Ç–æ–¥—ã: `add_candle()`, `update_last_candle()`, `get_candles()`
- Thread-safe —á–µ—Ä–µ–∑ asyncio.Lock

**–†–∞–∑–º–µ—Ä:** ~100-150 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

---

### **2. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: `DataRegistry` (–¥–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–æ–¥—ã)**

**–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º:**
- –•—Ä–∞–Ω–∏–ª–∏—â–µ CandleBuffer –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –∏ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞
- –ú–µ—Ç–æ–¥—ã: `get_candles()`, `update_candle()`, `add_candle()`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞–º–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** ~50-100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (–¥–æ–±–∞–≤–ª—è–µ–º, –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º)

---

### **3. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: `WebSocketCoordinator` (–¥–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏–∫—É)**

**–ß—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π —Å–≤–µ—á–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ CandleBuffer –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç–∏–∫–µ—Ä–æ–≤
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –º–∏–Ω—É—Ç—ã (–Ω–æ–≤–∞—è —Å–≤–µ—á–∞)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** ~100-150 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (–¥–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏–∫—É)

---

### **4. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è: `SignalGenerator` (—É–ø—Ä–æ—â–∞–µ–º)**

**–ß—Ç–æ –º–µ–Ω—è–µ–º:**
- –í–º–µ—Å—Ç–æ `_get_market_data()` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º `data_registry.get_candles()`
- –£–±–∏—Ä–∞–µ–º –∑–∞–ø—Ä–æ—Å—ã –∫ API –¥–ª—è —Å–≤–µ—á–µ–π
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ DataRegistry

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** ~50-100 —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞ (—É–ø—Ä–æ—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥)

---

## üîß –ö–ê–ö –≠–¢–û –†–ê–ë–û–¢–ê–ï–¢ –í–ú–ï–°–¢–ï

### **–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**

```
1. WebSocket —Ç–∏–∫–µ—Ä ‚Üí WebSocketCoordinator.handle_ticker_data()
   ‚Üì
2. –û–ø—Ä–µ–¥–µ–ª—è–µ–º: –Ω–æ–≤–∞—è –º–∏–Ω—É—Ç–∞? ‚Üí –¥–∞/–Ω–µ—Ç
   ‚Üì
3. –ï—Å–ª–∏ –Ω–æ–≤–∞—è –º–∏–Ω—É—Ç–∞:
   - –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–≤–µ—á—É –≤ CandleBuffer
   - –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—É—é —Å–≤–µ—á—É
   - –£–¥–∞–ª—è–µ–º —Å–∞–º—É—é —Å—Ç–∞—Ä—É—é (FIFO)
   
   –ï—Å–ª–∏ —Ç–∞ –∂–µ –º–∏–Ω—É—Ç–∞:
   - –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–≤–µ—á—É (high/low/close/volume)
   ‚Üì
4. –û–±–Ω–æ–≤–ª—è–µ–º DataRegistry —á–µ—Ä–µ–∑ data_registry.update_candle()
   ‚Üì
5. SignalGenerator –∏—Å–ø–æ–ª—å–∑—É–µ—Ç data_registry.get_candles()
   - –ü–æ–ª—É—á–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–≤–µ—á–∏ –∏–∑ –±—É—Ñ–µ—Ä–∞
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
   ‚Üì
6. –í—Å–µ –º–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
```

---

## ‚úÖ –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ì–ò–ë–†–ò–î–ù–û–ì–û –ü–û–î–•–û–î–ê

1. **–ù–µ –ª–æ–º–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥:**
   - –†–∞—Å—à–∏—Ä—è–µ–º, –∞ –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º
   - –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

2. **–ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É:**
   - DataRegistry —É–∂–µ –µ—Å—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
   - WebSocketCoordinator —É–∂–µ –ø–æ–ª—É—á–∞–µ—Ç —Ç–∏–∫–µ—Ä—ã
   - –ü—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏–∫—É

3. **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:**
   - CandleBuffer - –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π –∫–ª–∞—Å—Å
   - –õ–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å
   - –õ–µ–≥–∫–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å

4. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - –ú–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä—è—Ç—å –ø–æ —á–∞—Å—Ç—è–º
   - –ù–µ –Ω—É–∂–Ω–æ –≤—Å–µ –º–µ–Ω—è—Ç—å —Å—Ä–∞–∑—É

---

## üìù –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò (–ü–û–®–ê–ì–û–í–´–ô)

### **–≠—Ç–∞–ø 1: –°–æ–∑–¥–∞–µ–º CandleBuffer (30 –º–∏–Ω)**

```python
class CandleBuffer:
    - __init__(max_size: int)
    - add_candle(candle: OHLCV)
    - update_last_candle(high, low, close, volume)
    - get_candles() -> List[OHLCV]
    - get_last_candle() -> OHLCV
```

**–ü—Ä–æ—Å—Ç–æ—Ç–∞:** ‚úÖ –û—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –±—É—Ñ–µ—Ä)

---

### **–≠—Ç–∞–ø 2: –†–∞—Å—à–∏—Ä—è–µ–º DataRegistry (1 —á–∞—Å)**

```python
# –î–æ–±–∞–≤–ª—è–µ–º –≤ DataRegistry:
- _candle_buffers: Dict[str, Dict[str, CandleBuffer]]  # symbol -> timeframe -> buffer
- async def get_candles(symbol, timeframe) -> List[OHLCV]
- async def update_candle(symbol, timeframe, candle_data)
- async def add_candle(symbol, timeframe, candle)
```

**–ü—Ä–æ—Å—Ç–æ—Ç–∞:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (–Ω—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è, –Ω–æ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ—Å—Ç–∞—è)

---

### **–≠—Ç–∞–ø 3: –†–∞—Å—à–∏—Ä—è–µ–º WebSocketCoordinator (1 —á–∞—Å)**

```python
# –î–æ–±–∞–≤–ª—è–µ–º –≤ WebSocketCoordinator:
- _last_candle_minute: Dict[str, int]  # symbol -> –ø–æ—Å–ª–µ–¥–Ω—è—è –º–∏–Ω—É—Ç–∞
- _detect_new_candle(timestamp) -> bool
- async def _update_candle_from_ticker(symbol, ticker_data)
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å data_registry.update_candle()
```

**–ü—Ä–æ—Å—Ç–æ—Ç–∞:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (–Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –º–æ–º–µ–Ω—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è)

---

### **–≠—Ç–∞–ø 4: –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä—É–µ–º SignalGenerator (1 —á–∞—Å)**

```python
# –ò–∑–º–µ–Ω—è–µ–º _get_market_data():
- –í–º–µ—Å—Ç–æ API –∑–∞–ø—Ä–æ—Å–∞ ‚Üí data_registry.get_candles()
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –±—É—Ñ–µ—Ä–∞
- –£–±–∏—Ä–∞–µ–º –ª–∏—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã
```

**–ü—Ä–æ—Å—Ç–æ—Ç–∞:** ‚úÖ –ü—Ä–æ—Å—Ç–æ (–ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö)

---

### **–≠—Ç–∞–ø 5: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å—Ç–∞—Ä—à–∏—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤ (1 —á–∞—Å)**

```python
# 5m —Å–≤–µ—á–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∏–∑ 1m:
- –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç —Ñ–æ—Ä–º–∏—Ä—É–µ–º 5m —Å–≤–µ—á—É
- –î–æ–±–∞–≤–ª—è–µ–º –≤ –±—É—Ñ–µ—Ä 5m —Å–≤–µ—á–µ–π
- –û–±–Ω–æ–≤–ª—è–µ–º MultiTimeframeFilter

# 1H —Å–≤–µ—á–∏ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –∏–∑ 5m:
- –ö–∞–∂–¥—ã–π —á–∞—Å —Ñ–æ—Ä–º–∏—Ä—É–µ–º 1H —Å–≤–µ—á—É
- –î–æ–±–∞–≤–ª—è–µ–º –≤ –±—É—Ñ–µ—Ä 1H —Å–≤–µ—á–µ–π
- –û–±–Ω–æ–≤–ª—è–µ–º VolumeProfileFilter
```

**–ü—Ä–æ—Å—Ç–æ—Ç–∞:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (–Ω—É–∂–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–≤–µ—á–∏)

---

## ‚ö†Ô∏è –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –°–õ–û–ñ–ù–û–°–¢–ò

### **1. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–æ–º–µ–Ω—Ç–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–≤–µ—á–∏:**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- WebSocket —Ç–∏–∫–µ—Ä—ã –ø—Ä–∏—Ö–æ–¥—è—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω–æ
- –ù—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–æ–≥–¥–∞ –º–∏–Ω—É—Ç–∞ –∑–∞–≤–µ—Ä—à–∏–ª–∞—Å—å

**–†–µ—à–µ–Ω–∏–µ:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å timestamp –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏
- –ï—Å–ª–∏ timestamp —Ç–∏–∫–µ—Ä–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –Ω–æ–≤—É—é –º–∏–Ω—É—Ç—É ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å–≤–µ—á—É
- –ò—Å–ø–æ–ª—å–∑—É–µ–º `timestamp % 60 == 0` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥—Ä–∞–Ω–∏—Ü—ã –º–∏–Ω—É—Ç—ã

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (–Ω—É–∂–Ω–∞ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å)

---

### **2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –ø–æ—Ç–æ–∫–∞–º–∏:**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- WebSocket –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–≤–µ—á–∏
- SignalGenerator —á–∏—Ç–∞–µ—Ç —Å–≤–µ—á–∏
- –ù—É–∂–Ω–∞ thread-safety

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑—É–µ–º asyncio.Lock –≤ CandleBuffer
- –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π Lock –≤ DataRegistry

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚úÖ –ü—Ä–æ—Å—Ç–∞—è (asyncio.Lock —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

---

### **3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –Ω—É–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é
- –ü–æ—Ç–æ–º –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–†–µ—à–µ–Ω–∏–µ:**
- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –∑–∞–≥—Ä—É–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 —Å–≤–µ—á–µ–π (1m)
- –ó–∞–ø–æ–ª–Ω—è–µ–º CandleBuffer
- –ü–æ—Ç–æ–º –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚úÖ –ü—Ä–æ—Å—Ç–∞—è (–æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ)

---

### **4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ß—Ç–æ –µ—Å–ª–∏ WebSocket –æ—Ç–∫–ª—é—á–∏–ª—Å—è?
- –ß—Ç–æ –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ —Å–≤–µ—á—É?

**–†–µ—à–µ–Ω–∏–µ:**
- Fallback: –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å API
- –ï—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ ‚Üí –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Å–≤–µ—á–∏
- –õ–æ–≥–∏—Ä—É–µ–º –ø—Ä–æ–ø—É—Å–∫–∏

**–°–ª–æ–∂–Ω–æ—Å—Ç—å:** ‚ö†Ô∏è –°—Ä–µ–¥–Ω—è—è (–Ω—É–∂–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)

---

## ‚úÖ –í–´–í–û–î

### **–°–ª–æ–∂–Ω–æ—Å—Ç—å: ‚ö†Ô∏è –°–†–ï–î–ù–Ø–Ø (–Ω–µ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ)**

**–ü–æ—á–µ–º—É:**
- ‚úÖ –õ–æ–≥–∏–∫–∞ –ø–æ–Ω—è—Ç–Ω–∞
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚ö†Ô∏è –ù—É–∂–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ edge cases

### **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ì–ò–ë–†–ò–î–ù–´–ô –ü–û–î–•–û–î**

**–ù–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤—ã–µ –º–æ–¥—É–ª–∏, –∞:**
1. ‚úÖ **–û–¥–∏–Ω –Ω–æ–≤—ã–π –º–∞–ª–µ–Ω—å–∫–∏–π –∫–ª–∞—Å—Å:** `CandleBuffer`
2. ‚úÖ **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ DataRegistry:** –¥–æ–±–∞–≤–ª—è–µ–º –º–µ—Ç–æ–¥—ã –¥–ª—è —Å–≤–µ—á–µ–π
3. ‚úÖ **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ WebSocketCoordinator:** –¥–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏–∫—É —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è
4. ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–∏–µ SignalGenerator:** –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ DataRegistry

### **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ –ª–æ–º–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É
- ‚úÖ –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å (–ª–µ–≥–∫–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)
- ‚úÖ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### **–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- ~4-5 —á–∞—Å–æ–≤ —Ä–∞–±–æ—Ç—ã
- –ú–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ —ç—Ç–∞–ø—ã

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

**‚úÖ –†–ï–ê–õ–ò–ó–£–ï–ú!** –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ, –Ω–æ –¥–∞—Å—Ç –æ–≥—Ä–æ–º–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à:

- ‚ö° –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 10-100 —Ä–∞–∑
- üìâ –°–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API
- üéØ –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- üõ°Ô∏è –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞

**–ú–æ–∂–µ–º –Ω–∞—á–∞—Ç—å —Å —ç—Ç–∞–ø–∞ 1 (CandleBuffer) –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å!**

---

**‚úÖ –í–´–í–û–î: –ù–µ –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ, –¥–µ–ª–∞–µ–º –≥–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–Ω–æ–≤—ã–π –∫–ª–∞—Å—Å + —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö)!**






