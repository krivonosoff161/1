# üîç –ü–†–û–í–ï–†–ö–ê –†–ê–°–ß–ï–¢–ê –¶–ï–ù–´ –õ–ò–ú–ò–¢–ù–û–ì–û –û–†–î–ï–†–ê

## –ü—Ä–æ–±–ª–µ–º–∞
–û—Ä–¥–µ—Ä–∞ –≤—ã—Å—Ç–∞–≤–ª—è—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º –¥–∞–ª–µ–∫–æ –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã (7% –≤–º–µ—Å—Ç–æ –æ–∂–∏–¥–∞–µ–º—ã—Ö 0.05-0.12%)

## –ú–æ–¥—É–ª–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–∞—Å—á–µ—Ç–æ–º —Ü–µ–Ω—ã

### 1. **order_executor.py** - –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –ª–∏–º–∏—Ç–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞
- –ú–µ—Ç–æ–¥: `_calculate_limit_price(symbol, side, regime)`
- –°—Ç—Ä–æ–∫–∏: 234-728
- –õ–æ–≥–∏–∫–∞:
  - –ü–æ–ª—É—á–∞–µ—Ç `limit_offset_percent` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º: per-symbol+regime ‚Üí per-regime ‚Üí default)
  - –î–ª—è BUY: `limit_price = best_ask * (1 + offset_percent / 100.0)`
  - –î–ª—è SELL: `limit_price = best_bid * (1 - offset_percent / 100.0)`

### 2. **signal_generator.py** - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞
- –ú–µ—Ç–æ–¥: `_apply_filters()` - –¥–æ–±–∞–≤–ª—è–µ—Ç `regime` –≤ —Å–∏–≥–Ω–∞–ª
- –°—Ç—Ä–æ–∫–∞: 3511 - `signal["regime"] = current_regime_name`
- Fallback: –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω ‚Üí `"ranging"`

### 3. **config_manager.py** - –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞
- –ß–∏—Ç–∞–µ—Ç `limit_offset_percent` –∏–∑ `config_futures.yaml`
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã: per-symbol+regime ‚Üí per-regime ‚Üí default

### 4. **regime_manager.py** - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
- –ú–µ—Ç–æ–¥: `detect_regime(candles, current_price)`
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `trending`, `ranging`, `choppy`

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è offset –≤ config_futures.yaml

### –ë–∞–∑–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:
- `default_offset: 0.05%` (—Å—Ç—Ä–æ–∫–∞ 1050)
- `trending: 0.08%` (—Å—Ç—Ä–æ–∫–∞ 1060)
- `ranging: 0.12%` (—Å—Ç—Ä–æ–∫–∞ 1064)
- `choppy: 0.10%` (—Å—Ç—Ä–æ–∫–∞ 1068)

### Per-symbol –∑–Ω–∞—á–µ–Ω–∏—è:
- BTC: 0.03% (–±–∞–∑–æ–≤—ã–π), 0.05-0.08% –ø–æ —Ä–µ–∂–∏–º–∞–º
- ETH: 0.04% (–±–∞–∑–æ–≤—ã–π), 0.06-0.10% –ø–æ —Ä–µ–∂–∏–º–∞–º
- SOL: 0.05% (–±–∞–∑–æ–≤—ã–π), 0.08-0.12% –ø–æ —Ä–µ–∂–∏–º–∞–º
- DOGE: 0.08% (–±–∞–∑–æ–≤—ã–π), 0.10-0.15% –ø–æ —Ä–µ–∂–∏–º–∞–º
- XRP: 0.10% (–±–∞–∑–æ–≤—ã–π), 0.12-0.18% –ø–æ —Ä–µ–∂–∏–º–∞–º

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –†–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ï—Å–ª–∏ `regime = None` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `default_offset = 0.05%`
- –ù–æ –µ—Å–ª–∏ —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ —Å –∑–∞–≥–ª–∞–≤–Ω—ã–º–∏ –±—É–∫–≤–∞–º–∏ ‚Üí –º–æ–∂–µ—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∫–ª—é—á–∞–º–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ

### 2. Offset —á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `limit_offset_percent` —á–∏—Ç–∞–µ—Ç—Å—è –∫–∞–∫ —á–∏—Å–ª–æ (0.05), –∞ –Ω–µ —Å—Ç—Ä–æ–∫–∞ ("0.05")
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `limit_offset_bps` (7.0) –≤–º–µ—Å—Ç–æ `limit_offset_percent` (0.05)

### 3. –§–æ—Ä–º—É–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –î–ª—è BUY: `best_ask * (1 + 0.05 / 100.0) = best_ask * 1.0005` ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
- –ï—Å–ª–∏ offset = 7.0 (–≤–º–µ—Å—Ç–æ 0.05): `best_ask * (1 + 7.0 / 100.0) = best_ask * 1.07` = +7% ‚ùå

### 4. best_ask/best_bid —É—Å—Ç–∞—Ä–µ–ª–∏
- –ï—Å–ª–∏ `best_ask` —É—Å—Ç–∞—Ä–µ–ª –∏ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç `current_price` ‚Üí –æ—Ä–¥–µ—Ä –±—É–¥–µ—Ç –¥–∞–ª–µ–∫–æ

## –ü—Ä–æ–≤–µ—Ä–∫–∞

### –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:
1. –ö–∞–∫–æ–π `offset_percent` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?
2. –ö–∞–∫–æ–π `regime` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è?
3. –ö–∞–∫–∏–µ `best_ask`, `best_bid`, `current_price`?
4. –ö–∞–∫–∞—è –∏—Ç–æ–≥–æ–≤–∞—è `limit_price`?

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å:
- `order_executor.py:711-723` - –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç: `offset={offset_percent:.3f}%, —Ä–µ–∂–∏–º={regime or 'default'}`

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É, —á—Ç–æ `offset_percent < 1.0` (–Ω–µ –±–æ–ª—å—à–µ 1%)
2. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ `best_ask/best_bid` –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
3. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–µ–∂–∏–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è














