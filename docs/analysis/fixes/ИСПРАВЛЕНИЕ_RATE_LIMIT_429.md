# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Rate Limit (429) –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Leverage

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ **429 Too Many Requests** –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ leverage –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤:

```
ERROR | OKX API –≤–µ—Ä–Ω—É–ª —Å—Ç–∞—Ç—É—Å 429: {'msg': 'Too Many Requests', 'code': '50011'}
WARNING | –ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å leverage –¥–ª—è SOL-USDT (short): OKX API error: status 429
WARNING | –ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å leverage –¥–ª—è DOGE-USDT (long): OKX API error: status 429
```

### –ü—Ä–∏—á–∏–Ω–∞

- –í —Ä–µ–∂–∏–º–µ `long_short_mode` (hedge) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å leverage –¥–ª—è **–¥–≤—É—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π** (long –∏ short)
- –î–ª—è 5 —Å–∏–º–≤–æ–ª–æ–≤ —ç—Ç–æ **10 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥** –±–µ–∑ –∑–∞–¥–µ—Ä–∂–∫–∏
- OKX API –∏–º–µ–µ—Ç **rate limit** (–ª–∏–º–∏—Ç –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É)
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É **429 Too Many Requests**

## –†–µ—à–µ–Ω–∏–µ

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏

–í `src/strategies/scalping/futures/orchestrator.py`:

- **300ms –∑–∞–¥–µ—Ä–∂–∫–∞** –º–µ–∂–¥—É —É—Å—Ç–∞–Ω–æ–≤–∫–æ–π leverage –¥–ª—è long –∏ short (–¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞)
- **200ms –∑–∞–¥–µ—Ä–∂–∫–∞** –º–µ–∂–¥—É —Å–∏–º–≤–æ–ª–∞–º–∏
- **300ms –∑–∞–¥–µ—Ä–∂–∫–∞** –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏ (–¥–ª—è net mode)

```python
# –ú–µ–∂–¥—É long –∏ short –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
await asyncio.sleep(0.3)  # 300ms

# –ú–µ–∂–¥—É —Å–∏–º–≤–æ–ª–∞–º–∏
await asyncio.sleep(0.2)  # 200ms
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ 429 —Å retry

–í `src/clients/futures_client.py`:

- –ú–µ—Ç–æ–¥ `set_leverage` —Ç–µ–ø–µ—Ä—å **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫—É 429**
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ 429 –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–ø–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞** (–¥–æ 3 —Ä–∞–∑)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **exponential backoff** (–∑–∞–¥–µ—Ä–∂–∫–∞ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å –∫–∞–∂–¥–æ–π –ø–æ–ø—ã—Ç–∫–æ–π):
  - –ü–æ–ø—ã—Ç–∫–∞ 1: 0.5—Å
  - –ü–æ–ø—ã—Ç–∫–∞ 2: 1.0—Å
  - –ü–æ–ø—ã—Ç–∫–∞ 3: 2.0—Å

```python
# Retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff
max_retries = 3
retry_delay = 0.5  # 500ms

for attempt in range(max_retries):
    try:
        return await self._make_request(...)
    except RuntimeError as e:
        if "429" in error_str or "Too Many Requests" in error_str:
            if attempt < max_retries - 1:
                delay = retry_delay * (2 ** attempt)  # Exponential backoff
                await asyncio.sleep(delay)
                continue
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É leverage —Ç–µ–ø–µ—Ä—å –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏**
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ 429 —Å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏**
‚úÖ **–≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ retry –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ API**

## –í—Ä–µ–º—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ leverage

–î–ª—è 5 —Å–∏–º–≤–æ–ª–æ–≤ –≤ hedge mode:
- **–ë—ã–ª–æ**: ~0.5-1 —Å–µ–∫—É–Ω–¥–∞ (10 –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–¥—Ä—è–¥) ‚Üí **429 –æ—à–∏–±–∫–∏**
- **–°—Ç–∞–ª–æ**: ~3-4 —Å–µ–∫—É–Ω–¥—ã (10 –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏) ‚Üí **—É—Å–ø–µ—à–Ω–æ**

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–µ —É–º–µ–Ω—å—à–∞–π—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏** - —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –æ—à–∏–±–∫–∞–º 429
2. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤** –∑–∞–¥–µ—Ä–∂–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è
3. **–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ 429 –≤—Å–µ –µ—â–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç**, —É–≤–µ–ª–∏—á—å—Ç–µ –∑–∞–¥–µ—Ä–∂–∫–∏:
   - –ú–µ–∂–¥—É long/short: `0.3` ‚Üí `0.5` —Å–µ–∫—É–Ω–¥—ã
   - –ú–µ–∂–¥—É —Å–∏–º–≤–æ–ª–∞–º–∏: `0.2` ‚Üí `0.3` —Å–µ–∫—É–Ω–¥—ã

## –°—Ç–∞—Ç—É—Å

‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ**
üìÖ **–î–∞—Ç–∞**: 2025-11-11

