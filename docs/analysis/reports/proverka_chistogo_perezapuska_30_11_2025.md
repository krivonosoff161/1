# ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–∏—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (30.11.2025)

## üìä –°—Ç–∞—Ç—É—Å –±–æ—Ç–∞

**–í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏:** 07:39:34 - 07:40:10

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–π –∑–∞–ø—É—Å–∫

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**
   - ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
   - ‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω
   - ‚úÖ DataRegistry –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
   - ‚úÖ SmartExitCoordinator –≤–∫–ª—é—á–µ–Ω

2. **–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π:**
   - ‚úÖ XRP-USDT SHORT –æ—Ç–∫—Ä—ã—Ç–∞ (size=87.000000, entry=2.20)
   - ‚úÖ –ü–æ–∑–∏—Ü–∏—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ PositionRegistry
   - ‚úÖ TrailingSL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

---

## ‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ `time_since_open` –≤ Profit Drawdown

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
üîç [PROFIT_DRAWDOWN] XRP-USDT: –£–±—ã—Ç–æ—á–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è, –Ω–æ –æ—Ç–∫—Ä—ã—Ç–∞ —Ç–æ–ª—å–∫–æ -10791.8—Å < 60.0—Å
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- `entry_time` –∏–∑ `metadata.entry_time` - —ç—Ç–æ offset-naive datetime (–±–µ–∑ timezone)
- –ü—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å `datetime.now(timezone.utc)` (UTC) –ø–æ–ª—É—á–∞–µ—Ç—Å—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑-–∑–∞ —Ä–∞–∑–Ω–∏—Ü—ã —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- ‚úÖ –ü—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º `time_since_open` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ - –ø–æ–ª—É—á–µ–Ω–∏–µ `entry_time` –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ (cTime/uTime)
- ‚úÖ –ï—Å–ª–∏ –∏ —ç—Ç–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `time_since_open=0`

---

## ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### 1. Profit Harvesting
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏ (7.7—Å, 16.5—Å)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `entry_time` –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ (cTime/uTime) - timestamp –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–æ MIN_HOLDING (60 —Å–µ–∫—É–Ω–¥)

### 2. Profit Drawdown
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `markPx` –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –∑–∞–∫—Ä—ã—Ç–∏—è –≤ –ø–µ—Ä–≤—ã–µ 60 —Å–µ–∫—É–Ω–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–æ —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º)

### 3. –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ –õ–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –¶–µ–Ω—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (best_bid/best_ask)
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É—é—Ç—Å—è –≤ PositionRegistry

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ `time_since_open`

**–°–¢–ê–õ–û:**
```python
if time_since_open < 0:
    # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å entry_time –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ (cTime/uTime)
    try:
        c_time = position.get("cTime")
        u_time = position.get("uTime")
        entry_time_str = c_time or u_time
        if entry_time_str:
            entry_timestamp = int(entry_time_str) / 1000.0
            current_timestamp = datetime.now(timezone.utc).timestamp()
            time_since_open = current_timestamp - entry_timestamp
            if time_since_open < 0:
                time_since_open = 0
    except Exception as e:
        time_since_open = 0
```

**–ó–∞—á–µ–º:**
- –ï—Å–ª–∏ `entry_time` –∏–∑ metadata –¥–∞–µ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º `cTime/uTime` –∏–∑ –ø–æ–∑–∏—Ü–∏–∏
- –≠—Ç–æ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è (timestamp –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö)

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ö—Ä–∞–Ω–µ–Ω–∏–µ `entry_time` –≤ PositionMetadata

**–ü—Ä–æ–±–ª–µ–º–∞:** `entry_time` —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ offset-naive datetime

**–†–µ—à–µ–Ω–∏–µ:**
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `datetime.now(timezone.utc)` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `PositionMetadata`
- –ò–ª–∏ —Ö—Ä–∞–Ω–∏—Ç—å `entry_time` –∫–∞–∫ timestamp (int/float)

### 2. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ `entry_time`

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ `entry_time`

**–†–µ—à–µ–Ω–∏–µ:**
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `cTime/uTime` –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ (timestamp) –∫–∞–∫ –æ—Å–Ω–æ–≤–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫
- `metadata.entry_time` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback

---

## ‚úÖ –ò—Ç–æ–≥

**–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç!**

- ‚úÖ –£—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è
- ‚úÖ Profit Drawdown —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å –∑–∞—â–∏—Ç–æ–π –æ—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
- ‚úÖ Profit Harvesting —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º `time_since_open` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞)

**–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã!** üéâ

