# üîç –ö–û–ú–ü–õ–ï–ö–°–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• –ü–†–û–ë–õ–ï–ú (–û–ë–°–£–ñ–î–ï–ù–ò–ï, –ë–ï–ó –ö–û–î–ò–ù–ì–ê)

**–î–∞—Ç–∞:** 2025-11-18  
**–°—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç—Å—è –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è

---

## üö® –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–∏–∑ –∞–Ω–∞–ª–∏–∑–∞ 31 –∞—Ä—Ö–∏–≤–∞)

### 1. **TP/TSL –ù–ï –†–ê–ë–û–¢–ê–Æ–¢** ‚ùå‚ùå‚ùå

**–§–∞–∫—Ç—ã:**
- **3,351 –∑–∞–ø–∏—Å–µ–π** –æ –ø—Ä–æ–≤–µ—Ä–∫–µ TP
- **–¢–æ–ª—å–∫–æ 4 –∑–∞–∫—Ä—ã—Ç–∏—è** –ø–æ TP (0.12%!)
- **0 –∑–∞–∫—Ä—ã—Ç–∏–π** –ø–æ TSL (0%!)
- **146 –∑–∞–∫—Ä—ã—Ç–∏–π manual** (6.2%)
- **2,210 –∑–∞–∫—Ä—ã—Ç–∏–π –ø–æ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º –ø—Ä–∏—á–∏–Ω–∞–º** (93.6%)

**–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
- `min_holding_minutes` –±–ª–æ–∫–∏—Ä—É–µ—Ç **–í–°–ï** –∑–∞–∫—Ä—ã—Ç–∏—è
- **48,195 –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫** `min_holding_minutes`!
- TP –∏ TSL –Ω–µ –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –Ω–∞–¥ `min_holding_minutes`

---

### 2. **SAFETY_THRESHOLD –ù–ï –ó–ê–ì–†–£–ñ–ê–ï–¢–°–Ø –ò–ó –ö–û–ù–§–ò–ì–ê** ‚ùå

**–§–∞–∫—Ç—ã –∏–∑ –ª–æ–≥–æ–≤:**
- **49+ —Å–ª—É—á–∞–µ–≤** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è fallback `safety_threshold=1.5`
- –î–ª—è **–í–°–ï–• –ø–∞—Ä**: BTC, ETH, SOL, DOGE, XRP
- –î–ª—è **–í–°–ï–• —Ä–µ–∂–∏–º–æ–≤**: trending, ranging, choppy

**–ß—Ç–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ:**
- `scalping.margin.by_regime.trending.safety_threshold: 1.5`
- `scalping.margin.by_regime.ranging.safety_threshold: 1.3`
- `scalping.margin.by_regime.choppy.safety_threshold: 1.2`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–æ–¥ –Ω–µ —á–∏—Ç–∞–µ—Ç –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback 1.5 –¥–ª—è **–í–°–ï–•** —Ä–µ–∂–∏–º–æ–≤ –∏ –ø–∞—Ä

---

### 3. **EQUITY –ù–ï –ù–ê–ô–î–ï–ù –î–õ–Ø –í–°–ï–• –ü–ê–†** ‚ùå

**–§–∞–∫—Ç—ã –∏–∑ –ª–æ–≥–æ–≤:**
- **20+ —Å–ª—É—á–∞–µ–≤** "equity –Ω–µ –Ω–∞–π–¥–µ–Ω —á–µ—Ä–µ–∑ get_margin_info"
- –î–ª—è **–í–°–ï–• –ø–∞—Ä**: BTC, ETH, SOL, DOGE, XRP
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å (~847 USDT) –≤–º–µ—Å—Ç–æ equity –ø–æ–∑–∏—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `get_margin_info()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π —Å–ª–æ–≤–∞—Ä—å –∏–ª–∏ `equity = 0`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å –∞–∫–∫–∞—É–Ω—Ç–∞ –≤–º–µ—Å—Ç–æ equity –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- –≠—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞—Å—á–µ—Ç `margin_ratio` –∏ –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

### 4. **–ü–†–û–í–ï–†–ö–ê –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø –ü–ê–†–ê–ú–ï–¢–†–û–í –ü–û –ü–ê–†–ê–ú** ‚ö†Ô∏è

**–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã (BTC, ETH, SOL, DOGE, XRP):**

#### 4.1. **TP –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
- ‚úÖ **Per-regime TP:** –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è (620 –∑–∞–ø–∏—Å–µ–π)
- ‚úÖ **Per-symbol TP:** –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è (2,731 –∑–∞–ø–∏—Å–µ–π)
- ‚ùå **–ù–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è:** –¢–æ–ª—å–∫–æ 4 –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TP

**–í–æ–ø—Ä–æ—Å:** –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ per-symbol TP –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä?
- BTC-USDT: `tp_percent: 2.0%` (–≥–ª–æ–±–∞–ª—å–Ω—ã–π) ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 2.0% (–∏–ª–∏ 3.3% –¥–ª—è trending)
- ETH-USDT: `tp_percent: 1.95%` (per-symbol) ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 1.95% (–∏–ª–∏ 3.3% –¥–ª—è trending)
- SOL-USDT: `tp_percent: 1.9%` (per-symbol) ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 1.9% (–∏–ª–∏ 3.3% –¥–ª—è trending)
- DOGE-USDT: `tp_percent: 3.25%` (per-symbol) ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 3.25% (–∏–ª–∏ 3.25% –¥–ª—è ranging)
- XRP-USDT: `tp_percent: 3.25%` (per-symbol) ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å 3.25% (–∏–ª–∏ 3.25% –¥–ª—è ranging)

#### 4.2. **TSL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
- ‚úÖ **TSL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è:** 398 –∑–∞–ø–∏—Å–µ–π
- ‚ùå **–ù–æ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç:** 0 –∑–∞–∫—Ä—ã—Ç–∏–π –ø–æ TSL

**–í–æ–ø—Ä–æ—Å:** –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ per-regime TSL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã?
- `trending`: `initial_trail: 0.01`, `loss_cut_percent: 1.8%`
- `ranging`: `initial_trail: 0.008`, `loss_cut_percent: 0.8%`
- `choppy`: `initial_trail: 0.005`, `loss_cut_percent: 1.0%`

#### 4.3. **Filter –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
**–í–æ–ø—Ä–æ—Å:** –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ per-regime –∏ per-symbol —Ñ–∏–ª—å—Ç—Ä—ã?
- `min_score_threshold` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏ –ø–∞—Ä—ã
- `liquidity_filter`, `order_flow_filter`, `funding_rate_filter`

#### 4.4. **Margin –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
**–í–æ–ø—Ä–æ—Å:** –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ per-regime `safety_threshold`?
- `trending`: `safety_threshold: 1.5`
- `ranging`: `safety_threshold: 1.3`
- `choppy`: `safety_threshold: 1.2`

**–û—Ç–≤–µ—Ç –∏–∑ –ª–æ–≥–æ–≤:** ‚ùå –ù–ï–¢, –≤–µ–∑–¥–µ fallback 1.5

---

### 5. **FALLBACK –ó–ù–ê–ß–ï–ù–ò–Ø –í –ö–û–î–ï** ‚ö†Ô∏è

**–ù–∞–π–¥–µ–Ω–æ –≤ –∫–æ–¥–µ:**

#### 5.1. **Position Manager** (`position_manager.py`)
- `commission_rate = 0.0010` (fallback)
- `tp_percent` (fallback –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π)
- `equity` (fallback –Ω–∞ –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å)
- `size_in_coins` (fallback —Ä–∞—Å—á–µ—Ç)
- `PnL%` (fallback —Ä–∞—Å—á–µ—Ç –æ—Ç —Ü–µ–Ω—ã)

#### 5.2. **Margin Calculator** (`margin_calculator.py`)
- `safety_threshold = 1.5` (fallback) ‚ùå **–ö–†–ò–¢–ò–ß–ù–û**
- `risk_percentage = 0.02` (fallback)
- –ü–æ—Ä–æ–≥–∏ –∑–¥–æ—Ä–æ–≤—å—è –º–∞—Ä–∂–∏: `3.0`, `2.0`, `1.5`, `1.2` (hardcoded)

#### 5.3. **Orchestrator** (`orchestrator.py`)
- `max_loss_per_trade = 0.02` (fallback)
- `max_margin_percent = 0.80` (fallback)
- `max_drawdown_percent = 0.05` (fallback)
- `leverage = 3` (fallback)
- `max_funding_rate = 0.05` (fallback)
- `check_interval_seconds = 1.5` (fallback –¥–ª—è TSL)
- `min_critical_hold_seconds = 30.0` (fallback)

#### 5.4. **Trailing Stop Loss** (`trailing_stop_loss.py`)
- `regime_multiplier` (fallback: 1.5, 1.0, 0.8)
- `trend_strength_boost = 1.0` (fallback)

**–í–æ–ø—Ä–æ—Å:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ —ç—Ç–∏ fallback –∑–Ω–∞—á–µ–Ω–∏—è –≤–º–µ—Å—Ç–æ –∫–æ–Ω—Ñ–∏–≥–∞?

---

## üîç –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú

### –ü—Ä–æ–±–ª–µ–º–∞ #1: –õ–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
1. TSL –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º
2. –ï—Å–ª–∏ `time_in_position < min_holding_minutes` ‚Üí **–ù–ï –ó–ê–ö–†–´–í–ê–ï–ú** (–¥–∞–∂–µ –µ—Å–ª–∏ loss_cut –¥–æ—Å—Ç–∏–≥–Ω—É—Ç)
3. TP –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ—Å–ª–µ TSL
4. –ï—Å–ª–∏ TSL –∞–∫—Ç–∏–≤–µ–Ω ‚Üí TP –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ (–æ–±—Å—É–∂–¥–µ–Ω–∏–µ):**
1. **TP –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–ï–†–í–´–ú** (–µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ä–∞–∑—É, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏)
2. **Loss Cut –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –í–¢–û–†–´–ú** (–µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ø–æ—Å–ª–µ `min_critical_hold_seconds` ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å—Ä–∞–∑—É)
3. **TSL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¢–†–ï–¢–¨–ò–ú** (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ `min_holding_minutes` ‚Üí –æ–±—ã—á–Ω—ã–π —Ç—Ä–µ–π–ª–∏–Ω–≥)

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è:**
- –£–±–∏—Ä–∞–µ–º –ª–∏ `min_holding_minutes` –¥–ª—è TP –ø–æ–ª–Ω–æ—Å—Ç—å—é?
- –û—Å—Ç–∞–≤–ª—è–µ–º –ª–∏ `min_holding_minutes` —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Ç—Ä–µ–π–ª–∏–Ω–≥–∞?
- –ö–∞–∫–æ–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: TP ‚Üí Loss Cut ‚Üí TSL?

---

### –ü—Ä–æ–±–ª–µ–º–∞ #2: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
- `safety_threshold` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (49+ —Å–ª—É—á–∞–µ–≤ fallback)
- `equity` –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ (20+ —Å–ª—É—á–∞–µ–≤ fallback)
- –ù–µ –ø–æ–Ω—è—Ç–Ω–æ, –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è:**
- –ü–æ—á–µ–º—É `safety_threshold` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è? –¢–∏–ø –æ–±—ä–µ–∫—Ç–∞? –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥–∞?
- –ü–æ—á–µ–º—É `equity` –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è? API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç? –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç?
- –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä?

---

### –ü—Ä–æ–±–ª–µ–º–∞ #3: Fallback –∑–Ω–∞—á–µ–Ω–∏—è

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è:**
- –î–æ–ø—É—Å—Ç–∏–º—ã –ª–∏ fallback –∑–Ω–∞—á–µ–Ω–∏—è? –¢–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö? –ò–ª–∏ –Ω–∏–∫–æ–≥–¥–∞?
- –ï—Å–ª–∏ fallback –¥–æ–ø—É—Å—Ç–∏–º, –¥–æ–ª–∂–µ–Ω –ª–∏ –æ–Ω –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ **WARNING** –≤–º–µ—Å—Ç–æ DEBUG?
- –î–æ–ª–∂–µ–Ω –ª–∏ –±–æ—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è, –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ?

---

## üí° –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø –î–õ–Ø –û–ë–°–£–ñ–î–ï–ù–ò–Ø

### 1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π**

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏—è:**
1. **TP** (–µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç) ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º **–°–†–ê–ó–£**, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏
2. **Loss Cut** (–µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –ø–æ—Å–ª–µ `min_critical_hold_seconds`) ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º **–°–†–ê–ó–£**
3. **TSL** (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ `min_holding_minutes`) ‚Üí –æ–±—ã—á–Ω—ã–π —Ç—Ä–µ–π–ª–∏–Ω–≥

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å TP **–î–û** TSL
- –£–±—Ä–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É `min_holding_minutes` –¥–ª—è TP
- –£–±—Ä–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É `min_holding_minutes` –¥–ª—è Loss Cut –ø–æ—Å–ª–µ `min_critical_hold_seconds`
- –û—Å—Ç–∞–≤–∏—Ç—å `min_holding_minutes` —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–±—ã—á–Ω–æ–≥–æ —Ç—Ä–µ–π–ª–∏–Ω–≥–∞

---

### 2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞**

**–î–ª—è `safety_threshold`:**
- –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –∑–∞–≥—Ä—É–∑–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø `margin_config` (dict –∏–ª–∏ Pydantic –æ–±—ä–µ–∫—Ç)
- –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (dict, Pydantic, nested dicts)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è fallback

**–î–ª—è `equity`:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—á–µ–º—É `get_margin_info()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç–æ–π –æ—Ç–≤–µ—Ç
- –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–ª—É—á–∏—Ç—å `equity` –Ω–∞–ø—Ä—è–º—É—é –∏–∑ API –ø–æ–∑–∏—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ API (–º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏–ª—Å—è)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–µ–Ω–∏—è `equity`

---

### 3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä**

**–î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã (BTC, ETH, SOL, DOGE, XRP):**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ per-symbol TP
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ per-regime TP
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ per-regime TSL
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ª–∏ per-regime `safety_threshold`
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ª–∏ per-regime —Ñ–∏–ª—å—Ç—Ä—ã

**–°–ø–æ—Å–æ–± –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: "–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è TP X% –¥–ª—è Y-USDT (—Ä–µ–∂–∏–º Z)"
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: "–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è TSL –ø–∞—Ä–∞–º–µ—Ç—Ä X –¥–ª—è Y-USDT (—Ä–µ–∂–∏–º Z)"
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: "–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è safety_threshold X –¥–ª—è Y-USDT (—Ä–µ–∂–∏–º Z)"

---

### 4. **–£–±—Ä–∞—Ç—å –∏–ª–∏ —É–ª—É—á—à–∏—Ç—å fallback –∑–Ω–∞—á–µ–Ω–∏—è**

**–í–∞—Ä–∏–∞–Ω—Ç –ê: –£–±—Ä–∞—Ç—å –≤—Å–µ fallback**
- –ë–æ—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è, –µ—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω
- –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã

**–í–∞—Ä–∏–∞–Ω—Ç –ë: –£–ª—É—á—à–∏—Ç—å fallback (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
- Fallback —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- Fallback –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ **WARNING** (–Ω–µ DEBUG)
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (TP, TSL, margin) —Ç—Ä–µ–±—É—é—Ç –∫–æ–Ω—Ñ–∏–≥ (–±–µ–∑ fallback)

---

## üìã –í–û–ü–†–û–°–´ –î–õ–Ø –û–ë–°–£–ñ–î–ï–ù–ò–Ø

1. **–õ–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è:**
   - –£–±–∏—Ä–∞–µ–º –ª–∏ `min_holding_minutes` –¥–ª—è TP –ø–æ–ª–Ω–æ—Å—Ç—å—é? ‚úÖ/‚ùå
   - –£–±–∏—Ä–∞–µ–º –ª–∏ `min_holding_minutes` –¥–ª—è Loss Cut –ø–æ—Å–ª–µ `min_critical_hold_seconds`? ‚úÖ/‚ùå
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: TP ‚Üí Loss Cut ‚Üí TSL? ‚úÖ/‚ùå

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
   - –î–æ–±–∞–≤–ª—è–µ–º –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏? ‚úÖ/‚ùå
   - –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É `safety_threshold`? ‚úÖ/‚ùå
   - –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ `equity`? ‚úÖ/‚ùå

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:**
   - –î–æ–±–∞–≤–ª—è–µ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä? ‚úÖ/‚ùå
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —Ä–µ–∂–∏–º—ã (trending, ranging, choppy)? ‚úÖ/‚ùå

4. **Fallback –∑–Ω–∞—á–µ–Ω–∏—è:**
   - –£–±–∏—Ä–∞–µ–º –≤—Å–µ fallback? ‚ùå
   - –£–ª—É—á—à–∞–µ–º fallback (—Ç–æ–ª—å–∫–æ –Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, WARNING)? ‚úÖ
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç—Ä–µ–±—É—é—Ç –∫–æ–Ω—Ñ–∏–≥? ‚úÖ

---

## üéØ –ü–†–ò–û–†–ò–¢–ï–¢–´

1. **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è (TP ‚Üí Loss Cut ‚Üí TSL)
2. **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É `safety_threshold` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
3. **–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ `equity` –∏–∑ –ø–æ–∑–∏—Ü–∏–∏
4. **–í–ê–ñ–ù–û–ï:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä –∏ —Ä–µ–∂–∏–º–æ–≤
5. **–í–ê–ñ–ù–û–ï:** –£–ª—É—á—à–∏—Ç—å fallback –∑–Ω–∞—á–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ, WARNING)

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-18  
**–°—Ç–∞—Ç—É—Å:** –û–∂–∏–¥–∞–µ—Ç –æ–±—Å—É–∂–¥–µ–Ω–∏—è –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è





