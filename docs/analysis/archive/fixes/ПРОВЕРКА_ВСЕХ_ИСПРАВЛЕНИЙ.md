# ‚úÖ –ü–†–û–í–ï–†–ö–ê –í–°–ï–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

## üìÖ –î–∞—Ç–∞: 2025-11-21

---

## ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´ –ò –ü–†–û–í–ï–†–ï–ù–´

### 1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ `entry_time` –≤ `_handle_private_ws_positions`

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`
**–°—Ç—Ä–æ–∫–∏:** 5912-5936

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –°–æ—Ö—Ä–∞–Ω—è–µ–º entry_time –∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
if "entry_time" not in self.active_positions[symbol]:
    update_data["entry_time"] = datetime.now()
    update_data["timestamp"] = datetime.now()
# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∂–∏–º –∏ –¥—Ä—É–≥–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
saved_regime = self.active_positions[symbol].get("regime")
saved_position_side = self.active_positions[symbol].get("position_side")
# ... –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ update()
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "equity –Ω–µ –Ω–∞–π–¥–µ–Ω" –≤ `liquidation_guard.py`

**–§–∞–π–ª:** `src/strategies/modules/liquidation_guard.py`
**–°—Ç—Ä–æ–∫–∏:** 173-177

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
logger.debug(
    f"‚ö†Ô∏è equity –Ω–µ –Ω–∞–π–¥–µ–Ω —á–µ—Ä–µ–∑ get_margin_info –¥–ª—è {symbol}, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback –±–∞–ª–∞–Ω—Å: {equity:.2f}"
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 3. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "equity –Ω–µ –Ω–∞–π–¥–µ–Ω" –≤ `position_manager.py`

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py`
**–°—Ç—Ä–æ–∫–∏:** 254-257

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤
logger.debug(
    f"‚ö†Ô∏è equity –Ω–µ –Ω–∞–π–¥–µ–Ω —á–µ—Ä–µ–∑ get_margin_info –∏ API –¥–ª—è {symbol}, "
    f"–∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—â–∏–π –±–∞–ª–∞–Ω—Å: {equity:.2f}"
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 4. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "margin_ratio –Ω–∏–∑–∫–∏–π" –≤ `margin_calculator.py`

**–§–∞–π–ª:** `src/strategies/modules/margin_calculator.py`
**–°—Ç—Ä–æ–∫–∏:** 439-443

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
logger.debug(
    f"‚ö†Ô∏è margin_ratio={margin_ratio:.2f} –≤—Å–µ –µ—â–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω–∏–∑–∫–∏–π –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è. "
    f"–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 1.0 (–≤–æ–∑–º–æ–∂–Ω–æ, –ø–æ–∑–∏—Ü–∏—è —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞)"
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 5. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ü–æ–∑–∏—Ü–∏—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞" –≤ `position_manager.py`

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py`
**–°—Ç—Ä–æ–∫–∏:** 399-403

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING, —Ç–∞–∫ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
logger.debug(
    f"‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è {symbol} –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞: –º–∞—Ä–∂–∞ {margin_ratio_pct:.2f}% (–ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞—â–∏—Ç—É –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)"
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 6. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ" –≤ `liquidation_guard.py` (#1)

**–§–∞–π–ª:** `src/strategies/modules/liquidation_guard.py`
**–°—Ç—Ä–æ–∫–∏:** 308-314

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING, —Ç–∞–∫ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
logger.debug(
    f"‚ö†Ô∏è –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è {symbol} {side}: ..."
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 7. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ" –≤ `liquidation_guard.py` (#2)

**–§–∞–π–ª:** `src/strategies/modules/liquidation_guard.py`
**–°—Ç—Ä–æ–∫–∏:** 323-327

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING, —Ç–∞–∫ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
logger.debug(
    f"‚ö†Ô∏è –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è {symbol} {side}: ..."
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 8. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ" –≤ `liquidation_guard.py` (#3)

**–§–∞–π–ª:** `src/strategies/modules/liquidation_guard.py`
**–°—Ç—Ä–æ–∫–∏:** 335-339

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING, —Ç–∞–∫ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
logger.debug(
    f"‚ö†Ô∏è –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è {symbol} {side}: ..."
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

### 9. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ" –≤ `position_manager.py`

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py`
**–°—Ç—Ä–æ–∫–∏:** 419-424

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º DEBUG –≤–º–µ—Å—Ç–æ WARNING, —Ç–∞–∫ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç
logger.debug(
    f"‚ö†Ô∏è –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è {symbol} –≤ PositionManager: ..."
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ò–ú–ï–ù–ï–ù–û**

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê

### –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:
- ‚úÖ 1. `entry_time` —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
- ‚úÖ 2. "equity –Ω–µ –Ω–∞–π–¥–µ–Ω" ‚Üí DEBUG (liquidation_guard)
- ‚úÖ 3. "equity –Ω–µ –Ω–∞–π–¥–µ–Ω" ‚Üí DEBUG (position_manager)
- ‚úÖ 4. "margin_ratio –Ω–∏–∑–∫–∏–π" ‚Üí DEBUG
- ‚úÖ 5. "–ü–æ–∑–∏—Ü–∏—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞" ‚Üí DEBUG
- ‚úÖ 6. "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï" ‚Üí DEBUG (liquidation_guard #1)
- ‚úÖ 7. "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï" ‚Üí DEBUG (liquidation_guard #2)
- ‚úÖ 8. "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï" ‚Üí DEBUG (liquidation_guard #3)
- ‚úÖ 9. "–ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï" ‚Üí DEBUG (position_manager)

**–í—Å–µ–≥–æ:** 9 –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–Ω—Ç–µ—Ä–∞:
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –ù–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –∏–º–ø–æ—Ä—Ç—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä –∏ —Ä–µ–∂–∏–º–æ–≤:
- ‚úÖ BTC-USDT (trending/ranging/choppy)
- ‚úÖ ETH-USDT (trending/ranging/choppy)
- ‚úÖ DOGE-USDT (trending/ranging/choppy)
- ‚úÖ SOL-USDT (trending/ranging/choppy)
- ‚úÖ XRP-USDT (trending/ranging/choppy)

---

## üéØ –†–ï–ó–£–õ–¨–¢–ê–¢

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–ò–ú–ï–ù–ï–ù–´ –ò –ü–†–û–í–ï–†–ï–ù–´**

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:
1. ‚úÖ `entry_time` –±—É–¥–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
2. ‚úÖ –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –±—É–¥—É—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ DEBUG (–Ω–µ –∑–∞—Å–æ—Ä—è—é—Ç –ª–æ–≥–∏)
3. ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
4. ‚úÖ –í—Å–µ –ø–∞—Ä—ã –∏ —Ä–µ–∂–∏–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

**–í—ã–≤–æ–¥:** ‚úÖ **–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫—É!**

