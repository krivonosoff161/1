# ðŸ“Š ÐŸÐžÐ›ÐÐ«Ð™ Ð ÐÐ¡Ð§Ð•Ð¢ Ð ÐÐ—ÐœÐ•Ð Ð ÐŸÐžÐ—Ð˜Ð¦Ð˜Ð˜ (Ð’Ð˜Ð›ÐšÐ) Ð’ FUTURES Ð¡ÐšÐÐ›Ð¬ÐŸÐ˜ÐÐ“Ð•

## ðŸŽ¯ Ð¦Ð•Ð›Ð¬ Ð”ÐžÐšÐ£ÐœÐ•ÐÐ¢Ð

ÐŸÐ¾Ð»Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¿Ð¾Ð½ÑÑ‚ÑŒ, ÐºÐ°Ðº Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ (Ð²Ð¸Ð»ÐºÐ°), Ð¼Ð°Ñ€Ð¶Ð°, Ñ€Ð¸ÑÐº, leverage, Ð¸ Ð²ÑÐµ ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð¿Ñ€Ð¸ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð¸Ð¸ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð² futures ÑÐºÐ°Ð»ÑŒÐ¿Ð¸Ð½Ð³Ðµ.

---

## ðŸ“ Ð¤ÐÐ™Ð›Ð«, Ð“Ð”Ð• Ð ÐÐ¡Ð¡Ð§Ð˜Ð¢Ð«Ð’ÐÐ•Ð¢Ð¡Ð¯ Ð ÐÐ—ÐœÐ•Ð  ÐŸÐžÐ—Ð˜Ð¦Ð˜Ð˜

### 1. **`src/strategies/scalping/futures/risk_manager.py`**
   - **ÐžÑÐ½Ð¾Ð²Ð½Ð¾Ð¹ Ñ„Ð°Ð¹Ð»**: `calculate_position_size()` (ÑÑ‚Ñ€Ð¾ÐºÐ° 335)
   - **Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ**: Ð“Ð»Ð°Ð²Ð½Ð°Ñ Ñ„ÑƒÐ½ÐºÑ†Ð¸Ñ Ñ€Ð°ÑÑ‡ÐµÑ‚Ð° Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸
   - **Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚**: Ð Ð°Ð·Ð¼ÐµÑ€ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ð² **Ð¼Ð¾Ð½ÐµÑ‚Ð°Ñ…** (Ð½Ðµ USD!)

### 2. **`src/strategies/scalping/futures/calculations/position_sizer.py`**
   - **Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ**: `calculate_position_size()` (ÑÑ‚Ñ€Ð¾ÐºÐ° 47)
   - **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ**: ÐÐ»ÑŒÑ‚ÐµÑ€Ð½Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ð¹ ÐºÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ (Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ÑÑ Ñ€ÐµÐ¶Ðµ)

### 3. **`src/strategies/scalping/futures/calculations/margin_calculator.py`**
   - **Ð¤ÑƒÐ½ÐºÑ†Ð¸Ð¸**:
     - `calculate_max_position_size()` (ÑÑ‚Ñ€Ð¾ÐºÐ° 50)
     - `calculate_liquidation_price()` (ÑÑ‚Ñ€Ð¾ÐºÐ° 79)
     - `is_position_safe()` (ÑÑ‚Ñ€Ð¾ÐºÐ° 155)
   - **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ**: Ð Ð°ÑÑ‡ÐµÑ‚ Ð¼Ð°Ñ€Ð¶Ð¸, Ð»Ð¸ÐºÐ²Ð¸Ð´Ð°Ñ†Ð¸Ð¸, Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚Ð¸

### 4. **`src/strategies/scalping/futures/calculations/balance_calculator.py`**
   - **Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ**: `calculate_balance_parameters()` (ÑÑ‚Ñ€Ð¾ÐºÐ° 60)
   - **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ**: ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð±Ð°Ð»Ð°Ð½ÑÐ° Ð¸ boost Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÐµÐ¹

### 5. **`src/strategies/scalping/futures/adaptivity/balance_manager.py`**
   - **Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ**: `get_position_sizing_params()` (ÑÑ‚Ñ€Ð¾ÐºÐ° 269)
   - **ÐÐ°Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ**: ÐÐ´Ð°Ð¿Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ð¿Ð¾ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŽ Ð±Ð°Ð»Ð°Ð½ÑÐ°

---

## âš™ï¸ ÐšÐžÐÐ¤Ð˜Ð“Ð£Ð ÐÐ¦Ð˜ÐžÐÐÐ«Ð• ÐŸÐÐ ÐÐœÐ•Ð¢Ð Ð«

### **Ð¤Ð°Ð¹Ð»**: `config/config_futures.yaml`

#### **1. Balance Profiles (ÐŸÑ€Ð¾Ñ„Ð¸Ð»Ð¸ Ð±Ð°Ð»Ð°Ð½ÑÐ°)**

```yaml
scalping:
  balance_profiles:
    small:
      threshold: 500.0        # ÐŸÐ¾Ñ€Ð¾Ð³ Ð´Ð»Ñ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ
      min_balance: 0.0
      max_balance: 500.0
      base_position_usd: 100.0  # âœ… Ð‘ÐÐ—ÐžÐ’Ð«Ð™ Ð ÐÐ—ÐœÐ•Ð  ÐŸÐžÐ—Ð˜Ð¦Ð˜Ð˜ (notional)
      min_position_usd: 50.0    # ÐœÐ¸Ð½Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€
      max_position_usd: 200.0  # ÐœÐ°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€
      max_open_positions: 3     # ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¹
      progressive: false        # ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑÐ¸Ð²Ð½Ð°Ñ Ð¸Ð½Ñ‚ÐµÑ€Ð¿Ð¾Ð»ÑÑ†Ð¸Ñ
      
    medium:
      threshold: 1500.0
      min_balance: 500.0
      max_balance: 1500.0
      base_position_usd: 175.0
      min_position_usd: 100.0
      max_position_usd: 350.0
      max_open_positions: 4
      progressive: false
      
    large:
      threshold: 5000.0
      min_balance: 1500.0
      max_balance: 5000.0
      base_position_usd: 250.0
      min_position_usd: 150.0
      max_position_usd: 500.0
      max_open_positions: 5
      progressive: false
```

#### **2. Ð›ÐµÐ²ÐµÑ€Ð¸Ð´Ð¶ Ð¸ Ñ€Ð¸ÑÐº**

```yaml
scalping:
  leverage: 5                    # âœ… ÐŸÐ›Ð•Ð§Ðž (5x)
  base_risk_percentage: 0.01     # 1% Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ñ€Ð¸ÑÐº (fallback)
  sl_percent: 1.2                # Stop Loss 1.2%
  tp_percent: 2.4                # Take Profit 2.4%
```

#### **3. ÐÐ´Ð°Ð¿Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹ Ñ€Ð¸ÑÐºÐ°**

```yaml
futures_modules:
  margin:
    by_regime:
      trending:
        risk_per_trade_percent: 1.0   # 1% Ñ€Ð¸ÑÐº Ð½Ð° ÑÐ´ÐµÐ»ÐºÑƒ
        max_margin_percent: 80.0       # ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 80% Ð±Ð°Ð»Ð°Ð½ÑÐ° Ð² Ð¼Ð°Ñ€Ð¶Ðµ
        max_loss_per_trade_percent: 2.0  # ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 2% ÑƒÐ±Ñ‹Ñ‚ÐºÐ° Ð½Ð° ÑÐ´ÐµÐ»ÐºÑƒ
        max_margin_safety_percent: 90.0   # ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 90% Ð±Ð°Ð»Ð°Ð½ÑÐ° (Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ)
        position_size_multiplier: 1.2      # ÐœÐ½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð° Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸
        
      ranging:
        risk_per_trade_percent: 1.5   # 1.5% Ñ€Ð¸ÑÐº Ð½Ð° ÑÐ´ÐµÐ»ÐºÑƒ
        max_margin_percent: 80.0
        max_loss_per_trade_percent: 2.0
        max_margin_safety_percent: 90.0
        position_size_multiplier: 1.0
        
      choppy:
        risk_per_trade_percent: 2.0   # 2% Ñ€Ð¸ÑÐº Ð½Ð° ÑÐ´ÐµÐ»ÐºÑƒ
        max_margin_percent: 80.0
        max_loss_per_trade_percent: 2.0
        max_margin_safety_percent: 90.0
        position_size_multiplier: 0.8
```

#### **4. ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸**

```yaml
scalping:
  volatility_adjustment:
    enabled: true
    base_atr_percent: 0.02       # 2% Ð±Ð°Ð·Ð¾Ð²Ð°Ñ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ (ATR % Ð¾Ñ‚ Ñ†ÐµÐ½Ñ‹)
    min_multiplier: 0.5          # ÐœÐ¸Ð½Ð¸Ð¼ÑƒÐ¼ 50% Ð¾Ñ‚ Ð±Ð°Ð·Ð¾Ð²Ð¾Ð³Ð¾ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð°
    max_multiplier: 1.5          # ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ 150% Ð¾Ñ‚ Ð±Ð°Ð·Ð¾Ð²Ð¾Ð³Ð¾ Ñ€Ð°Ð·Ð¼ÐµÑ€Ð°
    by_regime:
      ranging:
        base_atr_percent: 0.02
        min_multiplier: 0.5
        max_multiplier: 1.3
```

#### **5. Per-Symbol Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»Ð¸**

```yaml
scalping:
  symbol_profiles:
    BTC-USDT:
      position_multiplier: 1.1   # +10% Ðº Ð±Ð°Ð·Ð¾Ð²Ð¾Ð¼Ñƒ Ñ€Ð°Ð·Ð¼ÐµÑ€Ñƒ
    ETH-USDT:
      position_multiplier: 1.0   # Ð‘ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
    SOL-USDT:
      position_multiplier: 0.8   # -20% Ðº Ð±Ð°Ð·Ð¾Ð²Ð¾Ð¼Ñƒ Ñ€Ð°Ð·Ð¼ÐµÑ€Ñƒ
```

---

## ðŸ”„ ÐŸÐžÐ Ð¯Ð”ÐžÐš Ð ÐÐ¡Ð§Ð•Ð¢Ð (STEP-BY-STEP)

### **Ð¤ÑƒÐ½ÐºÑ†Ð¸Ñ**: `risk_manager.py::calculate_position_size()`

#### **Ð¨ÐÐ“ 1: ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ðµ Ð±Ð°Ð»Ð°Ð½ÑÐ°**
```python
# 1.1. ÐŸÑ‹Ñ‚Ð°ÐµÐ¼ÑÑ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¸Ð· DataRegistry
balance = await data_registry.get_balance()

# 1.2. Fallback: Ð¸Ð· API
if balance is None:
    balance = await client.get_balance()
```

#### **Ð¨ÐÐ“ 2: ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ Ð±Ð°Ð»Ð°Ð½ÑÐ°**
```python
# 2.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð¿Ð¾ Ð±Ð°Ð»Ð°Ð½ÑÑƒ
balance_profile = config_manager.get_balance_profile(balance)
# Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚: {"name": "small", "base_position_usd": 100.0, ...}

# 2.2. Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ð¸Ð· Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ
base_usd_size = balance_profile["base_position_usd"]  # 100.0 USDT
min_usd_size = balance_profile["min_position_usd"]   # 50.0 USDT
max_usd_size = balance_profile["max_position_usd"]   # 200.0 USDT
```

#### **Ð¨ÐÐ“ 3: Per-Symbol Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ**
```python
# 3.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ Ð´Ð»Ñ ÑÐ¸Ð¼Ð²Ð¾Ð»Ð°
symbol_profile = symbol_profiles.get(symbol, {})
position_multiplier = symbol_profile.get("position_multiplier", 1.0)

# 3.2. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ
if position_multiplier != 1.0:
    base_usd_size = base_usd_size * position_multiplier
    # ÐŸÑ€Ð¸Ð¼ÐµÑ€: 100.0 * 1.1 = 110.0 USDT (Ð´Ð»Ñ BTC-USDT)
```

#### **Ð¨ÐÐ“ 4: Ð ÐµÐ¶Ð¸Ð¼Ð½Ñ‹Ð¹ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ**
```python
# 4.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ€ÐµÐ¶Ð¸Ð¼ Ñ€Ñ‹Ð½ÐºÐ°
regime = signal.get("regime")  # "ranging", "trending", "choppy"

# 4.2. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ Ð¸Ð· Ñ€ÐµÐ¶Ð¸Ð¼Ð°
regime_params = config_manager.get_regime_params(regime, symbol)
regime_multiplier = regime_params.get("position_size_multiplier", 1.0)

# 4.3. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ
base_usd_size = base_usd_size * regime_multiplier
# ÐŸÑ€Ð¸Ð¼ÐµÑ€: 110.0 * 1.0 = 110.0 USDT (Ð´Ð»Ñ ranging)
```

#### **Ð¨ÐÐ“ 5: ÐœÐ½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ ÑÐ¸Ð»Ñ‹ ÑÐ¸Ð³Ð½Ð°Ð»Ð°**
```python
# 5.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ ÑÐ¸Ð»Ñƒ ÑÐ¸Ð³Ð½Ð°Ð»Ð°
signal_strength = signal.get("strength", 0.5)  # 0.0 - 1.0
has_conflict = signal.get("has_conflict", False)

# 5.2. ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ Ð¿Ð¾ ÑÐ¸Ð»Ðµ
if has_conflict:
    strength_multiplier = 0.5  # ÐšÐ¾Ð½Ñ„Ð»Ð¸ÐºÑ‚ RSI/EMA
elif signal_strength > 0.8:
    strength_multiplier = 1.5  # ÐžÑ‡ÐµÐ½ÑŒ ÑÐ¸Ð»ÑŒÐ½Ñ‹Ð¹
elif signal_strength > 0.6:
    strength_multiplier = 1.2  # Ð¡Ð¸Ð»ÑŒÐ½Ñ‹Ð¹
elif signal_strength > 0.4:
    strength_multiplier = 1.0  # Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹
else:
    strength_multiplier = 0.8  # Ð¡Ð»Ð°Ð±Ñ‹Ð¹

# 5.3. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ
base_usd_size = base_usd_size * strength_multiplier
# ÐŸÑ€Ð¸Ð¼ÐµÑ€: 110.0 * 1.2 = 132.0 USDT (ÑÐ¸Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¸Ð³Ð½Ð°Ð»)

# 5.4. âœ… ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ•: ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ max_usd_size
if base_usd_size > max_usd_size:
    base_usd_size = max_usd_size  # ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ Ð´Ð¾ 200.0 USDT
```

#### **Ð¨ÐÐ“ 6: ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ (ATR)**
```python
# 6.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ ATR Ñ‡ÐµÑ€ÐµÐ· signal_generator
market_data = await signal_generator._get_market_data(symbol)
atr_indicator = ATR(period=14)
atr_result = atr_indicator.calculate(high_data, low_data, close_data)
atr_value = atr_result.value

# 6.2. Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ ATR Ð² Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð°Ñ…
current_atr_percent = (atr_value / price) * 100  # 0.4% Ð´Ð»Ñ Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð°

# 6.3. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ ATR Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°
base_atr_percent = volatility_config.get("base_atr_percent", 0.02)  # 2%

# 6.4. Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸
raw_multiplier = base_atr_percent / (current_atr_percent / 100.0)
# raw_multiplier = 0.02 / (0.004) = 5.0

# 6.5. ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ
volatility_multiplier = max(min_multiplier, min(raw_multiplier, max_multiplier))
# volatility_multiplier = max(0.5, min(5.0, 1.5)) = 1.5

# 6.6. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ
base_usd_size = base_usd_size * volatility_multiplier
# ÐŸÑ€Ð¸Ð¼ÐµÑ€: 132.0 * 1.5 = 198.0 USDT

# 6.7. âœ… ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ•: Ð¡Ð½Ð¾Ð²Ð° Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ max_usd_size
if base_usd_size > max_usd_size:
    base_usd_size = max_usd_size  # ÐžÐ³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÐµÐ¼ Ð´Ð¾ 200.0 USDT
```

#### **Ð¨ÐÐ“ 7: ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð»ÐµÐ²ÐµÑ€Ð¸Ð´Ð¶Ð°**
```python
# 7.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð»ÐµÐ²ÐµÑ€Ð¸Ð´Ð¶ Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°
leverage = scalping_config.leverage  # 5x

# 7.2. âœ… ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ•: base_usd_size ÑÑ‚Ð¾ ÐÐžÐœÐ˜ÐÐÐ›Ð¬ÐÐÐ¯ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ (notional)
# margin_required = notional / leverage
margin_required_initial = base_usd_size / leverage
# margin_required_initial = 198.0 / 5 = 39.6 USDT

# 7.3. ÐŸÐµÑ€ÐµÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ min/max Ð² Ð¼Ð°Ñ€Ð¶Ñƒ
min_margin_usd = min_usd_size / leverage  # 50.0 / 5 = 10.0 USDT
max_margin_usd = max_usd_size / leverage  # 200.0 / 5 = 40.0 USDT
```

#### **Ð¨ÐÐ“ 8: Ð—Ð°Ñ‰Ð¸Ñ‚Ñ‹ (Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ€Ð¶Ð¸)**

##### **8.1. Max Margin Used (80% Ð±Ð°Ð»Ð°Ð½ÑÐ°)**
```python
# 8.1.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ð½Ð½ÑƒÑŽ Ð¼Ð°Ñ€Ð¶Ñƒ
used_margin = await _get_used_margin()  # 0.0 USDT (Ð½ÐµÑ‚ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¹)

# 8.1.2. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð°Ð´Ð°Ð¿Ñ‚Ð¸Ð²Ð½Ñ‹Ðµ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹
max_margin_percent = 0.80  # 80% Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°
max_margin_allowed = balance * max_margin_percent  # 500 * 0.8 = 400.0 USDT
available_margin = balance - used_margin  # 500.0 - 0.0 = 500.0 USDT

# 8.1.3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ
if used_margin + margin_required > max_margin_allowed:
    margin_required = max(0, max_margin_allowed - used_margin)
    # ÐŸÑ€Ð¸Ð¼ÐµÑ€: 0.0 + 39.6 = 39.6 < 400.0 â†’ OK
```

##### **8.2. Ð”Ð¾ÑÑ‚ÑƒÐ¿Ð½Ð°Ñ Ð¼Ð°Ñ€Ð¶Ð°**
```python
# 8.2.1. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½ÑƒÑŽ Ð¼Ð°Ñ€Ð¶Ñƒ
if margin_required > available_margin:
    margin_required = max(0, available_margin)
    # ÐŸÑ€Ð¸Ð¼ÐµÑ€: 39.6 < 500.0 â†’ OK
```

##### **8.3. Max Loss per Trade (2% Ð±Ð°Ð»Ð°Ð½ÑÐ°)**
```python
# 8.3.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹
max_loss_per_trade_percent = 0.02  # 2% Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°
max_loss_usd = balance * max_loss_per_trade_percent  # 500 * 0.02 = 10.0 USDT
sl_percent_decimal = sl_percent / 100  # 1.2 / 100 = 0.012

# 8.3.2. Ð Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÐ¼ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð±ÐµÐ·Ð¾Ð¿Ð°ÑÐ½ÑƒÑŽ Ð¼Ð°Ñ€Ð¶Ñƒ
max_safe_margin = max_loss_usd / sl_percent_decimal
# max_safe_margin = 10.0 / 0.012 = 833.33 USDT

# 8.3.3. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ
if margin_required > max_safe_margin:
    margin_required = max_safe_margin
    # ÐŸÑ€Ð¸Ð¼ÐµÑ€: 39.6 < 833.33 â†’ OK
```

##### **8.4. Max Margin Safety (90% Ð±Ð°Ð»Ð°Ð½ÑÐ°)**
```python
# 8.4.1. ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ð¿Ð°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹
max_margin_safety_percent = 0.90  # 90% Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°
max_margin_safety = balance * max_margin_safety_percent  # 500 * 0.9 = 450.0 USDT

# 8.4.2. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ðµ
if margin_required > max_margin_safety:
    margin_required = max_margin_safety
    # ÐŸÑ€Ð¸Ð¼ÐµÑ€: 39.6 < 450.0 â†’ OK
```

#### **Ð¨ÐÐ“ 9: Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ**
```python
# 9.1. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÑÐµÐ¼ min/max Ðº Ð¼Ð°Ñ€Ð¶Ðµ
margin_usd = max(min_margin_usd, min(margin_required, max_margin_usd))
# margin_usd = max(10.0, min(39.6, 40.0)) = 39.6 USDT

# 9.2. âœ… ÐšÐ Ð˜Ð¢Ð˜Ð§Ð•Ð¡ÐšÐžÐ•: ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ð¸Ð¼ ÐœÐÐ Ð–Ð£ Ð² ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¼Ð¾Ð½ÐµÑ‚
position_size = (margin_usd * leverage) / price
# position_size = (39.6 * 5) / 136.8 = 198.0 / 136.8 = 1.447 Ð¼Ð¾Ð½ÐµÑ‚

# 9.3. ÐžÐºÑ€ÑƒÐ³Ð»ÐµÐ½Ð¸Ðµ Ð´Ð¾ ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²
ct_val = 0.01  # 1 ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚ = 0.01 Ð¼Ð¾Ð½ÐµÑ‚Ñ‹
size_in_contracts = position_size / ct_val  # 1.447 / 0.01 = 144.7 ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²
rounded_size_in_contracts = round_to_step(size_in_contracts, lot_sz)  # 145 ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²
final_position_size = rounded_size_in_contracts * ct_val  # 145 * 0.01 = 1.45 Ð¼Ð¾Ð½ÐµÑ‚
```

#### **Ð¨ÐÐ“ 10: Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ**
```python
# 10.1. ÐÐ¾Ð¼Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ (notional)
notional_usd = final_position_size * price  # 1.45 * 136.8 = 198.36 USDT

# 10.2. ÐœÐ°Ñ€Ð¶Ð° (margin)
margin_required = notional_usd / leverage  # 198.36 / 5 = 39.67 USDT

# 10.3. Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÐ¼ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ð² Ð¼Ð¾Ð½ÐµÑ‚Ð°Ñ…
return final_position_size  # 1.45 Ð¼Ð¾Ð½ÐµÑ‚
```

---

## ðŸ“Š ÐŸÐ Ð˜ÐœÐ•Ð  Ð ÐÐ¡Ð§Ð•Ð¢Ð (ÐÐ Ð‘Ð£ÐœÐÐ“Ð•)

### **Ð”Ð°Ð½Ð¾:**
- **balance** = 500 USDT
- **leverage** = 5x
- **sl_percent** = 1.2%
- **regime** = ranging
- **current_price** = 136.8 USDT
- **atr** = 0.8 USDT (0.585% Ð¾Ñ‚ Ñ†ÐµÐ½Ñ‹)
- **symbol** = SOL-USDT
- **signal_strength** = 0.7 (ÑÐ¸Ð»ÑŒÐ½Ñ‹Ð¹ ÑÐ¸Ð³Ð½Ð°Ð»)
- **used_margin** = 0.0 USDT (Ð½ÐµÑ‚ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ñ‹Ñ… Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¹)

### **Ð Ð°ÑÑ‡ÐµÑ‚:**

#### **1. ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð±Ð°Ð»Ð°Ð½ÑÐ°**
```
balance = 500 USDT â†’ profile = "small"
base_position_usd = 100.0 USDT
min_position_usd = 50.0 USDT
max_position_usd = 200.0 USDT
```

#### **2. Per-Symbol Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ**
```
symbol = SOL-USDT
position_multiplier = 0.8 (Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°)
base_usd_size = 100.0 * 0.8 = 80.0 USDT
```

#### **3. Ð ÐµÐ¶Ð¸Ð¼Ð½Ñ‹Ð¹ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ**
```
regime = ranging
position_size_multiplier = 1.0 (Ð¸Ð· ÐºÐ¾Ð½Ñ„Ð¸Ð³Ð°)
base_usd_size = 80.0 * 1.0 = 80.0 USDT
```

#### **4. ÐœÐ½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ ÑÐ¸Ð»Ñ‹ ÑÐ¸Ð³Ð½Ð°Ð»Ð°**
```
signal_strength = 0.7 (ÑÐ¸Ð»ÑŒÐ½Ñ‹Ð¹)
strength_multiplier = 1.2
base_usd_size = 80.0 * 1.2 = 96.0 USDT
```

#### **5. ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸**
```
current_atr_percent = (0.8 / 136.8) * 100 = 0.585%
base_atr_percent = 0.02 (2%)
raw_multiplier = 0.02 / (0.00585) = 3.42
volatility_multiplier = max(0.5, min(3.42, 1.3)) = 1.3
base_usd_size = 96.0 * 1.3 = 124.8 USDT
```

#### **6. ÐŸÑ€Ð¸Ð¼ÐµÐ½ÐµÐ½Ð¸Ðµ Ð»ÐµÐ²ÐµÑ€Ð¸Ð´Ð¶Ð°**
```
leverage = 5x
margin_required_initial = 124.8 / 5 = 24.96 USDT
min_margin_usd = 50.0 / 5 = 10.0 USDT
max_margin_usd = 200.0 / 5 = 40.0 USDT
```

#### **7. Ð—Ð°Ñ‰Ð¸Ñ‚Ñ‹**
```
âœ… Max Margin Used (80%): 24.96 < 400.0 â†’ OK
âœ… Available Margin: 24.96 < 500.0 â†’ OK
âœ… Max Loss per Trade (2%): max_safe_margin = 10.0 / 0.012 = 833.33 USDT â†’ 24.96 < 833.33 â†’ OK
âœ… Max Margin Safety (90%): 24.96 < 450.0 â†’ OK
```

#### **8. Ð¤Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ**
```
margin_usd = max(10.0, min(24.96, 40.0)) = 24.96 USDT
```

#### **9. ÐšÐ¾Ð½Ð²ÐµÑ€Ñ‚Ð°Ñ†Ð¸Ñ Ð² Ð¼Ð¾Ð½ÐµÑ‚Ñ‹**
```
position_size = (24.96 * 5) / 136.8 = 124.8 / 136.8 = 0.912 Ð¼Ð¾Ð½ÐµÑ‚
```

#### **10. ÐžÐºÑ€ÑƒÐ³Ð»ÐµÐ½Ð¸Ðµ**
```
ct_val = 0.01
size_in_contracts = 0.912 / 0.01 = 91.2 ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²
rounded_size = 91 ÐºÐ¾Ð½Ñ‚Ñ€Ð°ÐºÑ‚Ð¾Ð²
final_position_size = 91 * 0.01 = 0.91 Ð¼Ð¾Ð½ÐµÑ‚
```

### **Ð˜Ð¢ÐžÐ“Ðž:**
- **base_position_usd** = 100.0 USDT (Ð¸Ð· Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ñ)
- **final_notional_usd** = 0.91 * 136.8 = 124.49 USDT
- **margin_required** = 124.49 / 5 = 24.90 USDT
- **position_size** = 0.91 Ð¼Ð¾Ð½ÐµÑ‚ (Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ)
- **risk_usd** = 24.90 * 0.012 = 0.30 USDT (Ð¿Ñ€Ð¸ ÑÑ€Ð°Ð±Ð°Ñ‚Ñ‹Ð²Ð°Ð½Ð¸Ð¸ SL)

---

## ðŸŽ¯ ÐŸÐžÐ§Ð•ÐœÐ£ Ð’Ð˜Ð›ÐšÐ = 100 USDT ÐŸÐ Ð˜ Ð‘ÐÐ›ÐÐÐ¡Ð• 500 USDT?

### **ÐŸÑ€Ð¸Ñ‡Ð¸Ð½Ð°:**
1. **ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð±Ð°Ð»Ð°Ð½ÑÐ° "small"** (500 USDT) â†’ `base_position_usd = 100.0 USDT`
2. **Per-Symbol Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ** Ð¼Ð¾Ð¶ÐµÑ‚ ÑƒÐ¼ÐµÐ½ÑŒÑˆÐ¸Ñ‚ÑŒ (SOL-USDT: 0.8x) â†’ 80.0 USDT
3. **Ð ÐµÐ¶Ð¸Ð¼Ð½Ñ‹Ð¹ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ** (ranging: 1.0x) â†’ Ð±ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹
4. **ÐœÐ½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ ÑÐ¸Ð»Ñ‹ ÑÐ¸Ð³Ð½Ð°Ð»Ð°** (0.7: 1.2x) â†’ 96.0 USDT
5. **Ð’Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ** (ATR 0.585%: 1.3x) â†’ 124.8 USDT
6. **Ð›ÐµÐ²ÐµÑ€Ð¸Ð´Ð¶** (5x) â†’ Ð¼Ð°Ñ€Ð¶Ð° 24.96 USDT, notional 124.8 USDT

### **ÐšÐ°Ðº ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ Ð²Ð¸Ð»ÐºÑƒ 200-300 USDT?**

#### **Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 1: Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ base_position_usd Ð² Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ðµ**
```yaml
balance_profiles:
  small:
    base_position_usd: 200.0  # Ð‘Ñ‹Ð»Ð¾ 100.0
    max_position_usd: 300.0    # Ð‘Ñ‹Ð»Ð¾ 200.0
```

#### **Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 2: Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ per-symbol Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÑŒ**
```yaml
symbol_profiles:
  SOL-USDT:
    position_multiplier: 2.0  # Ð‘Ñ‹Ð»Ð¾ 0.8
```

#### **Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 3: Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ strength_multiplier**
```yaml
adaptive_risk:
  strength_multipliers:
    strong: 2.0  # Ð‘Ñ‹Ð»Ð¾ 1.2
```

#### **Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 4: Ð£Ð²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ leverage**
```yaml
scalping:
  leverage: 10  # Ð‘Ñ‹Ð»Ð¾ 5
```
âš ï¸ **Ð’ÐÐ˜ÐœÐÐÐ˜Ð•**: Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ leverage ÑƒÐ²ÐµÐ»Ð¸Ñ‡Ð¸Ð²Ð°ÐµÑ‚ Ñ€Ð¸ÑÐº Ð»Ð¸ÐºÐ²Ð¸Ð´Ð°Ñ†Ð¸Ð¸!

---

## ðŸ“Œ ÐšÐ›Ð®Ð§Ð•Ð’Ð«Ð• Ð¤ÐžÐ ÐœÐ£Ð›Ð«

### **1. Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ð¹ Ñ€Ð°Ð·Ð¼ÐµÑ€**
```
base_usd_size = balance_profile["base_position_usd"]
```

### **2. Ð¡ ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»ÐµÐ¹**
```
base_usd_size = base_usd_size * position_multiplier * regime_multiplier * strength_multiplier * volatility_multiplier
```

### **3. ÐœÐ°Ñ€Ð¶Ð°**
```
margin_required = base_usd_size / leverage
```

### **4. Ð Ð°Ð·Ð¼ÐµÑ€ Ð² Ð¼Ð¾Ð½ÐµÑ‚Ð°Ñ…**
```
position_size = (margin_required * leverage) / price
```

### **5. ÐÐ¾Ð¼Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ ÑÑ‚Ð¾Ð¸Ð¼Ð¾ÑÑ‚ÑŒ**
```
notional_usd = position_size * price
```

### **6. Ð Ð¸ÑÐº Ð½Ð° ÑÐ´ÐµÐ»ÐºÑƒ**
```
risk_usd = margin_required * (sl_percent / 100)
```

---

## âœ… Ð˜Ð¢ÐžÐ“

1. **Ð Ð°Ð·Ð¼ÐµÑ€ Ð¿Ð¾Ð·Ð¸Ñ†Ð¸Ð¸ Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑ‚ÑÑ Ð² `risk_manager.py::calculate_position_size()`**
2. **ÐŸÐ¾Ñ€ÑÐ´Ð¾Ðº**: ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ â†’ Per-Symbol â†’ Ð ÐµÐ¶Ð¸Ð¼ â†’ Ð¡Ð¸Ð»Ð° â†’ Ð’Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ â†’ Ð›ÐµÐ²ÐµÑ€Ð¸Ð´Ð¶ â†’ Ð—Ð°Ñ‰Ð¸Ñ‚Ñ‹ â†’ ÐžÐºÑ€ÑƒÐ³Ð»ÐµÐ½Ð¸Ðµ
3. **Ð’Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ÑÑ Ñ€Ð°Ð·Ð¼ÐµÑ€ Ð² ÐœÐžÐÐ•Ð¢ÐÐ¥**, Ð° Ð½Ðµ Ð² USD
4. **Ð’ÑÐµ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÐ½ÑÑŽÑ‚ÑÑ Ðº notional (base_usd_size)**, Ð·Ð°Ñ‚ÐµÐ¼ Ð´ÐµÐ»Ð¸Ñ‚ÑÑ Ð½Ð° leverage Ð´Ð»Ñ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ Ð¼Ð°Ñ€Ð¶Ð¸
5. **Ð—Ð°Ñ‰Ð¸Ñ‚Ñ‹ Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡Ð¸Ð²Ð°ÑŽÑ‚ Ð¼Ð°Ñ€Ð¶Ñƒ**, Ð° Ð½Ðµ notional
6. **Ð”Ð»Ñ ÑƒÐ²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ð²Ð¸Ð»ÐºÐ¸** Ð½ÑƒÐ¶Ð½Ð¾ Ð¸Ð·Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ `base_position_usd` Ð² Ð¿Ñ€Ð¾Ñ„Ð¸Ð»Ðµ Ð¸Ð»Ð¸ ÑƒÐ²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ Ð¼Ð½Ð¾Ð¶Ð¸Ñ‚ÐµÐ»Ð¸

---

**Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚ ÑÐ¾Ð·Ð´Ð°Ð½**: 2025-12-07
**Ð’ÐµÑ€ÑÐ¸Ñ**: 1.0



