# üîç –†–ï–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú 28.11.2025

**–î–∞—Ç–∞:** 2025-11-28  
**–ü–µ—Ä–∏–æ–¥:** 06:36 - 18:52

---

## üìä –ê–ù–ê–õ–ò–ó –†–ï–ê–õ–¨–ù–´–• –î–ê–ù–ù–´–• –ò–ó –ò–°–¢–û–†–ò–ò –û–†–î–ï–†–û–í

### –ü–†–û–ë–õ–ï–ú–ê #1: –ü–û–ó–ò–¶–ò–ò –ó–ê–ö–†–´–í–ê–Æ–¢–°–Ø –°–†–ê–ó–£ –ü–†–ò –£–ë–´–¢–ö–ï

–ò–∑ –∏—Å—Ç–æ—Ä–∏–∏ –æ—Ä–¥–µ—Ä–æ–≤ –≤–∏–∂—É **–ö–†–ò–¢–ò–ß–ï–°–ö–£–Æ –ü–†–û–ë–õ–ï–ú–£** - –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è **–°–†–ê–ó–£** –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å —É–±—ã—Ç–∫–æ–º:

| –°–∏–º–≤–æ–ª | –û—Ç–∫—Ä—ã—Ç–∏–µ | –ó–∞–∫—Ä—ã—Ç–∏–µ | –í—Ä–µ–º—è | PnL % | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|----------|----------|-------|-------|----------|
| **BTC-USDT** | 15:19:26 | 15:19:27 | **1 —Å–µ–∫—É–Ω–¥–∞!** | -0.51% | –ó–∞–∫—Ä—ã—Ç —Å—Ä–∞–∑—É! |
| **BTC-USDT** | 16:38:27 | 16:38:30 | **3 —Å–µ–∫—É–Ω–¥—ã!** | -0.51% | –ó–∞–∫—Ä—ã—Ç —Å—Ä–∞–∑—É! |
| **ETH-USDT** | 14:05:58 | 14:06:00 | **2 —Å–µ–∫—É–Ω–¥—ã!** | -0.72% | –ó–∞–∫—Ä—ã—Ç —Å—Ä–∞–∑—É! |
| **XRP-USDT** | 16:14:13 | 16:14:23 | **10 —Å–µ–∫—É–Ω–¥!** | -0.99% | –ó–∞–∫—Ä—ã—Ç —Å—Ä–∞–∑—É! |
| **BTC-USDT** | 10:54:04 | 10:54:23 | **19 —Å–µ–∫—É–Ω–¥!** | -0.74% | –ó–∞–∫—Ä—ã—Ç —Å—Ä–∞–∑—É! |

**–ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢:**
- –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –ß–µ—Ä–µ–∑ **1-19 —Å–µ–∫—É–Ω–¥** –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å —É–±—ã—Ç–∫–æ–º
- –≠—Ç–æ **–ù–ï loss_cut** (loss_cut = 4%, –∞ –∑–¥–µ—Å—å 0.5-1%)
- –≠—Ç–æ **–ù–ï MIN_HOLDING** (MIN_HOLDING = 35 –º–∏–Ω—É—Ç, –∞ –∑–¥–µ—Å—å —Å–µ–∫—É–Ω–¥—ã!)

**–≠–¢–û –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê!** –ß—Ç–æ-—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –°–†–ê–ó–£ –ø—Ä–∏ –º–∞–ª–µ–π—à–µ–º —É–±—ã—Ç–∫–µ!

---

### –ü–†–û–ë–õ–ï–ú–ê #2: –ü–û–ó–ò–¶–ò–ò –í–ò–°–Ø–¢ –ß–ê–°–ê–ú–ò –° –ë–û–õ–¨–®–ò–ú –£–ë–´–¢–ö–û–ú

| –°–∏–º–≤–æ–ª | –û—Ç–∫—Ä—ã—Ç–∏–µ | –ó–∞–∫—Ä—ã—Ç–∏–µ | –í—Ä–µ–º—è | PnL % | –ü—Ä–æ–±–ª–µ–º–∞ |
|--------|----------|----------|-------|-------|----------|
| **XRP-USDT** | 08:55:13 | 18:52:48 | **9—á 57–º** | -6.17% | –î–æ–ª–∂–µ–Ω –±—ã–ª –∑–∞–∫—Ä—ã—Ç—å—Å—è –ø—Ä–∏ -4%! |
| **ETH-USDT** | 12:08:55 | 18:52:48 | **6—á 44–º** | -6.26% | –î–æ–ª–∂–µ–Ω –±—ã–ª –∑–∞–∫—Ä—ã—Ç—å—Å—è –ø—Ä–∏ -4%! |
| **DOGE-USDT** | 15:31:45 | 18:52:46 | **3—á 21–º** | **-17.83%** | –î–æ–ª–∂–µ–Ω –±—ã–ª –∑–∞–∫—Ä—ã—Ç—å—Å—è –ø—Ä–∏ -4% –∏–ª–∏ -8%! |
| **SOL-USDT** | 14:59:05 | 18:52:44 | **3—á 54–º** | -7.73% | –î–æ–ª–∂–µ–Ω –±—ã–ª –∑–∞–∫—Ä—ã—Ç—å—Å—è –ø—Ä–∏ -4%! |
| **BTC-USDT** | 17:16:04 | 18:52:46 | **1—á 37–º** | -2.34% | –ú–µ–Ω—å—à–µ -4%, OK |

**–ß–¢–û –ü–†–û–ò–°–•–û–î–ò–¢:**
- –ü–æ–∑–∏—Ü–∏–∏ —É—Ö–æ–¥—è—Ç –≤ –±–æ–ª—å—à–æ–π —É–±—ã—Ç–æ–∫ (-6%, -8%, -17%!)
- **–ù–ï –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è** –ø–æ loss_cut (4% –æ—Ç –º–∞—Ä–∂–∏)
- –í–∏—Å—è—Ç —á–∞—Å–∞–º–∏, –ø–æ–∫–∞ –Ω–µ –∑–∞–∫—Ä–æ–µ—à—å –≤—Ä—É—á–Ω—É—é

---

## üîç –ê–ù–ê–õ–ò–ó –õ–û–ì–û–í

### –ß—Ç–æ –Ω–∞—à–µ–ª –≤ –ª–æ–≥–∞—Ö:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∏ TP —Ä–∞–±–æ—Ç–∞—é—Ç:**
   - `üìä TP –ø—Ä–æ–≤–µ—Ä–∫–∞ XRP-USDT: PnL=$-1.68, margin=$15.35, PnL%=-10.93% (–æ—Ç –º–∞—Ä–∂–∏)`
   - `üìä TP –ø—Ä–æ–≤–µ—Ä–∫–∞ ETH-USDT: PnL=$-1.87, margin=$35.88, PnL%=-5.22% (–æ—Ç –º–∞—Ä–∂–∏)`
   - `üìä TP –ø—Ä–æ–≤–µ—Ä–∫–∞ SOL-USDT: PnL=$-2.75, margin=$31.37, PnL%=-8.78% (–æ—Ç –º–∞—Ä–∂–∏)`
   - `üìä TP –ø—Ä–æ–≤–µ—Ä–∫–∞ DOGE-USDT: PnL=$-4.96, margin=$28.31, PnL%=-17.52% (–æ—Ç –º–∞—Ä–∂–∏)`

2. **–ù–û –ù–ï–¢ –ü–†–û–í–ï–†–û–ö LOSS_CUT!**
   - –í –ª–æ–≥–∞—Ö **–ù–ï–¢** –Ω–∏ –æ–¥–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ø—Ä–æ –ø—Ä–æ–≤–µ—Ä–∫—É loss_cut –¥–ª—è —ç—Ç–∏—Ö –ø–æ–∑–∏—Ü–∏–π
   - –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ TP (–∫–æ—Ç–æ—Ä—ã–µ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—é—Ç –ø—Ä–∏ —É–±—ã—Ç–∫–µ)
   - –ï—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∏ safety (margin_ratio), –Ω–æ –æ–Ω–∏ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç

3. **–ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ:**
   - `‚ö†Ô∏è –ü–û–î–û–ó–†–ò–¢–ï–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–ª—è DOGE-USDT: margin_ratio=0.10, pnl=-4.97. –í–æ–∑–º–æ–∂–Ω–∞ –æ—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ (–ø–æ–∑–∏—Ü–∏—è —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞?), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –∞–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ.`
   - –≠—Ç–∞ –∑–∞—â–∏—Ç–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–ª—è –º–∞–ª—ã—Ö –ø–æ–∑–∏—Ü–∏–π!

---

## üéØ –ö–û–†–ï–ù–¨ –ü–†–û–ë–õ–ï–ú

### –ü–†–û–ë–õ–ï–ú–ê #1: –ß—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –°–†–ê–ó–£ (1-19 —Å–µ–∫—É–Ω–¥)?

**–í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´:**
1. **Position Safety Check** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
2. **Liquidation Guard** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∂–∏ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
3. **Error –≤ —Ä–∞—Å—á–µ—Ç–µ –º–∞—Ä–∂–∏** - –ø–æ–∑–∏—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è "–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π" –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ —Ä–∞—Å—á–µ—Ç–∞
4. **Phantom position detection** - –ø–æ–∑–∏—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è "—Ñ–∞–Ω—Ç–æ–º–Ω–æ–π" –∏ —É–¥–∞–ª—è–µ—Ç—Å—è

**–ù–£–ñ–ù–û –ü–†–û–í–ï–†–ò–¢–¨:**
- –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ –ø–µ—Ä–≤—ã–µ —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏?
- –ö–∞–∫–æ–π –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è?
- –ü–æ—á–µ–º—É –ø–æ–∑–∏—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è "–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π" –ø—Ä–∏ –º–∞–ª–æ–º —É–±—ã—Ç–∫–µ?

---

### –ü–†–û–ë–õ–ï–ú–ê #2: –ü–æ—á–µ–º—É loss_cut –ù–ï —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç?

**–ù–ê–®–ï–õ –í –õ–û–ì–ê–•:**
- –ü—Ä–æ–≤–µ—Ä–∫–∏ loss_cut **–ù–ï –í–´–ó–´–í–ê–Æ–¢–°–Ø** –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ TP (–∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –ø—Ä–∏ —É–±—ã—Ç–∫–µ)

**–í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´:**
1. **TSL –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω** - –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut –≤ TSL –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–µ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
2. **MIN_HOLDING –±–ª–æ–∫–∏—Ä—É–µ—Ç** - –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut –≤ `trailing_stop_loss.py` –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è MIN_HOLDING
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ loss_cut –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è** - –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ loss_cut –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ `position_manager`

**–ù–£–ñ–ù–û –ü–†–û–í–ï–†–ò–¢–¨:**
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ `should_close_position` –¥–ª—è —ç—Ç–∏—Ö –ø–æ–∑–∏—Ü–∏–π?
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ª–∏ TSL –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π?
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ª–∏ loss_cut MIN_HOLDING?

---

## üîß –ß–¢–û –ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨

### 1. –ö–†–ò–¢–ò–ß–ù–û: –ù–∞–π—Ç–∏, —á—Ç–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É (1-19 —Å–µ–∫—É–Ω–¥)

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `position_manager._check_position_safety` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- `liquidation_guard` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∂–∏
- `orchestrator._load_existing_positions` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ–∑–∏—Ü–∏–π
- `entry_manager` - –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- –õ–æ–≥–∏ –ø–µ—Ä–≤—ã—Ö —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏
- –ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
- –ü–æ—á–µ–º—É –ø–æ–∑–∏—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è "–Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π" –ø—Ä–∏ –º–∞–ª–æ–º —É–±—ã—Ç–∫–µ

---

### 2. –ö–†–ò–¢–ò–ß–ù–û: –ò—Å–ø—Ä–∞–≤–∏—Ç—å, —á—Ç–æ–±—ã loss_cut —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `trailing_stop_loss.should_close_position` - –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut (–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è MIN_HOLDING?)
- `trailing_sl_coordinator.update_trailing_stop_loss` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ TSL
- `position_manager._check_tp_only` - –ø—Ä–æ–≤–µ—Ä–∫–∞ TP (–µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut, –Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ TSL –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω)

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ `should_close_position` –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π?
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ª–∏ loss_cut MIN_HOLDING?
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ª–∏ TSL –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π?

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

1. **–ù–∞–π—Ç–∏ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É (1-19 —Å–µ–∫—É–Ω–¥)**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –ø–µ—Ä–≤—ã—Ö —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
   - –ù–∞–π—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å—Ä–∞–∑—É

2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å, —á—Ç–æ–±—ã loss_cut —Ä–∞–±–æ—Ç–∞–ª**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut
   - –£–±—Ä–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É loss_cut MIN_HOLDING (–¥–ª—è –±–æ–ª—å—à–∏—Ö —É–±—ã—Ç–∫–æ–≤)
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ TSL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π

3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

---

---

## ‚úÖ –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –í –ö–û–î–ï

### –ü–†–û–ë–õ–ï–ú–ê #1: `_emergency_close_position` –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py:897-901`

```python
if margin_ratio < 1.2 and margin_ratio > 0:
    logger.warning(
        f"‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è {symbol} –∏–º–µ–µ—Ç –Ω–∏–∑–∫—É—é –º–∞—Ä–∂—É: {margin_ratio:.2f}%. –ó–∞–∫—Ä—ã—Ç–∏–µ..."
    )
    await self._emergency_close_position(position)
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ï—Å–ª–∏ `margin_ratio < 1.2` (–Ω–æ > 0), –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è **–°–†–ê–ó–£**
- –î–ª—è –º–∞–ª—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è `margin_ratio` –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∑–∫–∏–º –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ —Ä–∞—Å—á–µ—Ç–∞
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π (—Å—Ç—Ä–æ–∫–∏ 864-873) –Ω–µ –≤—Å–µ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

**–†–ï–®–ï–ù–ò–ï:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è - –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å, –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ < 30 —Å–µ–∫—É–Ω–¥
- –ò–ª–∏ —É–∂–µ—Å—Ç–æ—á–∏—Ç—å —É—Å–ª–æ–≤–∏–µ - –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `margin_ratio < 0.5` (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å)

---

### –ü–†–û–ë–õ–ï–ú–ê #2: Loss_cut –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–π —Å TSL

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py:1334-1339`

```python
tsl = self.orchestrator.trailing_sl_coordinator.get_tsl(symbol)
if tsl:
    # TSL –∞–∫—Ç–∏–≤–µ–Ω - –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut –±—É–¥–µ—Ç –≤ TSL
    pass
else:
    # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: TSL –Ω–µ –∞–∫—Ç–∏–≤–µ–Ω - –ø—Ä–æ–≤–µ—Ä—è–µ–º loss_cut –∑–¥–µ—Å—å
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ï—Å–ª–∏ TSL –∞–∫—Ç–∏–≤–µ–Ω, –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut –≤ `position_manager` **–ü–†–û–ü–£–°–ö–ê–ï–¢–°–Ø**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ loss_cut –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤ TSL (`trailing_stop_loss.should_close_position`)
- –ù–æ —Ç–∞–º –æ–Ω–∞ **–ë–õ–û–ö–ò–†–£–ï–¢–°–Ø** MIN_HOLDING (—Å—Ç—Ä–æ–∫–∏ 568-592 –≤ `trailing_stop_loss.py`)

**–†–ï–®–ï–ù–ò–ï:**
- –í `trailing_stop_loss.py` —Å–¥–µ–ª–∞—Ç—å loss_cut –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–µ–µ MIN_HOLDING
- –î–ª—è –±–æ–ª—å—à–∏—Ö —É–±—ã—Ç–∫–æ–≤ (loss_cut) –∑–∞–∫—Ä—ã–≤–∞—Ç—å –°–†–ê–ó–£, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç MIN_HOLDING

---

---

## ‚úÖ –ò–¢–û–ì

### –ù–ê–ô–î–ï–ù–û:

1. **–ü–†–û–ë–õ–ï–ú–ê #1 (–ó–∞–∫—Ä—ã—Ç–∏–µ —Å—Ä–∞–∑—É):** `_emergency_close_position` –≤ `position_manager.py:897-901` –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ `margin_ratio < 1.2`
2. **–ü–†–û–ë–õ–ï–ú–ê #2 (Loss_cut –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):** Loss_cut –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è MIN_HOLDING –≤ `trailing_stop_loss.py:568-592`

### –°–¢–ê–¢–ò–°–¢–ò–ö–ê:

- **5 –ø–æ–∑–∏—Ü–∏–π** –∑–∞–∫—Ä—ã—Ç–æ —Å—Ä–∞–∑—É (1-19 —Å–µ–∫—É–Ω–¥) —Å —É–±—ã—Ç–∫–æ–º -0.5% –¥–æ -1%
- **5 –ø–æ–∑–∏—Ü–∏–π** –≤–∏—Å–µ–ª–∏ —á–∞—Å–∞–º–∏ (3-10 —á–∞—Å–æ–≤) —Å —É–±—ã—Ç–∫–æ–º -6% –¥–æ -18%
- **10 –ø–æ–∑–∏—Ü–∏–π** –∑–∞–∫—Ä—ã—Ç–æ —Å –ø—Ä–∏–±—ã–ª—å—é (–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—é—Ç)
- **–ò—Ç–æ–≥–æ–≤—ã–π –±–∞–ª–∞–Ω—Å:** –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö (–Ω–∞—á–∞–ª—å–Ω—ã–π –∏ –∫–æ–Ω–µ—á–Ω—ã–π)

**–°–¢–ê–¢–£–°:** üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ù–ê–ô–î–ï–ù–´ –í –ö–û–î–ï - –¢–†–ï–ë–£–ï–¢–°–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï

