# –ê–ù–ê–õ–ò–ó: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ –≤—Å–µ–º —Ç–æ—Ä–≥–æ–≤—ã–º –ø–∞—Ä–∞–º

## ‚úÖ –ö–†–ê–¢–ö–ò–ô –û–¢–í–ï–¢

**–î–ê, –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –í–°–ï–ú —Ç–æ—Ä–≥–æ–≤—ã–º –ø–∞—Ä–∞–º!**

–†–∞–±–æ—Ç–∞—é—Ç –Ω–∞:
- ‚úÖ BTC-USDT
- ‚úÖ ETH-USDT
- ‚úÖ SOL-USDT
- ‚úÖ DOGE-USDT
- ‚úÖ XRP-USDT

---

## üìä 1. Leverage (–ü–ª–µ—á–æ)

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:

**–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞:

```python
# orchestrator.py, —Å—Ç—Ä–æ–∫–∏ 284-302
for symbol in self.scalping_config.symbols:
    try:
        await self.client.set_leverage(symbol, leverage_config)
        logger.info(f"‚úÖ –ü–ª–µ—á–æ {leverage_config}x —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è {symbol}")
    except Exception as e:
        logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–ª–µ—á–æ {leverage_config}x –¥–ª—è {symbol}: {e}")
```

**–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã** (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞):
```yaml
symbols:
  - "BTC-USDT"
  - "ETH-USDT"
  - "SOL-USDT"
  - "DOGE-USDT"
  - "XRP-USDT"
```

**Leverage –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞**: `5x` (–¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ Leverage 5x —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö 5 –ø–∞—Ä

---

## üìä 2. –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π (–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è)

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:

**–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è** –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º —Å–∏–º–≤–æ–ª–∞–º —á–µ—Ä–µ–∑ `_calculate_position_size`:

```python
# orchestrator.py, —Å—Ç—Ä–æ–∫–∏ 2040-2074
balance_profile = self._get_balance_profile(balance)
base_usd_size = balance_profile["base_position_usd"]  # –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç

# –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è per-symbol multiplier
symbol_profile = self.symbol_profiles.get(symbol, {})
position_multiplier = symbol_dict.get("position_multiplier")
if position_multiplier is not None:
    base_usd_size = base_usd_size * float(position_multiplier)
```

**Balance Profiles** (–ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º):
- `micro`: $100 - $500
- `small`: $500 - $1500
- `medium`: $1500 - $3000
- `large`: $3000+

**–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è**:
- –î–ª—è –±–∞–ª–∞–Ω—Å–∞ $1018: –ø—Ä–æ—Ñ–∏–ª—å `small`
- –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $50 + (($1018 - $500) / $1000) √ó $100 = $101.80
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä

---

## üìä 3. Per-Symbol Multipliers (–ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã)

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:

**–ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä** –≤ –∫–æ–Ω—Ñ–∏–≥–µ:

```yaml
symbol_profiles:
  BTC-USDT:
    position_multiplier: 1.2  # +20% (–≤—ã—Å–æ–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å)
  ETH-USDT:
    position_multiplier: 1.0  # –°—Ç–∞–Ω–¥–∞—Ä—Ç
  SOL-USDT:
    position_multiplier: 0.9  # -10% (—Å—Ä–µ–¥–Ω—è—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å)
  DOGE-USDT:
    position_multiplier: 0.8  # -20% (–Ω–∏–∑–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å)
  XRP-USDT:
    position_multiplier: 0.8  # -20% (–Ω–∏–∑–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å)
```

**–†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏** (–¥–ª—è –±–∞–ª–∞–Ω—Å–∞ $1018):

1. **–ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä** (–ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è): $101.80

2. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–Ω–æ–∂–∏—Ç–µ–ª–µ–π**:
   - **BTC-USDT**: $101.80 √ó 1.2 = **$122.16**
   - **ETH-USDT**: $101.80 √ó 1.0 = **$101.80**
   - **SOL-USDT**: $101.80 √ó 0.9 = **$91.62**
   - **DOGE-USDT**: $101.80 √ó 0.8 = **$81.44**
   - **XRP-USDT**: $101.80 √ó 0.8 = **$81.44**

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ Per-symbol multipliers –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º

---

## üìä 4. Take Profit (TP)

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:

**TP –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–æ–∑–∏—Ü–∏—è–º** –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–∏–º–≤–æ–ª–∞:

```python
# position_manager.py, —Å—Ç—Ä–æ–∫–∏ 426-432
tp_percent = self.scalping_config.tp_percent  # 1.0% –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
if pnl_percent >= tp_percent:
    await self._close_position_by_reason(position, "tp")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞**: `tp_percent: 1.0` (–¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä)

**–†–∞—Å—á–µ—Ç**: PnL% –æ—Ç –º–∞—Ä–∂–∏ (–∞–¥–∞–ø—Ç–∏–≤–µ–Ω –∫ —Ä–∞–∑–º–µ—Ä—É –ø–æ–∑–∏—Ü–∏–∏)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ TP —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä

---

## üìä 5. Trailing Stop Loss

### –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:

**Trailing Stop Loss –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–æ–∑–∏—Ü–∏—è–º** –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Å–∏–º–≤–æ–ª–∞:

```python
# orchestrator.py, —Å—Ç—Ä–æ–∫–∏ 2624-2723
async def _update_trailing_stop_loss(self, symbol: str, current_price: float):
    tsl = self.trailing_sl_by_symbol[symbol]
    if tsl.should_close_position(current_price):
        await self._close_position(symbol, "trailing_stop")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞** (–¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä):
```yaml
trailing_sl:
  initial_trail: 0.005  # 0.5%
  max_trail: 0.01       # 1.0%
  min_trail: 0.003      # 0.3%
  loss_cut_percent: 1.5  # -1.5%
  timeout_loss_percent: 0.5  # -0.5%
  timeout_minutes: 3
```

**–†–∞—Å—á–µ—Ç**: –ü—Ä–æ—Ü–µ–Ω—Ç—ã –æ—Ç —Ü–µ–Ω—ã (–∞–¥–∞–ø—Ç–∏–≤–µ–Ω –∫ —Ä–∞–∑–º–µ—Ä—É –ø–æ–∑–∏—Ü–∏–∏)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ Trailing Stop Loss —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä

---

## üìã –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ü–∞—Ä–∞–º–µ—Ç—Ä | BTC-USDT | ETH-USDT | SOL-USDT | DOGE-USDT | XRP-USDT |
|----------|----------|----------|----------|-----------|----------|
| **Leverage** | 5x ‚úÖ | 5x ‚úÖ | 5x ‚úÖ | 5x ‚úÖ | 5x ‚úÖ |
| **–ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä** | $101.80 ‚úÖ | $101.80 ‚úÖ | $101.80 ‚úÖ | $101.80 ‚úÖ | $101.80 ‚úÖ |
| **Multiplier** | 1.2x ‚úÖ | 1.0x ‚úÖ | 0.9x ‚úÖ | 0.8x ‚úÖ | 0.8x ‚úÖ |
| **–ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä** | $122.16 ‚úÖ | $101.80 ‚úÖ | $91.62 ‚úÖ | $81.44 ‚úÖ | $81.44 ‚úÖ |
| **TP (1.0%)** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| **Trailing SL** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä

### –î–ª—è –±–∞–ª–∞–Ω—Å–∞ $1018:

1. **BTC-USDT**:
   - –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80
   - Multiplier: 1.2x
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80 √ó 1.2 = **$122.16**
   - –ú–∞—Ä–∂–∞ (5x): $122.16 / 5 = **$24.43**
   - TP (1.0%): $0.2443

2. **ETH-USDT**:
   - –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80
   - Multiplier: 1.0x
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80 √ó 1.0 = **$101.80**
   - –ú–∞—Ä–∂–∞ (5x): $101.80 / 5 = **$20.36**
   - TP (1.0%): $0.2036

3. **SOL-USDT**:
   - –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80
   - Multiplier: 0.9x
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80 √ó 0.9 = **$91.62**
   - –ú–∞—Ä–∂–∞ (5x): $91.62 / 5 = **$18.32**
   - TP (1.0%): $0.1832

4. **DOGE-USDT**:
   - –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80
   - Multiplier: 0.8x
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80 √ó 0.8 = **$81.44**
   - –ú–∞—Ä–∂–∞ (5x): $81.44 / 5 = **$16.29**
   - TP (1.0%): $0.1629

5. **XRP-USDT**:
   - –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80
   - Multiplier: 0.8x
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: $101.80 √ó 0.8 = **$81.44**
   - –ú–∞—Ä–∂–∞ (5x): $81.44 / 5 = **$16.29**
   - TP (1.0%): $0.1629

---

## ‚úÖ –í–´–í–û–î–´

### 1. Leverage:
- ‚úÖ **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º**: 5x –¥–ª—è –≤—Å–µ—Ö 5 –ø–∞—Ä
- ‚úÖ **–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ**: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º**: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞

### 2. –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π:
- ‚úÖ **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è**: —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä
- ‚úÖ **Per-symbol multipliers**: –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º
- ‚úÖ **–†–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã**: –∫–∞–∂–¥–∞—è –ø–∞—Ä–∞ –∏–º–µ–µ—Ç —Å–≤–æ–π —Ä–∞–∑–º–µ—Ä –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è

### 3. Take Profit:
- ‚úÖ **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º**: 1.0% –æ—Ç –º–∞—Ä–∂–∏
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–µ–Ω**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–∑–∏—Ü–∏–∏

### 4. Trailing Stop Loss:
- ‚úÖ **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –ø–∞—Ä–∞–º**: 0.5% - 1.0% –æ—Ç —Ü–µ–Ω—ã
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–µ–Ω**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–∑–∏—Ü–∏–∏

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –∫–æ–¥–µ

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ leverage (orchestrator.py, —Å—Ç—Ä–æ–∫–∏ 284-302):
```python
for symbol in self.scalping_config.symbols:  # –í—Å–µ 5 –ø–∞—Ä
    await self.client.set_leverage(symbol, leverage_config)
```

### 2. –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ (orchestrator.py, —Å—Ç—Ä–æ–∫–∏ 2040-2074):
```python
balance_profile = self._get_balance_profile(balance)  # –î–ª—è –≤—Å–µ—Ö –ø–∞—Ä
base_usd_size = balance_profile["base_position_usd"]  # –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç

# Per-symbol multiplier –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã
symbol_profile = self.symbol_profiles.get(symbol, {})
position_multiplier = symbol_dict.get("position_multiplier")
base_usd_size = base_usd_size * float(position_multiplier)
```

### 3. Take Profit (position_manager.py, —Å—Ç—Ä–æ–∫–∏ 426-432):
```python
tp_percent = self.scalping_config.tp_percent  # –î–ª—è –≤—Å–µ—Ö –ø–∞—Ä
if pnl_percent >= tp_percent:
    await self._close_position_by_reason(position, "tp")
```

### 4. Trailing Stop Loss (orchestrator.py, —Å—Ç—Ä–æ–∫–∏ 2624-2723):
```python
async def _update_trailing_stop_loss(self, symbol: str, current_price: float):
    # –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
    tsl = self.trailing_sl_by_symbol[symbol]
    if tsl.should_close_position(current_price):
        await self._close_position(symbol, "trailing_stop")
```

---

## üéØ –ò–¢–û–ì

**–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ –í–°–ï–ú —Ç–æ—Ä–≥–æ–≤—ã–º –ø–∞—Ä–∞–º!**

1. ‚úÖ **Leverage 5x**: –¥–ª—è –≤—Å–µ—Ö 5 –ø–∞—Ä
2. ‚úÖ **–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è**: –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä
3. ‚úÖ **Per-symbol multipliers**: –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä (—Ä–∞–∑–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏)
4. ‚úÖ **Take Profit 1.0%**: –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä
5. ‚úÖ **Trailing Stop Loss**: –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ö–∞–∂–¥–∞—è –ø–∞—Ä–∞ –ø–æ–ª—É—á–∞–µ—Ç —Å–≤–æ–π –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–Ω–æ–∂–∏—Ç–µ–ª—è, –Ω–æ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π leverage, TP –∏ Trailing Stop Loss (–∫–æ—Ç–æ—Ä—ã–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã –∫ —Ä–∞–∑–º–µ—Ä—É –ø–æ–∑–∏—Ü–∏–∏).

