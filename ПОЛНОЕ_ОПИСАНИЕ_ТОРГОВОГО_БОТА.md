# ü§ñ –ü–û–õ–ù–û–ï –û–ü–ò–°–ê–ù–ò–ï –¢–û–†–ì–û–í–û–ì–û –ë–û–¢–ê OKX (FUTURES + SPOT)

> **‚ö†Ô∏è –í–ê–ñ–ù–û: –ù–ï –£–î–ê–õ–Ø–¢–¨ –≠–¢–û–¢ –§–ê–ô–õ!**  
> –≠—Ç–æ—Ç —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –≤ –Ω–µ–π—Ä–æ—Å–µ—Ç—å Kimi.

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 30 –Ω–æ—è–±—Ä—è 2025  
**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 28 —è–Ω–≤–∞—Ä—è 2026  
**–¢–∏–ø —Ç–æ—Ä–≥–æ–≤–ª–∏:** Futures (—Ñ—å—é—á–µ—Ä—Å—ã) –∏ Spot (—Å–ø–æ—Ç) –Ω–∞ –±–∏—Ä–∂–µ OKX  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 3.5 (—Ñ–∏–∫—Å detect_regime parameter issue, Parameter Orchestrator, Pattern Detection System)

### –ö—Ä–∞—Ç–∫–æ –ø–æ –≤–µ—Ä—Å–∏–∏ 3.4 (08.01.2026)
- –õ–∏–º–∏—Ç–Ω–∞—è —Ü–µ–Ω–∞ —Ç–µ–ø–µ—Ä—å –∂—ë—Å—Ç–∫–æ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ —Å–≤–µ–∂–∏–º best_bid/best_ask —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º offset –∏ –∑–∞—â–∏—Ç–æ–π –æ—Ç —É–¥–∞–ª–µ–Ω–∏—è >0.2% –æ—Ç —Ä—ã–Ω–∫–∞.
- –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ-—Ä–µ–ø—Ä–∞–π—Å –∑–∞–≤–∏—Å—à–∏—Ö –ª–∏–º–∏—Ç–æ–≤ (–¥—Ä–µ–π—Ñ ‚â•0.2%, —Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥ 2—Å, —É—á—ë—Ç price limits) –¥–æ —Ç–∞–π–º–∞—É—Ç–∞, –∑–∞—Ç–µ–º fallback –Ω–∞ market/–æ—Ç–º–µ–Ω–∞.
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ ADX (+DM/-DM –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ), —Å–æ—Ö—Ä–∞–Ω—è–µ–º ADX –≤ DataRegistry –ø–æ—Å–ª–µ fallback-—Ä–∞—Å—á—ë—Ç–∞.
- –ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ SHORT –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è –≤–≤–µ—Ä—Ö (1 + slippage), –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –ª–∏–º–∏—Ç—ã –Ω–∏–∂–µ —Ä—ã–Ω–∫–∞.
- TCC/Liquidation Guard –∑–∞—â–∏—â–µ–Ω—ã –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ—Å–ª–µ –æ–±—Ä—ã–≤–æ–≤ SSL; –ª–æ–≥–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã (RSI/MACD/ADX/–∫—ç—à —Ñ–∏–ª—å—Ç—Ä–æ–≤).

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–æ–±—â–∞—è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
2. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ñ–∞–π–ª—ã](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞-–∏-—Ñ–∞–π–ª—ã)
3. [–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –±–æ—Ç–∞](#–∂–∏–∑–Ω–µ–Ω–Ω—ã–π-—Ü–∏–∫–ª-–±–æ—Ç–∞)
4. [–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤](#–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-—Å–∏–≥–Ω–∞–ª–æ–≤)
5. [–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤](#—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ-–æ—Ä–¥–µ—Ä–æ–≤)
6. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø–æ–∑–∏—Ü–∏—è–º–∏)
7. [–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π](#–∑–∞–∫—Ä—ã—Ç–∏–µ-–ø–æ–∑–∏—Ü–∏–π)
8. [–°–∏—Å—Ç–µ–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏](#—Å–∏—Å—Ç–µ–º—ã-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)
9. [–°–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã](#—Å–∏—Å—Ç–µ–º—ã-–∑–∞—â–∏—Ç—ã)
10. [–†–∞—Å—á–µ—Ç—ã –∏ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞](#—Ä–∞—Å—á–µ—Ç—ã-–∏-–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞)
11. [–†–∞–±–æ—Ç–∞ —Å –±–∏—Ä–∂–µ–π OKX](#—Ä–∞–±–æ—Ç–∞-—Å-–±–∏—Ä–∂–µ–π-okx)
12. [–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã](#–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ-—Å–∏—Å—Ç–µ–º—ã)
13. [–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–ª–µ—á–æ (Adaptive Leverage)](#–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ-–ø–ª–µ—á–æ-adaptive-leverage)
14. [–õ–µ—Å—Ç–Ω–∏—á–Ω—ã–π –≤—Ö–æ–¥ (Ladder Entry / Position Scaling)](#–ª–µ—Å—Ç–Ω–∏—á–Ω—ã–π-–≤—Ö–æ–¥-ladder-entry--position-scaling)
15. [Exit Analyzer - –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π](#exit-analyzer---—É–º–Ω–æ–µ-–∑–∞–∫—Ä—ã—Ç–∏–µ-–ø–æ–∑–∏—Ü–∏–π)
16. [Position Registry - –†–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π](#position-registry---—Ä–µ–µ—Å—Ç—Ä-–ø–æ–∑–∏—Ü–∏–π)
17. [Position Sync - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–∏—Ä–∂–µ–π](#position-sync---—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è-—Å-–±–∏—Ä–∂–µ–π)
18. [–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ V2](#–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è-—Å–∏—Å—Ç–µ–º–∞-—Ñ–∏–ª—å—Ç—Ä–æ–≤-v2)
19. [Parameter Orchestrator](#parameter-orchestrator)
20. [Pattern Detection System](#pattern-detection-system)
21. [Trading Control Center](#trading-control-center)
22. [Spot —Ç–æ—Ä–≥–æ–≤–ª—è](#spot-—Ç–æ—Ä–≥–æ–≤–ª—è)
23. [–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–∏–≥–Ω–∞–ª–æ–≤ (31.12.2025)](#–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è-–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π-—Å–∏–≥–Ω–∞–ª–æ–≤-31122025)
24. [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ –∏ —Å–∏—Å—Ç–µ–º—ã](#–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–º–æ–¥—É–ª–∏-–∏-—Å–∏—Å—Ç–µ–º—ã)
25. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Spot –∏ Futures](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-spot-–∏-futures)

---

## üèóÔ∏è –û–ë–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

–ë–æ—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å —á–µ—Ç–∫–∏–º —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              FuturesScalpingOrchestrator                 ‚îÇ
‚îÇ              (–ì–ª–∞–≤–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä)                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                          ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ                 ‚îÇ                 ‚îÇ
        ‚ñº                 ‚ñº                 ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Signal       ‚îÇ  ‚îÇ Order        ‚îÇ  ‚îÇ Position     ‚îÇ
‚îÇ Generator    ‚îÇ  ‚îÇ Executor     ‚îÇ  ‚îÇ Manager      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                 ‚îÇ                 ‚îÇ
        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚îÇ
        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
        ‚îÇ               ‚îÇ               ‚îÇ
        ‚ñº               ‚ñº               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Filters      ‚îÇ ‚îÇ Risk         ‚îÇ ‚îÇ Indicators   ‚îÇ
‚îÇ (10+ —Ç–∏–ø–æ–≤)  ‚îÇ ‚îÇ Manager      ‚îÇ ‚îÇ (RSI, MACD...)‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **–Ø–∑—ã–∫:** Python 3.8+
- **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å:** asyncio
- **API –±–∏—Ä–∂–∏:** OKX REST API + WebSocket
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** YAML (Pydantic)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** loguru
- **–¢–∏–ø —Ç–æ—Ä–≥–æ–≤–ª–∏:** 
  - Futures (USDT-Margined Perpetual Swaps) - —Å –ª–µ–≤–µ—Ä–∏–¥–∂–µ–º
  - Spot (—Å–ø–æ—Ç —Ç–æ—Ä–≥–æ–≤–ª—è) - –±–µ–∑ –ª–µ–≤–µ—Ä–∏–¥–∂–∞
- **–†–µ–∂–∏–º –º–∞—Ä–∂–∏ (Futures):** Isolated Margin
- **–ü–ª–µ—á–æ (Futures):** –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ 3-30x (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–∞)
- **Spot —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:** Manual Pool Strategy (—Ä—É—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤)

---

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê –ò –§–ê–ô–õ–´

### –ü–æ–ª–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –ø—Ä–æ–µ–∫—Ç–∞

```
simple trading bot okx/
‚îú‚îÄ‚îÄ run.py                          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ (–≤—ã–±–æ—Ä Spot/Futures)
‚îú‚îÄ‚îÄ README.md                       # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ –ü–û–õ–ù–û–ï_–û–ü–ò–°–ê–ù–ò–ï_–¢–û–†–ì–û–í–û–ì–û_–ë–û–¢–ê.md  # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ requirements.txt                # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ config.yaml                     # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ (legacy)
‚îÇ
‚îú‚îÄ‚îÄ config/                         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ config_futures.yaml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Futures (–æ—Å–Ω–æ–≤–Ω–æ–π)
‚îÇ   ‚îú‚îÄ‚îÄ config_spot.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Spot
‚îÇ   ‚îú‚îÄ‚îÄ features.yaml              # –§–ª–∞–≥–∏ —Ñ—É–Ω–∫—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ manual_pools.yaml         # –†—É—á–Ω—ã–µ –ø—É–ª—ã –¥–ª—è Spot
‚îÇ   ‚îî‚îÄ‚îÄ –ö–û–ù–§–ò–ì_–ê–î–ê–ü–¢–ò–í–ù–´–•_–ü–ê–†–ê–ú–ï–¢–†–û–í_–†–ò–°–ö–ê.yaml
‚îÇ
‚îú‚îÄ‚îÄ src/                            # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main_futures.py            # –ó–∞–ø—É—Å–∫ Futures –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ main_spot.py               # –ó–∞–ø—É—Å–∫ Spot –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py                  # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ models.py                  # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ clients/                   # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ futures_client.py      # OKX Futures API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ spot_client.py         # OKX Spot API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ strategies/                # –¢–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modules/               # –û–±—â–∏–µ –º–æ–¥—É–ª–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ adaptive_regime_manager.py  # ARM - –º–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ–∂–∏–º–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ correlation_filter.py       # –§–∏–ª—å—Ç—Ä –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ multi_timeframe.py          # –ú—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º –∞–Ω–∞–ª–∏–∑
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pivot_points.py             # –†–∞—Å—á–µ—Ç –ø–∏–≤–æ—Ç–æ–≤
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ volume_profile_filter.py    # –§–∏–ª—å—Ç—Ä –æ–±—ä–µ–º–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ margin_calculator.py        # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∞—Ä–∂–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ liquidation_guard.py        # –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ slippage_guard.py           # –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ balance_checker.py          # –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trading_statistics.py      # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ volatility_adapter.py       # –ê–¥–∞–ø—Ç–µ—Ä –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ debug_logger.py             # –û—Ç–ª–∞–¥–æ—á–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scalping/              # –°–∫–∞–ª—å–ø–∏–Ω–≥ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ futures/           # Futures —Å–∫–∞–ª—å–ø–∏–Ω–≥
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ orchestrator.py         # –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ signal_generator.py    # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ order_executor.py      # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ position_manager.py    # –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ risk_manager.py        # –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ websocket_manager.py   # –ü—É–±–ª–∏—á–Ω—ã–π WebSocket
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ private_websocket_manager.py  # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π WebSocket
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ tsl_manager.py         # –ú–µ–Ω–µ–¥–∂–µ—Ä TSL
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ adaptivity/           # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ regime_manager.py         # –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ–∂–∏–º–æ–≤ —Ä—ã–Ω–∫–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ balance_manager.py       # –ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–ª–∞–Ω—Å–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filter_parameters.py     # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ V2
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parameter_adapter.py     # –ê–¥–∞–ø—Ç–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ analysis/              # –ê–Ω–∞–ª–∏–∑
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ direction_analyzer.py    # –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ calculations/          # –†–∞—Å—á–µ—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ balance_calculator.py    # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–∞–ª–∞–Ω—Å–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ margin_calculator.py     # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∞—Ä–∂–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pnl_calculator.py        # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä PnL
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ position_sizer.py        # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ regime_calculator.py     # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–µ–∂–∏–º–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ config/                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py        # –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parameter_provider.py    # –ü—Ä–æ–≤–∞–π–¥–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ parameters/           # –ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parameter_orchestrator.py # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ parameter_schema.py       # –°—Ö–µ–º—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ parameter_validators.py   # –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ patterns/             # –î–µ—Ç–µ–∫—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ pattern_detector.py       # –î–µ—Ç–µ–∫—Ç–æ—Ä –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pattern_engine.py         # –î–≤–∏–∂–æ–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ coordinators/          # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ signal_coordinator.py         # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exit_decision_coordinator.py  # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ priority_resolver.py          # –†–µ–∑–æ–ª–≤–µ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ smart_exit_coordinator.py     # –£–º–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∑–∞–∫—Ä—ã—Ç–∏—è
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trailing_sl_coordinator.py    # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä TSL
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ order_coordinator.py          # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ websocket_coordinator.py      # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä WebSocket
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ core/                  # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ data_registry.py           # –†–µ–µ—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö (—Ü–µ–Ω—ã, —Å–≤–µ—á–∏)
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ position_registry.py       # –†–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ position_sync.py           # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–∏—Ä–∂–µ–π
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ candle_buffer.py           # –ë—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ trading_control_center.py  # –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ filters/              # –§–∏–ª—å—Ç—Ä—ã —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ funding_rate_filter.py      # –§–∏–ª—å—Ç—Ä funding rate
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ liquidity_filter.py         # –§–∏–ª—å—Ç—Ä –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ momentum_filter.py          # –§–∏–ª—å—Ç—Ä –º–æ–º–µ–Ω—Ç—É–º–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ order_flow_filter.py         # –§–∏–ª—å—Ç—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ volatility_regime_filter.py  # –§–∏–ª—å—Ç—Ä –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ indicators/           # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ indicator_calculator.py     # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fast_adx.py                  # –ë—ã—Å—Ç—Ä—ã–π ADX
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ atr_provider.py             # –ü—Ä–æ–≤–∞–π–¥–µ—Ä ATR
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ trailing_stop_loss.py       # –¢—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ funding_rate_monitor.py     # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ funding rate
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ order_flow_indicator.py      # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ liquidity_levels.py         # –£—Ä–æ–≤–Ω–∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ micro_pivot_calculator.py   # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ futures_volume_profile.py   # –û–±—ä–µ–º–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ logging/              # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logger_factory.py           # –§–∞–±—Ä–∏–∫–∞ –ª–æ–≥–≥–µ—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ structured_logger.py        # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ debug_logger.py             # –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥–≥–µ—Ä
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ metrics/               # –ú–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ conversion_metrics.py       # –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ holding_time_metrics.py     # –ú–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ alert_manager.py            # –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ positions/            # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entry_manager.py            # –ú–µ–Ω–µ–¥–∂–µ—Ä –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ exit_analyzer.py            # –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –≤—ã—Ö–æ–¥–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ position_monitor.py         # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ position_scaling_manager.py # –õ–µ—Å—Ç–Ω–∏—á–Ω—ã–π –≤—Ö–æ–¥
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ peak_profit_tracker.py      # –¢—Ä–µ–∫–µ—Ä –ø–∏–∫–æ–≤–æ–π –ø—Ä–∏–±—ã–ª–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ take_profit_manager.py      # –ú–µ–Ω–µ–¥–∂–µ—Ä TP
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stop_loss_manager.py        # –ú–µ–Ω–µ–¥–∂–µ—Ä SL
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ exit_decision_logger.py     # –õ–æ–≥–≥–µ—Ä —Ä–µ—à–µ–Ω–∏–π –æ –≤—ã—Ö–æ–¥–µ
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ risk/                 # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ adaptive_leverage.py        # –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–ª–µ—á–æ
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ liquidation_protector.py    # –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ margin_monitor.py           # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∞—Ä–∂–∏
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ max_size_limiter.py         # –û–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å —Ä–∞–∑–º–µ—Ä–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ position_sizer.py           # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ signals/             # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ filter_manager.py           # –ú–µ–Ω–µ–¥–∂–µ—Ä —Ñ–∏–ª—å—Ç—Ä–æ–≤
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rsi_signal_generator.py     # RSI –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ macd_signal_generator.py    # MACD –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
‚îÇ   ‚îÇ       ‚îÇ   ‚îÇ
‚îÇ   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ utils/               # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ       ‚îÇ       ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ       ‚îÇ       ‚îî‚îÄ‚îÄ units.py                    # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü
‚îÇ   ‚îÇ       ‚îÇ
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ spot/                   # Spot —Å–∫–∞–ª—å–ø–∏–Ω–≥
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ orchestrator.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ signal_generator.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ order_executor.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ position_manager.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ risk_manager.py
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ indicators/                 # –û–±—â–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py                 # –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ talib_wrapper.py        # –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è TA-Lib
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ advanced/                # –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ candle_patterns.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pivot_calculator.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ volume_profile.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ risk/                       # –°–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ risk_controller.py     # –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ä–∏—Å–∫–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ risk_controller_config.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/                      # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logging_setup.py       # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ telegram_notifier.py   # Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ filters/                    # –û–±—â–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ correlation_manager.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ time_session_manager.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ balance/                    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–º
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ adaptive_balance_manager.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ websocket_manager.py        # –û–±—â–∏–π WebSocket –º–µ–Ω–µ–¥–∂–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ market_data_websocket.py    # WebSocket —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ
‚îú‚îÄ‚îÄ logs/                           # –õ–æ–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ futures/                    # –õ–æ–≥–∏ Futures
‚îÇ       ‚îú‚îÄ‚îÄ structured/             # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ docs/                           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ analysis/                   # –ê–Ω–∞–ª–∏–∑—ã
‚îÇ   ‚îú‚îÄ‚îÄ architecture/               # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
‚îÇ   ‚îú‚îÄ‚îÄ current/                    # –¢–µ–∫—É—â–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ scripts/                        # –°–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ utils/                      # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ tests/                          # –¢–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ venv/                           # –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–Ω–µ –≤ git)
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ –∏—Ö —Ñ—É–Ω–∫—Ü–∏–∏

#### 1. `run.py` - –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ (Spot/Futures)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ó–∞–ø—É—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—Ç–∞

#### 2. `src/main_futures.py` - –ó–∞–ø—É—Å–∫ Futures –±–æ—Ç–∞
- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `config_futures.yaml`
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `FuturesScalpingOrchestrator`
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ graceful shutdown

#### 3. `src/strategies/scalping/futures/orchestrator.py` - –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- –ì–ª–∞–≤–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø–æ–∑–∏—Ü–∏–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `start()` - –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
- `run()` - –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª —Ç–æ—Ä–≥–æ–≤–ª–∏
- `_process_symbol()` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
- `_update_trailing_stop_loss()` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–π–ª–∏–Ω–≥-—Å—Ç–æ–ø–∞
- `_close_position()` - –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏

#### 4. `src/strategies/scalping/futures/signal_generator.py` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–∞—Å—á–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (BUY/SELL)
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (ARM)

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
- RSI (Relative Strength Index)
- MACD (Moving Average Convergence Divergence)
- Bollinger Bands
- EMA (Exponential Moving Average)
- SMA (Simple Moving Average)
- ATR (Average True Range)

#### 5. `src/strategies/scalping/futures/order_executor.py` - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ—Ä–¥–µ—Ä–æ–≤
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ –Ω–∞ –±–∏—Ä–∂–µ
- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –æ—Ä–¥–µ—Ä–∞ (MARKET/LIMIT)
- –†–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –¥–ª—è –ª–∏–º–∏—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

#### 6. `src/strategies/scalping/futures/position_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–∑–∏—Ü–∏–π
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –†–∞—Å—á–µ—Ç PnL (–ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è (TP/SL)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Trailing Stop Loss

#### 7. `src/strategies/scalping/futures/risk_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –º–∞—Ä–∂–∏
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
- –ö–æ–Ω—Ç—Ä–æ–ª—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å

#### 8. `src/strategies/scalping/futures/risk/adaptive_leverage.py` - –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–ª–µ—á–æ
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–ª–µ—á–∞ (3-30x) –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–∞
- –£—á–µ—Ç —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ (trending/ranging/choppy)
- –£—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (ATR)
- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –±–∏—Ä–∂–µ

**–õ–æ–≥–∏–∫–∞:**
- –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞ 0.0-0.3 ‚Üí 3x (very_weak)
- –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞ 0.3-0.5 ‚Üí 5x (weak)
- –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞ 0.5-0.7 ‚Üí 10x (medium)
- –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞ 0.7-0.9 ‚Üí 20x (strong)
- –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞ 0.9-1.0 ‚Üí 30x (very_strong)

#### 9. `src/strategies/scalping/futures/positions/position_scaling_manager.py` - –õ–µ—Å—Ç–Ω–∏—á–Ω—ã–π –≤—Ö–æ–¥
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫ –ø–æ–∑–∏—Ü–∏–∏
- –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ª–∏–º–∏—Ç–æ–≤ (max_additions, min_interval, max_loss)
- –ó–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π

**–õ–µ—Å—Ç–Ω–∏—Ü–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:** [1.0, 0.8, 0.6, 0.4, 0.3, 0.2, 0.15]
- 1-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 100% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 2-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 80% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 3-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 60% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- –ò —Ç–∞–∫ –¥–∞–ª–µ–µ...

#### 10. `src/strategies/scalping/futures/positions/exit_analyzer.py` - Exit Analyzer
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –£–º–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–π –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
- –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ (trending/ranging/choppy)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤: ADX, Order Flow, MTF, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ
- –ó–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏ —á–µ—Ä–µ–∑ trailing stop
- ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û (23.12.2025):** –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ SL –∏–∑ `adaptive_regime.{regime}.sl_percent`

#### 11. `src/strategies/scalping/futures/core/position_registry.py` - –†–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
- –•—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (entry_time, regime, balance_profile, leverage, scaling_history)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ peak_profit (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ partial_tp_executed —Ñ–ª–∞–≥–æ–º

#### 12. `src/strategies/scalping/futures/core/position_sync.py` - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å –±–∏—Ä–∂–µ–π
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ "drift" –ø–æ–∑–∏—Ü–∏–π (–Ω–∞ –±–∏—Ä–∂–µ, –Ω–æ –Ω–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è drift –ø–æ–∑–∏—Ü–∏–π –≤ PositionRegistry
- –û—á–∏—Å—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π

#### 13. `src/clients/futures_client.py` - –ö–ª–∏–µ–Ω—Ç OKX API
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- REST API –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∏—Ä–∂–µ
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
- –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∏ –ø–æ–∑–∏—Ü–∏–π

---

## üîÑ –ñ–ò–ó–ù–ï–ù–ù–´–ô –¶–ò–ö–õ –ë–û–¢–ê

### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (`orchestrator.start()`)

```python
1. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ config_futures.yaml
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OKXFuturesClient (API –∫–ª—é—á–∏, sandbox —Ä–µ–∂–∏–º)
3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π:
   - SignalGenerator (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤)
   - OrderExecutor (–∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ—Ä–¥–µ—Ä–æ–≤)
   - PositionManager (–º–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–∑–∏—Ü–∏–π)
   - RiskManager (–º–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤)
   - –§–∏–ª—å—Ç—Ä—ã (10+ —Ç–∏–ø–æ–≤)
   - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (RSI, MACD, BB, EMA, SMA, ATR)
4. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π —Å –±–∏—Ä–∂–∏
5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Trailing Stop Loss –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
6. –ó–∞–ø—É—Å–∫ WebSocket –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
7. –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
```

### 2. –ì–ª–∞–≤–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª (`orchestrator.run()`)

**–¶–∏–∫–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ ~6 —Å–µ–∫—É–Ω–¥:**

```python
while active:
    for symbol in symbols:  # BTC-USDT, ETH-USDT, SOL-USDT...
        # –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit
        await _check_rate_limit()
        
        # –®–ê–ì 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        await _update_market_data(symbol)
        # - –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–≤–µ—á–µ–π 5m —á–µ—Ä–µ–∑ REST API
        # - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã —á–µ—Ä–µ–∑ WebSocket
        
        # –®–ê–ì 3: –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
        indicators = indicator_manager.calculate_all(candles)
        # - RSI, MACD, Bollinger Bands, EMA, SMA, ATR
        
        # –®–ê–ì 4: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ (ARM)
        regime = regime_manager.detect_regime(candles, current_price)
        # - TRENDING (—Ç—Ä–µ–Ω–¥–æ–≤—ã–π)
        # - RANGING (–±–æ–∫–æ–≤–æ–π)
        # - CHOPPY (—Ö–∞–æ—Ç–∏—á–Ω—ã–π)
        
        # –®–ê–ì 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
        if symbol in active_positions:
            position = active_positions[symbol]
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Trailing Stop Loss
            await _update_trailing_stop_loss(symbol, current_price)
            
            # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è
            await position_manager.manage_position(position)
            # - –ü—Ä–æ–≤–µ—Ä–∫–∞ TP (Take Profit)
            # - –ü—Ä–æ–≤–µ—Ä–∫–∞ SL (Stop Loss)
            # - –ü—Ä–æ–≤–µ—Ä–∫–∞ Trailing SL
            # - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
            
        # –®–ê–ì 6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (–µ—Å–ª–∏ can_trade)
        if can_trade(symbol):
            signal = await signal_generator.generate_signal(
                symbol=symbol,
                indicators=indicators,
                tick=current_price,
                current_positions=active_positions
            )
            
            # –®–ê–ì 7: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            if signal:
                if await _apply_filters(signal):
                    # –®–ê–ì 8: –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
                    await _execute_signal(signal)
        
        # –®–ê–ì 9: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–∫–∞–∂–¥—ã–µ 60 —Å–µ–∫)
        if time.time() - last_stats_time > 60:
            _log_statistics()
```

### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ (`orchestrator.stop()`)

```python
1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ active = False
2. –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
3. –ó–∞–∫—Ä—ã—Ç–∏–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
5. –ó–∞–ø–∏—Å—å —Ñ–∏–Ω–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤
```

---

## üìä –ì–ï–ù–ï–†–ê–¶–ò–Ø –°–ò–ì–ù–ê–õ–û–í

### –ü—Ä–æ—Ü–µ—Å—Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–∞

#### 1. –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**RSI (Relative Strength Index):**
```python
# –ü–µ—Ä–∏–æ–¥: 14 (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
# –ü–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å: RSI > 70
# –ü–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å: RSI < 30

if RSI < 30:
    long_score += 2  # –°–∏–≥–Ω–∞–ª –Ω–∞ –ø–æ–∫—É–ø–∫—É
elif RSI > 70:
    short_score += 2  # –°–∏–≥–Ω–∞–ª –Ω–∞ –ø—Ä–æ–¥–∞–∂—É
```

**MACD (Moving Average Convergence Divergence):**
```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: fast=12, slow=26, signal=9
# –°–∏–≥–Ω–∞–ª BUY: macd_line > signal_line AND histogram > 0
# –°–∏–≥–Ω–∞–ª SELL: macd_line < signal_line AND histogram < 0

if macd_line > signal_line and histogram > 0:
    long_score += 2
elif macd_line < signal_line and histogram < 0:
    short_score += 2
```

**Bollinger Bands:**
```python
# –ü–µ—Ä–∏–æ–¥: 20, —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: 2.0
# –°–∏–≥–Ω–∞–ª BUY: —Ü–µ–Ω–∞ <= –Ω–∏–∂–Ω—è—è –ø–æ–ª–æ—Å–∞
# –°–∏–≥–Ω–∞–ª SELL: —Ü–µ–Ω–∞ >= –≤–µ—Ä—Ö–Ω—è—è –ø–æ–ª–æ—Å–∞

if price <= bb_lower:
    long_score += 2
elif price >= bb_upper:
    short_score += 2
```

**EMA (Exponential Moving Average):**
```python
# EMA_12 –∏ EMA_26
# –°–∏–≥–Ω–∞–ª BUY: EMA_12 > EMA_26 AND —Ü–µ–Ω–∞ > EMA_12
# –°–∏–≥–Ω–∞–ª SELL: EMA_12 < EMA_26 AND —Ü–µ–Ω–∞ < EMA_12

if ema_12 > ema_26 and price > ema_12:
    long_score += 2
elif ema_12 < ema_26 and price < ema_12:
    short_score += 2
```

**ATR (Average True Range):**
```python
# –ü–µ—Ä–∏–æ–¥: 14
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –≤—Ö–æ–¥–∞: 0.0004 (0.04%)
```

#### 2. –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ (Scoring System)

**–ë–∞–∑–æ–≤—ã–µ –±–∞–ª–ª—ã (0-12):**
- SMA Trend: +1 –±–∞–ª–ª
- EMA Trend: +2 –±–∞–ª–ª–∞
- RSI: +2 –±–∞–ª–ª–∞
- Bollinger Bands: +2 –±–∞–ª–ª–∞
- Volume: +2 –±–∞–ª–ª–∞
- MACD: +2 –±–∞–ª–ª–∞

**–ë–æ–Ω—É—Å—ã –æ—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤:**
- Multi-Timeframe: +1-3 –±–∞–ª–ª–∞
- Pivot Points: +1-3 –±–∞–ª–ª–∞
- Volume Profile: +1-3 –±–∞–ª–ª–∞

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ —Ä–µ–∂–∏–º—É):**
- TRENDING: 6/12 –±–∞–ª–ª–æ–≤ (50%)
- RANGING: 4/12 –±–∞–ª–ª–æ–≤ (33%)
- CHOPPY: 7/12 –±–∞–ª–ª–æ–≤ (58%)

#### 3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞

```python
if long_score >= threshold and long_score > short_score:
    signal_direction = "LONG"
    signal_strength = long_score / 12.0
elif short_score >= threshold and short_score > long_score:
    signal_direction = "SHORT"
    signal_strength = short_score / 12.0
else:
    return None  # –°–∏–≥–Ω–∞–ª –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è
```

#### 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤

–ü–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º—É —Ñ–∏–ª—å—Ç—Ä–æ–≤ (—Å–º. —Ä–∞–∑–¥–µ–ª [–°–∏—Å—Ç–µ–º—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏](#—Å–∏—Å—Ç–µ–º—ã-—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏)).

---

## üìù –§–û–†–ú–ò–†–û–í–ê–ù–ò–ï –û–†–î–ï–†–û–í

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞

#### 1. –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ (`risk_manager.calculate_position_size()`)

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –±–∞–ª–∞–Ω—Å–∞:**

**SMALL (< $1,500):**
```python
base_position = $50
min_position = $20
max_position = $120
max_open = 2 –ø–æ–∑–∏—Ü–∏–∏
max_percent = 8% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
```

**MEDIUM ($1,500 - $3,500):**
```python
base_position = $100
min_position = $40
max_position = $200
max_open = 3 –ø–æ–∑–∏—Ü–∏–∏
max_percent = 6% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
```

**LARGE (> $3,500):**
```python
base_position = $200
min_position = $80
max_position = $400
max_open = 3 –ø–æ–∑–∏—Ü–∏–∏
max_percent = 5% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
```

**–†–∞—Å—á–µ—Ç —Å —É—á–µ—Ç–æ–º —Ä–µ–∂–∏–º–∞:**
```python
# –ü–æ–ª—É—á–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –¥–ª—è —Ä–µ–∂–∏–º–∞
regime_profile = get_regime_profile(symbol, regime)

# –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è
base_size = regime_profile.get("base_position", $100)

# –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
atr_percent = calculate_atr_percent(candles, current_price)
volatility_multiplier = calculate_volatility_multiplier(atr_percent, regime)

# –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
position_size = base_size * volatility_multiplier

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
position_size = min(position_size, max_position)
position_size = max(position_size, min_position)
position_size = min(position_size, balance * max_percent)
```

#### 2. –í—ã–±–æ—Ä —Ç–∏–ø–∞ –æ—Ä–¥–µ—Ä–∞

**LIMIT –æ—Ä–¥–µ—Ä (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é):**
```python
# –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
# - –ö–æ–º–∏—Å—Å–∏—è maker: 0.02% (–≤–º–µ—Å—Ç–æ 0.05% taker)
# - –ö–æ–Ω—Ç—Ä–æ–ª—å —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞
# - –≠–∫–æ–Ω–æ–º–∏—è –Ω–∞ –∫–æ–º–∏—Å—Å–∏—è—Ö

# –ê–Ω–∫–æ—Ä –∫ —Å—Ç–∞–∫–∞–Ω—É (—Å–≤–µ–∂–µ—Å—Ç—å <0.5% –æ—Ç current_price):
if side == "LONG":
    ref = best_ask if fresh(best_ask, current_price, 0.5%) else current_price
    base_offset = adaptive_offset_pct or max(offset_percent, 0.01)
    limit_price = ref * (1 + base_offset/100)
    # –ó–∞—â–∏—Ç–∞: –µ—Å–ª–∏ |limit_price - ref| > 0.2% ‚Üí —Å–∂–∏–º–∞–µ–º –¥–æ ref * 1.001
    # –ë–∏—Ä–∂–µ–≤–æ–π –ª–∏–º–∏—Ç: limit_price <= max_buy_price (–∑–∞–ø–∞—Å 0.1‚Äì0.2%)
elif side == "SHORT":
    ref = best_bid if fresh(best_bid, current_price, 0.5%) else current_price
    base_offset = adaptive_offset_pct or max(offset_percent, 0.01)
    limit_price = ref * (1 - base_offset/100)
    # –ó–∞—â–∏—Ç–∞: –µ—Å–ª–∏ |limit_price - ref| > 0.2% ‚Üí —Å–∂–∏–º–∞–µ–º –¥–æ ref * 0.999
    # –ë–∏—Ä–∂–µ–≤–æ–π –ª–∏–º–∏—Ç: limit_price >= min_sell_price (–∑–∞–ø–∞—Å 0.1‚Äì0.2%)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ:
# - spread-aware: –µ—Å–ª–∏ –µ—Å—Ç—å bid/ask, offset –º–æ–∂–µ—Ç –±—Ä–∞—Ç—å—Å—è –∏–∑ —Å–ø—Ä–µ–¥–∞
# - post_only –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞—Ä–µ–≤—à–µ–π —Ü–µ–Ω–µ (>1—Å) –∏–ª–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ >0.5%
# - –û—à–∏–±–∫–∞ 51006: –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –¥–æ –ª–∏–º–∏—Ç–∞ –±–∏—Ä–∂–∏ —Å –∑–∞–ø–∞—Å–æ–º –∏ –ø–æ–≤—Ç–æ—Ä—è–µ–º
# - SHORT slippage: —Ü–µ–Ω–∞ ‚Üë (1 + slippage), —á—Ç–æ–±—ã –Ω–µ —Å—Ç–∞–≤–∏—Ç—å –Ω–∏–∂–µ —Ä—ã–Ω–∫–∞
```

**MARKET –æ—Ä–¥–µ—Ä (fallback):**
```python
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ—Å–ª–∏:
# - –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ü–µ–Ω—É –¥–ª—è LIMIT
# - –°—Ä–æ—á–Ω—ã–π –≤—Ö–æ–¥ (–≤—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)
# - –û—à–∏–±–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è LIMIT –æ—Ä–¥–µ—Ä–∞

# –†–∞–∑–º–µ—â–∞–µ—Ç—Å—è –ø–æ —Ç–µ–∫—É—â–µ–π —Ä—ã–Ω–æ—á–Ω–æ–π —Ü–µ–Ω–µ
```

#### 3. –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –±–∏—Ä–∂–µ (`order_executor.execute_signal()`)

**REST API –∑–∞–ø—Ä–æ—Å:**
```python
POST /api/v5/trade/order

{
    "instId": "BTC-USDT-SWAP",
    "tdMode": "isolated",  # Isolated margin
    "side": "buy",  # –∏–ª–∏ "sell"
    "ordType": "limit",  # –∏–ª–∏ "market"
    "sz": "0.01",  # –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
    "px": "50000.0",  # –¶–µ–Ω–∞ (–¥–ª—è LIMIT)
    "posSide": "long",  # –∏–ª–∏ "short"
    "lever": "5"  # –ü–ª–µ—á–æ
}
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–≤–µ—Ç–∞:**
```python
if order_status == "filled":
    # –û—Ä–¥–µ—Ä –∏—Å–ø–æ–ª–Ω–µ–Ω
    position = create_position(order)
    active_positions[symbol] = position
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Trailing Stop Loss
    trailing_sl.initialize(
        entry_price=order.fill_price,
        side=signal.side,
        symbol=symbol
    )
    
elif order_status == "partially_filled":
    # –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ
    # –ñ–¥–µ–º –ø–æ–ª–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –∏–ª–∏ –æ—Ç–º–µ–Ω—è–µ–º
    
elif order_status == "canceled":
    # –û—Ä–¥–µ—Ä –æ—Ç–º–µ–Ω–µ–Ω
    # –õ–æ–≥–∏—Ä—É–µ–º –ø—Ä–∏—á–∏–Ω—É
```

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–∏–º–∏—Ç–æ–≤ –∏ –∞–≤—Ç–æ-—Ä–µ–ø—Ä–∞–π—Å:**
- –ï—Å–ª–∏ –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä –≤–∏—Å–∏—Ç –∏ –¥—Ä–µ–π—Ñ —Ü–µ–Ω—ã –æ—Ç bid/ask ‚â• 0.2% –¥–æ –Ω–∞—Å—Ç—É–ø–ª–µ–Ω–∏—è —Ç–∞–π–º–∞—É—Ç–∞ ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è amend —Å –Ω–æ–≤–æ–π —Ü–µ–Ω–æ–π (—Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥ ‚â•2—Å, —É—á—ë—Ç –±–∏—Ä–∂–µ–≤—ã—Ö –ª–∏–º–∏—Ç–æ–≤).
- post_only —Ä–µ–ø—Ä–∞–π—Å–∏—Ç—Å—è –∫ —Å—Ç–æ—Ä–æ–Ω–µ maker (BUY –∫ bid, SELL –∫ ask) —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º —Å–º–µ—â–µ–Ω–∏–µ–º; –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ —Ü–µ–Ω–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `calculate_limit_price` (–∞–Ω–∫–æ—Ä –∫ —Å–≤–µ–∂–µ–º—É —Å—Ç–∞–∫–∞–Ω—É, –∑–∞—â–∏—Ç–∞ 0.2%).
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ —Ç–∞–π–º–∞—É—Ç–∞: –æ—Ç–º–µ–Ω–∞ –∏, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ, –∑–∞–º–µ–Ω–∞ –Ω–∞ market; –ø—Ä–∏ —á–∞—Å—Ç–∏—á–Ω–æ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ.

---

## üìà –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–ó–ò–¶–ò–Ø–ú–ò

### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏:**
```python
position = {
    "symbol": "BTC-USDT",
    "side": "long",  # –∏–ª–∏ "short"
    "entry_price": 50000.0,
    "size": 0.01,
    "margin": 100.0,  # –ú–∞—Ä–∂–∞
    "leverage": 5,
    "entry_time": datetime.now(),
    "regime": "trending",  # –†–µ–∂–∏–º –ø—Ä–∏ –≤—Ö–æ–¥–µ
    "trailing_sl": TrailingStopLoss(),
    "tp_percent": 6.0,  # ‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø (24.12.2025): Take Profit % (–±—ã–ª–æ 2.4)
    "sl_percent": 1.2,  # ‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø (24.12.2025): Stop Loss % (–±—ã–ª–æ 1.2, –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    "min_profit_to_close": 0.020,  # ‚úÖ –ù–û–í–û–ï (24.12.2025): –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è (2.0%)
    "min_holding_minutes": 3.0,  # ‚úÖ –ù–û–í–û–ï (24.12.2025): –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è (3 –º–∏–Ω)
    "pnl": 0.0,  # –¢–µ–∫—É—â–∏–π PnL
    "pnl_percent": 0.0  # PnL –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
}
```

### –†–∞—Å—á–µ—Ç PnL (Profit and Loss)

**–î–ª—è LONG –ø–æ–∑–∏—Ü–∏–∏:**
```python
pnl = (current_price - entry_price) * size
pnl_percent = (current_price - entry_price) / entry_price * 100

# –° —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π:
pnl_net = pnl - (entry_price * size * fee_rate) - (current_price * size * fee_rate)
pnl_percent_net = pnl_net / (entry_price * size) * 100
```

**–î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–∏:**
```python
pnl = (entry_price - current_price) * size
pnl_percent = (entry_price - current_price) / entry_price * 100

# –° —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π:
pnl_net = pnl - (entry_price * size * fee_rate) - (current_price * size * fee_rate)
pnl_percent_net = pnl_net / (entry_price * size) * 100
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Trailing Stop Loss

**–õ–æ–≥–∏–∫–∞ –¥–ª—è LONG:**
```python
# –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É
if current_price > highest_price:
    highest_price = current_price
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏–±—ã–ª—å
    profit_pct = (highest_price - entry_price) / entry_price
    
    # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç—Ä–µ–π–ª–∏–Ω–≥ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–∏–±—ã–ª–∏
    if profit_pct < 0.5%:
        trail_multiplier = 1.5x
    elif profit_pct < 1.5%:
        trail_multiplier = 2.0x
    else:
        trail_multiplier = 3.0x
    
    # –ù–æ–≤—ã–π —Å—Ç–æ–ø-–ª–æ—Å—Å
    trailing_sl = highest_price * (1 - initial_trail * trail_multiplier)
    
    # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
    trailing_sl = max(trailing_sl, entry_price * (1 - max_trail))
    trailing_sl = min(trailing_sl, entry_price * (1 - min_trail))
```

**–õ–æ–≥–∏–∫–∞ –¥–ª—è SHORT:**
```python
# –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é —Ü–µ–Ω—É
if current_price < lowest_price:
    lowest_price = current_price
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–∏–±—ã–ª—å
    profit_pct = (entry_price - lowest_price) / entry_price
    
    # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ç—Ä–µ–π–ª–∏–Ω–≥
    # (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ LONG, –Ω–æ –≤ –æ–±—Ä–∞—Ç–Ω—É—é —Å—Ç–æ—Ä–æ–Ω—É)
    
    # –ù–æ–≤—ã–π —Å—Ç–æ–ø-–ª–æ—Å—Å
    trailing_sl = lowest_price * (1 + initial_trail * trail_multiplier)
```

---

## üö™ –ó–ê–ö–†–´–¢–ò–ï –ü–û–ó–ò–¶–ò–ô

### –£—Å–ª–æ–≤–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è

#### 1. Take Profit (TP)

**–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π TP:**
```python
# TP —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏
tp_percent = 5.0%  # ‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø (24.12.2025): –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 2.0% –¥–æ 5.0% - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7%

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
if pnl_percent >= tp_percent:
    await close_position(symbol, reason="tp")
```

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π TP –ø–æ —Ä–µ–∂–∏–º—É (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025):**
- TRENDING: 6.0% (–±—ã–ª–æ 2.5%) - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7%
- RANGING: 5.0% (–±—ã–ª–æ 1.8%) - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7%
- CHOPPY: 4.5% (–±—ã–ª–æ 1.8%) - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7%

**–ü–æ —Å–∏–º–≤–æ–ª–∞–º (–ø—Ä–∏–º–µ—Ä—ã):**
- BTC-USDT trending: 6.0%
- BTC-USDT ranging: 5.5%
- ETH-USDT trending: 6.0%
- SOL-USDT trending: 6.0%
- DOGE-USDT trending: 6.0%
- XRP-USDT trending: 5.0%

#### 2. Stop Loss (SL)

**–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π SL:**
```python
# SL —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏
sl_percent = 1.0%  # ‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø (24.12.2025): –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.8% –¥–æ 1.0% - –±–∞–ª–∞–Ω—Å —Å –Ω–æ–≤—ã–º TP

# –ü—Ä–æ–≤–µ—Ä–∫–∞:
if pnl_percent <= -sl_percent:
    await close_position(symbol, reason="sl")
```

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π SL –ø–æ —Ä–µ–∂–∏–º—É (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025):**
- TRENDING: 1.2% (–±—ã–ª–æ 0.8%) - –±–∞–ª–∞–Ω—Å —Å –Ω–æ–≤—ã–º TP
- RANGING: 1.0% (–±—ã–ª–æ 0.8%) - –±–∞–ª–∞–Ω—Å —Å –Ω–æ–≤—ã–º TP
- CHOPPY: 1.2% (–±—ã–ª–æ 1.0%) - –±–∞–ª–∞–Ω—Å —Å –Ω–æ–≤—ã–º TP

#### 3. Trailing Stop Loss (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025)

**–õ–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è:**
```python
# –î–ª—è LONG:
if current_price <= trailing_sl:
    await close_position(symbol, reason="trailing_sl")

# –î–ª—è SHORT:
if current_price >= trailing_sl:
    await close_position(symbol, reason="trailing_sl")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã TSL (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025):**
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π: `initial_trail: 0.025` (2.5%, –±—ã–ª–æ 1.5%) - –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ
- TRENDING: `initial_trail: 0.020` (2.0%, –±—ã–ª–æ 1.2%)
- RANGING: `initial_trail: 0.030` (3.0%, –±—ã–ª–æ 2.0%)
- CHOPPY: `initial_trail: 0.030` (3.0%, –±—ã–ª–æ 2.5%)
- `max_trail: 0.050` (5.0%, –±—ã–ª–æ 3.5%) - –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è —Ä–æ—Å—Ç–∞
- `min_trail: 0.010` (1.0%, –±—ã–ª–æ 0.5%) - –∑–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–Ω–Ω–∏—Ö –∑–∞–∫—Ä—ã—Ç–∏–π
- `min_profit_to_activate: 0.015` (1.5%, –±—ã–ª–æ 0.8%) - –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ –±–æ–ª—å—à–µ–≥–æ –ø—Ä–æ—Ñ–∏—Ç–∞

#### 4. Partial Take Profit

**–ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ:**
```python
# –¢—Ä–∏–≥–≥–µ—Ä: –ø—Ä–∏–±—ã–ª—å –¥–æ—Å—Ç–∏–≥–ª–∞ trigger_percent
if pnl_percent >= trigger_percent:
    # –ó–∞–∫—Ä—ã–≤–∞–µ–º —á–∞—Å—Ç—å –ø–æ–∑–∏—Ü–∏–∏
    close_size = position_size * fraction
    
    # –ê–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É:
    # - TRENDING: 50% –ø—Ä–∏ 0.5%
    # - RANGING: 60% –ø—Ä–∏ 0.6%
    # - CHOPPY: 70% –ø—Ä–∏ 0.3%
    
    await close_position_partial(symbol, close_size, reason="partial_tp")
```

#### 5. Time Stop

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025):**
```python
# –ê–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É:
# - –ì–ª–æ–±–∞–ª—å–Ω—ã–π: 1.0 –º–∏–Ω—É—Ç–∞
# - TRENDING: 3.0 –º–∏–Ω—É—Ç—ã (–±—ã–ª–æ 2.0)
# - RANGING: 1.0 –º–∏–Ω—É—Ç–∞ (–±—ã–ª–æ 0.2)
# - CHOPPY: 1.0 –º–∏–Ω—É—Ç–∞ (–±—ã–ª–æ 0.3)

holding_time = current_time - entry_time
if holding_time < min_holding_time:
    # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω—å—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
    return
```

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è (‚úÖ –û–ë–ù–û–í–õ–ï–ù–û 24.12.2025):**
```python
# –ê–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É:
# - TRENDING: 40 –º–∏–Ω—É—Ç (–±—ã–ª–æ 45)
# - RANGING: 25 –º–∏–Ω—É—Ç (–±—ã–ª–æ 12)
# - CHOPPY: 14 –º–∏–Ω—É—Ç (–±—ã–ª–æ 30)

holding_time = current_time - entry_time
if holding_time > max_holding_time:
    await close_position(symbol, reason="time_stop")
```

#### 5.1. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ñ–∏—Ç –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è (‚úÖ –ù–û–í–û–ï 24.12.2025)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π —Å –º–∏–∫—Ä–æ–ø—Ä–∏–±—ã–ª—å—é (–Ω–µ –ø–æ–∫—Ä—ã–≤–∞—é—â–µ–π –∫–æ–º–∏—Å—Å–∏–∏).

```python
# –ê–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É:
# - –ì–ª–æ–±–∞–ª—å–Ω—ã–π: 1.5% (–±—ã–ª–æ 0.1%)
# - TRENDING: 2.0% (–±—ã–ª–æ 1.0%)
# - RANGING: 3.0% (–±—ã–ª–æ 2.5%)
# - CHOPPY: 2.0% (–±—ã–ª–æ 1.0%)

if pnl_percent < min_profit_to_close:
    # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Å –º–∏–∫—Ä–æ–ø—Ä–∏–±—ã–ª—å—é
    return
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- –ò—Å–∫–ª—é—á–µ–Ω—ã —Å–¥–µ–ª–∫–∏ —Å –º–∏–∫—Ä–æ–ø—Ä–∏–±—ã–ª—å—é (–º–∏–Ω–∏–º—É–º 1.5-3.0%)
- –ü–æ–∑–∏—Ü–∏–∏ –¥–µ—Ä–∂–∞—Ç—Å—è –¥–æ–ª—å—à–µ –¥–ª—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏

#### 6. Break-even Stop Loss

**–ó–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏:**
```python
# –ü–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 1.0 ATR –ø—Ä–∏–±—ã–ª–∏
if pnl_percent >= 1.0 * atr_percent:
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º SL –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—Ö–æ–¥–∞ (break-even)
    sl_price = entry_price
    # –ó–∞—â–∏—â–∞–µ–º –æ—Ç —É–±—ã—Ç–∫–∞
```

### –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–∫—Ä—ã—Ç–∏—è

```python
async def close_position(symbol: str, reason: str):
    # –®–ê–ì 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
    position = active_positions.get(symbol)
    if not position:
        return
    
    # –®–ê–ì 2: –†–∞–∑–º–µ—â–µ–Ω–∏–µ MARKET –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ
    if position.side == "long":
        close_side = "sell"
    else:
        close_side = "buy"
    
    order = await client.place_order(
        symbol=symbol,
        side=close_side,
        order_type="market",
        quantity=position.size
    )
    
    # –®–ê–ì 3: –û–∂–∏–¥–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
    await wait_for_order_fill(order)
    
    # –®–ê–ì 4: –†–∞—Å—á–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ PnL
    final_pnl = calculate_pnl(position, order.fill_price)
    
    # –®–ê–ì 5: –ó–∞–ø–∏—Å—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    trading_statistics.record_trade(
        symbol=symbol,
        side=position.side,
        pnl=final_pnl,
        reason=reason
    )
    
    # –®–ê–ì 6: –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
    del active_positions[symbol]
    
    # –®–ê–ì 7: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
    logger.info(f"‚úÖ –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞: {symbol} | –ü—Ä–∏—á–∏–Ω–∞: {reason} | PnL: {final_pnl:.2f}%")
```

---

## üîç –°–ò–°–¢–ï–ú–´ –§–ò–õ–¨–¢–†–ê–¶–ò–ò

### –¢–∏–ø—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤

#### 1. Correlation Filter (–§–∏–ª—å—Ç—Ä –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π –≤ —Å–∏–ª—å–Ω–æ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞—Ö.

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏
correlation = calculate_correlation(symbol1, symbol2)

# –ï—Å–ª–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è > 0.7 –∏ —É–∂–µ –µ—Å—Ç—å –ø–æ–∑–∏—Ü–∏—è –≤ –æ–¥–Ω–æ–π –ø–∞—Ä–µ
if correlation > 0.7 and has_position(symbol1):
    if same_direction(symbol1, symbol2):
        block_signal(symbol2, reason="high_correlation")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `correlation_threshold: 0.7` - –ü–æ—Ä–æ–≥ –≤—ã—Å–æ–∫–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- `max_correlated_positions: 1` - –ú–∞–∫—Å–∏–º—É–º –ø–æ–∑–∏—Ü–∏–π –≤ –∫–æ—Ä—Ä–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞—Ö
- `block_same_direction_only: true` - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### 2. Multi-Timeframe Filter (–ú—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º —Ñ–∏–ª—å—Ç—Ä)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–∏–≥–Ω–∞–ª –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö.

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö
timeframes = ["5m", "15m", "1h"]

for tf in timeframes:
    candles_tf = get_candles(symbol, tf)
    indicators_tf = calculate_indicators(candles_tf)
    
    if confirm_signal(indicators_tf, direction):
        confirmation_score += 1

# –ú–∏–Ω–∏–º—É–º 2 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–∑ 3
if confirmation_score >= 2:
    allow_signal()
else:
    block_signal(reason="insufficient_timeframe_confirmation")
```

**–ë–æ–Ω—É—Å—ã:**
- 1 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: +1 –±–∞–ª–ª
- 2 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: +2 –±–∞–ª–ª–∞
- 3 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è: +3 –±–∞–ª–ª–∞

#### 3. ADX Filter (–§–∏–ª—å—Ç—Ä —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–ª–∞–±—ã–µ —Ç—Ä–µ–Ω–¥—ã.

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç ADX (Average Directional Index)
adx = calculate_adx(candles, period=14)

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ø–æ—Ä–æ–≥ –ø–æ —Ä–µ–∂–∏–º—É:
# - TRENDING: ADX > 25
# - RANGING: ADX > 20
# - CHOPPY: ADX > 25

if adx < threshold:
    block_signal(reason="weak_trend_strength")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (+DI vs -DI)
if direction == "LONG" and di_plus < di_minus + di_difference:
    block_signal(reason="wrong_trend_direction")
```

**–ê–∫—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (08.01.2026):**
- +DM –∏ -DM –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –≤–∑–∞–∏–º–æ–∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ (–±–µ—Ä—ë–º –¥–æ–º–∏–Ω–∏—Ä—É—é—â–µ–µ –¥–≤–∏–∂–µ–Ω–∏–µ –±–∞—Ä–∞), —á—Ç–æ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç +DI/-DI –∏ –∏—Å–∫–ª—é—á–∞–µ—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤—Å–ø–ª–µ—Å–∫–∏.
- –ü–æ—Å–ª–µ fallback-—Ä–∞—Å—á—ë—Ç–∞ ADX/+DI/-DI —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ DataRegistry, —á—Ç–æ–±—ã downstream-–º–æ–¥—É–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `adx_threshold: 25.0` - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞
- `di_difference: 1.5` - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É +DI –∏ -DI
- `adx_period: 14` - –ü–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ ADX

#### 4. Pivot Points Filter (–§–∏–ª—å—Ç—Ä —Ç–æ—á–µ–∫ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è.

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç Pivot Points
pivot = (high + low + close) / 3
resistance = 2 * pivot - low
support = 2 * pivot - high

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–∏–∑–æ—Å—Ç–∏ –∫ —É—Ä–æ–≤–Ω—è–º
if direction == "LONG":
    if price <= support * 1.002:  # –í –ø—Ä–µ–¥–µ–ª–∞—Ö 0.2% –æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏
        allow_signal()
        bonus_score += 2
elif direction == "SHORT":
    if price >= resistance * 0.998:  # –í –ø—Ä–µ–¥–µ–ª–∞—Ö 0.2% –æ—Ç —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
        allow_signal()
        bonus_score += 2
```

**–ë–æ–Ω—É—Å—ã:**
- TRENDING: +1-2 –±–∞–ª–ª–∞ √ó 1.5
- RANGING: +2 –±–∞–ª–ª–∞ √ó 1.5
- CHOPPY: +3 –±–∞–ª–ª–∞ √ó 2.0

#### 5. Volume Profile Filter (–§–∏–ª—å—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è –æ–±—ä–µ–º–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä–µ–º–∞ –ø–æ —Ü–µ–Ω–∞–º.

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç Volume Profile
volume_profile = calculate_volume_profile(candles)

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–æ–Ω –≤—ã—Å–æ–∫–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
high_volume_zones = get_high_volume_zones(volume_profile)

if price in high_volume_zones:
    allow_signal()
    bonus_score += 2
```

**–ë–æ–Ω—É—Å—ã:**
- TRENDING: +1-2 –±–∞–ª–ª–∞ √ó 1.0
- RANGING: +2 –±–∞–ª–ª–∞ √ó 1.5
- CHOPPY: +3 –±–∞–ª–ª–∞ √ó 2.0

#### 6. Funding Rate Filter (–§–∏–ª—å—Ç—Ä funding rate)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—á–∏—Ç—ã–≤–∞–µ—Ç funding rate –¥–ª—è Futures.

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ funding rate
funding_rate = await client.get_funding_rate(symbol)

# –î–ª—è LONG: –∏–∑–±–µ–≥–∞–µ–º –≤—ã—Å–æ–∫–∏–π –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π funding
if direction == "LONG" and funding_rate > 0.01:  # > 1%
    block_signal(reason="high_funding_rate_long")

# –î–ª—è SHORT: –∏–∑–±–µ–≥–∞–µ–º –≤—ã—Å–æ–∫–∏–π –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π funding
if direction == "SHORT" and funding_rate < -0.01:  # < -1%
    block_signal(reason="high_funding_rate_short")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_funding_rate: 0.01` - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π funding rate (1%)

#### 7. Liquidity Filter (–§–∏–ª—å—Ç—Ä –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ order book
order_book = await client.get_order_book(symbol)

# –†–∞—Å—á–µ—Ç –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö 0.5% –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
liquidity = calculate_liquidity(order_book, price_range=0.005)

# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å: $10,000
if liquidity < 10000:
    block_signal(reason="insufficient_liquidity")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `min_liquidity: 10000` - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å (USD)

#### 8. Order Flow Filter (–§–∏–ª—å—Ç—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫ –ø–æ–∫—É–ø–æ–∫/–ø—Ä–æ–¥–∞–∂.

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Å–¥–µ–ª–∫–∞—Ö
trades = await client.get_recent_trades(symbol)

# –†–∞—Å—á–µ—Ç –ø–æ—Ç–æ–∫–∞
buy_volume = sum(t.volume for t in trades if t.side == "buy")
sell_volume = sum(t.volume for t in trades if t.side == "sell")

# –î–ª—è LONG: –Ω—É–∂–µ–Ω –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—â–∏–π –ø–æ—Ç–æ–∫ –ø–æ–∫—É–ø–æ–∫
if direction == "LONG":
    if buy_volume < sell_volume * 1.2:  # –ü–æ–∫—É–ø–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞ 20% –±–æ–ª—å—à–µ
        block_signal(reason="weak_buy_pressure")
```

#### 9. Volatility Regime Filter (–§–∏–ª—å—Ç—Ä —Ä–µ–∂–∏–º–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å.

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (ATR %)
atr_percent = calculate_atr_percent(candles, current_price)

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
if atr_percent < 0.01:  # < 1%
    volatility_regime = "low"
elif atr_percent > 0.03:  # > 3%
    volatility_regime = "high"
else:
    volatility_regime = "normal"

# –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
if volatility_regime == "low":
    # –£–º–µ–Ω—å—à–∞–µ–º —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
    position_size *= 0.5
elif volatility_regime == "high":
    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º SL
    sl_percent *= 1.5
```

#### 10. Momentum Filter (–§–∏–ª—å—Ç—Ä –∏–º–ø—É–ª—å—Å–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏–ª—É –∏–º–ø—É–ª—å—Å–∞ –¥–≤–∏–∂–µ–Ω–∏—è.

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç –∏–º–ø—É–ª—å—Å–∞ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –∑–∞ –ø–µ—Ä–∏–æ–¥)
momentum = (current_price - price_n_periods_ago) / price_n_periods_ago

# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–º–ø—É–ª—å—Å: 0.2%
if abs(momentum) < 0.002:
    block_signal(reason="weak_momentum")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
if direction == "LONG" and momentum < 0:
    block_signal(reason="negative_momentum")
```

#### 11. Time Filter (–§–∏–ª—å—Ç—Ä –≤—Ä–µ–º–µ–Ω–∏)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¢–æ—Ä–≥–æ–≤–ª—è –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

**–õ–æ–≥–∏–∫–∞:**
```python
# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏
current_hour = datetime.utcnow().hour

# –ê–∑–∏–∞—Ç—Å–∫–∞—è —Å–µ—Å—Å–∏—è: 00:00-09:00 UTC
# –ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è —Å–µ—Å—Å–∏—è: 07:00-16:00 UTC
# –ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∞—è —Å–µ—Å—Å–∏—è: 13:00-22:00 UTC

if not is_trading_session(current_hour):
    block_signal(reason="outside_trading_hours")
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç–∫–ª—é—á–µ–Ω (–∫—Ä–∏–ø—Ç–∞ —Ç–æ—Ä–≥—É–µ—Ç—Å—è 24/7).

#### 12. Balance Checker (–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å –±–∞–ª–∞–Ω—Å–∞.

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
balance = await client.get_balance()

# –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å: $50
if balance < 50:
    block_signal(reason="insufficient_balance")

# –†–µ–∑–µ—Ä–≤: 10% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
reserve = balance * 0.1
available = balance - reserve

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏
if position_size > available:
    block_signal(reason="insufficient_available_balance")
```

---

## üõ°Ô∏è –°–ò–°–¢–ï–ú–´ –ó–ê–©–ò–¢–´

### –ó–∞—â–∏—Ç—ã –æ—Ç —Ä–∏—Å–∫–æ–≤

#### 1. Consecutive Losses Protection (–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É–±—ã—Ç–∫–æ–≤)

**–õ–æ–≥–∏–∫–∞:**
```python
# –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É–±—ã—Ç–∫–æ–≤
if trade.pnl < 0:
    consecutive_losses += 1
else:
    consecutive_losses = 0

# –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–¥—Ä—è–¥ —É–±—ã—Ç–∫–∞ ‚Üí STOP
if consecutive_losses >= 3:
    emergency_stop()
    block_all_trading()
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_consecutive_losses: 3` - –ú–∞–∫—Å–∏–º—É–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É–±—ã—Ç–∫–æ–≤

#### 2. Daily Loss Limit (–î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç —É–±—ã—Ç–∫–æ–≤)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç –¥–Ω–µ–≤–Ω–æ–≥–æ PnL
daily_pnl = sum(trade.pnl for trade in today_trades)

# –õ–∏–º–∏—Ç: 10% –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
if daily_pnl <= -initial_balance * 0.10:
    emergency_stop()
    block_all_trading()
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `daily_loss_limit: 0.10` - 10% –æ—Ç –±–∞–ª–∞–Ω—Å–∞

#### 3. Daily Profit Lock (–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–Ω–µ–≤–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç –¥–Ω–µ–≤–Ω–æ–≥–æ PnL
daily_pnl = sum(trade.pnl for trade in today_trades)

# –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ +5% –ø—Ä–∏–±—ã–ª–∏
if daily_pnl >= initial_balance * 0.05:
    stop_trading()
    logger.info("‚úÖ –î–Ω–µ–≤–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞: +5%")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `daily_profit_lock: 0.05` - 5% –æ—Ç –±–∞–ª–∞–Ω—Å–∞

#### 4. Max Open Positions (–ú–∞–∫—Å–∏–º—É–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π)

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü–æ–¥—Å—á–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
open_positions_count = len(active_positions)

# –ú–∞–∫—Å–∏–º—É–º: 3 –ø–æ–∑–∏—Ü–∏–∏
if open_positions_count >= 3:
    block_new_signals(reason="max_positions_reached")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_open_positions: 3` - –ú–∞–∫—Å–∏–º—É–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π

#### 5. Max Position Size (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
position_size = calculate_position_size(...)

# –ú–∞–∫—Å–∏–º—É–º: 5% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
max_size = balance * 0.05

if position_size > max_size:
    position_size = max_size
    logger.warning("‚ö†Ô∏è –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ 5%")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_position_size_percent: 0.05` - 5% –æ—Ç –±–∞–ª–∞–Ω—Å–∞

#### 6. Max Loss per Trade (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Ç–µ—Ä—è –Ω–∞ —Å–¥–µ–ª–∫—É)

**–õ–æ–≥–∏–∫–∞:**
```python
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Ç–µ—Ä—è: 2% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
max_loss = balance * 0.02

# –†–∞—Å—á–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
# –ï—Å–ª–∏ SL = 1.2%, —Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä:
max_position = max_loss / 0.012

if position_size > max_position:
    position_size = max_position
    logger.warning("‚ö†Ô∏è –†–∞–∑–º–µ—Ä –æ–≥—Ä–∞–Ω–∏—á–µ–Ω max_loss_per_trade")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_loss_per_trade: 0.02` - 2% –æ—Ç –±–∞–ª–∞–Ω—Å–∞

#### 7. Max Margin Used (–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞—Ä–∂–∏)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ä–∂–∏
used_margin = sum(pos.margin for pos in active_positions.values())

# –ú–∞–∫—Å–∏–º—É–º: 80% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
max_margin = balance * 0.80

if used_margin + new_position_margin > max_margin:
    block_signal(reason="max_margin_reached")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_margin_percent: 0.80` - 80% –æ—Ç –±–∞–ª–∞–Ω—Å–∞

#### 8. Drawdown Protection (–ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∞–¥–∫–∏)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç –ø—Ä–æ—Å–∞–¥–∫–∏
drawdown = (initial_balance - current_balance) / initial_balance

# –ú–∞–∫—Å–∏–º—É–º: 5% –ø—Ä–æ—Å–∞–¥–∫–∏
if drawdown > 0.05:
    emergency_stop()
    close_all_positions()
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_drawdown: 0.05` - 5% –ø—Ä–æ—Å–∞–¥–∫–∏

### –ó–∞—â–∏—Ç—ã –ø–æ–∑–∏—Ü–∏–π

#### 9. Break-even Stop Loss

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü–æ—Å–ª–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è 1.0 ATR –ø—Ä–∏–±—ã–ª–∏
if pnl_percent >= 1.0 * atr_percent:
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º SL –Ω–∞ —É—Ä–æ–≤–µ–Ω—å –≤—Ö–æ–¥–∞
    sl_price = entry_price
    # –ó–∞—â–∏—â–∞–µ–º –æ—Ç —É–±—ã—Ç–∫–∞
```

#### 10. Trailing Stop Loss

**–û–ø–∏—Å–∞–Ω–∏–µ:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å—Ç–æ–ø-–ª–æ—Å—Å –ø–æ–¥ –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã (—Å–º. —Ä–∞–∑–¥–µ–ª [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–ø–æ–∑–∏—Ü–∏—è–º–∏)).

#### 11. Partial Take Profit

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ø—Ä–∏–±—ã–ª–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª [–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π](#–∑–∞–∫—Ä—ã—Ç–∏–µ-–ø–æ–∑–∏—Ü–∏–π)).

#### 12. Time Stop

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ (—Å–º. —Ä–∞–∑–¥–µ–ª [–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π](#–∑–∞–∫—Ä—ã—Ç–∏–µ-–ø–æ–∑–∏—Ü–∏–π)).

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∑–∞—â–∏—Ç—ã

#### 13. Spread Filter (–§–∏–ª—å—Ç—Ä —Å–ø—Ä–µ–¥–∞)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç —Å–ø—Ä–µ–¥–∞
spread = (ask_price - bid_price) / bid_price

# –ú–∞–∫—Å–∏–º—É–º: 0.1%
if spread > 0.001:
    block_signal(reason="spread_too_wide")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_spread: 0.001` - 0.1% —Å–ø—Ä–µ–¥–∞

#### 14. Min Order Value (–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ—Ä–¥–µ—Ä–∞)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –æ—Ä–¥–µ—Ä–∞
order_value = position_size * current_price

# –ú–∏–Ω–∏–º—É–º: $30
if order_value < 30:
    block_signal(reason="order_value_too_small")
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `min_order_value: 30` - $30 USD

#### 15. Rate Limiting (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤)

**–õ–æ–≥–∏–∫–∞:**
```python
# –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
requests_count = count_requests_in_last_minute()

# –ú–∞–∫—Å–∏–º—É–º: 60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É
if requests_count >= 60:
    wait_until_rate_limit_reset()
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_requests_per_minute: 60` - 60 –∑–∞–ø—Ä–æ—Å–æ–≤/–º–∏–Ω—É—Ç—É

#### 16. Slippage Guard (–ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è)

**–õ–æ–≥–∏–∫–∞:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è –ø—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏
expected_price = signal.price
actual_price = order.fill_price

slippage = abs(actual_price - expected_price) / expected_price

# –ú–∞–∫—Å–∏–º—É–º: 0.2% –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è
if slippage > 0.002:
    logger.warning(f"‚ö†Ô∏è –í—ã—Å–æ–∫–æ–µ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ: {slippage:.2%}")
    # –õ–æ–≥–∏—Ä—É–µ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `max_slippage: 0.002` - 0.2% –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è

#### 17. Liquidation Protector (–ó–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏)

**–õ–æ–≥–∏–∫–∞:**
```python
# –†–∞—Å—á–µ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–Ω—ã
liquidation_price = calculate_liquidation_price(position)

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ: 5% –æ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
safe_distance = current_price * 0.05

if abs(current_price - liquidation_price) < safe_distance:
    logger.warning("‚ö†Ô∏è –ë–ª–∏–∑–∫–æ –∫ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏!")
    # –†–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `liquidation_safety_distance: 0.05` - 5% –æ—Ç —Ü–µ–Ω—ã

---

## üßÆ –†–ê–°–ß–ï–¢–´ –ò –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê

### –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏

**–ë–∞–∑–æ–≤–∞—è —Ñ–æ—Ä–º—É–ª–∞:**
```python
# 1. –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –±–∞–ª–∞–Ω—Å–∞
base_size = get_base_size_from_profile(balance)

# 2. –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
atr_percent = calculate_atr_percent(candles, price)
volatility_multiplier = calculate_volatility_multiplier(atr_percent, regime)

# 3. –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
position_size = base_size * volatility_multiplier

# 4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
position_size = min(position_size, max_position)
position_size = max(position_size, min_position)
position_size = min(position_size, balance * max_percent)
position_size = min(position_size, max_loss / sl_percent)
```

**–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å:**
```python
# –ë–∞–∑–æ–≤—ã–π ATR % –¥–ª—è —Ä–µ–∂–∏–º–∞
base_atr = regime_profile.base_atr_percent

# –¢–µ–∫—É—â–∏–π ATR %
current_atr = calculate_atr_percent(candles, price)

# –ú–Ω–æ–∂–∏—Ç–µ–ª—å
if current_atr < base_atr * 0.5:
    multiplier = min_multiplier  # 0.5x
elif current_atr > base_atr * 1.5:
    multiplier = max_multiplier  # 1.5x
else:
    multiplier = 1.0 + (current_atr / base_atr - 1.0) * 0.5
```

### –†–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏

**–î–ª—è Futures —Å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ä–∂–æ–π:**
```python
# –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –≤ USD
position_value = position_size * entry_price

# –ú–∞—Ä–∂–∞ —Å —É—á–µ—Ç–æ–º –ø–ª–µ—á–∞
margin_required = position_value / leverage

# Maintenance margin (–¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏)
maintenance_margin = position_value * maintenance_margin_ratio

# Initial margin (—Ç—Ä–µ–±—É–µ–º–∞—è –º–∞—Ä–∂–∞)
initial_margin = position_value * initial_margin_ratio

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
margin = max(margin_required, initial_margin)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `leverage: 5` - –ü–ª–µ—á–æ
- `maintenance_margin_ratio: 0.01` - 1% maintenance margin
- `initial_margin_ratio: 0.20` - 20% initial margin (–¥–ª—è 5x –ø–ª–µ—á–∞)

### –†–∞—Å—á–µ—Ç PnL

**–î–ª—è LONG –ø–æ–∑–∏—Ü–∏–∏:**
```python
# –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å
gross_pnl = (exit_price - entry_price) * size

# –ö–æ–º–∏—Å—Å–∏–∏
entry_fee = entry_price * size * fee_rate
exit_fee = exit_price * size * fee_rate
total_fees = entry_fee + exit_fee

# –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å
net_pnl = gross_pnl - total_fees

# PnL –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
pnl_percent = net_pnl / (entry_price * size) * 100
```

**–î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–∏:**
```python
# –í–∞–ª–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å
gross_pnl = (entry_price - exit_price) * size

# –ö–æ–º–∏—Å—Å–∏–∏ (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ)
total_fees = (entry_price + exit_price) * size * fee_rate

# –ß–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å
net_pnl = gross_pnl - total_fees

# PnL –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
pnl_percent = net_pnl / (entry_price * size) * 100
```

### –†–∞—Å—á–µ—Ç Trailing Stop Loss

**–î–ª—è LONG:**
```python
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
highest_price = max(highest_price, current_price)

# –ü—Ä–∏–±—ã–ª—å
profit_pct = (highest_price - entry_price) / entry_price

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å —Ç—Ä–µ–π–ª–∏–Ω–≥–∞
if profit_pct < 0.005:  # < 0.5%
    multiplier = 1.5
elif profit_pct < 0.015:  # 0.5-1.5%
    multiplier = 2.0
else:  # > 1.5%
    multiplier = 3.0

# –¢–µ–∫—É—â–∏–π —Ç—Ä–µ–π–ª–∏–Ω–≥
current_trail = initial_trail + profit_pct * multiplier
current_trail = min(current_trail, max_trail)
current_trail = max(current_trail, min_trail)

# –¶–µ–Ω–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
trailing_sl_price = highest_price * (1 - current_trail)
```

**–î–ª—è SHORT:**
```python
# –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞
lowest_price = min(lowest_price, current_price)

# –ü—Ä–∏–±—ã–ª—å
profit_pct = (entry_price - lowest_price) / entry_price

# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ)

# –¶–µ–Ω–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
trailing_sl_price = lowest_price * (1 + current_trail)
```

### –†–∞—Å—á–µ—Ç ATR (Average True Range)

**–§–æ—Ä–º—É–ª–∞:**
```python
# True Range –¥–ª—è –∫–∞–∂–¥–æ–π —Å–≤–µ—á–∏
true_range = max(
    high - low,  # –†–∞–∑–Ω–∏—Ü–∞ High –∏ Low
    abs(high - prev_close),  # –†–∞–∑–Ω–∏—Ü–∞ High –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ Close
    abs(low - prev_close)  # –†–∞–∑–Ω–∏—Ü–∞ Low –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ Close
)

# ATR = —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ True Range –∑–∞ –ø–µ—Ä–∏–æ–¥
atr = sum(true_ranges[-period:]) / period

# ATR –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç —Ü–µ–Ω—ã
atr_percent = atr / current_price
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `atr_period: 14` - –ü–µ—Ä–∏–æ–¥ —Ä–∞—Å—á–µ—Ç–∞ ATR

### –†–∞—Å—á–µ—Ç RSI (Relative Strength Index)

**–§–æ—Ä–º—É–ª–∞ (Wilder's Method):**
```python
# –®–∞–≥ 1: –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ü–µ–Ω—ã
deltas = [price[i] - price[i-1] for i in range(1, len(price))]

# –®–∞–≥ 2: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–±—ã–ª–∏ –∏ —É–±—ã—Ç–∫–∏
gains = [delta if delta > 0 else 0 for delta in deltas]
losses = [-delta if delta < 0 else 0 for delta in deltas]

# –®–∞–≥ 3: –ü–µ—Ä–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ - –ø—Ä–æ—Å—Ç–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ –ø–µ—Ä–∏–æ–¥
if len(gains) >= period:
    avg_gain = sum(gains[-period:]) / period
    avg_loss = sum(losses[-period:]) / period
    
    # –®–∞–≥ 4: –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ Wilder –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
    # –§–æ—Ä–º—É–ª–∞ Wilder: EMA = (prev_EMA * (period - 1) + current) / period
    for i in range(period, len(gains)):
        avg_gain = (avg_gain * (period - 1) + gains[i]) / period
        avg_loss = (avg_loss * (period - 1) + losses[i]) / period
else:
    avg_gain = 0
    avg_loss = 0

# –®–∞–≥ 5: Relative Strength
rs = avg_gain / avg_loss if avg_loss > 0 else float('inf')

# –®–∞–≥ 6: RSI
rsi = 100 - (100 / (1 + rs))
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º–∞–º:**
- **TRENDING:** `overbought=85, oversold=25` (–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ –ø–æ—Ä–æ–≥–∏)
- **RANGING:** `overbought=70, oversold=30` (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ)
- **CHOPPY:** `overbought=65, oversold=35` (–±–æ–ª–µ–µ –º—è–≥–∫–∏–µ)
- **–ü–µ—Ä–∏–æ–¥:** `rsi_period: 14` (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)

### –†–∞—Å—á–µ—Ç MACD (Moving Average Convergence Divergence)

**–§–æ—Ä–º—É–ª–∞:**
```python
# –®–∞–≥ 1: –ë—ã—Å—Ç—Ä–∞—è EMA
ema_fast = EMA(close, period=fast_period)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 12

# –®–∞–≥ 2: –ú–µ–¥–ª–µ–Ω–Ω–∞—è EMA
ema_slow = EMA(close, period=slow_period)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 26

# –®–∞–≥ 3: MACD Line
macd_line = ema_fast - ema_slow

# –®–∞–≥ 4: Signal Line (EMA –æ—Ç MACD Line)
signal_line = EMA(macd_line, period=signal_period)  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: 9

# –®–∞–≥ 5: Histogram
histogram = macd_line - signal_line

# –®–∞–≥ 6: MACD Strength (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏–ª–∞)
macd_strength = abs(histogram) / abs(macd_line) if macd_line != 0 else 0
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º–∞–º:**
- **TRENDING:** `fast=19, slow=39, signal=9` (–±–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–ª—è —Ç—Ä–µ–Ω–¥–∞)
- **RANGING:** `fast=12, slow=26, signal=9` (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ)
- **CHOPPY:** `fast=8, slow=21, signal=9` (–±–æ–ª–µ–µ –±—ã—Å—Ç—Ä—ã–µ –¥–ª—è —Ö–∞–æ—Å–∞)

### –†–∞—Å—á–µ—Ç EMA (Exponential Moving Average)

**–§–æ—Ä–º—É–ª–∞:**
```python
# Alpha (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è)
alpha = 2 / (period + 1)

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è: EMA[0] = Price[0]
ema[0] = prices[0]

# –†–µ–∫—É—Ä—Ä–µ–Ω—Ç–Ω–∞—è —Ñ–æ—Ä–º—É–ª–∞
for i in range(1, len(prices)):
    ema[i] = prices[i] * alpha + ema[i-1] * (1 - alpha)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **Fast EMA:** `period=8` (trending), `period=12` (ranging), `period=8` (choppy)
- **Slow EMA:** `period=21` (trending), `period=26` (ranging), `period=21` (choppy)

### –†–∞—Å—á–µ—Ç SMA (Simple Moving Average)

**–§–æ—Ä–º—É–ª–∞:**
```python
# –ü—Ä–æ—Å—Ç–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ
sma = sum(prices[-period:]) / period
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **Fast SMA:** `period=8` (trending), `period=10` (ranging), `period=8` (choppy)
- **Slow SMA:** `period=21` (trending), `period=20` (ranging), `period=21` (choppy)

### –†–∞—Å—á–µ—Ç Bollinger Bands

**–§–æ—Ä–º—É–ª–∞:**
```python
# –®–∞–≥ 1: –°—Ä–µ–¥–Ω—è—è –ø–æ–ª–æ—Å–∞ (SMA)
middle_band = SMA(close, period=20)

# –®–∞–≥ 2: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
std_dev = sqrt(sum((close[i] - middle_band)**2 for i in range(-period, 0)) / period)

# –®–∞–≥ 3: –í–µ—Ä—Ö–Ω—è—è –∏ –Ω–∏–∂–Ω—è—è –ø–æ–ª–æ—Å—ã
upper_band = middle_band + (std_multiplier * std_dev)
lower_band = middle_band - (std_multiplier * std_dev)

# –®–∞–≥ 4: –ü–æ–∑–∏—Ü–∏—è —Ü–µ–Ω—ã –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–æ–ª–æ—Å (%B)
bb_percent = (current_price - lower_band) / (upper_band - lower_band) if (upper_band - lower_band) > 0 else 0.5
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º–∞–º:**
- **TRENDING:** `period=20, std_multiplier=2.0` (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ)
- **RANGING:** `period=20, std_multiplier=2.0` (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ)
- **CHOPPY:** `period=20, std_multiplier=2.2` (—à–∏—Ä–µ –ø–æ–ª–æ—Å—ã –¥–ª—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏)

### –†–∞—Å—á–µ—Ç ADX (Average Directional Index)

**–§–æ—Ä–º—É–ª–∞:**
```python
# –®–∞–≥ 1: Directional Movement
+DM = max(high - prev_high, 0)  # –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ
-DM = max(prev_low - low, 0)    # –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ

# –®–∞–≥ 2: True Range
TR = max(
    high - low,                    # –†–∞–∑–Ω–∏—Ü–∞ High –∏ Low
    abs(high - prev_close),        # –†–∞–∑–Ω–∏—Ü–∞ High –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ Close
    abs(low - prev_close)          # –†–∞–∑–Ω–∏—Ü–∞ Low –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ Close
)

# –®–∞–≥ 3: –°–≥–ª–∞–∂–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (Wilder's smoothing)
smoothed_+DM = Wilder_Smoothing(+DM, period)
smoothed_-DM = Wilder_Smoothing(-DM, period)
smoothed_TR = Wilder_Smoothing(TR, period)

# –®–∞–≥ 4: Directional Indicators
+DI = 100 * (smoothed_+DM / smoothed_TR)
-DI = 100 * (smoothed_-DM / smoothed_TR)

# –®–∞–≥ 5: Directional Index
DX = 100 * abs(+DI - -DI) / (+DI + -DI) if (+DI + -DI) > 0 else 0

# –®–∞–≥ 6: ADX (—Å–≥–ª–∞–∂–µ–Ω–Ω—ã–π DX)
ADX = Wilder_Smoothing(DX, period)
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- **–ü–µ—Ä–∏–æ–¥:** `adx_period: 9` (–±—ã—Å—Ç—Ä—ã–π –¥–ª—è Futures)
- **–ü–æ—Ä–æ–≥–∏ —Ä–µ–∂–∏–º–æ–≤:**
  - `trending_adx_threshold: 15.0` (ADX > 15 ‚Üí TRENDING)
  - `ranging_adx_threshold: 18.0` (ADX < 18 ‚Üí RANGING)
  - `high_volatility_threshold: 0.02` (2% ‚Üí CHOPPY)

---

## üìä –ü–û–õ–ù–û–ï –û–ü–ò–°–ê–ù–ò–ï –ü–ê–†–ê–ú–ï–¢–†–û–í –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ—Ä–≥–æ–≤–ª–∏

#### –°–∏–º–≤–æ–ª—ã –∏ —Ä–µ–∂–∏–º—ã
```yaml
scalping:
  symbols:
    - "BTC-USDT"   # Bitcoin
    - "ETH-USDT"   # Ethereum
    - "SOL-USDT"   # Solana
    - "DOGE-USDT"  # Dogecoin
    - "XRP-USDT"   # XRP
  
  check_interval: 1.0  # –ò–Ω—Ç–µ—Ä–≤–∞–ª –≥–ª–∞–≤–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ (—Å–µ–∫—É–Ω–¥—ã)
  min_signal_strength: 0.60  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞ (0.0-1.0)
  min_adx: 16.0  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π ADX –¥–ª—è —Å–∏–≥–Ω–∞–ª–∞
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∏—Å–∫–∞
```yaml
scalping:
  base_risk_percentage: 0.01  # –ë–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É (1%)
  min_position_size: 0.001    # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ (–≤ –º–æ–Ω–µ—Ç–∞—Ö)
  leverage: 5                 # –ë–∞–∑–æ–≤–æ–µ –ø–ª–µ—á–æ (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ 3-30x)
  
  risk_config:
    max_margin_per_trade: 22.0      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–∞—Ä–∂–∞ –Ω–∞ —Å–¥–µ–ª–∫—É (%)
    max_portfolio_margin: 65.0      # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–∞—Ä–∂–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è (%)
    use_risk_based_sizing: true     # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–∞—Å—á–µ—Ç —á–µ—Ä–µ–∑ risk_usd / sl_distance
    volatility_factor_enabled: true  # –£—á–∏—Ç—ã–≤–∞—Ç—å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    drawdown_factor_enabled: true    # –£—á–∏—Ç—ã–≤–∞—Ç—å –ø—Ä–æ—Å–∞–¥–∫—É
    min_margin_cap: 8.0              # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –º–∞—Ä–∂–∞ –≤ USD
    max_margin_cap_multiplier: 2.5   # –ú–Ω–æ–∂–∏—Ç–µ–ª—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –º–∞—Ä–∂–∏
```

#### Take Profit –∏ Stop Loss
```yaml
scalping:
  tp_percent: 5.0   # –ë–∞–∑–æ–≤—ã–π Take Profit (%)
  sl_percent: 1.0   # –ë–∞–∑–æ–≤—ã–π Stop Loss (%)
  
  # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL –ø–æ —Ä–µ–∂–∏–º–∞–º (–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –±–∞–∑–æ–≤—ã–µ)
  adaptive_regime:
    trending:
      tp_percent: 6.0   # TP –¥–ª—è —Ç—Ä–µ–Ω–¥–∞
      sl_percent: 1.2   # SL –¥–ª—è —Ç—Ä–µ–Ω–¥–∞
      tp_atr_multiplier: 1.2  # –ú–Ω–æ–∂–∏—Ç–µ–ª—å TP –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR
      sl_atr_multiplier: 0.6  # –ú–Ω–æ–∂–∏—Ç–µ–ª—å SL –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR
    ranging:
      tp_percent: 5.0
      sl_percent: 1.0
      tp_atr_multiplier: 1.0
      sl_atr_multiplier: 0.8
    choppy:
      tp_percent: 4.5
      sl_percent: 1.2
      tp_atr_multiplier: 0.9
      sl_atr_multiplier: 1.0
```

#### Partial Take Profit (–ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)
```yaml
scalping:
  partial_tp:
    enabled: true
    fraction: 0.6            # –î–æ–ª—è –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è (60%)
    trigger_percent: 1.0     # –¢—Ä–∏–≥–≥–µ—Ä –ø—Ä–∏–±—ã–ª–∏ –¥–ª—è Partial TP (%)
    post_only: true          # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å POST-ONLY –æ—Ä–¥–µ—Ä–∞
    limit_offset_bps: 7.0    # –°–º–µ—â–µ–Ω–∏–µ –ª–∏–º–∏—Ç–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞ (0.07%)
    min_profit_after_commission: 0.5  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å ($)
    
    adaptive_min_holding:
      enabled: true
      profit_threshold_1: 0.8   # –ü—Ä–∏–±—ã–ª—å >= 0.8% ‚Üí —Å–Ω–∏–∑–∏—Ç—å min_holding –¥–æ 30%
      profit_threshold_2: 0.4   # –ü—Ä–∏–±—ã–ª—å >= 0.4% ‚Üí —Å–Ω–∏–∑–∏—Ç—å min_holding –¥–æ 60%
      reduction_factor_1: 0.3   # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–Ω–∏–∂–µ–Ω–∏—è –¥–ª—è threshold_1
      reduction_factor_2: 0.6   # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–Ω–∏–∂–µ–Ω–∏—è –¥–ª—è threshold_2
    
    by_regime:
      trending:
        fraction: 0.4        # 40% –ø–æ–∑–∏—Ü–∏–∏
        trigger_percent: 1.8 # 1.8% –ø—Ä–∏–±—ã–ª–∏
      ranging:
        fraction: 0.5        # 50% –ø–æ–∑–∏—Ü–∏–∏
        trigger_percent: 0.65 # 0.65% –ø—Ä–∏–±—ã–ª–∏
      choppy:
        fraction: 0.6        # 60% –ø–æ–∑–∏—Ü–∏–∏
        trigger_percent: 1.2 # 1.2% –ø—Ä–∏–±—ã–ª–∏
```

#### Profit Drawdown Protection (–ó–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç–∫–∞—Ç–∞ –ø—Ä–∏–±—ã–ª–∏)
```yaml
scalping:
  profit_drawdown:
    enabled: true
    drawdown_percent: 0.75   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ç–∫–∞—Ç –æ—Ç –ø–∏–∫–∞ (75%)
    min_profit_to_activate_type: "margin_percent"  # –¢–∏–ø –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
    min_profit_to_activate_percent: 3.0  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (% –æ—Ç –º–∞—Ä–∂–∏)
    
    by_regime:
      trending:
        multiplier: 2.0   # 150% –æ—Ç–∫–∞—Ç –≤ —Ç—Ä–µ–Ω–¥–µ
      ranging:
        multiplier: 0.25  # 20% –æ—Ç–∫–∞—Ç –≤ –±–æ–∫–æ–≤–∏–∫–µ
      choppy:
        multiplier: 1.0   # 75% –æ—Ç–∫–∞—Ç –≤ —Ö–∞–æ—Å–µ
```

#### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –±–∞–ª–∞–Ω—Å—É (Balance Profiles)
```yaml
scalping:
  balance_profiles:
    micro:    # $100 - $500
      threshold: 500.0
      min_balance: 100.0
      size_at_min: 30.0
      size_at_max: 50.0
      max_open_positions: 5
      max_position_percent: 25.0
      progressive: true
    
    small:    # $500 - $1500
      threshold: 1500.0
      min_balance: 500.0
      size_at_min: 100.0
      size_at_max: 200.0
      max_open_positions: 8
      max_position_percent: 25.0
      progressive: true
    
    medium:   # $1500 - $3000
      threshold: 3000.0
      min_balance: 1500.0
      size_at_min: 150.0
      size_at_max: 200.0
      max_open_positions: 7
      max_position_percent: 12.0
      progressive: true
    
    large:    # $3000+
      threshold: 999999.0
      min_balance: 3000.0
      size_at_min: 200.0
      size_at_max: 300.0
      max_open_positions: 8
      max_position_percent: 10.0
      progressive: true
```

#### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (ARM)
```yaml
scalping:
  adaptive_regime:
    enabled: true
    detection:
      trending_adx_threshold: 15.0      # ADX > 15 ‚Üí TRENDING
      ranging_adx_threshold: 18.0       # ADX < 18 ‚Üí RANGING
      high_volatility_threshold: 0.02   # 2% ‚Üí CHOPPY
      trend_strength_percent: 1.0       # –°–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ (%)
      lookback_candles: 50              # –°–≤–µ—á–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
      adx_period: 9                     # –ü–µ—Ä–∏–æ–¥ ADX
    
    trending:
      block_counter_trend: true         # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–∏–≤–æ—Ç—Ä–µ–Ω–¥
      conflict_multiplier: 0.0          # –ú–Ω–æ–∂–∏—Ç–µ–ª—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
      min_score_threshold: 2.0          # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score —Å–∏–≥–Ω–∞–ª–∞
      max_trades_per_hour: 20           # –ú–∞–∫—Å–∏–º—É–º —Å–¥–µ–ª–æ–∫ –≤ —á–∞—Å
      position_size_multiplier: 1.3     # –ú–Ω–æ–∂–∏—Ç–µ–ª—å —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
      max_holding_minutes: 40           # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
      min_holding_minutes: 0.8          # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
    
    ranging:
      min_score_threshold: 1.8
      max_trades_per_hour: 15
      position_size_multiplier: 1.0
      max_holding_minutes: 25
      min_holding_minutes: 1.0
    
    choppy:
      min_score_threshold: 2.0
      max_trades_per_hour: 8
      position_size_multiplier: 0.8
      max_holding_minutes: 14
      min_holding_minutes: 1.0
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –ø–æ —Ä–µ–∂–∏–º–∞–º
```yaml
scalping:
  adaptive_regime:
    trending:
      indicators:
        rsi_overbought: 85
        rsi_oversold: 25
        macd_fast: 19
        macd_slow: 39
        macd_signal: 9
        bb_period: 20
        bb_std_multiplier: 2.0
        sma_fast: 8
        sma_slow: 21
        ema_fast: 8
        ema_slow: 21
        atr_period: 14
        min_volatility_atr: 0.0004
    
    ranging:
      indicators:
        rsi_overbought: 70
        rsi_oversold: 30
        macd_fast: 12
        macd_slow: 26
        macd_signal: 9
        bb_period: 20
        bb_std_multiplier: 2.0
    
    choppy:
      indicators:
        rsi_overbought: 65
        rsi_oversold: 35
        macd_fast: 8
        macd_slow: 21
        macd_signal: 9
        bb_period: 20
        bb_std_multiplier: 2.2
```

#### –ö–æ–º–∏—Å—Å–∏–∏ –∏ —Å–±–æ—Ä—ã
```yaml
scalping:
  commission:
    trading_fee_rate: 0.0010      # 0.10% –Ω–∞ –∫—Ä—É–≥ (fallback)
    maker_fee_rate: 0.0002        # 0.02% –¥–ª—è LIMIT –æ—Ä–¥–µ—Ä–æ–≤
    taker_fee_rate: 0.0005       # 0.05% –¥–ª—è MARKET –æ—Ä–¥–µ—Ä–æ–≤
    slippage_buffer_percent: 0.15 # –ë—É—Ñ–µ—Ä –Ω–∞ slippage (0.15%)
    tp_buffer_percent: 0.1        # –ë—É—Ñ–µ—Ä –¥–ª—è TP (0.1%)
```

#### –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
```yaml
scalping:
  positions_sync:
    base_interval_min: 1.0        # –ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—Å–µ–∫—É–Ω–¥—ã)
    base_interval_multiplier: 1.0 # –ú–Ω–æ–∂–∏—Ç–µ–ª—å –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
    
    by_regime:
      trending:
        interval_multiplier: 1.0  # –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
      ranging:
        interval_multiplier: 1.0  # –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
      choppy:
        interval_multiplier: 1.0  # –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
    
    by_balance:
      micro:
        interval_multiplier: 1.0
      small:
        interval_multiplier: 1.0
      medium:
        interval_multiplier: 1.2  # –ö–∞–∂–¥—ã–µ 1.2 —Å–µ–∫—É–Ω–¥—ã
      large:
        interval_multiplier: 1.5  # –ö–∞–∂–¥—ã–µ 1.5 —Å–µ–∫—É–Ω–¥
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Å–∏–º–≤–æ–ª–∞–º (Per-Symbol)
```yaml
scalping:
  by_symbol:
    ETH-USDT:
      min_signal_strength: 0.55   # –ë–æ–ª–µ–µ –º—è–≥–∫–∏–π –¥–ª—è ETH
      sl_atr_multiplier: 3.0      # –®–∏—Ä–µ SL –¥–ª—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
      tp_atr_multiplier: 4.0      # –ë–æ–ª—å—à–µ TP –¥–ª—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
      max_holding_minutes: 30.0   # –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
      min_adx: 14.0               # –ë–æ–ª–µ–µ –º—è–≥–∫–∏–π ADX
      indicators:
        rsi_overbought: 78        # –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π –ø–æ—Ä–æ–≥
        rsi_oversold: 22
        macd_fast: 10
        macd_slow: 22
        bb_std_multiplier: 2.1    # –®–∏—Ä–µ –ø–æ–ª–æ—Å—ã
```

---

## üåê –†–ê–ë–û–¢–ê –° –ë–ò–†–ñ–ï–ô OKX

### –¢–∏–ø —Ç–æ—Ä–≥–æ–≤–ª–∏

**Futures (USDT-Margined Perpetual Swaps):**
- –¢–∏–ø –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞: Perpetual Swap
- –í–∞–ª—é—Ç–∞ –º–∞—Ä–∂–∏: USDT
- –†–µ–∂–∏–º –º–∞—Ä–∂–∏: Isolated Margin (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ä–∂–∞)
- –ü–ª–µ—á–æ: 5x (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

### API Endpoints

#### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–°–≤–µ—á–∏:**
```python
GET /api/v5/market/candles
{
    "instId": "BTC-USDT-SWAP",
    "bar": "5m",  # 5-–º–∏–Ω—É—Ç–Ω—ã–µ —Å–≤–µ—á–∏
    "limit": 50  # 50 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–≤–µ—á–µ–π
}
```

**–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞:**
```python
GET /api/v5/market/ticker
{
    "instId": "BTC-USDT-SWAP"
}
```

**Order Book:**
```python
GET /api/v5/market/books
{
    "instId": "BTC-USDT-SWAP",
    "sz": 20  # –ì–ª—É–±–∏–Ω–∞ —Å—Ç–∞–∫–∞–Ω–∞
}
```

#### 2. –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤

**MARKET –æ—Ä–¥–µ—Ä:**
```python
POST /api/v5/trade/order
{
    "instId": "BTC-USDT-SWAP",
    "tdMode": "isolated",  # Isolated margin
    "side": "buy",  # –∏–ª–∏ "sell"
    "ordType": "market",
    "sz": "0.01",  # –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
    "posSide": "long",  # –∏–ª–∏ "short"
    "lever": "5"  # –ü–ª–µ—á–æ
}
```

**LIMIT –æ—Ä–¥–µ—Ä:**
```python
POST /api/v5/trade/order
{
    "instId": "BTC-USDT-SWAP",
    "tdMode": "isolated",
    "side": "buy",
    "ordType": "limit",
    "sz": "0.01",
    "px": "50000.0",  # –¶–µ–Ω–∞
    "posSide": "long",
    "lever": "5"
}
```

#### 3. –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π

```python
GET /api/v5/account/positions
{
    "instId": "BTC-USDT-SWAP"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "data": [{
        "instId": "BTC-USDT-SWAP",
        "pos": "0.01",  # –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
        "posSide": "long",  # –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        "avgPx": "50000.0",  # –°—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞
        "markPx": "50100.0",  # –¢–µ–∫—É—â–∞—è –º–∞—Ä–∫–∏—Ä–æ–≤–æ—á–Ω–∞—è —Ü–µ–Ω–∞
        "upl": "1.0",  # –ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL
        "margin": "100.0",  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ä–∂–∞
        "liqPx": "45000.0"  # –õ–∏–∫–≤–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è —Ü–µ–Ω–∞
    }]
}
```

#### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

```python
GET /api/v5/account/balance
{
    "ccy": "USDT"
}
```

**–û—Ç–≤–µ—Ç:**
```json
{
    "data": [{
        "details": [{
            "ccy": "USDT",
            "eq": "1000.0",  # Equity (–±–∞–ª–∞–Ω—Å)
            "availEq": "900.0"  # –î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å
        }]
    }]
}
```

#### 5. –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏

```python
POST /api/v5/trade/order
{
    "instId": "BTC-USDT-SWAP",
    "tdMode": "isolated",
    "side": "sell",  # –ü—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∞—è —Å—Ç–æ—Ä–æ–Ω–∞
    "ordType": "market",
    "sz": "0.01",  # –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
    "posSide": "long",
    "ccy": "USDT",
    "reduceOnly": true  # –¢–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã—Ç–∏–µ
}
```

### WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

**–ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–∏–∫–µ—Ä—ã:**
```python
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
ws = await websocket_connect("wss://ws.okx.com:8443/ws/v5/public")

# –ü–æ–¥–ø–∏—Å–∫–∞
subscribe = {
    "op": "subscribe",
    "args": [{
        "channel": "tickers",
        "instId": "BTC-USDT-SWAP"
    }]
}
await ws.send_json(subscribe)

# –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
while True:
    message = await ws.receive_json()
    if message.get("arg", {}).get("channel") == "tickers":
        ticker_data = message["data"][0]
        current_price = float(ticker_data["last"])
```

### –ö–æ–º–∏—Å—Å–∏–∏

**Maker –∫–æ–º–∏—Å—Å–∏—è (LIMIT –æ—Ä–¥–µ—Ä–∞):**
- 0.02% –æ—Ç –æ–±—ä–µ–º–∞ —Å–¥–µ–ª–∫–∏

**Taker –∫–æ–º–∏—Å—Å–∏—è (MARKET –æ—Ä–¥–µ—Ä–∞):**
- 0.05% –æ—Ç –æ–±—ä–µ–º–∞ —Å–¥–µ–ª–∫–∏

**–†–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π:**
```python
# –î–ª—è LIMIT –æ—Ä–¥–µ—Ä–∞ (maker)
entry_fee = entry_price * size * 0.0002  # 0.02%
exit_fee = exit_price * size * 0.0002   # 0.02%
total_fees = entry_fee + exit_fee

# –î–ª—è MARKET –æ—Ä–¥–µ—Ä–∞ (taker)
entry_fee = entry_price * size * 0.0005  # 0.05%
exit_fee = exit_price * size * 0.0005   # 0.05%
total_fees = entry_fee + exit_fee
```

---

## üéØ –ê–î–ê–ü–¢–ò–í–ù–´–ï –°–ò–°–¢–ï–ú–´

### ARM (Adaptive Regime Manager)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ—Ä–≥–æ–≤–ª–∏.

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞

**TRENDING (–¢—Ä–µ–Ω–¥–æ–≤—ã–π):**
```python
# –£—Å–ª–æ–≤–∏—è:
# - ADX > 25
# - –ß–µ—Ç–∫–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (+DI –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ -DI)
# - –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤

if adx > 25 and di_plus > di_minus + 1.5 and reversals < 3:
    regime = "TRENDING"
```

**RANGING (–ë–æ–∫–æ–≤–æ–π):**
```python
# –£—Å–ª–æ–≤–∏—è:
# - ADX < 20
# - –ë–æ–∫–æ–≤–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ (—Ü–µ–Ω–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ)
# - –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

if adx < 20 and range_width < price * 0.02 and volatility < 0.01:
    regime = "RANGING"
```

**CHOPPY (–•–∞–æ—Ç–∏—á–Ω—ã–π):**
```python
# –£—Å–ª–æ–≤–∏—è:
# - ADX > 25
# - –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
# - –ú–Ω–æ–≥–æ —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤

if adx > 25 and volatility > 0.03 and reversals > 5:
    regime = "CHOPPY"
```

#### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º—É

**TRENDING (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025):**
```python
tp_percent = 6.0%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 2.5% –¥–æ 6.0% (+140%) - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7%
sl_percent = 1.2%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.8% –¥–æ 1.2% - –±–∞–ª–∞–Ω—Å —Å –Ω–æ–≤—ã–º TP
min_score_threshold = 2.0  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.4 –¥–æ 2.0 (+43%) - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–∞–±—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
max_trades_per_hour = 20  # ‚úÖ –°–Ω–∏–∂–µ–Ω–æ —Å 35 –¥–æ 20 (-43%) - –º–µ–Ω—å—à–µ —Å–¥–µ–ª–æ–∫, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ
max_holding_minutes = 40  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 30 –¥–æ 40 (+33%)
min_holding_minutes = 3.0  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 2.0 –¥–æ 3.0 (+50%)
min_profit_to_close = 0.020  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.01 –¥–æ 0.020 (2.0%, –±—ã–ª–æ 1.0%)
partial_tp_fraction = 0.4  # 40%
partial_tp_trigger = 1.8%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.2% –¥–æ 1.8%
```

**RANGING (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025):**
```python
tp_percent = 5.0%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.8% –¥–æ 5.0% (+178%) - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7%
sl_percent = 1.0%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.8% –¥–æ 1.0% - –±–∞–ª–∞–Ω—Å —Å –Ω–æ–≤—ã–º TP
min_score_threshold = 1.8  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.4 –¥–æ 1.8 (+29%) - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–∞–±—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
max_trades_per_hour = 15  # ‚úÖ –°–Ω–∏–∂–µ–Ω–æ —Å 22 –¥–æ 15 (-32%) - –º–µ–Ω—å—à–µ —Å–¥–µ–ª–æ–∫, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ
max_holding_minutes = 25  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 12 –¥–æ 25 (+108%)
min_holding_minutes = 1.0  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.2 –¥–æ 1.0 (+400%)
min_profit_to_close = 0.030  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.025 –¥–æ 0.030 (3.0%, –±—ã–ª–æ 2.5%)
partial_tp_fraction = 0.5  # 50%
partial_tp_trigger = 0.65%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.6% –¥–æ 0.65%
```

**CHOPPY (‚úÖ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø 24.12.2025):**
```python
tp_percent = 4.5%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.8% –¥–æ 4.5% (+150%) - –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7%
sl_percent = 1.2%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.0% –¥–æ 1.2% - –±–∞–ª–∞–Ω—Å —Å –Ω–æ–≤—ã–º TP
min_score_threshold = 2.0  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.6 –¥–æ 2.0 (+25%) - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–∞–±—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
max_trades_per_hour = 8  # ‚úÖ –°–Ω–∏–∂–µ–Ω–æ —Å 10 –¥–æ 8 (-20%) - –º–µ–Ω—å—à–µ —Å–¥–µ–ª–æ–∫, –Ω–æ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ
max_holding_minutes = 14  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 10 –¥–æ 14 (+40%)
min_holding_minutes = 1.0  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.3 –¥–æ 1.0 (+233%)
min_profit_to_close = 0.020  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.01 –¥–æ 0.020 (2.0%, –±—ã–ª–æ 1.0%)
partial_tp_fraction = 0.6  # 60%
partial_tp_trigger = 1.2%  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.8% –¥–æ 1.2%
```

### Adaptive Balance Manager

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π –ø–æ–¥ –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞.

**–ü—Ä–æ—Ñ–∏–ª–∏ –±–∞–ª–∞–Ω—Å–∞:**
- SMALL (< $1,500): –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä $50
- MEDIUM ($1,500 - $3,500): –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä $100
- LARGE (> $3,500): –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä $200

**–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å:**
- –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: √ó0.5
- –ù–æ—Ä–º–∞–ª—å–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: √ó1.0
- –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: √ó1.5

---

## ‚ö° –ê–î–ê–ü–¢–ò–í–ù–û–ï –ü–õ–ï–ß–û (ADAPTIVE LEVERAGE)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –ø–ª–µ—á–æ (3-30x) –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–∞, —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏.

### –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞

**–ë–∞–∑–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–∏–ª—ã —Å–∏–≥–Ω–∞–ª–∞:**
```python
# –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–∞:
very_weak (0.0-0.3)   ‚Üí 3x  –ø–ª–µ—á–æ
weak (0.3-0.5)        ‚Üí 5x  –ø–ª–µ—á–æ
medium (0.5-0.7)      ‚Üí 10x –ø–ª–µ—á–æ
strong (0.7-0.9)      ‚Üí 20x –ø–ª–µ—á–æ
very_strong (0.9-1.0)  ‚Üí 30x –ø–ª–µ—á–æ
```

**–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞:**
```python
# –ú–Ω–æ–∂–∏—Ç–µ–ª—å —Ä–µ–∂–∏–º–∞:
if regime == "trending":
    regime_multiplier = 1.2  # +20% –∫ –ø–ª–µ—á—É –≤ —Ç—Ä–µ–Ω–¥–µ
elif regime == "choppy":
    regime_multiplier = 0.8  # -20% –∫ –ø–ª–µ—á—É –≤ —Ö–∞–æ—Å–µ
else:  # ranging
    regime_multiplier = 1.0  # –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

**–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –Ω–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å:**
```python
# –ú–Ω–æ–∂–∏—Ç–µ–ª—å –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏:
if volatility > 0.05:  # –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (>5%)
    volatility_multiplier = 0.7  # –£–º–µ–Ω—å—à–∞–µ–º –ø–ª–µ—á–æ –Ω–∞ 30%
elif volatility < 0.01:  # –ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (<1%)
    volatility_multiplier = 1.3  # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –ø–ª–µ—á–æ –Ω–∞ 30%
else:
    volatility_multiplier = 1.0  # –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

**–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç:**
```python
# –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏:
adjusted_strength = signal_strength * regime_multiplier * volatility_multiplier
adjusted_strength = max(0.0, min(1.0, adjusted_strength))  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º 0-1

# –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∏ –ø–æ–ª—É—á–∞–µ–º –ø–ª–µ—á–æ:
leverage = leverage_map[category]

# –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –Ω–∞ –±–∏—Ä–∂–µ (3, 5, 10, 20, 30):
leverage = round_to_available_leverage(leverage, symbol)
```

### –ü—Ä–∏–º–µ—Ä—ã

**–°–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª –≤ —Ç—Ä–µ–Ω–¥–µ:**
- –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞: 0.85
- –†–µ–∂–∏–º: trending (√ó1.2)
- –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è (√ó1.0)
- –ò—Ç–æ–≥: 0.85 √ó 1.2 = 1.02 ‚Üí very_strong ‚Üí **30x**

**–°–ª–∞–±—ã–π —Å–∏–≥–Ω–∞–ª –≤ —Ö–∞–æ—Å–µ:**
- –°–∏–ª–∞ —Å–∏–≥–Ω–∞–ª–∞: 0.4
- –†–µ–∂–∏–º: choppy (√ó0.8)
- –í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å: –≤—ã—Å–æ–∫–∞—è (√ó0.7)
- –ò—Ç–æ–≥: 0.4 √ó 0.8 √ó 0.7 = 0.224 ‚Üí very_weak ‚Üí **3x**

---

## üìä –õ–ï–°–¢–ù–ò–ß–ù–´–ô –í–•–û–î (LADDER ENTRY / POSITION SCALING)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–π —Å —É–º–µ–Ω—å—à–∞—é—â–∏–º—Å—è —Ä–∞–∑–º–µ—Ä–æ–º (–ª–µ—Å—Ç–Ω–∏—Ü–∞).

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
```python
{
    "max_additions": 7,              # –ú–∞–∫—Å–∏–º—É–º 7 –¥–æ–±–∞–≤–ª–µ–Ω–∏–π
    "min_interval_seconds": 30,      # –ú–∏–Ω–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è–º–∏
    "max_loss_for_addition": -3.0,   # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è: -3%
    "ladder": [1.0, 0.8, 0.6, 0.4, 0.3, 0.2, 0.15]  # –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ª–µ—Å—Ç–Ω–∏—Ü—ã
}
```

**–õ–µ—Å—Ç–Ω–∏—Ü–∞:**
- 1-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 100% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 2-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 80% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 3-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 60% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 4-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 40% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 5-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 30% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 6-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 20% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- 7-–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ: 15% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

### –£—Å–ª–æ–≤–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º:**
```python
# 1. –ù–µ –ø—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∏–π
if addition_count >= max_additions:
    return False

# 2. –ü—Ä–æ—à–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
if time_since_last_addition < min_interval_seconds:
    return False

# 3. –£–±—ã—Ç–æ–∫ –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç
if pnl_percent <= max_loss_for_addition:
    return False

# 4. –î–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
if available_balance < addition_size:
    return False
```

### –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è

```python
# –ü–æ–ª—É—á–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏–∑ –ª–µ—Å—Ç–Ω–∏—Ü—ã:
addition_count = len(scaling_history)  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–Ω—ã—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–π

if addition_count >= len(ladder):
    ladder_coefficient = ladder[-1]  # –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç
else:
    ladder_coefficient = ladder[addition_count]  # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑–º–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:
addition_size_usd = base_size_usd * ladder_coefficient

# –ü—Ä–∏–º–µ–Ω—è–µ–º –≤–∞–ª–∏–¥–∞—Ü–∏—é:
addition_size_usd = min(addition_size_usd, max_addition_size)
addition_size_usd = max(addition_size_usd, min_addition_size)
```

### –ò—Å—Ç–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–π

–ö–∞–∂–¥–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ `PositionMetadata.scaling_history`:
```python
scaling_history = [
    {
        "timestamp": "2025-12-21T10:00:00",
        "size_usd": 100.0,
        "leverage": 10,
        "price": 50000.0,
        "addition_number": 1
    },
    {
        "timestamp": "2025-12-21T10:00:30",
        "size_usd": 80.0,  # 80% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ
        "leverage": 10,
        "price": 49950.0,
        "addition_number": 2
    },
    # ...
]
```

### –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞

–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –∫ –ø–æ–∑–∏—Ü–∏–∏ —Ü–µ–Ω–∞ –≤—Ö–æ–¥–∞ —É—Å—Ä–µ–¥–Ω—è–µ—Ç—Å—è:
```python
# –¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è:
entry_price = 50000.0
size = 0.01

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ:
addition_price = 49950.0
addition_size = 0.008  # 80% –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ

# –ù–æ–≤–∞—è —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞:
total_size = size + addition_size
weighted_price = (entry_price * size + addition_price * addition_size) / total_size
# weighted_price = (50000 * 0.01 + 49950 * 0.008) / 0.018 = 49977.78
```

---

## üß† EXIT ANALYZER - –£–ú–ù–û–ï –ó–ê–ö–†–´–¢–ò–ï –ü–û–ó–ò–¶–ò–ô

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–π —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –ª–æ–≥–∏–∫–æ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `ExitAnalyzer` - –≥–ª–∞–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
- `_generate_exit_for_trending()` - –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ç—Ä–µ–Ω–¥–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
- `_generate_exit_for_ranging()` - –ª–æ–≥–∏–∫–∞ –¥–ª—è –±–æ–∫–æ–≤–æ–≥–æ —Ä–µ–∂–∏–º–∞
- `_generate_exit_for_choppy()` - –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ö–∞–æ—Ç–∏—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

### –õ–æ–≥–∏–∫–∞ –¥–ª—è RANGING —Ä–µ–∂–∏–º–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫:**
1. **Stop Loss** - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ SL
2. **Partial Take Profit** - —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ trigger_percent
3. **Take Profit** - –ø–æ–ª–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ TP
4. **Time Stop** - –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
5. **Big Profit Exit** - –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª–∏ (>2x TP)

**Partial Take Profit:**
```python
# –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞:
if pnl_percent >= trigger_percent:  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é 1.0%
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è (–∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è)
    if can_partial_close:  # –ü—Ä–æ—à–ª–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏
        # –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –¥–æ–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è:
        if pnl_percent < 1.0%:
            fraction = 0.4  # 40% –ø–æ–∑–∏—Ü–∏–∏
        elif pnl_percent >= 2.0%:
            fraction = 0.8  # 80% –ø–æ–∑–∏—Ü–∏–∏
        else:
            fraction = 0.6  # 60% –ø–æ–∑–∏—Ü–∏–∏ (—Å—Ç–∞–Ω–¥–∞—Ä—Ç)
        
        await close_position_partial(symbol, fraction, reason="partial_tp")
```

**–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è:**
```python
# –î–ª—è partial_tp —Ç—Ä–µ–±—É–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è:
# - –ï—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å < 0.5%: min_holding = 30 —Å–µ–∫—É–Ω–¥
# - –ï—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å 0.5-1.0%: min_holding = 60 —Å–µ–∫—É–Ω–¥
# - –ï—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > 1.0%: min_holding = 90 —Å–µ–∫—É–Ω–¥

# –≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
```

### –õ–æ–≥–∏–∫–∞ –¥–ª—è TRENDING —Ä–µ–∂–∏–º–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ
- –ë–æ–ª–µ–µ —à–∏—Ä–æ–∫–∏–π trailing stop
- –î–æ–ª—å—à–µ —É–¥–µ—Ä–∂–∞–Ω–∏–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

**–ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP:**
```python
# –ï—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å –¥–æ—Å—Ç–∏–≥–ª–∞ TP, –Ω–æ —Ç—Ä–µ–Ω–¥ —Å–∏–ª—å–Ω—ã–π:
if pnl_percent >= tp_percent:
    if adx > 30 and trend_strength > 0.7:
        # –ü—Ä–æ–¥–ª–µ–≤–∞–µ–º TP –Ω–∞ 50%
        extended_tp = tp_percent * 1.5
        tp_extension_count += 1
        # –ú–∞–∫—Å–∏–º—É–º 2 –ø—Ä–æ–¥–ª–µ–Ω–∏—è
        if tp_extension_count < 2:
            return {"action": "extend_tp", "new_tp": extended_tp}
```

### –õ–æ–≥–∏–∫–∞ –¥–ª—è CHOPPY —Ä–µ–∂–∏–º–∞

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
- –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤
- –ë—ã—Å—Ç—Ä–∞—è —Ñ–∏–∫—Å–∞—Ü–∏—è –ø—Ä–∏–±—ã–ª–∏

---

## üìã POSITION REGISTRY - –†–ï–ï–°–¢–† –ü–û–ó–ò–¶–ò–ô

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π –≤ —Å–∏—Å—Ç–µ–º–µ. –•—Ä–∞–Ω–∏—Ç position –¥–∞–Ω–Ω—ã–µ + –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ PositionMetadata

```python
@dataclass
class PositionMetadata:
    entry_time: datetime                    # –í—Ä–µ–º—è –≤—Ö–æ–¥–∞
    position_id: Optional[str]               # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–∑–∏—Ü–∏–∏
    regime: Optional[str]                    # –†–µ–∂–∏–º –ø—Ä–∏ –≤—Ö–æ–¥–µ (trending/ranging/choppy)
    balance_profile: Optional[str]          # –ü—Ä–æ—Ñ–∏–ª—å –±–∞–ª–∞–Ω—Å–∞ (small/medium/large)
    entry_price: Optional[float]            # –¶–µ–Ω–∞ –≤—Ö–æ–¥–∞
    position_side: Optional[str]            # –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (long/short)
    order_id: Optional[str]                 # ID –æ—Ä–¥–µ—Ä–∞ –≤—Ö–æ–¥–∞
    tp_percent: Optional[float]              # Take Profit –≤ %
    sl_percent: Optional[float]             # Stop Loss –≤ %
    leverage: Optional[int]                  # –ü–ª–µ—á–æ (3-30x)
    size_in_coins: Optional[float]          # –†–∞–∑–º–µ—Ä –≤ –º–æ–Ω–µ—Ç–∞—Ö
    margin_used: Optional[float]            # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ä–∂–∞
    min_holding_seconds: Optional[float]   # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
    created_at: datetime                    # –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏
    
    # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏:
    peak_profit_usd: float = 0.0           # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å –≤ USD
    peak_profit_time: Optional[datetime]    # –í—Ä–µ–º—è –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –º–∞–∫—Å–∏–º—É–º–∞
    peak_profit_price: Optional[float]      # –¶–µ–Ω–∞ –ø—Ä–∏ –º–∞–∫—Å–∏–º—É–º–µ
    
    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TP:
    tp_extension_count: int = 0             # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–π TP
    partial_tp_executed: bool = False      # –§–ª–∞–≥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è partial_tp
    
    # –ò—Å—Ç–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∏–π (–ª–µ—Å—Ç–Ω–∏—á–Ω—ã–π –≤—Ö–æ–¥):
    scaling_history: Optional[List[Dict]]   # –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –¥–æ–±–∞–≤–ª–µ–Ω–∏–π
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

**–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–∏:**
```python
await position_registry.register_position(
    symbol="BTC-USDT",
    position={
        "instId": "BTC-USDT-SWAP",
        "posSide": "long",
        "pos": "0.01",
        "avgPx": "50000.0",
        "margin": "100.0"
    },
    metadata=PositionMetadata(
        entry_time=datetime.now(timezone.utc),
        regime="trending",
        balance_profile="medium",
        entry_price=50000.0,
        position_side="long",
        leverage=10,
        size_in_coins=0.01,
        margin_used=100.0
    )
)
```

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö:**
```python
await position_registry.update_position(
    symbol="BTC-USDT",
    position_side="long",
    updates={
        "peak_profit_usd": 50.0,
        "peak_profit_time": datetime.now(timezone.utc),
        "partial_tp_executed": True
    }
)
```

**–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏:**
```python
position, metadata = await position_registry.get_position("BTC-USDT", "long")
```

---

## üîÑ POSITION SYNC - –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø –° –ë–ò–†–ñ–ï–ô

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏ –Ω–∞ –±–∏—Ä–∂–µ. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è "drift" –ø–æ–∑–∏—Ü–∏–π.

### –ü—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Å –±–∏—Ä–∂–∏**
```python
exchange_positions = await client.get_positions()
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π –Ω–∞ –±–∏—Ä–∂–µ
```

**–®–∞–≥ 2: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Ä–µ–µ—Å—Ç—Ä–æ–º**
```python
for exchange_pos in exchange_positions:
    symbol = exchange_pos["instId"].replace("-SWAP", "")
    pos_side = exchange_pos["posSide"]
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ:
    local_pos = await position_registry.get_position(symbol, pos_side)
    
    if not local_pos:
        # DRIFT_ADD: –ü–æ–∑–∏—Ü–∏—è –Ω–∞ –±–∏—Ä–∂–µ, –Ω–æ –Ω–µ –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ
        await register_drift_position(exchange_pos)
    elif local_pos["pos"] == "0":
        # DRIFT_REMOVE: –ü–æ–∑–∏—Ü–∏—è –≤ —Ä–µ–µ—Å—Ç—Ä–µ, –Ω–æ –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ
        await remove_drift_position(symbol, pos_side)
```

**–®–∞–≥ 3: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è drift –ø–æ–∑–∏—Ü–∏–π**
```python
async def register_drift_position(exchange_pos):
    # –°–æ–∑–¥–∞–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è drift –ø–æ–∑–∏—Ü–∏–∏:
    metadata = PositionMetadata(
        entry_time=datetime.now(timezone.utc),
        regime="drift_add",  # –£–∫–∞–∑—ã–≤–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫
        balance_profile=get_balance_profile(),
        entry_price=float(exchange_pos["avgPx"]),
        position_side=exchange_pos["posSide"],
        size_in_coins=float(exchange_pos["pos"]),
        margin_used=float(exchange_pos["margin"]),
        leverage=int(exchange_pos["lever"])
    )
    
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –≤ PositionRegistry:
    await position_registry.register_position(
        symbol=symbol,
        position=exchange_pos,
        metadata=metadata
    )
```

### –¢–∏–ø—ã drift

**DRIFT_ADD:**
- –ü–æ–∑–∏—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ –±–∏—Ä–∂–µ, –Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ
- –ü—Ä–∏—á–∏–Ω—ã: –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞, —Ä—É—á–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ, –æ—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –î–µ–π—Å—Ç–≤–∏–µ: —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ PositionRegistry —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏

**DRIFT_REMOVE:**
- –ü–æ–∑–∏—Ü–∏—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ, –Ω–æ –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ
- –ü—Ä–∏—á–∏–Ω—ã: –ª–∏–∫–≤–∏–¥–∞—Ü–∏—è, —Ä—É—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ, –æ—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
- –î–µ–π—Å—Ç–≤–∏–µ: —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ PositionRegistry

---

## üéØ –ê–î–ê–ü–¢–ò–í–ù–ê–Ø –°–ò–°–¢–ï–ú–ê –§–ò–õ–¨–¢–†–û–í V2

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤, –∫–æ—Ç–æ—Ä–∞—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–¥ —Ç–µ–∫—É—â–∏–µ —Ä—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è.

**–§–∞–π–ª:** `src/strategies/scalping/futures/adaptivity/filter_parameters.py`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ö–ª–∞—Å—Å:** `AdaptiveFilterParameters`

**–§–∞–∫—Ç–æ—Ä—ã –∞–¥–∞–ø—Ç–∞—Ü–∏–∏:**
1. **–†–µ–∂–∏–º —Ä—ã–Ω–∫–∞** (trending/ranging/choppy) - 50% –≤–ª–∏—è–Ω–∏—è
2. **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å** (ATR) - 30% –≤–ª–∏—è–Ω–∏—è
3. **Win Rate** (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å) - 20% –≤–ª–∏—è–Ω–∏—è

### –§–æ—Ä–º—É–ª–∞ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏

**–í–∑–≤–µ—à–µ–Ω–Ω–æ–µ —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```python
final_value = base * (1 + 0.5*regime_factor + 0.3*volatility_factor + 0.2*winrate_factor)
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –õ–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å (–ø—Ä–æ—â–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
- –ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ
- –ú–µ–Ω—å—à–µ —Ä–∏—Å–∫–∞ –ø–µ—Ä–µ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**1. Reversal Threshold (–ø–æ—Ä–æ–≥ V-–æ–±—Ä–∞–∑–Ω–æ–≥–æ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞):**
- –ë–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 0.15%
- –î–∏–∞–ø–∞–∑–æ–Ω: 0.05% - 0.5%
- –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ä–µ–∂–∏–º –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

**2. ADX Threshold:**
- –ë–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 20.0
- –î–∏–∞–ø–∞–∑–æ–Ω: 15.0 - 30.0
- –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ä–µ–∂–∏–º –∏ win rate

**3. Correlation Threshold:**
- –ë–∞–∑–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: 0.7
- –î–∏–∞–ø–∞–∑–æ–Ω: 0.5 - 0.9
- –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ —Ä–µ–∂–∏–º –∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á—Ç–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

1. **per-symbol per-regime** (symbol_profiles[symbol][regime])
2. **per-regime** (adaptive_regime[regime])
3. **global** (scalping_config)
4. **fallback** (–∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

### –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

- **TTL:** 60 —Å–µ–∫—É–Ω–¥
- **–ö–ª—é—á –∫—ç—à–∞:** `{parameter}_{symbol}_{regime}`
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –°–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ —Å–∏—Å—Ç–µ–º—É

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**SignalGenerator:**
```python
# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
self.adaptive_filter_params = AdaptiveFilterParameters(
    config_manager=self.config_manager,
    regime_manager=self.regime_manager,
    data_registry=self.data_registry,
    trading_statistics=self.trading_statistics
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
reversal_threshold = self.adaptive_filter_params.get_reversal_threshold(
    symbol=symbol,
    regime=regime_name_ma
)
```

---

## ‚öôÔ∏è PARAMETER ORCHESTRATOR

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤. –†–∞–∑—Ä–µ—à–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞, –±–∞–ª–∞–Ω—Å–∞ –∏ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–§–∞–π–ª:** `src/strategies/scalping/futures/parameters/parameter_orchestrator.py`

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–ö–ª–∞—Å—Å:** `ParameterOrchestrator`

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `ParameterBundle` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- `ParameterStatus` - —Å—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- `ParameterSchema` - —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã

**resolve_bundle():**
```python
def resolve_bundle(
    self,
    symbol: str,
    regime: Optional[str] = None,
    market_data: Optional[Any] = None,
    balance: Optional[float] = None,
    position: Optional[Any] = None,
    include_signal: bool = True,
    include_exit: bool = True,
    include_order: bool = True,
    include_risk: bool = True,
    include_patterns: bool = True,
) -> ParameterBundle:
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ò–∑–≤–ª–µ–∫–∞–µ—Ç candles –∏ current_price –∏–∑ market_data
- –†–∞–∑—Ä–µ—à–∞–µ—Ç —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ —á–µ—Ä–µ–∑ regime_manager.detect_regime()
- –°–æ–±–∏—Ä–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (config, adaptive_regime, per-symbol)
- –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç ParameterBundle —Å status –∏ resolved –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

**_resolve_regime():**
```python
def _resolve_regime(
    self, 
    symbol: str, 
    regime: Optional[str], 
    status: ParameterStatus, 
    candles: Optional[List] = None, 
    current_price: Optional[float] = None
) -> Optional[str]:
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞:**
1. –ï—Å–ª–∏ regime –ø–µ—Ä–µ–¥–∞–Ω - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ
2. –ò–Ω–∞—á–µ –≤—ã–∑—ã–≤–∞–µ—Ç regime_manager.detect_regime(candles, current_price)
3. Fallback –Ω–∞ get_current_regime() –µ—Å–ª–∏ detect_regime –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
4. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

### –¢–∏–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**SignalParams:**
- min_signal_strength
- max_trades_per_hour
- score_threshold

**ExitParams:**
- tp_percent
- sl_percent
- min_holding_minutes
- max_holding_minutes

**OrderParams:**
- limit_offset_percent
- post_only
- reduce_only

**RiskParams:**
- max_position_size
- max_margin_percent
- leverage

**PatternParams:**
- pattern_detection_enabled
- min_pattern_confidence

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- SignalGenerator - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è signal_params
- PositionManager - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è exit_params
- OrderExecutor - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è order_params
- RiskManager - –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è risk_params

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
```python
# –í orchestrator.py
bundle = self.parameter_orchestrator.resolve_bundle(
    symbol=symbol,
    market_data=market_data,
    balance=balance
)

if bundle.status.valid:
    signal_params = bundle.signal
    exit_params = bundle.exit
    # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤...
else:
    logger.error(f"Parameter resolution failed: {bundle.status.errors}")
```

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

**No fallbacks:** –ï—Å–ª–∏ —Ç—Ä–µ–±—É–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç invalid status
**Type safety:** –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ Pydantic
**Validation:** –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
**Logging:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

---

## üéØ PATTERN DETECTION SYSTEM

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ —Ü–µ–Ω–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ –≤—Ö–æ–¥–µ/–≤—ã—Ö–æ–¥–µ.

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/patterns/pattern_detector.py`
- `src/strategies/scalping/futures/patterns/pattern_engine.py`

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

**–¶–µ–Ω–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**
- Double Top/Bottom
- Head and Shoulders
- Triangle patterns (Ascending/Descending/Symmetrical)
- Flag patterns
- Wedge patterns

**–û–±—ä–µ–º–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**
- Volume spikes
- Volume climaxes
- Volume divergences

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**PatternDetector:**
- –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
- –í—ã—á–∏—Å–ª—è–µ—Ç confidence score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–∞

**PatternEngine:**
- –î–≤–∏–∂–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Ç–æ—Ä–≥–æ–≤—ã–º —Ü–∏–∫–ª–æ–º
- –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–∞—Ç—Ç–µ—Ä–Ω-—Å–∏–≥–Ω–∞–ª—ã –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

**–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞:**
```python
def detect_pattern(self, candles: List[Candle], current_price: float) -> PatternResult:
    # 1. –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ü–µ–Ω—ã
    structure = self.analyze_price_structure(candles)
    
    # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω–∞
    if self.is_double_top(structure):
        confidence = self.calculate_confidence(structure)
        return PatternResult(
            pattern_type="double_top",
            confidence=confidence,
            direction="short",
            target_price=structure.neckline
        )
    
    return None
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏–≥–Ω–∞–ª–∞–º–∏:**
```python
# –í SignalGenerator
pattern_result = self.pattern_detector.detect_pattern(candles, current_price)
if pattern_result and pattern_result.confidence > threshold:
    if pattern_result.direction == signal.direction:
        # –£—Å–∏–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
        signal.strength *= (1 + pattern_result.confidence * 0.2)
    else:
        # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–µ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
        return None
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

**–í config_futures.yaml:**
```yaml
patterns:
  enabled: true
  min_confidence: 0.7
  lookback_candles: 50
  patterns:
    double_top:
      enabled: true
      min_height_percent: 2.0
      max_tolerance_percent: 0.5
    head_shoulders:
      enabled: true
      min_symmetry_ratio: 0.8
    triangles:
      enabled: true
      min_breakout_volume: 1.5
```

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è:** –ü–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç—Å–µ–∏–≤–∞—Ç—å —Å–ª–∞–±—ã–µ —Å–∏–≥–Ω–∞–ª—ã
- **–£—Å–∏–ª–µ–Ω–∏–µ —Å–∏–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º–∏ –ø–æ–≤—ã—à–∞–µ—Ç confidence
- **–ü—Ä–æ–≥–Ω–æ–∑ –¥–≤–∏–∂–µ–Ω–∏—è:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –¥–∞—é—Ç —Ü–µ–ª–µ–≤—ã–µ —É—Ä–æ–≤–Ω–∏

---

## üéõÔ∏è TRADING CONTROL CENTER

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ç–æ—Ä–≥–æ–≤–æ–π –ª–æ–≥–∏–∫–∏, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –≥–ª–∞–≤–Ω—ã–º —Ü–∏–∫–ª–æ–º —Ç–æ—Ä–≥–æ–≤–ª–∏.

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/trading_control_center.py`

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

**1. –ì–ª–∞–≤–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∏—Å–∫–æ–≤

**2. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π:**
- SignalGenerator - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
- SignalCoordinator - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
- PositionManager - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
- OrderCoordinator - –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
- TrailingSLCoordinator - —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å

**3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ü–∏–∫–ª–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫

### –¶–∏–∫–ª —Ä–∞–±–æ—Ç—ã

```python
while active:
    for symbol in symbols:
        # 1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        await _update_market_data(symbol)
        
        # 2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
        signal = await signal_generator.generate_signal(symbol)
        
        # 3. –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
        if signal:
            await signal_coordinator.process_signal(signal)
        
        # 4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
        await position_manager.manage_positions()
        
        # 5. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å
        await trailing_sl_coordinator.update_all()
```

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- **–¶–µ–ª–µ–≤–æ–µ –≤—Ä–µ–º—è —Ü–∏–∫–ª–∞:** < 5 —Å–µ–∫—É–Ω–¥
- **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
- **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–≠—Ç–æ—Ç —Ç–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–ª–æ–∂–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ —Ñ—å—é—á–µ—Ä—Å–∞—Ö OKX —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤, —Ñ–∏–ª—å—Ç—Ä–æ–≤ –∏ –∑–∞—â–∏—Ç. –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ **Futures (USDT-Margined Perpetual Swaps)** —Å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ä–∂–æ–π –∏ **–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –ø–ª–µ—á–æ–º 3-30x**.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (ARM)
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ V2** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–ª–µ—á–æ 3-30x** –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–∞
- ‚úÖ **–õ–µ—Å—Ç–Ω–∏—á–Ω—ã–π –≤—Ö–æ–¥** - –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ **Exit Analyzer** - —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π —Å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
- ‚úÖ **Position Registry** - –µ–¥–∏–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ **Position Sync** - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–∏—Ä–∂–µ–π
- ‚úÖ **Trading Control Center** - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ç–æ—Ä–≥–æ–≤–ª–∏
- ‚úÖ 10+ —Ç–∏–ø–æ–≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–∏–≥–Ω–∞–ª–æ–≤
- ‚úÖ 17+ —Å–∏—Å—Ç–µ–º –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∏—Å–∫–æ–≤
- ‚úÖ Trailing Stop Loss —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º —Ç—Ä–µ–π–ª–∏–Ω–≥–æ–º
- ‚úÖ Partial Take Profit –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ø—Ä–∏–±—ã–ª–∏
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OKX REST API –∏ WebSocket
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ (–¥–µ–∫–∞–±—Ä—å 2025):**
- ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ V2** (23 –¥–µ–∫–∞–±—Ä—è) - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á—Ç–µ–Ω–∏—è SL –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞** (23 –¥–µ–∫–∞–±—Ä—è) - –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –∏–∑ adaptive_regime
- ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ datetime –æ—à–∏–±–æ–∫** (23 –¥–µ–∫–∞–±—Ä—è) - timezone-aware –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–ª–µ—á–æ (3-30x) –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏–ª—ã —Å–∏–≥–Ω–∞–ª–∞
- ‚úÖ –õ–µ—Å—Ç–Ω–∏—á–Ω—ã–π –≤—Ö–æ–¥ —Å —É–º–µ–Ω—å—à–∞—é—â–∏–º—Å—è —Ä–∞–∑–º–µ—Ä–æ–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–π
- ‚úÖ Exit Analyzer —Å —Ä–µ–∂–∏–º-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è
- ‚úÖ Position Registry —Å –ø–æ–ª–Ω—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- ‚úÖ Position Sync –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è drift –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ peak_profit (–º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏)
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –¥–ª—è partial_tp

**–í–∞–∂–Ω–æ:** –ë–æ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ª—É—á—à–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏.

---

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 24 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 2.2

---

## üéØ –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø –î–õ–Ø –ö–ê–ß–ï–°–¢–í–ï–ù–ù–´–• –°–î–ï–õ–û–ö (24.12.2025)

### –¶–µ–ª—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
–ò–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å –º–∏–∫—Ä–æ-–ø—Ä–∏–±—ã–ª—è–º–∏, —Ä–∞–Ω–Ω–∏–º–∏ –∑–∞–∫—Ä—ã—Ç–∏—è–º–∏ –∏ –Ω–∏–∑–∫–∏–º win rate. –ü–æ–ª—É—á–∞—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏ +4-7% –∑–∞ —Å–¥–µ–ª–∫—É –≤–º–µ—Å—Ç–æ –º–∏–∫—Ä–æ-–ø—Ä–∏–±—ã–ª–µ–π.

### –ü—Ä–∏–º–µ–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. –£–≤–µ–ª–∏—á–µ–Ω TP (Take Profit) –¥–æ 4-7%
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π TP: 2.0% ‚Üí 5.0% (+150%)
- TRENDING: 2.5% ‚Üí 6.0% (+140%)
- RANGING: 1.8% ‚Üí 5.0% (+178%)
- CHOPPY: 1.8% ‚Üí 4.5% (+150%)

#### 2. –£–≤–µ–ª–∏—á–µ–Ω initial_trail –¥–ª—è TSL
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π: 1.5% ‚Üí 2.5% (+67%)
- TRENDING: 1.2% ‚Üí 2.0% (+67%)
- RANGING: 2.0% ‚Üí 3.0% (+50%)
- CHOPPY: 2.5% ‚Üí 3.0% (+20%)
- max_trail: 3.5% ‚Üí 5.0% (+43%)
- min_trail: 0.5% ‚Üí 1.0% (+100%)

#### 3. –£–≤–µ–ª–∏—á–µ–Ω min_score_threshold
- TRENDING: 1.4 ‚Üí 2.0 (+43%)
- RANGING: 1.4 ‚Üí 1.8 (+29%)
- CHOPPY: 1.6 ‚Üí 2.0 (+25%)

#### 4. –£–≤–µ–ª–∏—á–µ–Ω min_profit_to_close
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π: 0.1% ‚Üí 1.5% (+1400%)
- TRENDING: 1.0% ‚Üí 2.0% (+100%)
- RANGING: 2.5% ‚Üí 3.0% (+20%)
- CHOPPY: 1.0% ‚Üí 2.0% (+100%)

#### 5. –£–≤–µ–ª–∏—á–µ–Ω min_holding_minutes
- –ì–ª–æ–±–∞–ª—å–Ω—ã–π: 0.5 –º–∏–Ω ‚Üí 1.0 –º–∏–Ω (+100%)
- TRENDING: 2.0 –º–∏–Ω ‚Üí 3.0 –º–∏–Ω (+50%)
- RANGING: 0.2 –º–∏–Ω ‚Üí 1.0 –º–∏–Ω (+400%)
- CHOPPY: 0.3 –º–∏–Ω ‚Üí 1.0 –º–∏–Ω (+233%)

#### 6. –°–Ω–∏–∂–µ–Ω–æ max_trades_per_hour
- TRENDING: 35 ‚Üí 20 (-43%)
- RANGING: 22 ‚Üí 15 (-32%)
- CHOPPY: 10 ‚Üí 8 (-20%)

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–∏–±—ã–ª–∏: +4-7% –∑–∞ —Å–¥–µ–ª–∫—É –≤–º–µ—Å—Ç–æ –º–∏–∫—Ä–æ-–ø—Ä–∏–±—ã–ª–µ–π
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä–∞–Ω–Ω–∏—Ö –∑–∞–∫—Ä—ã—Ç–∏–π: TSL –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ
- ‚úÖ –ü–æ–≤—ã—à–µ–Ω–Ω—ã–π win rate: —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ª–∞–±—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- ‚úÖ –ú–µ–Ω—å—à–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫: –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–µ —Ñ–∏–ª—å—Ç—Ä—ã

---

## üîß –ö–û–û–†–î–ò–ù–ê–¢–û–†–´ (COORDINATORS)

### –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å–ª–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏

–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ –∞—Å–ø–µ–∫—Ç–∞–º–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –µ–¥–∏–Ω—É—é –ª–æ–≥–∏–∫—É.

#### 1. SignalCoordinator - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `process_signals(signals: List[Dict])` - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–∏—Å–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
- `check_for_signals(symbol: str)` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è —Å–∏–º–≤–æ–ª–∞
- `validate_signal(signal: Dict)` - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ–º
- `execute_signal(signal: Dict)` - –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- Throttling —Å–∏–≥–Ω–∞–ª–æ–≤ (–ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∏–∑–±—ã—Ç–æ—á–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –±–∞–ª–∞–Ω—Å–∞ –∏ –º–∞—Ä–∂–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–æ–∑–∏—Ü–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EntryManager –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ —á–µ—Ä–µ–∑ ConversionMetrics

**Throttling:**
```python
# –ú–∏–Ω–∏–º—É–º 30 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è–º–∏
_warning_throttle_seconds = 30.0
_last_warning_time: Dict[str, float] = {}
```

#### 2. ExitDecisionCoordinator - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/exit_decision_coordinator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ä–µ—à–µ–Ω–∏—è –æ—Ç –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è –∏ –≤—ã–±–∏—Ä–∞–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.

**–ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤:**
```python
EXIT_PRIORITIES = {
    "emergency_loss_protection": 1,  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–±—ã—Ç–æ–∫ - —Å–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π
    "sl_reached": 2,                 # Stop Loss –¥–æ—Å—Ç–∏–≥–Ω—É—Ç
    "tp_reached": 3,                 # Take Profit –¥–æ—Å—Ç–∏–≥–Ω—É—Ç
    "trailing_stop": 4,              # Trailing Stop Loss —Å—Ä–∞–±–æ—Ç–∞–ª
    "max_holding_time": 5,           # –ü—Ä–µ–≤—ã—à–µ–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
    "smart_exit_reversal": 6,        # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ —Ä–∞–∑–≤–æ—Ä–æ—Ç—É
    "smart_exit_pattern": 7,         # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
    "partial_tp": 8,                 # –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
    "extend_tp": 9,                  # –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP (–Ω–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)
}
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `analyze_position(symbol, position, metadata, market_data, current_price, regime)` - –ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–∏ –∏ –≤–æ–∑–≤—Ä–∞—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
- `_check_trailing_stop()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ Trailing Stop Loss
- `_check_smart_exit()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ Smart Exit
- `_check_position_manager()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ TP/SL —á–µ—Ä–µ–∑ PositionManager

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- ExitAnalyzer - –æ—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∞
- TrailingSLCoordinator - —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å—ã
- SmartExitCoordinator - —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
- PositionManager - –ø—Ä–æ–≤–µ—Ä–∫–∏ TP/SL
- PriorityResolver - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

#### 3. PriorityResolver - –†–µ–∑–æ–ª–≤–µ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/priority_resolver.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω—É—é —Å–∏—Å—Ç–µ–º—É –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π.

**–ú–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤:**

**EXIT_PRIORITIES** (–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π):
- emergency_loss_protection: 1
- sl_reached: 2
- tp_reached: 3
- trailing_stop: 4
- max_holding_time: 5
- smart_exit_reversal: 6
- smart_exit_pattern: 7
- partial_tp: 8
- extend_tp: 9

**ENTRY_PRIORITIES** (–æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π):
- high_confidence_signal: 1
- medium_confidence_signal: 2
- low_confidence_signal: 3
- scaling_in: 4

**RISK_PRIORITIES** (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏):
- liquidation_risk: 1
- margin_call: 2
- max_drawdown: 3
- correlation_limit: 4
- position_limit: 5

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `resolve_exit_priority(decisions: List[Dict])` - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
- `resolve_entry_priority(signals: List[Dict])` - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è
- `resolve_risk_priority(risk_actions: List[Dict])` - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –¥–ª—è —Ä–∏—Å–∫–æ–≤
- `compare_priorities(reason1, reason2, matrix_type)` - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤

#### 4. SmartExitCoordinator - –£–º–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∑–∞–∫—Ä—ã—Ç–∏—è

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/smart_exit_coordinator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (RSI, MACD, Bollinger, ADX) –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–õ–æ–≥–∏–∫–∞ —É–º–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è:**

**–î–ª—è LONG –ø–æ–∑–∏—Ü–∏–∏:**
```python
# RSI –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω (>70) ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
if rsi > 70:
    return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º

# MACD –º–µ–¥–≤–µ–∂–∏–π (macd < signal) ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
if macd_line < signal_line:
    return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º

# Bollinger: —Ü–µ–Ω–∞ –≤—ã—à–µ –≤–µ—Ä—Ö–Ω–µ–π –ø–æ–ª–æ—Å—ã ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
if price > bb_upper:
    return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º
```

**–î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–∏:**
```python
# RSI –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω (<30) ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
if rsi < 30:
    return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º

# MACD –±—ã—á–∏–π (macd > signal) ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
if macd_line > signal_line:
    return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º

# Bollinger: —Ü–µ–Ω–∞ –Ω–∏–∂–µ –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã ‚Üí —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
if price < bb_lower:
    return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `check_position(symbol, position)` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å —É–º–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º
- `_apply_smart_filter(symbol, side, indicators)` - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —É–º–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ WebSocketCoordinator.handle_ticker_data()
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ü–µ–Ω—ã
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç DataRegistry –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

#### 5. TrailingSLCoordinator - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/trailing_sl_coordinator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞–º–∏ –¥–ª—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `update_all()` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö TSL –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
- `update_for_symbol(symbol)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ TSL –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
- `initialize_trailing_stop(symbol, entry_price, side, leverage, metadata)` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TSL
- `check_trailing_stop(symbol, current_price)` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è TSL

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- PositionRegistry - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- DataRegistry - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Ü–µ–Ω
- ExitDecisionCoordinator - –ø–µ—Ä–µ–¥–∞—á–∞ —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏

#### 6. OrderCoordinator - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ—Ä–¥–µ—Ä–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/order_coordinator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞–º–∏ –Ω–∞ –±–∏—Ä–∂–µ.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ (MARKET/LIMIT)
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ä–¥–µ—Ä–æ–≤
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- –û—Ç–º–µ–Ω–∞ –æ—Ä–¥–µ—Ä–æ–≤

#### 7. WebSocketCoordinator - –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä WebSocket

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/websocket_coordinator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª—è–µ—Ç WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è–º–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket OKX
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–∏–∫–µ—Ä—ã
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ü–µ–Ω
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SmartExitCoordinator –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–∑–∏—Ü–∏–π

---

## üßÆ –ú–û–î–£–õ–ò –†–ê–°–ß–ï–¢–û–í (CALCULATIONS)

### –†–∞—Å—á–µ—Ç–Ω—ã–µ –º–æ–¥—É–ª–∏ - –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è

#### 1. MarginCalculator - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∞—Ä–∂–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/calculations/margin_calculator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏, –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**calculate_max_position_size(equity, current_price, leverage):**
```python
# –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ–∑–∏—Ü–∏—è = (–ë–∞–ª–∞–Ω—Å * –ü–ª–µ—á–æ) / –¶–µ–Ω–∞
max_position_value = equity * leverage
max_position_size = max_position_value / current_price
```

**calculate_liquidation_price(side, entry_price, position_size, equity, leverage):**
```python
# –î–ª—è LONG:
liquidation_price = entry_price * (1 - (1/leverage) + maintenance_margin_ratio)
liquidation_price *= 0.999  # –ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –∫–æ–º–∏—Å—Å–∏–∏

# –î–ª—è SHORT:
liquidation_price = entry_price * (1 + (1/leverage) - maintenance_margin_ratio)
liquidation_price *= 1.001  # –ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –∫–æ–º–∏—Å—Å–∏–∏
```

**calculate_margin_ratio(position_value, equity, leverage):**
```python
margin_used = position_value / leverage
margin_ratio = equity / margin_used  # –ß–µ–º –≤—ã—à–µ, —Ç–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ
```

**is_position_safe(position_value, equity, current_price, entry_price, side, leverage, safety_threshold, regime, position_age_seconds):**
```python
# –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π safety_threshold –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –ø–æ —Ä–µ–∂–∏–º—É
# –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ –ø—Ä–∏:
# - equity < 100 USDT ‚Üí —É—Å–∏–ª–µ–Ω–∏–µ –¥–æ 1.8-2.0
# - ADX –Ω–∏–∑–∫–∏–π ‚Üí —É—Å–∏–ª–µ–Ω–∏–µ
# - –æ—Ç–∫—Ä—ã—Ç–æ >3 –ø–æ–∑–∏—Ü–∏–π ‚Üí —É—Å–∏–ª–µ–Ω–∏–µ

# –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
liquidation_price = calculate_liquidation_price(...)
distance_to_liq = abs(current_price - liquidation_price) / current_price

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
is_safe = distance_to_liq >= safety_threshold
```

**calculate_optimal_position_size(equity, current_price, leverage, risk_percent, sl_percent):**
```python
# –†–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∏—Å–∫–∞
risk_amount = equity * risk_percent
max_loss = risk_amount / sl_percent
optimal_size = max_loss / current_price
```

**get_margin_health_status(equity, used_margin, leverage):**
```python
# –°—Ç–∞—Ç—É—Å—ã:
# - "healthy": margin_ratio > 2.0
# - "warning": margin_ratio 1.5-2.0
# - "critical": margin_ratio < 1.5
```

#### 2. PnLCalculator - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/calculations/pnl_calculator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç PnL —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π –∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**calculate_pnl(symbol, side, entry_price, exit_price, size_in_contracts, entry_time, entry_order_type, entry_post_only, exit_order_type):**
```python
# 1. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –≤ –º–æ–Ω–µ—Ç—ã
size_in_coins = size_in_contracts * ct_val

# 2. –†–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π
entry_commission = notional_entry * entry_commission_rate
exit_commission = notional_exit * exit_commission_rate
total_commission = entry_commission + exit_commission

# 3. –†–∞—Å—á–µ—Ç Gross PnL
if side == "long":
    gross_pnl = (exit_price - entry_price) * size_in_coins
else:  # short
    gross_pnl = (entry_price - exit_price) * size_in_coins

# 4. –†–∞—Å—á–µ—Ç Net PnL
net_pnl = gross_pnl - total_commission

# 5. –†–∞—Å—á–µ—Ç PnL –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
pnl_percent = (net_pnl / notional_entry) * 100

# 6. –†–∞—Å—á–µ—Ç duration
duration_sec = (datetime.now(timezone.utc) - entry_time).total_seconds()
duration_min = duration_sec / 60.0
```

**–ö–æ–º–∏—Å—Å–∏–∏:**
- Maker (LIMIT + post-only): 0.02% (0.0002)
- Taker (MARKET): 0.05% (0.0005)

**–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```python
{
    "gross_pnl": float,
    "net_pnl": float,
    "commission_entry": float,
    "commission_exit": float,
    "commission_total": float,
    "pnl_percent_from_price": float,
    "size_in_coins": float,
    "size_in_contracts": float,
    "notional_entry": float,
    "duration_sec": float,
    "duration_min": float,
}
```

#### 3. PositionSizer - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/calculations/position_sizer.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**calculate_position_size(signal, regime, regime_params, balance_profile, balance):**
```python
# 1. –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä (–ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
risk_per_trade = _get_risk_per_trade(regime, regime_params)
base_size_usd = balance * risk_per_trade

# 2. –†–µ–∂–∏–º–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å
regime_multiplier = regime_calculator.calculate_position_size_multiplier(...)
adjusted_size_usd = base_size_usd * regime_multiplier

# 3. Balance profile boost
size_boost = balance_params.get("position_size_boost", 1.0)
adjusted_size_usd = adjusted_size_usd * size_boost

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —á–µ—Ä–µ–∑ MarginCalculator
max_size = margin_calculator.calculate_max_position_size(...)
adjusted_size_usd = min(adjusted_size_usd, max_size * price)

# 5. –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –º–æ–Ω–µ—Ç—ã
position_size_coins = adjusted_size_usd / price
```

**–†–µ–∂–∏–º–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:**
- TRENDING: 1.0
- RANGING: 0.9
- CHOPPY: 0.5

#### 4. RegimeCalculator - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–∂–∏–º–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/calculations/regime_calculator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**calculate_tp_percent(symbol, regime, balance_profile):**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–∑–æ–≤–æ–≥–æ TP –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
base_tp = get_base_tp_from_config(regime)

# Balance profile boost
tp_boost = _get_tp_boost(balance_profile)
# SMALL: 1.0x
# MEDIUM: 1.1x
# LARGE: 1.2x

final_tp = base_tp * tp_boost
```

**calculate_sl_percent(symbol, regime, balance_profile):**
```python
# –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ TP, –Ω–æ —Å –º–µ–Ω—å—à–∏–º–∏ boost –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
base_sl = get_base_sl_from_config(regime)
sl_boost = _get_sl_boost(balance_profile)
final_sl = base_sl * sl_boost
```

**calculate_position_size_multiplier(symbol, regime, balance_profile):**
```python
# –ë–∞–∑–æ–≤—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ —Ä–µ–∂–∏–º—É
base_multiplier = get_regime_multiplier(regime)

# Balance profile boost
profile_boost = _get_position_size_boost(balance_profile)
# SMALL: 1.0x
# MEDIUM: 1.1x
# LARGE: 1.2x

final_multiplier = base_multiplier * profile_boost
```

#### 5. BalanceCalculator - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–∞–ª–∞–Ω—Å–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/calculations/balance_calculator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –±–∞–ª–∞–Ω—Å–∞ –∏ —Ä–∞—Å—á–µ—Ç –±–∞–ª–∞–Ω—Å–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**determine_balance_profile(balance):**
```python
if balance < 1500:
    return "small"
elif balance < 3500:
    return "medium"
else:
    return "large"
```

**calculate_balance_parameters(balance, profile):**
```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ—Ñ–∏–ª—è:
# SMALL: base_position=$50, min=$20, max=$120, max_open=2, max_percent=8%
# MEDIUM: base_position=$100, min=$40, max=$200, max_open=3, max_percent=6%
# LARGE: base_position=$200, min=$80, max=$400, max_open=3, max_percent=5%

# Boost –∑–Ω–∞—á–µ–Ω–∏—è:
tp_boost = _get_tp_boost(profile)
position_size_boost = _get_position_size_boost(profile)
```

---

## üìä –ú–ï–¢–†–ò–ö–ò –ò –ú–û–ù–ò–¢–û–†–ò–ù–ì (METRICS)

### –°–∏—Å—Ç–µ–º—ã –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

#### 1. ConversionMetrics - –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/metrics/conversion_metrics.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ.

**–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤, –ø—Ä–æ—à–µ–¥—à–∏—Ö —Ñ–∏–ª—å—Ç—Ä—ã
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤, –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö (–æ—Ç–∫—Ä—ã—Ç—ã –ø–æ–∑–∏—Ü–∏–∏)
- –ö–æ–Ω–≤–µ—Ä—Å–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
- –ü—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**record_signal_generated(symbol, signal_type, regime, strength):**
```python
# –ó–∞–ø–∏—Å—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
signals_generated[symbol] += 1
signals_by_regime[regime]["generated"] += 1
signals_by_type[signal_type]["generated"] += 1
```

**record_signal_filtered(symbol, reason, signal_type, regime):**
```python
# –ó–∞–ø–∏—Å—å –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞
signals_filtered[symbol] += 1
filter_reasons[symbol][reason] += 1
```

**record_signal_executed(symbol, signal_type, regime):**
```python
# –ó–∞–ø–∏—Å—å –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ (–æ—Ç–∫—Ä—ã—Ç–∞ –ø–æ–∑–∏—Ü–∏—è)
signals_executed[symbol] += 1
```

**get_conversion_rate(symbol, period_hours):**
```python
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
{
    "generated": int,
    "filtered": int,
    "executed": int,
    "filter_to_generated": float,      # –ö–æ–Ω–≤–µ—Ä—Å–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (%)
    "executed_to_generated": float,   # –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è (%)
    "executed_to_filtered": float,     # –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (%)
}
```

**get_filter_reasons(symbol, top_n):**
```python
# –¢–æ–ø –ø—Ä–∏—á–∏–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
[
    {"reason": str, "count": int, "percentage": float},
    ...
]
```

**get_regime_stats():**
```python
# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–∂–∏–º–∞–º
{
    "trending": {"generated": int, "filtered": int, "executed": int, "conversion_rate": float},
    "ranging": {...},
    "choppy": {...},
}
```

#### 2. HoldingTimeMetrics - –ú–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è

**–§–∞–π–ª:** `src/strategies/scalping/futures/metrics/holding_time_metrics.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π.

**–û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:**
- –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π
- –í—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ —Ä–µ–∂–∏–º–∞–º
- –í—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ —Ç–∏–ø–∞–º –≤—ã—Ö–æ–¥–∞ (TP, SL, Emergency, etc.)
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**record_position_opened(symbol, regime, position_id):**
```python
# –ó–∞–ø–∏—Å—å –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏
_positions_history.append({
    "position_id": position_id,
    "symbol": symbol,
    "regime": regime,
    "opened_at": datetime.now(),
    "closed_at": None,
    "exit_reason": None,
    "holding_seconds": None,
})
```

**record_position_closed(symbol, exit_reason, position_id, opened_at):**
```python
# –ó–∞–ø–∏—Å—å –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏
holding_seconds = (closed_at - opened_at).total_seconds()
holding_times_by_regime[regime].append(holding_seconds)
holding_times_by_exit[exit_reason].append(holding_seconds)
holding_times_by_symbol[symbol].append(holding_seconds)
```

**get_average_holding_time(symbol, regime, exit_reason, period_hours):**
```python
# –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
```

**get_holding_time_stats(symbol, regime, period_hours):**
```python
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
{
    "average": float,      # –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è (—Å–µ–∫—É–Ω–¥—ã)
    "median": float,       # –ú–µ–¥–∏–∞–Ω–∞
    "min": float,          # –ú–∏–Ω–∏–º—É–º
    "max": float,          # –ú–∞–∫—Å–∏–º—É–º
    "count": int,          # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π
    "by_exit_reason": {    # –ü–æ –ø—Ä–∏—á–∏–Ω–∞–º –≤—ã—Ö–æ–¥–∞
        "tp_reached": float,
        "sl_reached": float,
        ...
    },
}
```

#### 3. AlertManager - –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/metrics/alert_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–ª–µ—Ä—Ç–∞–º–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –æ –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö.

**–¢–∏–ø—ã –∞–ª–µ—Ä—Ç–æ–≤:**
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ —Ä–∏—Å–∫–∞
- –ù–µ–æ–±—ã—á–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏–µ —Ü–µ–ª–µ–π

---

## üìà –ò–ù–î–ò–ö–ê–¢–û–†–´ (INDICATORS)

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–∫–∞

#### 1. FastADX - –ë—ã—Å—Ç—Ä—ã–π ADX –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/fast_adx.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—Å–∫–æ—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è ADX –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ü–µ—Ä–∏–æ–¥: 9 (–≤–º–µ—Å—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö 14)
- –ü–æ—Ä–æ–≥ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞: 20.0
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞ –Ω–∞ 1m, 5m —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö

**–§–æ—Ä–º—É–ª–∞ —Ä–∞—Å—á–µ—Ç–∞:**
```python
# True Range
tr = max(
    high - low,
    abs(high - prev_close),
    abs(low - prev_close)
)

# Directional Movement
up_move = high - prev_high
down_move = prev_low - low
plus_dm = up_move if up_move > down_move and up_move > 0 else 0.0
minus_dm = down_move if down_move > up_move and down_move > 0 else 0.0

# Smoothed TR, +DM, -DM (—ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Å–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ)
smoothed_tr = smoothed_tr - (smoothed_tr / period) + tr
smoothed_plus_dm = smoothed_plus_dm - (smoothed_plus_dm / period) + plus_dm
smoothed_minus_dm = smoothed_minus_dm - (smoothed_minus_dm / period) + minus_dm

# Directional Indicators
di_plus = 100 * (smoothed_plus_dm / smoothed_tr)
di_minus = 100 * (smoothed_minus_dm / smoothed_tr)

# Directional Index
di_sum = di_plus + di_minus
dx = 100 * abs(di_plus - di_minus) / di_sum

# ADX (—Å–≥–ª–∞–∂–µ–Ω–Ω—ã–π DX)
adx = ((adx * (period - 1)) + dx) / period
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `update(high, low, close)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–æ–≤–æ–π —Å–≤–µ—á–æ–π
- `get_current_adx()` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ ADX
- `get_current_di_plus()` - –ü–æ–ª—É—á–µ–Ω–∏–µ +DI
- `get_current_di_minus()` - –ü–æ–ª—É—á–µ–Ω–∏–µ -DI
- `is_trend_strong()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ (ADX > threshold)
- `get_trend_direction()` - –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ (bullish/bearish/neutral)
- `get_trend_info()` - –ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–µ–Ω–¥–µ

#### 2. OrderFlowIndicator - –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/order_flow_indicator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–Ω–∞–ª–∏–∑ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è bid/ask –æ–±—ä–µ–º–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–ª—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤.

**–§–æ—Ä–º—É–ª–∞ Delta:**
```python
delta = (bid_volume - ask_volume) / (bid_volume + ask_volume)

# –î–∏–∞–ø–∞–∑–æ–Ω: [-1, 1]
# 1.0 = –≤—Å–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏
# -1.0 = –≤—Å–µ –ø—Ä–æ–¥–∞–≤—Ü—ã
# 0.0 = —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `update(bid_volume, ask_volume)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ bid/ask –æ–±—ä–µ–º–∞—Ö
- `get_delta()` - –¢–µ–∫—É—â–∏–π delta
- `get_avg_delta(periods)` - –°—Ä–µ–¥–Ω–∏–π delta –∑–∞ N –ø–µ—Ä–∏–æ–¥–æ–≤
- `get_delta_trend()` - –¢—Ä–µ–Ω–¥ delta (long/short/neutral)
- `is_long_favorable(threshold)` - –ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–µ–Ω –ª–∏ –≤—Ö–æ–¥ –≤ –ª–æ–Ω–≥
- `is_short_favorable(threshold)` - –ë–ª–∞–≥–æ–ø—Ä–∏—è—Ç–µ–Ω –ª–∏ –≤—Ö–æ–¥ –≤ —à–æ—Ä—Ç
- `get_market_pressure()` - –î–∞–Ω–Ω—ã–µ –æ —Ä—ã–Ω–æ—á–Ω–æ–º –¥–∞–≤–ª–µ–Ω–∏–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- window: 100 (—Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞)
- long_threshold: 0.1 (–ø–æ—Ä–æ–≥ –¥–ª—è –ª–æ–Ω–≥–∞)
- short_threshold: -0.1 (–ø–æ—Ä–æ–≥ –¥–ª—è —à–æ—Ä—Ç–∞)

#### 3. MicroPivotCalculator - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/micro_pivot_calculator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ü–µ–ª–µ–π TP –Ω–∞ –æ—Å–Ω–æ–≤–µ 15-–º–∏–Ω—É—Ç–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞.

**–§–æ—Ä–º—É–ª—ã –ø–∏–≤–æ—Ç–æ–≤:**

**Standard Pivot:**
```python
pivot = (high + low + close) / 3
r1 = 2 * pivot - low
s1 = 2 * pivot - high
r2 = pivot + (high - low)
s2 = pivot - (high - low)
```

**Camarilla Pivots:**
```python
cam_r1 = close + (high - low) * 0.08333
cam_r2 = close + (high - low) * 0.1666
cam_s1 = close - (high - low) * 0.08333
cam_s2 = close - (high - low) * 0.1666
```

**Fibonacci Pivots:**
```python
fib_r1 = pivot + 0.382 * (high - low)
fib_r2 = pivot + 0.618 * (high - low)
fib_s1 = pivot - 0.382 * (high - low)
fib_s2 = pivot - 0.618 * (high - low)
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `update(high, low, close)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–≤–µ—á–∏
- `calculate_pivots()` - –†–∞—Å—á–µ—Ç –≤—Å–µ—Ö –ø–∏–≤–æ—Ç–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
- `get_optimal_tp(entry_price, side, max_distance_pct)` - –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π TP –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∏–≤–æ—Ç–æ–≤
- `get_current_range()` - –¢–µ–∫—É—â–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω —Ü–µ–Ω

#### 4. LiquidityLevelsDetector - –î–µ—Ç–µ–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/liquidity_levels.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–ª–∏–∂–∞–π—à–∏—Ö —É—Ä–æ–≤–Ω–µ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ (–≤—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º) –≤—ã—à–µ –∏ –Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**get_nearest_liquidity(symbol, current_price):**
```python
# –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
{
    "below": {
        "volume": float,          # –û–±—ä–µ–º –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –≤ USDT
        "distance_pct": float,   # –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç —Ü–µ–Ω—ã –≤ %
        "price_level": float,     # –¶–µ–Ω–æ–≤–æ–π —É—Ä–æ–≤–µ–Ω—å –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
        "depth_usd": float       # –ì–ª—É–±–∏–Ω–∞ —Å—Ç–∞–∫–∞–Ω–∞ –≤ USDT
    },
    "above": {
        "volume": float,
        "distance_pct": float,
        "price_level": float,
        "depth_usd": float
    }
}
```

**–ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–∫–∞–Ω–∞:**
- –ê–Ω–∞–ª–∏–∑ –±–∏–¥–æ–≤ (–ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –Ω–∏–∂–µ —Ü–µ–Ω—ã)
- –ê–Ω–∞–ª–∏–∑ –∞—Å–∫–æ–≤ (–ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –≤—ã—à–µ —Ü–µ–Ω—ã)
- –ü–æ–∏—Å–∫ —É—Ä–æ–≤–Ω–µ–π —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –æ–±—ä–µ–º–æ–º
- –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ —É—Ä–æ–≤–Ω–µ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- TTL: 30 —Å–µ–∫—É–Ω–¥
- –°–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ API

#### 5. IndicatorCalculator - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/indicator_calculator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.

**–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
- RSI (Relative Strength Index)
- MACD (Moving Average Convergence Divergence)
- Bollinger Bands
- EMA (Exponential Moving Average)
- SMA (Simple Moving Average)
- ATR (Average True Range)
- ADX (Average Directional Index)

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `calculate_all(candles)` - –†–∞—Å—á–µ—Ç –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- `calculate_rsi(candles, period)` - –†–∞—Å—á–µ—Ç RSI
- `calculate_macd(candles, fast, slow, signal)` - –†–∞—Å—á–µ—Ç MACD
- `calculate_bollinger_bands(candles, period, std_dev)` - –†–∞—Å—á–µ—Ç Bollinger Bands
- `calculate_ema(candles, period)` - –†–∞—Å—á–µ—Ç EMA
- `calculate_sma(candles, period)` - –†–∞—Å—á–µ—Ç SMA
- `calculate_atr(candles, period)` - –†–∞—Å—á–µ—Ç ATR

#### 6. ATRProvider - –ü—Ä–æ–≤–∞–π–¥–µ—Ä ATR

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/atr_provider.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ ATR –∑–Ω–∞—á–µ–Ω–∏–π –¥–ª—è —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `get_atr(symbol)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ ATR
- `get_atr_percent(symbol, price)` - –ü–æ–ª—É—á–µ–Ω–∏–µ ATR –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç —Ü–µ–Ω—ã
- `update_atr(symbol, candles)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ATR

#### 7. FundingRateMonitor - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ funding rate

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/funding_rate_monitor.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ funding rate –¥–ª—è Futures –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ funding rate
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π funding rate
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –≤—ã—Å–æ–∫–æ–º funding rate

---

## üìç –ú–ï–ù–ï–î–ñ–ï–†–´ –ü–û–ó–ò–¶–ò–ô (POSITIONS)

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø–æ–∑–∏—Ü–∏–π

#### 1. EntryManager - –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/entry_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–π.

**–ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏:**

**–®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ PositionRegistry
has_position = await position_registry.has_position(symbol)

# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∏—Ä–∂–µ
exchange_positions = await client.get_positions(symbol)
```

**–®–∞–≥ 2: –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏**
```python
position_size = await _calculate_position_size(
    signal, regime, regime_params, balance_profile
)
```

**–®–∞–≥ 3: –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞**
```python
order_result = await _place_order(signal, position_size)
```

**–®–∞–≥ 4: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ PositionRegistry**
```python
metadata = PositionMetadata(
    entry_time=datetime.now(timezone.utc),
    position_id=f"{symbol}:{timestamp}:{order_id}",
    regime=regime,
    balance_profile=balance_profile,
    entry_price=position_data.get("entry_price"),
    position_side=position_data.get("position_side"),
    leverage=signal.get("leverage"),
    ...
)

await position_registry.register_position(
    symbol=symbol,
    position=position_data,
    metadata=metadata,
)
```

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `open_position(signal, regime, regime_params, balance_profile)` - –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- `open_position_with_size(signal, position_size)` - –û—Ç–∫—Ä—ã—Ç–∏–µ —Å –∑–∞–¥–∞–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º
- `_calculate_position_size()` - –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
- `_place_order()` - –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞
- `_get_position_data()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–∏

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
- PositionRegistry - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
- OrderExecutor - —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
- PositionSizer - —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞
- ConversionMetrics - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

#### 2. PositionMonitor - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/position_monitor.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è (TP/SL/TSL)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ peak_profit
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `monitor_position(symbol, position, metadata)` - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–∏
- `check_exit_conditions()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è
- `update_peak_profit()` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∏–∫–æ–≤–æ–π –ø—Ä–∏–±—ã–ª–∏

#### 3. PeakProfitTracker - –¢—Ä–µ–∫–µ—Ä –ø–∏–∫–æ–≤–æ–π –ø—Ä–∏–±—ã–ª–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/peak_profit_tracker.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ –ø–æ–∑–∏—Ü–∏–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**update_peak_profit(position, current_price):**
```python
# –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ PnL
if pos_side == "long":
    unrealized_pnl = size_in_coins * (current_price - entry_price)
else:  # short
    unrealized_pnl = size_in_coins * (entry_price - current_price)

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π PnL –±–æ–ª—å—à–µ peak_profit
if unrealized_pnl > peak_profit_usd:
    peak_profit_usd = unrealized_pnl
    await position_registry.update_position(
        symbol=symbol,
        metadata_updates={"peak_profit_usd": peak_profit_usd}
    )
```

#### 4. ExitDecisionLogger - –õ–æ–≥–≥–µ—Ä —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_decision_logger.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—à–µ–Ω–∏–π ExitAnalyzer –≤ JSON —Ñ–∞–π–ª—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –≤ JSON —Ñ–æ—Ä–º–∞—Ç
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `logs/futures/debug/exit_decisions/`
- –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è datetime –æ–±—ä–µ–∫—Ç–æ–≤
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

**–§–æ—Ä–º–∞—Ç –ª–æ–≥–∞:**
```json
{
    "timestamp": "2025-12-28T10:30:00",
    "symbol": "BTC-USDT",
    "decision": "close",
    "reason": "tp_reached",
    "pnl_pct": 6.5,
    "regime": "trending",
    "trend_strength": 0.85,
    "metadata": {
        "duration_minutes": 15.5,
        "entry_price": 50000.0,
        "current_price": 53250.0,
        "position_side": "long"
    }
}
```

#### 5. TakeProfitManager - –ú–µ–Ω–µ–¥–∂–µ—Ä —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/take_profit_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞–º–∏ –∏ —á–∞—Å—Ç–∏—á–Ω—ã–º –∑–∞–∫—Ä—ã—Ç–∏–µ–º.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è TP
- –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (Partial TP)
- –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º—É

#### 6. StopLossManager - –ú–µ–Ω–µ–¥–∂–µ—Ä —Å—Ç–æ–ø-–ª–æ—Å—Å–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/stop_loss_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞–º–∏.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è SL
- Break-even SL (–∑–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏)
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ SL –ø–æ —Ä–µ–∂–∏–º—É

---

## üõ°Ô∏è –°–ò–°–¢–ï–ú–´ –†–ò–°–ö–ê (RISK)

### –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–∏—Å–∫–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ø–∏—Ç–∞–ª–æ–º

#### 1. LiquidationProtector - –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/risk/liquidation_protector.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–æ–∑–∏—Ü–∏–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**check_liquidation_risk(symbol, position_size, entry_price, current_price, margin):**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
# TODO: –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
# - –†–∞—Å—á–µ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–Ω—ã
# - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
# - –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –±–ª–∏–∑–æ—Å—Ç–∏ –∫ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
```

#### 2. MarginMonitor - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∞—Ä–∂–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/risk/margin_monitor.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–∞—Ä–∂–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**check_margin_available(required_margin, current_balance, used_margin):**
```python
available_margin = current_balance - used_margin

if required_margin > available_margin:
    return False, "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–∞—Ä–∂–∏"
else:
    return True, "–ú–∞—Ä–∂–∞ –¥–æ—Å—Ç—É–ø–Ω–∞"
```

**get_margin_ratio(current_balance, used_margin):**
```python
# –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –º–∞—Ä–∂–∏ (0.0 - 1.0)
margin_ratio = used_margin / current_balance
```

#### 3. MaxSizeLimiter - –û–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/risk/max_size_limiter.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ –±–∞–ª–∞–Ω—Å—É
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ —Ä–∏—Å–∫—É
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏

---

## üîç –°–ò–°–¢–ï–ú–´ –ê–ù–ê–õ–ò–ó–ê (ANALYSIS)

### –ê–Ω–∞–ª–∏–∑ —Ä—ã–Ω–∫–∞ –∏ –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π

#### 1. DirectionAnalyzer - –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä—ã–Ω–∫–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/analysis/direction_analyzer.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï–¥–∏–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä—ã–Ω–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–∑–≤–µ—à–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.

**–í–µ—Å–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:**
```python
INDICATOR_WEIGHTS = {
    "adx": 0.40,        # ADX - —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π (40%)
    "ema": 0.25,       # EMA - –≤–∞–∂–Ω—ã–π (25%)
    "sma": 0.15,       # SMA - —Å—Ä–µ–¥–Ω–∏–π –≤–µ—Å (15%)
    "price_action": 0.10,  # Price action (10%)
    "volume": 0.10,    # Volume analysis (10%)
}
```

**–ü–æ—Ä–æ–≥–∏:**
- ADX_STRONG_THRESHOLD: 25.0 (—Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥)
- ADX_MODERATE_THRESHOLD: 18.0 (—É–º–µ—Ä–µ–Ω–Ω—ã–π —Ç—Ä–µ–Ω–¥)
- DI_DIFFERENCE_THRESHOLD: 3.0 (—Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É +DI –∏ -DI)

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**analyze_direction(candles, current_price, indicators):**
```python
# 1. ADX –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 40%)
adx_result = _analyze_adx_direction(candles, indicators)

# 2. EMA –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 25%)
ema_result = _analyze_ema_direction(candles, current_price, indicators)

# 3. SMA –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 15%)
sma_result = _analyze_sma_direction(candles, current_price, indicators)

# 4. Price Action –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 10%)
price_action_result = _analyze_price_action(candles, current_price)

# 5. Volume –∞–Ω–∞–ª–∏–∑ (–≤–µ—Å 10%)
volume_result = _analyze_volume(candles)

# –í–∑–≤–µ—à–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
bullish_score = sum(weights * confidences for bullish signals)
bearish_score = sum(weights * confidences for bearish signals)

if bullish_score > bearish_score:
    direction = "bullish"
    confidence = bullish_score
else:
    direction = "bearish"
    confidence = bearish_score
```

**–í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
```python
{
    "direction": "bullish" | "bearish" | "neutral",
    "confidence": 0.0-1.0,
    "adx_value": float,
    "adx_direction": str,
    "ema_direction": str,
    "sma_direction": str,
    "price_action_direction": str,
    "volume_signal": str,
    "weighted_score": float,
    "reason": str
}
```

---

## üìù –°–ò–°–¢–ï–ú–´ –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø (LOGGING)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

#### 1. DebugLogger - –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥–≥–µ—Ä

**–§–∞–π–ª:** `src/strategies/scalping/futures/logging/debug_logger.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π CSV —ç–∫—Å–ø–æ—Ä—Ç–∞.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–∞–º–∏ (üîÑ üîç ‚ùå ‚ú® etc.)
- CSV —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ Excel
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Ä–æ–≤–Ω—è –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–∏
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ü—Ä–µ—Ñ–∏–∫—Å—ã —Å–æ–±—ã—Ç–∏–π:**
- tick: üîÑ
- config: ‚öôÔ∏è
- tsl_create: ‚ú®
- tsl_check: üîç
- close: ‚ùå
- open: üì§
- signal: üìä
- filter: üî•
- position: üìç
- tp_check: üí∞
- warning: ‚ö†Ô∏è
- error: üö®

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `log_tick(symbol, regime, price, minutes_running)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–∏–∫–∞
- `log_config_loaded(symbol, regime, params)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- `log_tsl_created(symbol, entry_price, side, initial_trail)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–∏—è TSL
- `log_tsl_check(symbol, current_price, trailing_sl, pnl_pct)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ TSL
- `log_close(symbol, reason, pnl_pct, duration_min)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è
- `log_open(symbol, side, entry_price, size, leverage)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
- `log_signal(symbol, signal_type, strength, regime)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞
- `log_filter(symbol, filter_name, passed, reason)` - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞

**CSV —ç–∫—Å–ø–æ—Ä—Ç:**
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `logs/futures/debug/debug_YYYYMMDD_HHMMSS.csv`
- –ö–æ–ª–æ–Ω–∫–∏: timestamp, event_type, symbol, data

#### 2. StructuredLogger - –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä

**–§–∞–π–ª:** `src/strategies/scalping/futures/logging/structured_logger.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ JSON —Ñ–æ—Ä–º–∞—Ç.

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- JSON –ª–æ–≥–∏ –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏–π
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `logs/futures/structured/`

#### 3. LoggerFactory - –§–∞–±—Ä–∏–∫–∞ –ª–æ–≥–≥–µ—Ä–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/logging/logger_factory.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

**–ú–µ—Ç–æ–¥—ã:**
- `setup_futures_logging(log_dir, log_level)` - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Futures

---

## üíæ CORE –ú–û–î–£–õ–ò

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

#### 1. DataRegistry - –†–µ–µ—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/data_registry.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Å–∏—Å—Ç–µ–º–µ.

**–•—Ä–∞–Ω–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- Market data (—Ü–µ–Ω—ã, –æ–±—ä–µ–º—ã, —Å–≤–µ—á–∏)
- Indicators (ADX, MA, RSI, etc.)
- Regimes (trending, ranging, choppy) —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- Balance –∏ balance profile
- Margin –¥–∞–Ω–Ω—ã–µ

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**Market Data:**
- `update_market_data(symbol, data)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `get_market_data(symbol)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `get_price(symbol)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã

**Indicators:**
- `update_indicator(symbol, indicator_name, value)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
- `update_indicators(symbol, indicators)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- `get_indicator(symbol, indicator_name)` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
- `get_indicators(symbol, check_freshness)` - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
  - `check_freshness=True`: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ (TTL 1 —Å–µ–∫—É–Ω–¥–∞ –¥–ª—è ADX)

**Regimes:**
- `update_regime(symbol, regime, params)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
- `get_regime(symbol)` - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞

**Balance:**
- `update_balance(balance, profile)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
- `get_balance()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
- `get_balance_profile()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è –±–∞–ª–∞–Ω—Å–∞

**Margin:**
- `update_margin(used, available, total)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–∞—Ä–∂–∏
- `get_margin()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –º–∞—Ä–∂–∏
- `get_margin_used()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ä–∂–∏
- `get_margin_available()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ–π –º–∞—Ä–∂–∏

**CandleBuffer:**
- `get_candle_buffer(symbol, timeframe)` - –ü–æ–ª—É—á–µ–Ω–∏–µ –±—É—Ñ–µ—Ä–∞ —Å–≤–µ—á–µ–π
- `add_candle(symbol, timeframe, candle)` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤–µ—á–∏
- `update_last_candle(symbol, timeframe, high, low, close, volume)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏

**Thread-safety:**
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `asyncio.Lock`
- –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

#### 2. CandleBuffer - –ë—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/candle_buffer.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–π –±—É—Ñ–µ—Ä –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–≤–µ—á–µ–π.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –•—Ä–∞–Ω–∏—Ç N —Å–≤–µ—á–µ–π –≤ –ø–∞–º—è—Ç–∏ (max_size=200 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö —Å–≤–µ—á–µ–π (FIFO)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∏—Ä—É—é—â–µ–π—Å—è —Å–≤–µ—á–∏
- Thread-safe —á–µ—Ä–µ–∑ asyncio.Lock

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `add_candle(candle)` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Å–≤–µ—á–∏
- `update_last_candle(high, low, close, volume)` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏
- `get_candles()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–≤–µ—á–µ–π
- `get_last_candle()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏
- `get_first_candle()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π (—Å–∞–º–æ–π —Å—Ç–∞—Ä–æ–π) —Å–≤–µ—á–∏
- `size()` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π
- `clear()` - –û—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞
- `is_empty()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Å—Ç–æ—Ç—ã

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
- –°–∏–º–≤–æ–ª ‚Üí –¢–∞–π–º—Ñ—Ä–µ–π–º ‚Üí CandleBuffer
- –ù–∞–ø—Ä–∏–º–µ—Ä: "BTC-USDT" ‚Üí "5m" ‚Üí CandleBuffer(max_size=200)

#### 3. ParameterProvider - –ü—Ä–æ–≤–∞–π–¥–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–§–∞–π–ª:** `src/strategies/scalping/futures/config/parameter_provider.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ï–¥–∏–Ω–∞—è —Ç–æ—á–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á—Ç–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
1. per-symbol per-regime (symbol_profiles[symbol][regime])
2. per-regime (adaptive_regime[regime])
3. global (scalping_config)
4. fallback (–∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**

**get_regime_params(symbol, regime, balance):**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–∂–∏–º–∞ —Å –∞–¥–∞–ø—Ç–∞—Ü–∏–µ–π –ø–æ–¥ –±–∞–ª–∞–Ω—Å
regime_params = config_manager.get_regime_params(regime)
if balance:
    adaptive_params = config_manager.get_adaptive_risk_params(balance, regime)
    regime_params = {**regime_params, **adaptive_params}
```

**get_exit_params(symbol, regime):**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ exit_params –∏–∑ raw_config_dict
exit_params = raw_config_dict.get("exit_params", {}).get(regime, {})
```

**get_symbol_params(symbol):**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–∏–º–≤–æ–ª–∞ –∏–∑ symbol_profiles
symbol_params = config_manager.get_symbol_profile(symbol)
```

**get_indicator_params(symbol, regime):**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è —Ä–µ–∂–∏–º–∞
indicator_params = {
    "rsi_period": int,
    "rsi_overbought": float,
    "rsi_oversold": float,
    "atr_period": int,
    ...
}
```

**–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- TTL: 60 —Å–µ–∫—É–Ω–¥
- –ö–ª—é—á: `{parameter}_{symbol}_{regime}`
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üìê –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –†–ê–°–ß–ï–¢–´ –ò –§–û–†–ú–£–õ–´

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ —Ñ–æ—Ä–º—É–ª—ã

#### 1. –†–∞—Å—á–µ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π —Ü–µ–Ω—ã (—É–ª—É—á—à–µ–Ω–Ω—ã–π)

**–î–ª—è LONG –ø–æ–∑–∏—Ü–∏–∏:**
```python
# –§–æ—Ä–º—É–ª–∞ OKX –¥–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ä–∂–∏:
liquidation_price = entry_price * (1 - (1/leverage) + maintenance_margin_ratio)

# –£—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π:
liquidation_price *= 0.999  # –ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –∫–æ–º–∏—Å—Å–∏–∏ (~0.1%)

# –ü—Ä–∏–º–µ—Ä:
# entry_price = $50,000
# leverage = 10x
# maintenance_margin_ratio = 0.01 (1%)
# liquidation_price = 50000 * (1 - 0.1 + 0.01) = 50000 * 0.91 = $45,500
# –° —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π: $45,500 * 0.999 = $45,454.50
```

**–î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–∏:**
```python
liquidation_price = entry_price * (1 + (1/leverage) - maintenance_margin_ratio)
liquidation_price *= 1.001  # –ü–æ–ø—Ä–∞–≤–∫–∞ –Ω–∞ –∫–æ–º–∏—Å—Å–∏–∏
```

#### 2. –†–∞—Å—á–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –º–∞—Ä–∂–∏

```python
margin_ratio = equity / margin_used

# –°—Ç–∞—Ç—É—Å—ã:
# - margin_ratio > 2.0 ‚Üí "healthy" (–∑–¥–æ—Ä–æ–≤—ã–π)
# - margin_ratio 1.5-2.0 ‚Üí "warning" (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ)
# - margin_ratio < 1.5 ‚Üí "critical" (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)
```

#### 3. –†–∞—Å—á–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–∏—Å–∫–∞

```python
# –ú–µ—Ç–æ–¥ 1: –ù–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Ä–∏—Å–∫–∞
risk_amount = equity * risk_percent  # –ù–∞–ø—Ä–∏–º–µ—Ä, 2% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
max_loss = risk_amount / sl_percent  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫
optimal_size = max_loss / current_price  # –†–∞–∑–º–µ—Ä –≤ –º–æ–Ω–µ—Ç–∞—Ö

# –ú–µ—Ç–æ–¥ 2: –ù–∞ –æ—Å–Ω–æ–≤–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –Ω–∞ —Å–¥–µ–ª–∫—É
max_loss_per_trade = equity * max_loss_percent  # –ù–∞–ø—Ä–∏–º–µ—Ä, 2%
max_position_value = max_loss_per_trade / sl_percent
optimal_size = max_position_value / current_price
```

#### 4. –†–∞—Å—á–µ—Ç Order Flow Delta

```python
# Delta –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–æ–±–ª–∞–¥–∞–Ω–∏–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏–ª–∏ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
delta = (bid_volume - ask_volume) / (bid_volume + ask_volume)

# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:
# delta > 0.1 ‚Üí –ü—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ (–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ –¥–ª—è LONG)
# delta < -0.1 ‚Üí –ü—Ä–µ–æ–±–ª–∞–¥–∞—é—Ç –ø—Ä–æ–¥–∞–≤—Ü—ã (–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ –¥–ª—è SHORT)
# -0.1 <= delta <= 0.1 ‚Üí –†–∞–≤–Ω–æ–≤–µ—Å–∏–µ (–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ)
```

#### 5. –†–∞—Å—á–µ—Ç Pivot Points (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ)

```python
# Standard Pivot
pivot = (high + low + close) / 3

# Resistance Levels
r1 = 2 * pivot - low
r2 = pivot + (high - low)

# Support Levels
s1 = 2 * pivot - high
s2 = pivot - (high - low)
```

#### 6. –†–∞—Å—á–µ—Ç Camarilla Pivots

```python
# Camarilla –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è –º–∏–∫—Ä–æ-—É—Ä–æ–≤–Ω–µ–π
cam_r1 = close + (high - low) * 0.08333
cam_r2 = close + (high - low) * 0.1666
cam_r3 = close + (high - low) * 0.5
cam_r4 = close + (high - low) * 1.0

cam_s1 = close - (high - low) * 0.08333
cam_s2 = close - (high - low) * 0.1666
cam_s3 = close - (high - low) * 0.5
cam_s4 = close - (high - low) * 1.0
```

#### 7. –†–∞—Å—á–µ—Ç Fibonacci Pivots

```python
# Fibonacci –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –§–∏–±–æ–Ω–∞—á—á–∏
range_value = high - low

fib_r1 = pivot + 0.382 * range_value
fib_r2 = pivot + 0.618 * range_value
fib_r3 = pivot + 1.0 * range_value

fib_s1 = pivot - 0.382 * range_value
fib_s2 = pivot - 0.618 * range_value
fib_s3 = pivot - 1.0 * range_value
```

#### 8. –†–∞—Å—á–µ—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

```python
# –ö–æ–Ω–≤–µ—Ä—Å–∏—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
filter_to_generated = (filtered / generated) * 100

# –ö–æ–Ω–≤–µ—Ä—Å–∏—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
executed_to_generated = (executed / generated) * 100

# –ö–æ–Ω–≤–µ—Ä—Å–∏—è –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
executed_to_filtered = (executed / (generated - filtered)) * 100
```

#### 9. –†–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è

```python
# –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
avg_holding_time = sum(holding_times) / len(holding_times)

# –ú–µ–¥–∏–∞–Ω–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
sorted_times = sorted(holding_times)
median_holding_time = sorted_times[len(sorted_times) // 2]
```

#### 10. –†–∞—Å—á–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –¥–æ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏

```python
# –î–ª—è LONG
distance_to_liq_pct = ((current_price - liquidation_price) / current_price) * 100

# –î–ª—è SHORT
distance_to_liq_pct = ((liquidation_price - current_price) / current_price) * 100

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
is_safe = distance_to_liq_pct >= (safety_threshold * 100)
```

---

## üîÑ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø –ú–û–î–£–õ–ï–ô

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

#### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏:

```
SignalGenerator ‚Üí SignalCoordinator ‚Üí EntryManager ‚Üí OrderExecutor
                                                      ‚Üì
                                              PositionRegistry
                                                      ‚Üì
                                              TrailingSLCoordinator
                                                      ‚Üì
                                              ConversionMetrics
```

#### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏:

```
PositionMonitor ‚Üí ExitAnalyzer ‚Üí ExitDecisionCoordinator ‚Üí PriorityResolver
                                                                    ‚Üì
                                                          PositionManager
                                                                    ‚Üì
                                                          OrderExecutor
                                                                    ‚Üì
                                                          PositionRegistry (—É–¥–∞–ª–µ–Ω–∏–µ)
                                                                    ‚Üì
                                                          HoldingTimeMetrics
```

#### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ü–µ–Ω—ã:

```
WebSocketCoordinator ‚Üí DataRegistry (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã)
                              ‚Üì
                      TrailingSLCoordinator (–ø—Ä–æ–≤–µ—Ä–∫–∞ TSL)
                              ‚Üì
                      SmartExitCoordinator (—É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)
                              ‚Üì
                      PeakProfitTracker (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ peak_profit)
```

---

## üìã –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –í–°–ï–• –ú–û–î–£–õ–ï–ô –ü–†–û–ï–ö–¢–ê

### –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ: 152 Python —Ñ–∞–π–ª–∞

#### üîß –û–°–ù–û–í–ù–´–ï –ú–û–î–£–õ–ò (10 —Ñ–∞–π–ª–æ–≤)
- `src/__init__.py`
- `src/config.py` - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- `src/models.py` - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
- `src/main_futures.py` - –ó–∞–ø—É—Å–∫ Futures –±–æ—Ç–∞
- `src/main_spot.py` - –ó–∞–ø—É—Å–∫ Spot –±–æ—Ç–∞
- `src/connection_quality_monitor.py` - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–∞—á–µ—Å—Ç–≤–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- `src/market_data_websocket.py` - WebSocket —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- `src/websocket_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä WebSocket
- `src/websocket_order_executor.py` - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ—Ä–¥–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ WebSocket

#### üìä –ö–õ–ò–ï–ù–¢–´ API (3 —Ñ–∞–π–ª–∞)
- `src/clients/__init__.py`
- `src/clients/futures_client.py` - OKX Futures API –∫–ª–∏–µ–Ω—Ç
- `src/clients/spot_client.py` - OKX Spot API –∫–ª–∏–µ–Ω—Ç

#### üìà –ò–ù–î–ò–ö–ê–¢–û–†–´ (6 —Ñ–∞–π–ª–æ–≤)
- `src/indicators/__init__.py`
- `src/indicators/base.py` - –ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- `src/indicators/talib_wrapper.py` - –û–±–µ—Ä—Ç–∫–∞ –¥–ª—è TA-Lib
- `src/indicators/advanced/__init__.py`
- `src/indicators/advanced/candle_patterns.py` - –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Å–≤–µ—á–µ–π
- `src/indicators/advanced/pivot_calculator.py` - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–∏–≤–æ—Ç–æ–≤
- `src/indicators/advanced/volume_profile.py` - –û–±—ä–µ–º–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å

#### ‚ö†Ô∏è –†–ò–°–ö-–ú–ï–ù–ï–î–ñ–ú–ï–ù–¢ (3 —Ñ–∞–π–ª–∞)
- `src/risk/__init__.py`
- `src/risk/risk_controller.py` - –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ä–∏—Å–∫–æ–≤
- `src/risk/risk_controller_config.py` - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤

#### üîç –§–ò–õ–¨–¢–†–´ (3 —Ñ–∞–π–ª–∞)
- `src/filters/__init__.py`
- `src/filters/correlation_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- `src/filters/time_session_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π

#### üí∞ –ë–ê–õ–ê–ù–° (2 —Ñ–∞–π–ª–∞)
- `src/balance/__init__.py`
- `src/balance/adaptive_balance_manager.py` - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –±–∞–ª–∞–Ω—Å–∞

#### ü§ñ ML (1 —Ñ–∞–π–ª)
- `src/ml/__init__.py`

#### üõ†Ô∏è –£–¢–ò–õ–ò–¢–´ (2 —Ñ–∞–π–ª–∞)
- `src/utils/__init__.py`
- `src/utils/telegram_notifier.py` - Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

#### üéØ –°–¢–†–ê–¢–ï–ì–ò–ò - –û–ë–©–ò–ï –ú–û–î–£–õ–ò (13 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/__init__.py`
- `src/strategies/modules/__init__.py`
- `src/strategies/modules/adaptive_regime_manager.py` - ARM –º–µ–Ω–µ–¥–∂–µ—Ä
- `src/strategies/modules/adx_filter.py` - ADX —Ñ–∏–ª—å—Ç—Ä
- `src/strategies/modules/balance_checker.py` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
- `src/strategies/modules/correlation_filter.py` - –§–∏–ª—å—Ç—Ä –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
- `src/strategies/modules/debug_logger.py` - –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥–≥–µ—Ä
- `src/strategies/modules/liquidation_guard.py` - –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
- `src/strategies/modules/margin_calculator.py` - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∞—Ä–∂–∏
- `src/strategies/modules/multi_timeframe.py` - –ú—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º
- `src/strategies/modules/pivot_points.py` - –ü–∏–≤–æ—Ç –ø–æ–∏–Ω—Ç—ã
- `src/strategies/modules/slippage_guard.py` - –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è
- `src/strategies/modules/trading_statistics.py` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏
- `src/strategies/modules/volatility_adapter.py` - –ê–¥–∞–ø—Ç–µ—Ä –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- `src/strategies/modules/volume_profile_filter.py` - –§–∏–ª—å—Ç—Ä –æ–±—ä–µ–º–Ω–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è

#### ‚ö° FUTURES SCALPING - –û–°–ù–û–í–ù–´–ï (10 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/__init__.py`
- `src/strategies/scalping/futures/__init__.py`
- `src/strategies/scalping/futures/orchestrator.py` - –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä
- `src/strategies/scalping/futures/order_executor.py` - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ—Ä–¥–µ—Ä–æ–≤
- `src/strategies/scalping/futures/position_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–∑–∏—Ü–∏–π
- `src/strategies/scalping/futures/private_websocket_manager.py` - –ü—Ä–∏–≤–∞—Ç–Ω—ã–π WebSocket
- `src/strategies/scalping/futures/risk_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤
- `src/strategies/scalping/futures/signal_generator.py` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
- `src/strategies/scalping/futures/tsl_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä TSL
- `src/strategies/scalping/futures/websocket_manager.py` - WebSocket –º–µ–Ω–µ–¥–∂–µ—Ä

#### üéØ FUTURES - –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ (5 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/adaptivity/__init__.py`
- `src/strategies/scalping/futures/adaptivity/balance_manager.py`
- `src/strategies/scalping/futures/adaptivity/filter_parameters.py`
- `src/strategies/scalping/futures/adaptivity/parameter_adapter.py`
- `src/strategies/scalping/futures/adaptivity/regime_manager.py`

#### üìä FUTURES - –ê–ù–ê–õ–ò–ó (2 —Ñ–∞–π–ª–∞)
- `src/strategies/scalping/futures/analysis/__init__.py`
- `src/strategies/scalping/futures/analysis/direction_analyzer.py`

#### üßÆ FUTURES - –†–ê–°–ß–ï–¢–´ (6 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/calculations/__init__.py`
- `src/strategies/scalping/futures/calculations/balance_calculator.py`
- `src/strategies/scalping/futures/calculations/margin_calculator.py`
- `src/strategies/scalping/futures/calculations/pnl_calculator.py`
- `src/strategies/scalping/futures/calculations/position_sizer.py`
- `src/strategies/scalping/futures/calculations/regime_calculator.py`

#### ‚öôÔ∏è FUTURES - –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (4 —Ñ–∞–π–ª–∞)
- `src/strategies/scalping/futures/config/__init__.py`
- `src/strategies/scalping/futures/config/config_manager.py`
- `src/strategies/scalping/futures/config/config_view.py`
- `src/strategies/scalping/futures/config/parameter_provider.py`

#### üéº FUTURES - –ö–û–û–†–î–ò–ù–ê–¢–û–†–´ (8 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/coordinators/__init__.py`
- `src/strategies/scalping/futures/coordinators/exit_decision_coordinator.py`
- `src/strategies/scalping/futures/coordinators/order_coordinator.py`
- `src/strategies/scalping/futures/coordinators/priority_resolver.py`
- `src/strategies/scalping/futures/coordinators/signal_coordinator.py`
- `src/strategies/scalping/futures/coordinators/smart_exit_coordinator.py`
- `src/strategies/scalping/futures/coordinators/trailing_sl_coordinator.py`
- `src/strategies/scalping/futures/coordinators/websocket_coordinator.py`

#### üß† FUTURES - CORE (6 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/core/__init__.py`
- `src/strategies/scalping/futures/core/candle_buffer.py`
- `src/strategies/scalping/futures/core/data_registry.py`
- `src/strategies/scalping/futures/core/position_registry.py`
- `src/strategies/scalping/futures/core/position_sync.py`
- `src/strategies/scalping/futures/core/trading_control_center.py`

#### üî• FUTURES - –§–ò–õ–¨–¢–†–´ (6 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/filters/__init__.py`
- `src/strategies/scalping/futures/filters/funding_rate_filter.py`
- `src/strategies/scalping/futures/filters/liquidity_filter.py`
- `src/strategies/scalping/futures/filters/momentum_filter.py`
- `src/strategies/scalping/futures/filters/order_flow_filter.py`
- `src/strategies/scalping/futures/filters/volatility_regime_filter.py`

#### üìà FUTURES - –ò–ù–î–ò–ö–ê–¢–û–†–´ (10 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/indicators/__init__.py`
- `src/strategies/scalping/futures/indicators/atr_provider.py`
- `src/strategies/scalping/futures/indicators/fast_adx.py`
- `src/strategies/scalping/futures/indicators/funding_rate_monitor.py`
- `src/strategies/scalping/futures/indicators/futures_volume_profile.py`
- `src/strategies/scalping/futures/indicators/indicator_calculator.py`
- `src/strategies/scalping/futures/indicators/liquidity_levels.py`
- `src/strategies/scalping/futures/indicators/micro_pivot_calculator.py`
- `src/strategies/scalping/futures/indicators/order_flow_indicator.py`
- `src/strategies/scalping/futures/indicators/trailing_stop_loss.py`

#### üìù FUTURES - –õ–û–ì–ò–†–û–í–ê–ù–ò–ï (5 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/logging/__init__.py`
- `src/strategies/scalping/futures/logging/correlation_id_context.py`
- `src/strategies/scalping/futures/logging/debug_logger.py`
- `src/strategies/scalping/futures/logging/logger_factory.py`
- `src/strategies/scalping/futures/logging/structured_logger.py`

#### üìä FUTURES - –ú–ï–¢–†–ò–ö–ò (4 —Ñ–∞–π–ª–∞)
- `src/strategies/scalping/futures/metrics/__init__.py`
- `src/strategies/scalping/futures/metrics/alert_manager.py`
- `src/strategies/scalping/futures/metrics/conversion_metrics.py`
- `src/strategies/scalping/futures/metrics/holding_time_metrics.py`

#### ‚öôÔ∏è FUTURES - –ü–ê–†–ê–ú–ï–¢–†–´ (4 —Ñ–∞–π–ª–∞)
- `src/strategies/scalping/futures/parameters/__init__.py`
- `src/strategies/scalping/futures/parameters/parameter_orchestrator.py`
- `src/strategies/scalping/futures/parameters/parameter_schema.py`
- `src/strategies/scalping/futures/parameters/parameter_validators.py`

#### üé® FUTURES - –ü–ê–¢–¢–ï–†–ù–´ (3 —Ñ–∞–π–ª–∞)
- `src/strategies/scalping/futures/patterns/__init__.py`
- `src/strategies/scalping/futures/patterns/pattern_detector.py`
- `src/strategies/scalping/futures/patterns/pattern_engine.py`

#### üìç FUTURES - –ü–û–ó–ò–¶–ò–ò (9 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/positions/__init__.py`
- `src/strategies/scalping/futures/positions/entry_manager.py`
- `src/strategies/scalping/futures/positions/exit_analyzer.py`
- `src/strategies/scalping/futures/positions/exit_decision_logger.py`
- `src/strategies/scalping/futures/positions/peak_profit_tracker.py`
- `src/strategies/scalping/futures/positions/position_monitor.py`
- `src/strategies/scalping/futures/positions/position_scaling_manager.py`
- `src/strategies/scalping/futures/positions/stop_loss_manager.py`
- `src/strategies/scalping/futures/positions/take_profit_manager.py`

#### ‚ö†Ô∏è FUTURES - –†–ò–°–ö–ò (5 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/risk/__init__.py`
- `src/strategies/scalping/futures/risk/adaptive_leverage.py`
- `src/strategies/scalping/futures/risk/liquidation_protector.py`
- `src/strategies/scalping/futures/risk/margin_monitor.py`
- `src/strategies/scalping/futures/risk/max_size_limiter.py`

#### üì° FUTURES - –°–ò–ì–ù–ê–õ–´ (5 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/futures/signals/__init__.py`
- `src/strategies/scalping/futures/signals/filter_manager.py`
- `src/strategies/scalping/futures/signals/macd_signal_generator.py`
- `src/strategies/scalping/futures/signals/rsi_signal_generator.py`
- `src/strategies/scalping/futures/signals/trend_following_signal_generator.py`

#### üõ†Ô∏è FUTURES - –£–¢–ò–õ–ò–¢–´ (2 —Ñ–∞–π–ª–∞)
- `src/strategies/scalping/futures/utils/__init__.py`
- `src/strategies/scalping/futures/utils/units.py`

#### üìà SPOT SCALPING (12 —Ñ–∞–π–ª–æ–≤)
- `src/strategies/scalping/spot/__init__.py`
- `src/strategies/scalping/spot/batch_order_manager.py`
- `src/strategies/scalping/spot/module_factory.py`
- `src/strategies/scalping/spot/orchestrator.py`
- `src/strategies/scalping/spot/order_executor.py`
- `src/strategies/scalping/spot/order_executor_config.py`
- `src/strategies/scalping/spot/performance_tracker.py`
- `src/strategies/scalping/spot/position_manager.py`
- `src/strategies/scalping/spot/position_manager_config.py`
- `src/strategies/scalping/spot/risk_manager.py`
- `src/strategies/scalping/spot/signal_generator.py`
- `src/strategies/scalping/spot/signal_generator_config.py`
- `src/strategies/scalping/spot/websocket_orchestrator.py`

**–í—Å–µ–≥–æ: 152 —Ñ–∞–π–ª–∞**

### –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã (7 –º–æ–¥—É–ª–µ–π):
1. SignalCoordinator - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
2. ExitDecisionCoordinator - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
3. PriorityResolver - —Ä–µ–∑–æ–ª–≤–µ—Ä –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
4. SmartExitCoordinator - —É–º–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –∑–∞–∫—Ä—ã—Ç–∏—è
5. TrailingSLCoordinator - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å–æ–≤
6. OrderCoordinator - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä –æ—Ä–¥–µ—Ä–æ–≤
7. WebSocketCoordinator - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä WebSocket

### –†–∞—Å—á–µ—Ç—ã (5 –º–æ–¥—É–ª–µ–π):
1. MarginCalculator - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∞—Ä–∂–∏
2. PnLCalculator - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞
3. PositionSizer - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π
4. RegimeCalculator - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–∂–∏–º–∞
5. BalanceCalculator - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–∞–ª–∞–Ω—Å–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

### –ú–µ—Ç—Ä–∏–∫–∏ (3 –º–æ–¥—É–ª—è):
1. ConversionMetrics - –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
2. HoldingTimeMetrics - –º–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
3. AlertManager - –º–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤

### –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (8 –º–æ–¥—É–ª–µ–π):
1. FastADX - –±—ã—Å—Ç—Ä—ã–π ADX –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
2. OrderFlowIndicator - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤
3. MicroPivotCalculator - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∏–∫—Ä–æ-–ø–∏–≤–æ—Ç–æ–≤
4. LiquidityLevelsDetector - –¥–µ—Ç–µ–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
5. IndicatorCalculator - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
6. ATRProvider - –ø—Ä–æ–≤–∞–π–¥–µ—Ä ATR
7. FundingRateMonitor - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ funding rate
8. TrailingStopLoss - —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å

### –ü–æ–∑–∏—Ü–∏–∏ (8 –º–æ–¥—É–ª–µ–π):
1. EntryManager - –º–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
2. PositionMonitor - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π
3. PeakProfitTracker - —Ç—Ä–µ–∫–µ—Ä –ø–∏–∫–æ–≤–æ–π –ø—Ä–∏–±—ã–ª–∏
4. ExitDecisionLogger - –ª–æ–≥–≥–µ—Ä —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
5. TakeProfitManager - –º–µ–Ω–µ–¥–∂–µ—Ä —Ç–µ–π–∫-–ø—Ä–æ—Ñ–∏—Ç–∞
6. StopLossManager - –º–µ–Ω–µ–¥–∂–µ—Ä —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
7. ExitAnalyzer - –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
8. PositionScalingManager - –º–µ–Ω–µ–¥–∂–µ—Ä –ª–µ—Å—Ç–Ω–∏—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞

### –†–∏—Å–∫ (4 –º–æ–¥—É–ª—è):
1. AdaptiveLeverage - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ –ø–ª–µ—á–æ
2. LiquidationProtector - –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
3. MarginMonitor - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∞—Ä–∂–∏
4. MaxSizeLimiter - –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

### –ê–Ω–∞–ª–∏–∑ (1 –º–æ–¥—É–ª—å):
1. DirectionAnalyzer - –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä—ã–Ω–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (3 –º–æ–¥—É–ª—è):
1. DebugLogger - –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥–≥–µ—Ä
2. StructuredLogger - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä
3. LoggerFactory - —Ñ–∞–±—Ä–∏–∫–∞ –ª–æ–≥–≥–µ—Ä–æ–≤

### Core (4 –º–æ–¥—É–ª—è):
1. DataRegistry - —Ä–µ–µ—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö
2. CandleBuffer - –±—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π
3. PositionRegistry - —Ä–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π
4. PositionSync - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–∏—Ä–∂–µ–π

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (2 –º–æ–¥—É–ª—è):
1. ConfigManager - –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
2. ParameterProvider - –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–í—Å–µ–≥–æ –º–æ–¥—É–ª–µ–π:** 45+

---

## üîë –ö–õ–Æ–ß–ï–í–´–ï –§–ê–ô–õ–´ –î–õ–Ø –ë–´–°–¢–†–û–ì–û –î–û–°–¢–£–ü–ê

| –ó–∞–¥–∞—á–∞ | –§–∞–π–ª—ã |
|--------|-------|
| **–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞** | `run.py`, `src/main_spot.py`, `src/main_futures.py` |
| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** | `config/config_spot.yaml`, `config/config_futures.yaml`, `src/config.py` |
| **–°–∏–≥–Ω–∞–ª—ã** | `src/strategies/scalping/{spot,futures}/signal_generator.py` |
| **–û—Ä–¥–µ—Ä—ã** | `src/strategies/scalping/{spot,futures}/order_executor.py` |
| **–ü–æ–∑–∏—Ü–∏–∏** | `src/strategies/scalping/{spot,futures}/position_manager.py` |
| **–†–∏—Å–∫** | `src/risk/risk_controller.py`, `src/strategies/scalping/futures/risk/` |
| **–§–∏–ª—å—Ç—Ä—ã** | `src/strategies/modules/`, `src/strategies/scalping/futures/filters/` |
| **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã** | `src/indicators/`, `src/strategies/scalping/futures/indicators/` |
| **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã** | `src/strategies/scalping/futures/parameters/parameter_orchestrator.py` |
| **–ü–∞—Ç—Ç–µ—Ä–Ω—ã** | `src/strategies/scalping/futures/patterns/pattern_detector.py` |
| **–ú–æ–¥–µ–ª–∏** | `src/models.py`, `src/config.py` |
| **API** | `src/clients/{spot_client,futures_client}.py` |
| **WebSocket** | `src/market_data_websocket.py`, `src/websocket_manager.py` |
| **–õ–æ–≥–∏** | `logs/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, `src/strategies/scalping/futures/logging/` |
| **–¢–µ—Å—Ç—ã** | `tests/`, `test_adaptive_integration.py` |

---

## üéØ –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–†–û–ï–ö–¢–ê

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã:** 7 –º–æ–¥—É–ª–µ–π
- **–†–∞—Å—á–µ—Ç—ã:** 5 –º–æ–¥—É–ª–µ–π
- **–ú–µ—Ç—Ä–∏–∫–∏:** 3 –º–æ–¥—É–ª—è
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:** 8 –º–æ–¥—É–ª–µ–π
- **–ü–æ–∑–∏—Ü–∏–∏:** 8 –º–æ–¥—É–ª–µ–π
- **–†–∏—Å–∫:** 4 –º–æ–¥—É–ª—è
- **–ê–Ω–∞–ª–∏–∑:** 1 –º–æ–¥—É–ª—å
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** 3 –º–æ–¥—É–ª—è
- **Core:** 4 –º–æ–¥—É–ª—è
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** 2 –º–æ–¥—É–ª—è
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** 3 –º–æ–¥—É–ª—è (ParameterOrchestrator, Schema, Validators)
- **–ü–∞—Ç—Ç–µ—Ä–Ω—ã:** 2 –º–æ–¥—É–ª—è (PatternDetector, PatternEngine)
- **–û–±—â–∏–µ –º–æ–¥—É–ª–∏:** 25+ –º–æ–¥—É–ª–µ–π (clients, indicators, risk, utils, filters, balance, websocket)
- **Spot –º–æ–¥—É–ª–∏:** 12+ –º–æ–¥—É–ª–µ–π
- **Futures –º–æ–¥—É–ª–∏:** 120+ –º–æ–¥—É–ª–µ–π

### –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ Python —Ñ–∞–π–ª–æ–≤:
- **–í—Å–µ–≥–æ –≤ src/:** 152 —Ñ–∞–π–ª–∞
- **Futures scalping:** ~120 —Ñ–∞–π–ª–æ–≤
- **Spot scalping:** ~12 —Ñ–∞–π–ª–æ–≤
- **–û–±—â–∏–µ –º–æ–¥—É–ª–∏:** ~20 —Ñ–∞–π–ª–æ–≤

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–µ—Ç–æ–¥–æ–≤:
- **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã:** ~60 –º–µ—Ç–æ–¥–æ–≤
- **–†–∞—Å—á–µ—Ç—ã:** ~30 –º–µ—Ç–æ–¥–æ–≤
- **–ú–µ—Ç—Ä–∏–∫–∏:** ~20 –º–µ—Ç–æ–¥–æ–≤
- **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:** ~78 –º–µ—Ç–æ–¥–æ–≤
- **–ü–æ–∑–∏—Ü–∏–∏:** ~76 –º–µ—Ç–æ–¥–æ–≤
- **–†–∏—Å–∫:** ~21 –º–µ—Ç–æ–¥
- **–ê–Ω–∞–ª–∏–∑:** ~10 –º–µ—Ç–æ–¥–æ–≤
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** ~15 –º–µ—Ç–æ–¥–æ–≤
- **Core:** ~50 –º–µ—Ç–æ–¥–æ–≤
- **–ü–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è:** ~40 –º–µ—Ç–æ–¥–æ–≤
- **–ü–∞—Ç—Ç–µ—Ä–Ω—ã:** ~25 –º–µ—Ç–æ–¥–æ–≤
- **–û–±—â–∏–µ –º–æ–¥—É–ª–∏:** ~200+ –º–µ—Ç–æ–¥–æ–≤

**–í—Å–µ–≥–æ –º–µ—Ç–æ–¥–æ–≤:** ~600+

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤:
- **–í—Å–µ–≥–æ –∫–ª–∞—Å—Å–æ–≤:** 200+

---

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 31 –¥–µ–∫–∞–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 3.2 (–¥–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ Spot —Ç–æ—Ä–≥–æ–≤–ª–∏, –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–∏–≥–Ω–∞–ª–æ–≤)

---

## üìä SPOT –¢–û–†–ì–û–í–õ–Ø

### –û–±–∑–æ—Ä Spot —Ç–æ—Ä–≥–æ–≤–ª–∏

–ü–æ–º–∏–º–æ Futures —Ç–æ—Ä–≥–æ–≤–ª–∏, –±–æ—Ç –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç Spot —Ç–æ—Ä–≥–æ–≤–ª—é (—Ç–æ—Ä–≥–æ–≤–ª—è –±–µ–∑ –ª–µ–≤–µ—Ä–∏–¥–∂–∞). Spot —Ç–æ—Ä–≥–æ–≤–ª—è –∏–º–µ–µ—Ç —Å–≤–æ—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∏ –º–æ–¥—É–ª–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –±–µ–∑ –ø–ª–µ—á–∞.

### –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è –æ—Ç Futures:

1. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–µ–≤–µ—Ä–∏–¥–∂–∞** - —Ç–æ—Ä–≥–æ–≤–ª—è 1:1 (–±–µ–∑ –ø–ª–µ—á–∞)
2. **Manual Pool Strategy** - —Ä—É—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ –ø—É–ª–∞–º (ETH, BTC, USDT)
3. **–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∏—Å–∫–æ–≤** - –Ω–µ—Ç –º–∞—Ä–∂–∏ –∏ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
4. **OCO –æ—Ä–¥–µ—Ä–∞** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ One-Cancel-Other –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è TP/SL
5. **Batch Order Manager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–Ω—ã–º–∏ –æ—Ä–¥–µ—Ä–∞–º–∏

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Spot –º–æ–¥—É–ª–µ–π

```
src/strategies/scalping/spot/
‚îú‚îÄ‚îÄ orchestrator.py              # –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä Spot —Ç–æ—Ä–≥–æ–≤–ª–∏
‚îú‚îÄ‚îÄ signal_generator.py          # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è Spot
‚îú‚îÄ‚îÄ order_executor.py            # –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ—Ä–¥–µ—Ä–æ–≤ (MARKET, OCO)
‚îú‚îÄ‚îÄ position_manager.py          # –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–∑–∏—Ü–∏–π Spot
‚îú‚îÄ‚îÄ risk_manager.py             # –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤ (–±–µ–∑ –º–∞—Ä–∂–∏)
‚îú‚îÄ‚îÄ performance_tracker.py      # –¢—Ä–µ–∫–µ—Ä –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ websocket_orchestrator.py   # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä WebSocket
‚îú‚îÄ‚îÄ module_factory.py           # –§–∞–±—Ä–∏–∫–∞ –º–æ–¥—É–ª–µ–π (Phase 1)
‚îú‚îÄ‚îÄ batch_order_manager.py     # –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ order_executor_config.py   # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
‚îú‚îÄ‚îÄ position_manager_config.py  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π
‚îî‚îÄ‚îÄ signal_generator_config.py # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
```

### –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã Spot —Ç–æ—Ä–≥–æ–≤–ª–∏

#### 1. `src/main_spot.py` - –ó–∞–ø—É—Å–∫ Spot –±–æ—Ç–∞
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `config_spot.yaml`
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `ScalpingOrchestrator` (Spot –≤–µ—Ä—Å–∏—è)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ graceful shutdown

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `OKXClient` (Spot API –∫–ª–∏–µ–Ω—Ç)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `logs/spot/`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–µ–π –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

#### 2. `src/strategies/scalping/spot/orchestrator.py` - –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä Spot
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö Spot –º–æ–¥—É–ª–µ–π
- –ì–ª–∞–≤–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª (–∫–∞–∂–¥—ã–µ 6 —Å–µ–∫—É–Ω–¥)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –ø–æ–∑–∏—Ü–∏–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Phase 1 –º–æ–¥—É–ª—è–º–∏

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã:**
- `start()` - –ó–∞–ø—É—Å–∫ Spot –±–æ—Ç–∞
- `run()` - –ì–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª —Ç–æ—Ä–≥–æ–≤–ª–∏
- `_process_symbol()` - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
- `_check_and_close_positions()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π

**Phase 1 –º–æ–¥—É–ª–∏:**
- Multi-Timeframe Filter (MTF)
- Correlation Filter
- ADX Filter
- Pivot Points Filter
- Volume Profile Filter
- Balance Checker
- Time Filter
- Adaptive Regime Manager (ARM)

#### 3. `src/strategies/scalping/spot/signal_generator.py` - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤ Spot
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–∞—Å—á–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (BUY/SELL)
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (Phase 1 –º–æ–¥—É–ª–∏)
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (ARM)

**–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
- RSI (Relative Strength Index)
- MACD (Moving Average Convergence Divergence)
- Bollinger Bands
- EMA (Exponential Moving Average)
- SMA (Simple Moving Average)
- ATR (Average True Range)

**–°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ (Scoring):**
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π score: 12 –±–∞–ª–ª–æ–≤
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥: –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∂–∏–º–∞ (trending/ranging/choppy)
- –ë–æ–Ω—É—Å—ã –∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–∞ —Å—Ç–∞—Ä—à–∏—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞—Ö

#### 4. `src/strategies/scalping/spot/order_executor.py` - –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –æ—Ä–¥–µ—Ä–æ–≤ Spot
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ MARKET –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –≤—Ö–æ–¥–∞
- –†–∞–∑–º–µ—â–µ–Ω–∏–µ OCO –æ—Ä–¥–µ—Ä–æ–≤ (TP + SL –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ)
- –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏–∑ Manual Pools
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏

**–¢–∏–ø—ã –æ—Ä–¥–µ—Ä–æ–≤:**
- **MARKET** - –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –ø–æ–∑–∏—Ü–∏—é
- **OCO (One-Cancel-Other)** - –¥–ª—è TP –∏ SL –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

**Manual Pool Strategy:**
- ETH Pool - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ –≤ ETH
- BTC Pool - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ –≤ BTC
- USDT Pool - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ –≤ USDT
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º–∞–º (trending/ranging/choppy):
  - `quantity_per_trade` - —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
  - `score_threshold` - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π score
  - `tp_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç Take Profit
  - `sl_percent` - –ø—Ä–æ—Ü–µ–Ω—Ç Stop Loss
  - `time_limit_seconds` - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
  - `ph_threshold` - –ø–æ—Ä–æ–≥ Profit Harvesting

#### 5. `src/strategies/scalping/spot/position_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–æ–∑–∏—Ü–∏–π Spot
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –†–∞—Å—á–µ—Ç PnL (–ø—Ä–∏–±—ã–ª—å/—É–±—ã—Ç–æ–∫)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è (TP/SL —á–µ—Ä–µ–∑ OCO)
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Profit Harvesting
- –≠–∫—Å–ø–æ—Ä—Ç —Å–¥–µ–ª–æ–∫ –≤ CSV

**–£—Å–ª–æ–≤–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è:**
- Take Profit –¥–æ—Å—Ç–∏–≥–Ω—É—Ç (OCO)
- Stop Loss –¥–æ—Å—Ç–∏–≥–Ω—É—Ç (OCO)
- Profit Harvesting (–¥–æ—Å—Ä–æ—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –±—ã—Å—Ç—Ä–æ–π –ø—Ä–∏–±—ã–ª–∏)
- Time Stop (–ø—Ä–µ–≤—ã—à–µ–Ω–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è)
- Break-even Stop Loss

#### 6. `src/strategies/scalping/spot/risk_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–∏—Å–∫–æ–≤ Spot
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ –∏–∑ Manual Pools
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º
- –ö–æ–Ω—Ç—Ä–æ–ª—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –ø–æ—Ç–µ—Ä—å
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É–±—ã—Ç–∫–æ–≤

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ù–µ—Ç –º–∞—Ä–∂–∏ –∏ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—É–º–º—ã –∏–∑ –ø—É–ª–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å–∞ –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º

#### 7. `src/strategies/scalping/spot/module_factory.py` - –§–∞–±—Ä–∏–∫–∞ –º–æ–¥—É–ª–µ–π
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö Phase 1 –º–æ–¥—É–ª–µ–π
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥—É–ª–µ–π
- –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –º–æ–¥—É–ª–µ–π

**–°–æ–∑–¥–∞–≤–∞–µ–º—ã–µ –º–æ–¥—É–ª–∏:**
- Multi-Timeframe Filter
- Correlation Filter
- ADX Filter
- Pivot Points Filter
- Volume Profile Filter
- Balance Checker
- Time Filter
- Adaptive Regime Manager (ARM)

#### 8. `src/strategies/scalping/spot/batch_order_manager.py` - –ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–Ω—ã–º–∏ –æ—Ä–¥–µ—Ä–∞–º–∏
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

### Manual Pool Strategy

**–ö–æ–Ω—Ü–µ–ø—Ü–∏—è:**
–†—É—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –ø–æ –ø—É–ª–∞–º –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤. –ö–∞–∂–¥—ã–π –ø—É–ª –∏–º–µ–µ—Ç —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—É–º–º—É –∏ —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–æ—Ä–≥–æ–≤–ª–∏.

**–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:**
```yaml
manual_pools:
  eth_pool:
    fixed_amount: 400.0  # –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞ –≤ ETH
    max_open_positions: 3
    priority: 1
    trending:
      quantity_per_trade: 0.008
      score_threshold: 4
      tp_percent: 0.7
      sl_percent: 0.45
      time_limit_seconds: 480
      ph_threshold: 0.40
    ranging:
      quantity_per_trade: 0.005
      score_threshold: 3
      tp_percent: 0.5
      sl_percent: 0.35
      time_limit_seconds: 300
      ph_threshold: 0.50
    choppy:
      quantity_per_trade: 0.006
      score_threshold: 5
      tp_percent: 0.6
      sl_percent: 0.45
      time_limit_seconds: 360
      ph_threshold: 0.45
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º —Å—Ä–µ–¥—Å—Ç–≤
- –†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∞–∫—Ç–∏–≤–æ–≤
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (trending/ranging/choppy)
- –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø—É–ª–æ–≤

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª Spot –±–æ—Ç–∞

#### 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
```python
1. –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ config_spot.yaml
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OKXClient (Spot API)
3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π —á–µ—Ä–µ–∑ ModuleFactory:
   - SignalGenerator
   - OrderExecutor
   - PositionManager
   - RiskManager
   - Phase 1 –º–æ–¥—É–ª–∏ (MTF, Correlation, ADX, Pivot, VP, Balance, Time, ARM)
4. –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π —Å –±–∏—Ä–∂–∏
5. –ó–∞–ø—É—Å–∫ WebSocket –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
6. –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
```

#### 2. –ì–ª–∞–≤–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª
```python
while active:
    for symbol in symbols:  # BTC-USDT, ETH-USDT...
        # –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limit
        await _check_rate_limit()
        
        # –®–ê–ì 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        await _update_market_data(symbol)
        
        # –®–ê–ì 3: –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
        indicators = indicator_manager.calculate_all(candles)
        
        # –®–ê–ì 4: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ (ARM)
        regime = regime_manager.detect_regime(candles, current_price)
        
        # –®–ê–ì 5: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
        if symbol in active_positions:
            await position_manager.manage_position(position)
            # - –ü—Ä–æ–≤–µ—Ä–∫–∞ TP/SL —á–µ—Ä–µ–∑ OCO
            # - –ü—Ä–æ–≤–µ—Ä–∫–∞ Profit Harvesting
            # - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
            
        # –®–ê–ì 6: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
        if can_trade(symbol):
            signal = await signal_generator.generate_signal(
                symbol=symbol,
                indicators=indicators,
                regime=regime
            )
            
            # –®–ê–ì 7: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
            if signal and filters.pass_all(signal):
                # –®–ê–ì 8: –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –∏–∑ Manual Pool
                pool = manual_pools.get_pool_for_symbol(symbol)
                size = pool.get_quantity_for_regime(regime)
                
                # –®–ê–ì 9: –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
                await order_executor.execute_signal(signal, size)
                # - MARKET –æ—Ä–¥–µ—Ä –¥–ª—è –≤—Ö–æ–¥–∞
                # - OCO –æ—Ä–¥–µ—Ä –¥–ª—è TP/SL
```

#### 3. –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```python
1. –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
2. –û—Å—Ç–∞–Ω–æ–≤–∫–∞ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
4. –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
```

### –û—Ç–ª–∏—á–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Spot

**–§–∞–π–ª:** `config/config_spot.yaml`

**–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `trading_mode: "spot"` - —Ä–µ–∂–∏–º Spot —Ç–æ—Ä–≥–æ–≤–ª–∏
- `manual_pools` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ä—É—á–Ω—ã—Ö –ø—É–ª–æ–≤
- `scalping.adaptive_regime` - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º–∞–º
- `scalping.balance_profiles` - –ø—Ä–æ—Ñ–∏–ª–∏ –±–∞–ª–∞–Ω—Å–∞ (small/medium/large)

**–ù–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
- –õ–µ–≤–µ—Ä–∏–¥–∂–∞ (leverage)
- –ú–∞—Ä–∂–∏ (margin)
- –õ–∏–∫–≤–∏–¥–∞—Ü–∏–∏ (liquidation)

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ô –°–ò–ì–ù–ê–õ–û–í (31.12.2025)

### –ü—Ä–æ–±–ª–µ–º–∞

–ë—ã–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤:
- **71.9% —Å–∏–≥–Ω–∞–ª–æ–≤** –∏–º–µ–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- –ò–º–ø—É–ª—å—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –æ–ø—Ä–µ–¥–µ–ª—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ø–æ —Ü–≤–µ—Ç—É —Å–≤–µ—á–∏ (–∑–µ–ª–µ–Ω–∞—è = BUY, –∫—Ä–∞—Å–Ω–∞—è = SELL)
- MA —Å–∏–≥–Ω–∞–ª—ã –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏—Å—å –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞ –ø—Ä–∏ `price_direction == "neutral"`
- ADX –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –≤ –∏–º–ø—É–ª—å—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

#### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #1: –ò–º–ø—É–ª—å—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
**–§–∞–π–ª:** `src/strategies/scalping/futures/signal_generator.py`  
**–°—Ç—Ä–æ–∫–∏:** 5008-5034

**–ë—ã–ª–æ:**
```python
body = current_candle.close - current_candle.open
direction = "buy" if body >= 0 else "sell"  # ‚ùå –¢–æ–ª—å–∫–æ –ø–æ —Ü–≤–µ—Ç—É —Å–≤–µ—á–∏!
```

**–°—Ç–∞–ª–æ:**
```python
initial_direction = "buy" if body >= 0 else "sell"

# –ü—Ä–æ–≤–µ—Ä—è–µ–º ADX —Ç—Ä–µ–Ω–¥ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
if adx_value >= adx_threshold and adx_trend:
    if adx_trend == "bearish" and initial_direction == "buy":
        # –ë–ª–æ–∫–∏—Ä—É–µ–º LONG –≤ bearish —Ä—ã–Ω–∫–µ
        return []
    elif adx_trend == "bullish" and initial_direction == "sell":
        # –ë–ª–æ–∫–∏—Ä—É–µ–º SHORT –≤ bullish —Ä—ã–Ω–∫–µ
        return []
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ò–º–ø—É–ª—å—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç: `üö´ –ò–º–ø—É–ª—å—Å–Ω—ã–π —Å–∏–≥–Ω–∞–ª BTC-USDT BUY –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: bearish —Ç—Ä–µ–Ω–¥ (ADX=28.2 >= 20.0)`

#### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #2: MA —Å–∏–≥–Ω–∞–ª—ã - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞
**–§–∞–π–ª:** `src/strategies/scalping/futures/signal_generator.py`  
**–°—Ç—Ä–æ–∫–∏:** 4787-4819 (BULLISH), 4863-4881 (BEARISH)

**–ë—ã–ª–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ ADX —Ä–∞–±–æ—Ç–∞–ª–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `price_direction != "neutral"`
- –ï—Å–ª–∏ `price_direction == "neutral"`, —Å–∏–≥–Ω–∞–ª –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–ª—Å—è –¥–∞–∂–µ –≤ bearish/bullish —Ä—ã–Ω–∫–µ

**–°—Ç–∞–ª–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ ADX –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–ü–ï–†–í–û–ô** –≤ —Ü–µ–ø–æ—á–∫–µ if-elif
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç BULLISH –≤ bearish —Ä—ã–Ω–∫–µ –∏ BEARISH –≤ bullish —Ä—ã–Ω–∫–µ **–î–û** –ø—Ä–æ–≤–µ—Ä–∫–∏ `price_direction`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –ø—Ä–∏ `price_direction == "neutral"`
- ‚úÖ MA —Å–∏–≥–Ω–∞–ª—ã –Ω–µ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞

#### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #3: –ü–µ—Ä–µ–¥–∞—á–∞ ADX –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –∏–º–ø—É–ª—å—Å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã
**–§–∞–π–ª:** `src/strategies/scalping/futures/signal_generator.py`  
**–°—Ç—Ä–æ–∫–∏:** 2441-2444

**–ë—ã–ª–æ:**
```python
impulse_signals = await self._detect_impulse_signals(
    symbol, market_data, indicators, current_regime
)  # ‚ùå –ù–µ—Ç adx_trend –∏ adx_value!
```

**–°—Ç–∞–ª–æ:**
```python
impulse_signals = await self._detect_impulse_signals(
    symbol, market_data, indicators, current_regime, adx_trend, adx_value, adx_threshold
)  # ‚úÖ –ü–µ—Ä–µ–¥–∞–µ–º ADX –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ ADX –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –∏–º–ø—É–ª—å—Å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

#### ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏–º–ø—É–ª—å—Å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤:
1. **BTC-USDT 01:39:35:**
   - –°–≤–µ—á–∞: –∑–µ–ª–µ–Ω–∞—è (BUY)
   - ADX: 28.2 (bearish)
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `üö´ –ò–º–ø—É–ª—å—Å–Ω—ã–π —Å–∏–≥–Ω–∞–ª BTC-USDT BUY –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: bearish —Ç—Ä–µ–Ω–¥`

2. **ETH-USDT 01:39:27:**
   - –°–≤–µ—á–∞: –∫—Ä–∞—Å–Ω–∞—è (SELL)
   - ADX: 29.5 (bullish)
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `üö´ –ò–º–ø—É–ª—å—Å–Ω—ã–π —Å–∏–≥–Ω–∞–ª ETH-USDT SELL –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: bullish —Ç—Ä–µ–Ω–¥`

3. **XRP-USDT 01:39:15:**
   - –°–≤–µ—á–∞: –∑–µ–ª–µ–Ω–∞—è (BUY)
   - ADX: 20.5 (bearish)
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** `üö´ –ò–º–ø—É–ª—å—Å–Ω—ã–π —Å–∏–≥–Ω–∞–ª XRP-USDT BUY –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: bearish —Ç—Ä–µ–Ω–¥`

#### ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è SHORT —Å–∏–≥–Ω–∞–ª–æ–≤:
- **XRP-USDT:** `SHORT —Å–∏–≥–Ω–∞–ª` (ADX bearish=21.1)
- **BTC-USDT:** `SHORT —Å–∏–≥–Ω–∞–ª` (—Ü–µ–Ω–∞ –ø–∞–¥–∞–µ—Ç)

#### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ADX —Ç—Ä–µ–Ω–¥–∞:
- **XRP-USDT:** `bearish, ADX=21.1, -DI=40.9, +DI=22.2` ‚Üí SHORT —Å–∏–≥–Ω–∞–ª—ã
- **ETH-USDT:** `bullish, ADX=32.3, +DI=71.0, -DI=12.9` ‚Üí LONG —Å–∏–≥–Ω–∞–ª—ã
- **BTC-USDT:** `ranging, ADX=5.6` ‚Üí –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π

### –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç

- **–£–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π** —Å 71.9% –¥–æ <30%
- **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ SHORT —Å–∏–≥–Ω–∞–ª–æ–≤** (—Ç–µ–ø–µ—Ä—å –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è)
- **–°–Ω–∏–∂–µ–Ω–∏–µ —É–±—ã—Ç–∫–æ–≤** –æ—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π –ø—Ä–æ—Ç–∏–≤ —Ç—Ä–µ–Ω–¥–∞
- **–ü–æ–≤—ã—à–µ–Ω–∏–µ win rate** –∑–∞ —Å—á–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –°—Ç–∞—Ç—É—Å

‚úÖ **–ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ù–£** - –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã.

---

## üìä –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–û–î–£–õ–ò –ò –°–ò–°–¢–ï–ú–´

### WebSocket Orchestrator (Spot)

**–§–∞–π–ª:** `src/strategies/scalping/spot/websocket_orchestrator.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è–º–∏ –¥–ª—è Spot —Ç–æ—Ä–≥–æ–≤–ª–∏
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π

### Performance Tracker (Spot)

**–§–∞–π–ª:** `src/strategies/scalping/spot/performance_tracker.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ Spot —Ç–æ—Ä–≥–æ–≤–ª–∏
- –†–∞—Å—á–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (win rate, —Å—Ä–µ–¥–Ω–∏–π PnL, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞)
- –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ CSV

**–ú–µ—Ç—Ä–∏–∫–∏:**
- –û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö/—É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
- Win rate (%)
- –°—Ä–µ–¥–Ω–∏–π PnL
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞
- –û–±—â–∏–π PnL

### Batch Order Manager

**–§–∞–π–ª:** `src/strategies/scalping/spot/batch_order_manager.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–Ω—ã–º–∏ –æ—Ä–¥–µ—Ä–∞–º–∏
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–∞–∫–µ—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ API –∑–∞–ø—Ä–æ—Å–æ–≤
- –ë–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

---

## üîÑ –ò–ù–¢–ï–ì–†–ê–¶–ò–Ø SPOT –ò FUTURES

### –û–±—â–∏–µ –º–æ–¥—É–ª–∏

–û–±–∞ —Ä–µ–∂–∏–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â–∏–µ –º–æ–¥—É–ª–∏ –∏–∑ `src/strategies/modules/`:

1. **AdaptiveRegimeManager** - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ (trending/ranging/choppy)
2. **CorrelationFilter** - —Ñ–∏–ª—å—Ç—Ä –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏
3. **MultiTimeframeFilter** - –º—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º –∞–Ω–∞–ª–∏–∑
4. **PivotPointsFilter** - —Ñ–∏–ª—å—Ç—Ä —Ç–æ—á–µ–∫ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞
5. **VolumeProfileFilter** - —Ñ–∏–ª—å—Ç—Ä –ø—Ä–æ—Ñ–∏–ª—è –æ–±—ä–µ–º–∞
6. **BalanceChecker** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞
7. **TimeSessionManager** - —Ñ–∏–ª—å—Ç—Ä —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π

### –†–∞–∑–ª–∏—á–∏—è –≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –ê—Å–ø–µ–∫—Ç | Futures | Spot |
|--------|---------|------|
| –õ–µ–≤–µ—Ä–∏–¥–∂ | 3-30x (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ–µ) | 1:1 (–±–µ–∑ –ø–ª–µ—á–∞) |
| –ú–∞—Ä–∂–∞ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è | –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è |
| –õ–∏–∫–≤–∏–¥–∞—Ü–∏—è | –ï—Å—Ç—å –∑–∞—â–∏—Ç–∞ | –ù–µ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ |
| –¢–∏–ø –æ—Ä–¥–µ—Ä–æ–≤ | MARKET, LIMIT, OCO | MARKET, OCO |
| –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ | –ù–∞ –æ—Å–Ω–æ–≤–µ –º–∞—Ä–∂–∏ | –ò–∑ Manual Pools |
| Risk Manager | –°–ª–æ–∂–Ω—ã–π (–º–∞—Ä–∂–∞, –ª–∏–∫–≤–∏–¥–∞—Ü–∏—è) | –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π (–±–∞–ª–∞–Ω—Å) |

### –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏

**–§–∞–π–ª:** `run.py`

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—ã–±—Ä–∞—Ç—å —Ä–µ–∂–∏–º —Ç–æ—Ä–≥–æ–≤–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
- `python run.py --mode spot` - Spot —Ç–æ—Ä–≥–æ–≤–ª—è
- `python run.py --mode futures` - Futures —Ç–æ—Ä–≥–æ–≤–ª—è
- `python run.py --interactive` - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–¢–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç OKX –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∫–æ–º–ø–ª–µ–∫—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏ –Ω–∞ –±–∏—Ä–∂–µ OKX, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â—É—é –¥–≤–∞ —Ä–µ–∂–∏–º–∞:

1. **Futures —Ç–æ—Ä–≥–æ–≤–ª—è** - —Å –ª–µ–≤–µ—Ä–∏–¥–∂–µ–º 3-30x, —Å–ª–æ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏, –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –ø–ª–µ—á–æ–º –∏ –ª–µ—Å—Ç–Ω–∏—á–Ω—ã–º –≤—Ö–æ–¥–æ–º
2. **Spot —Ç–æ—Ä–≥–æ–≤–ª—è** - –±–µ–∑ –ª–µ–≤–µ—Ä–∏–¥–∂–∞, —Å Manual Pool Strategy, —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π —Ä–∏—Å–∫–æ–≤

–û–±–∞ —Ä–µ–∂–∏–º–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–±—â–∏–µ –º–æ–¥—É–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞, –Ω–æ –∏–º–µ—é—Ç —Å–≤–æ–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏, –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–¥ —Å–ø–µ—Ü–∏—Ñ–∏–∫—É –∫–∞–∂–¥–æ–≥–æ —Ç–∏–ø–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (ARM)
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ V2
- ‚úÖ 10+ —Ç–∏–ø–æ–≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Å–∏–≥–Ω–∞–ª–æ–≤
- ‚úÖ 17+ —Å–∏—Å—Ç–µ–º –∑–∞—â–∏—Ç—ã –æ—Ç —Ä–∏—Å–∫–æ–≤
- ‚úÖ Trailing Stop Loss —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º —Ç—Ä–µ–π–ª–∏–Ω–≥–æ–º
- ‚úÖ Partial Take Profit –¥–ª—è —Ñ–∏–∫—Å–∞—Ü–∏–∏ –ø—Ä–∏–±—ã–ª–∏
- ‚úÖ Exit Analyzer - —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ Position Registry - –µ–¥–∏–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ Position Sync - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–∏—Ä–∂–µ–π
- ‚úÖ Trading Control Center - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Å–∏–≥–Ω–∞–ª–æ–≤ (31.12.2025)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è confidence –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (05.01.2026)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ record_position_closed –≤ ConversionMetrics (05.01.2026)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OKX REST API –∏ WebSocket
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ —É–ª—É—á—à–∞–µ—Ç—Å—è

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –û–¢ 05.01.2026

### –û–±–∑–æ—Ä –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

–í —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤ —Ç–æ—Ä–≥–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ –æ—Ç 05.01.2026 –±—ã–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤.

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #1: –û—à–∏–±–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è confidence

**–ü—Ä–æ–±–ª–µ–º–∞:** `TypeError: Unknown format code 'f' for object of type 'str'`

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `confidence` –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–ª–∞—Å—å –∫–∞–∫ —Å—Ç—Ä–æ–∫–∞ –≤–º–µ—Å—Ç–æ —á–∏—Å–ª–∞, —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫—É –ø—Ä–∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (`.1%`, `.2f`).

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ 5 –º–µ—Å—Ç–∞—Ö:**

1. **`src/strategies/scalping/futures/coordinators/signal_coordinator.py:1939-1943`** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ confidence –ø—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
2. **`src/strategies/scalping/futures/signal_generator.py:2830-2834` (2 –º–µ—Å—Ç–∞)** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ confidence –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–æ ADX
3. **`src/strategies/scalping/futures/adaptivity/regime_manager.py:969-979`** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ confidence –≤ is_signal_valid
4. **`src/strategies/scalping/futures/adaptivity/regime_manager.py:1092-1103`** - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –≤ _log_regime_switch

**–í–ª–∏—è–Ω–∏–µ:**
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –†–µ–∂–∏–º—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ DataRegistry

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #2: –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ record_position_closed –≤ ConversionMetrics

**–ü—Ä–æ–±–ª–µ–º–∞:** `AttributeError: 'ConversionMetrics' object has no attribute 'record_position_closed'`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `record_position_closed()` –≤ `src/strategies/scalping/futures/metrics/conversion_metrics.py:162-209`

**–í–ª–∏—è–Ω–∏–µ:**
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Ç–µ–ø–µ—Ä—å –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–π
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏–π –ø–æ–∑–∏—Ü–∏–π –ø–æ–ª–Ω–∞—è

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –û–¢ 28.01.2026

### –û–±–∑–æ—Ä –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

–í —Ö–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∞ —Ä–∞–±–æ—Ç—ã ParameterOrchestrator –±—ã–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ detect_regime().

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #1: –§–∏–∫—Å detect_regime parameter issue

**–ü—Ä–æ–±–ª–µ–º–∞:** `TypeError: detect_regime() missing 2 required positional arguments: 'candles' and 'current_price'`

**–ü—Ä–∏—á–∏–Ω–∞:** ParameterOrchestrator –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª candles –∏ current_price –≤ detect_regime(), —á—Ç–æ –≤—ã–∑—ã–≤–∞–ª–æ –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ `src/strategies/scalping/futures/parameters/parameter_orchestrator.py`:**

**–ë—ã–ª–æ (—Å—Ç—Ä–æ–∫–∏ 67-75):**
```python
regime_value = self._resolve_regime(symbol, regime, status)
```

**–°—Ç–∞–ª–æ:**
```python
# Extract candles and current_price from market_data if available
candles = None
current_price = None
if market_data and hasattr(market_data, 'ohlcv_data'):
    candles = market_data.ohlcv_data
if not current_price:
    current_price = self.data_registry.get_fresh_price_for_signals(symbol)

regime_value = self._resolve_regime(symbol, regime, status, candles, current_price)
```

**–¢–∞–∫–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω –º–µ—Ç–æ–¥ _resolve_regime() (—Å—Ç—Ä–æ–∫–∏ 78-120):**
```python
def _resolve_regime(
    self, symbol: str, regime: Optional[str], status: ParameterStatus, candles: Optional[List] = None, current_price: Optional[float] = None
) -> Optional[str]:
    if regime:
        logger.debug(f"PARAM_ORCH: _resolve_regime: using provided regime '{regime}'")
        return str(regime).lower()
    if self.regime_manager is None:
        status.errors.append("regime_manager is not set")
        logger.debug("PARAM_ORCH: _resolve_regime: regime_manager is None")
        return None
    try:
        # Try detect_regime first (per-symbol), fallback to get_current_regime (global)
        if hasattr(self.regime_manager, 'detect_regime'):
            # Use provided candles and current_price, or get them
            if candles is None:
                candles = self.data_registry.get_candles(symbol)
            if current_price is None:
                current_price = self.data_registry.get_fresh_price_for_signals(symbol)
            if candles is None or current_price is None:
                status.errors.append(f"failed to get market data for regime detection: candles={candles is not None}, price={current_price is not None}")
                return None
            resolved = self.regime_manager.detect_regime(candles, current_price)
            resolved = resolved.regime if hasattr(resolved, 'regime') else str(resolved)
            logger.debug(f"PARAM_ORCH: _resolve_regime: detect_regime('{symbol}') returned '{resolved}'")
        else:
            resolved = self.regime_manager.get_current_regime()
            logger.debug(f"PARAM_ORCH: _resolve_regime: get_current_regime() returned '{resolved}'")
    except Exception as exc:
        status.errors.append(f"failed to get regime: {exc}")
        logger.debug(f"PARAM_ORCH: _resolve_regime: exception getting regime: {exc}")
        return None
    if not resolved:
        status.errors.append("regime is empty")
        logger.debug("PARAM_ORCH: _resolve_regime: regime is empty")
        return None
    resolved_str = str(resolved).lower()
    logger.debug(f"PARAM_ORCH: _resolve_regime: resolved to '{resolved_str}'")
    return resolved_str
```

**–í–ª–∏—è–Ω–∏–µ:**
- ‚úÖ ParameterOrchestrator —Ç–µ–ø–µ—Ä—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–µ—Ç candles –∏ current_price –≤ detect_regime()
- ‚úÖ –†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∞–∑—Ä–µ—à–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –°–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #2: –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –º–æ–¥—É–ª–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–∏ —Ä–∞–∑–¥–µ–ª—ã –æ parameter_orchestrator.py –∏ —Å–∏—Å—Ç–µ–º–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "Parameter Orchestrator" —Å –ø–æ–ª–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "Pattern Detection System" 
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–¥–æ–±–∞–≤–ª–µ–Ω—ã parameters/ –∏ patterns/)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ units.py (–ø–µ—Ä–µ–º–µ—â–µ–Ω –≤ utils/)

**–í–ª–∏—è–Ω–∏–µ:**
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏–º–µ—é—Ç –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö 152 –º–æ–¥—É–ª–µ–π
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –∫–ª—é—á–µ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

---

**–î–∞—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 28 —è–Ω–≤–∞—Ä—è 2026  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 3.5 (–¥–æ–±–∞–≤–ª–µ–Ω –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π –∏ —Ç–∞–±–ª–∏—Ü–∞ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞)

---


