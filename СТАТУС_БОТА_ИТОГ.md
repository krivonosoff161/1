# ‚úÖ –°–¢–ê–¢–£–° –ë–û–¢–ê - –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê

## üéØ –û–ë–©–ò–ô –°–¢–ê–¢–£–°: ‚úÖ **–ë–û–¢ –†–ê–ë–û–¢–ê–ï–¢ –ù–û–†–ú–ê–õ–¨–ù–û**

---

## ‚úÖ –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø

### –ú–æ–¥—É–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:
1. ‚úÖ **FundingRateMonitor** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ orchestrator
2. ‚úÖ **ExitAnalyzer** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
3. ‚úÖ **PositionMonitor** - —Ä–∞–±–æ—Ç–∞–µ—Ç
4. ‚úÖ **TrailingStopLoss** - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π
5. ‚úÖ **CandlePatternDetector** - —Å–æ–∑–¥–∞–Ω (–±–µ–∑ –ª–æ–≥–æ–≤, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
6. ‚úÖ **LiquidityLevelsDetector** - —Å–æ–∑–¥–∞–Ω (–±–µ–∑ –ª–æ–≥–æ–≤, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
7. ‚úÖ **VolumeProfileCalculator** - —Å–æ–∑–¥–∞–Ω (–±–µ–∑ –ª–æ–≥–æ–≤, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)
8. ‚úÖ **PivotCalculator** - —Å–æ–∑–¥–∞–Ω (–±–µ–∑ –ª–æ–≥–æ–≤, –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)

---

## üìä –û–¢–ö–†–´–¢–´–ï –ü–û–ó–ò–¶–ò–ò

### –ü–æ–∑–∏—Ü–∏–∏ (3 —à—Ç):
1. **DOGE-USDT** - short, entry=0.14215, size=490, PnL=-0.17% –¥–æ -0.21%
2. **ETH-USDT** - short, entry=3125.70, size=0.022, PnL=-0.04%
3. **BTC-USDT** - short, entry=91268.73, size=0.0007, PnL=–Ω–µ –≤–∏–¥–Ω–æ

### –†–µ–∂–∏–º: **ranging** –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π

---

## ‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø (–ù–û–†–ú–ê–õ–¨–ù–´–ï)

### 1. –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ max_position_size:
```
ERROR: –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ $85.17 –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_position_size $70.00 –¥–ª—è ETH-USDT!
ERROR: –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ $91.00 –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_position_size $70.00 –¥–ª—è ETH-USDT!
ERROR: –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ $104.83 –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_position_size $70.00 –¥–ª—è BTC-USDT!
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ù–û–†–ú–ê–õ–¨–ù–û** - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ max_position_size

**–ü—Ä–∏—á–∏–Ω–∞**: 
- Volatility multiplier (ATR –Ω–∏–∑–∫–∏–π ‚Üí multiplier –≤—ã—Å–æ–∫–∏–π)
- Strength multiplier (—Å–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª)
- –°–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç

### 2. DRIFT_ADD:
```
CRITICAL: DRIFT_ADD ETH-USDT found on exchange but not in registry
```

**–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è **–ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï** - –ø–æ–∑–∏—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üìä –†–ê–°–ß–ï–¢ –†–ê–ó–ú–ï–†–ê –ü–û–ó–ò–¶–ò–ò

### –¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å: **$459.96**

### –ü—Ä–æ—Ñ–∏–ª—å: **micro** (–±–∞–ª–∞–Ω—Å < $500)

### Progressive —Ä–∞—Å—á–µ—Ç:
- **min_balance**: 100.0
- **size_at_min**: 30.0
- **size_at_max**: 50.0
- **max_position_usd**: 70.0
- **progressive**: true

### –†–∞—Å—á–µ—Ç –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ $459.96:
```
interpolated_size = 30.0 + (50.0 - 30.0) * (459.96 - 100.0) / (500.0 - 100.0)
interpolated_size = 30.0 + 20.0 * 359.96 / 400.0
interpolated_size = 30.0 + 17.998 = 47.998 ‚âà 48.0 USDT
```

### –í –ª–æ–≥–∞—Ö: base_usd_size = $70.00

**–ü—Ä–∏—á–∏–Ω–∞**: 
- Progressive —Ä–∞—Å—á–µ—Ç –¥–∞–µ—Ç ~$48.0
- –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ (strength, volatility) —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç –¥–æ $70.0 (max_position_usd)
- –°–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç

---

## üß† –£–ú–ù–û–ï –ó–ê–ö–†–´–¢–ò–ï

### –°—Ç–∞—Ç—É—Å: ‚ùå **–ù–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç** (–æ–∂–∏–¥–∞–µ–º–æ)

### –£—Å–ª–æ–≤–∏–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è:
```
pnl_percent <= -sl_percent * 1.5
```

–î–ª—è ranging —Ä–µ–∂–∏–º–∞:
- `sl_percent = 2.0%`
- –ü–æ—Ä–æ–≥ = `-2.0% * 1.5 = -3.0%`

### –¢–µ–∫—É—â–∏–µ —É–±—ã—Ç–∫–∏:
- **DOGE-USDT**: -0.17% –¥–æ -0.21% < -3.0% ‚Üí –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚úÖ
- **ETH-USDT**: -0.04% < -3.0% ‚Üí –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç ‚úÖ

**–í—ã–≤–æ–¥**: –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ, —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ —É–±—ã—Ç–∫–µ >= -3.0%

---

## ‚úÖ –†–ê–ë–û–¢–ê–ï–¢

1. ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
2. ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π
3. ‚úÖ –ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–π (ExitAnalyzer)
4. ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–π (–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ)
5. ‚úÖ Trailing Stop Loss
6. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
7. ‚úÖ Progressive —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è max_position_usd)

---

## ‚ö†Ô∏è –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø (–ù–û–†–ú–ê–õ–¨–ù–´–ï)

1. –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ max_position_size (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è) ‚úÖ
2. DRIFT_ADD (–ø–æ–∑–∏—Ü–∏—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞) ‚úÖ

---

## üîß –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. –£–≤–µ–ª–∏—á–∏—Ç—å max_position_usd –¥–ª—è micro –ø—Ä–æ—Ñ–∏–ª—è:
```yaml
micro:
  max_position_usd: 100.0  # –ë—ã–ª–æ 70.0
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–æ $50.0 + –º–Ω–æ–∂–∏—Ç–µ–ª–∏ –¥–æ $100.0

### 2. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π:
–í `ExitAnalyzer.__init__` –¥–æ–±–∞–≤–∏—Ç—å:
```python
logger.debug("‚úÖ CandlePatternDetector –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
logger.debug("‚úÖ LiquidityLevelsDetector –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
logger.debug("‚úÖ VolumeProfileCalculator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
logger.debug("‚úÖ PivotCalculator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
```

### 3. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É–º–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è:
- –î–æ–∂–¥–∞—Ç—å—Å—è —É–±—ã—Ç–∫–∞ >= -3.0% –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É–º–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏

---

## üìã –ò–¢–û–ì

### ‚úÖ **–ë–û–¢ –†–ê–ë–û–¢–ê–ï–¢ –ù–û–†–ú–ê–õ–¨–ù–û**

- –í—Å–µ –º–æ–¥—É–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã—Ç—ã –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è
- –°–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π
- –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ (—Å—Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ —É–±—ã—Ç–∫–µ >= -3.0%)

### ‚ö†Ô∏è **–ú–ï–õ–ö–ò–ï –£–õ–£–ß–®–ï–ù–ò–Ø**

- –£–≤–µ–ª–∏—á–∏—Ç—å max_position_usd –¥–ª—è micro –ø—Ä–æ—Ñ–∏–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)

---

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏**: 2025-12-07 22:03
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–°–Å –†–ê–ë–û–¢–ê–ï–¢**



