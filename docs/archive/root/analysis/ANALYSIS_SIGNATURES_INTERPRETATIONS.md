# –ê–ù–ê–õ–ò–ó: –°–ò–ì–ù–ê–¢–£–†–´ –ò –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ò –î–ê–ù–ù–´–•

**–î–∞—Ç–∞:** 2025-12-18  
**–°—Ç–∞—Ç—É—Å:** üîç –ê–ù–ê–õ–ò–ó

---

## üìä –ê–ù–ê–õ–ò–ó –°–ò–ì–ù–ê–¢–£–† –ò –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ô

---

## 1. –ü–û–ó–ò–¶–ò–ò (Positions)

### 1.1 –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ (size/pos) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `pos` –∏–ª–∏ `size`
- –§–æ—Ä–º–∞—Ç: **–ö–û–ù–¢–†–ê–ö–¢–´** (–Ω–µ –º–æ–Ω–µ—Ç—ã!)
- –ü—Ä–∏–º–µ—Ä: `pos: "1.5"` = 1.5 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
size = float(position.get("pos", "0"))
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: size –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –º–æ–Ω–µ—Ç—ã:
ct_val = float(details.get("ctVal", "0.01"))
size_in_coins = abs(size) * ct_val
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã * ctVal = –º–æ–Ω–µ—Ç—ã
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 1.2 –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ (posSide/position_side) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `posSide`
- –ó–Ω–∞—á–µ–Ω–∏—è: `"long"` –∏–ª–∏ `"short"`
- –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: `side` (–≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
pos_side = position.get("posSide") or position.get("position_side", "long")
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º posSide –∏–∑ API

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
if side.lower() in ["buy", "long"]:
    position_side = "long"
elif side.lower() in ["sell", "short"]:
    position_side = "short"
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º buy/sell ‚Üí long/short
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 1.3 –ú–∞—Ä–∂–∞ (margin/imr) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `margin` –∏–ª–∏ `imr` (initial margin requirement)
- –§–æ—Ä–º–∞—Ç: **USDT** (–≤–∞–ª—é—Ç–∞ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏)
- –ü—Ä–∏–º–µ—Ä: `margin: "20.5"` = 20.5 USDT

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
margin_str = position.get("margin") or position.get("imr") or "0"
if margin_str and str(margin_str).strip() and str(margin_str) != "0":
    margin_used = float(margin_str)
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º margin –∏–ª–∏ imr
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 1.4 –ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL (upl/unrealizedPnl) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `upl` –∏–ª–∏ `unrealizedPnl`
- –§–æ—Ä–º–∞—Ç: **USDT** (–≤–∞–ª—é—Ç–∞ –∫–æ—Ç–∏—Ä–æ–≤–∫–∏)
- –ú–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º (—É–±—ã—Ç–æ–∫)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
upl_str = position.get("upl") or position.get("unrealizedPnl") or "0"
if upl_str and str(upl_str).strip() and str(upl_str) != "0":
    unrealized_pnl = float(upl_str)
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º upl –∏–ª–∏ unrealizedPnl
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 1.5 –¶–µ–Ω–∞ –≤—Ö–æ–¥–∞ (avgPx) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `avgPx`
- –§–æ—Ä–º–∞—Ç: **–¶–µ–Ω–∞** (USDT –∑–∞ –µ–¥–∏–Ω–∏—Ü—É –±–∞–∑–æ–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞)
- –ü—Ä–∏–º–µ—Ä: `avgPx: "110000"` = 110,000 USDT –∑–∞ BTC

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
entry_price = float(position.get("avgPx", "0"))
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º avgPx –∫–∞–∫ —Ü–µ–Ω—É –≤—Ö–æ–¥–∞
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 1.6 Mark Price (markPx) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `markPx`
- –§–æ—Ä–º–∞—Ç: **–¶–µ–Ω–∞** (—Å–ø—Ä–∞–≤–æ—á–Ω–∞—è —Ü–µ–Ω–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ PnL)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ unrealized PnL

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
mark_px = float(position.get("markPx", "0"))
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º markPx –∫–∞–∫ —Å–ø—Ä–∞–≤–æ—á–Ω—É—é —Ü–µ–Ω—É
# ‚ö†Ô∏è –ù–û: –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º current_price –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞ –¥–ª—è —Ä–µ–∞–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (—Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º current_price –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞)

---

## 2. –û–†–î–ï–†–ê (Orders)

### 2.1 Order ID (ordId/clOrdId) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `ordId` (–±–∏—Ä–∂–µ–≤–æ–π ID)
- –ü–æ–ª–µ: `clOrdId` (–∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π ID)
- –§–æ—Ä–º–∞—Ç: **–°—Ç—Ä–æ–∫–∞**

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
order_id = order.get("ordId") or order.get("clOrdId")
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º ordId –∏–ª–∏ clOrdId
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 2.2 –°–æ—Å—Ç–æ—è–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ (state) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `state`
- –ó–Ω–∞—á–µ–Ω–∏—è: `"live"`, `"filled"`, `"partially_filled"`, `"canceled"`

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
order_state = order.get("state", "").lower()
if order_state in ["live", "pending", "partially_filled"]:
    # –û—Ä–¥–µ—Ä –∞–∫—Ç–∏–≤–µ–Ω
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 2.3 –†–∞–∑–º–µ—Ä –æ—Ä–¥–µ—Ä–∞ (sz) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `sz`
- –§–æ—Ä–º–∞—Ç: **–ö–û–ù–¢–†–ê–ö–¢–´** (–Ω–µ –º–æ–Ω–µ—Ç—ã!)
- –ü—Ä–∏–º–µ—Ä: `sz: "0.5"` = 0.5 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
order_size = float(order.get("sz", "0"))
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: size –≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö

# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –º–æ–Ω–µ—Ç—ã:
size_in_coins = order_size * ct_val
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ ctVal
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 2.4 –¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞ (px) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `px`
- –§–æ—Ä–º–∞—Ç: **–¶–µ–Ω–∞** (USDT –∑–∞ –µ–¥–∏–Ω–∏—Ü—É –±–∞–∑–æ–≤–æ–≥–æ –∞–∫—Ç–∏–≤–∞)
- –î–ª—è market –æ—Ä–¥–µ—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç—ã–º

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
order_price = float(order.get("px", "0"))
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º px –∫–∞–∫ —Ü–µ–Ω—É –æ—Ä–¥–µ—Ä–∞
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## 3. –¶–ï–ù–´ (Prices)

### 3.1 Best Bid/Ask ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `best_bid` / `best_ask` (–∏–∑ —Å—Ç–∞–∫–∞–Ω–∞)
- –§–æ—Ä–º–∞—Ç: **–¶–µ–Ω–∞** (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏/–ø—Ä–æ–¥–∞–∂–∏)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
best_bid = price_limits.get("best_bid", 0)
best_ask = price_limits.get("best_ask", 0)

# –î–ª—è BUY: –∏—Å–ø–æ–ª—å–∑—É–µ–º best_ask ‚úÖ
limit_price = best_ask * (1 + offset_percent / 100.0)

# –î–ª—è SELL: –∏—Å–ø–æ–ª—å–∑—É–µ–º best_bid ‚úÖ
limit_price = best_bid * (1 - offset_percent / 100.0)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 3.2 Current Price (last) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `last` (–∏–∑ ticker)
- –§–æ—Ä–º–∞—Ç: **–¶–µ–Ω–∞** (–ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞ —Å–¥–µ–ª–∫–∏)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
current_price = float(ticker.get("last", "0"))
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∏—Å–ø–æ–ª—å–∑—É–µ–º last –∫–∞–∫ —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 3.3 Mark Price (markPx) ‚ö†Ô∏è

**OKX API:**
- –ü–æ–ª–µ: `markPx`
- –§–æ—Ä–º–∞—Ç: **–°–ø—Ä–∞–≤–æ—á–Ω–∞—è —Ü–µ–Ω–∞** (–¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ PnL)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
mark_px = float(position.get("markPx", "0"))
# ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback, –Ω–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º current_price –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback)

---

## 4. –ò–ù–°–¢–†–£–ú–ï–ù–¢–´ (Instruments)

### 4.1 ctVal (Contract Value) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `ctVal`
- –§–æ—Ä–º–∞—Ç: **–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç –≤ 1 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–µ**
- –ü—Ä–∏–º–µ—Ä—ã:
  - BTC: `ctVal: "0.01"` = 1 –∫–æ–Ω—Ç—Ä–∞–∫—Ç = 0.01 BTC
  - SOL: `ctVal: "1"` = 1 –∫–æ–Ω—Ç—Ä–∞–∫—Ç = 1 SOL

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
ct_val = float(details.get("ctVal", "0.01"))
size_in_coins = size_in_contracts * ct_val
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã –≤ –º–æ–Ω–µ—Ç—ã
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 4.2 lotSz (Lot Size) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `lotSz`
- –§–æ—Ä–º–∞—Ç: **–®–∞–≥ —Ä–∞–∑–º–µ—Ä–∞** (–≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö)
- –ü—Ä–∏–º–µ—Ä: `lotSz: "0.01"` = —à–∞–≥ 0.01 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
lot_sz = float(details.get("lotSz", "0.01"))
rounded_size = round_to_step(size_in_contracts, lot_sz)
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –æ–∫—Ä—É–≥–ª—è–µ–º –¥–æ lotSz
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 4.3 minSz (Minimum Size) ‚úÖ

**OKX API:**
- –ü–æ–ª–µ: `minSz`
- –§–æ—Ä–º–∞—Ç: **–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä** (–≤ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö)
- –ü—Ä–∏–º–µ—Ä: `minSz: "0.01"` = –º–∏–Ω–∏–º—É–º 0.01 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
min_sz = float(details.get("minSz", "0.01"))
if rounded_size < min_sz:
    rounded_size = min_sz
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø—Ä–æ–≤–µ—Ä—è–µ–º –º–∏–Ω–∏–º—É–º
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## 5. –°–ò–ì–ù–ê–¢–£–†–´ –ú–ï–¢–û–î–û–í

### 5.1 –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –ø–æ–∑–∏—Ü–∏—è–º–∏ ‚úÖ

**–°–∏–≥–Ω–∞—Ç—É—Ä—ã:**
```python
async def get_positions(self) -> List[Dict[str, Any]]
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ü–∏–π

async def get_position(self, symbol: str) -> Optional[Dict[str, Any]]
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–¥–Ω—É –ø–æ–∑–∏—Ü–∏—é –∏–ª–∏ None
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 5.2 –ú–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –æ—Ä–¥–µ—Ä–∞–º–∏ ‚úÖ

**–°–∏–≥–Ω–∞—Ç—É—Ä—ã:**
```python
async def place_order(
    self,
    symbol: str,
    side: str,
    order_type: str,
    size: float,
    price: Optional[float] = None,
    post_only: bool = False,
) -> Optional[Dict[str, Any]]
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 5.3 –ú–µ—Ç–æ–¥—ã —Ä–∞—Å—á–µ—Ç–∞ PnL ‚úÖ

**–°–∏–≥–Ω–∞—Ç—É—Ä—ã:**
```python
def get_profit_pct(
    self,
    current_price: float,
    include_fees: bool = True,
    margin_used: Optional[float] = None,
    unrealized_pnl: Optional[float] = None,
) -> float
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç float
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## 6. –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ò –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ô

### 6.1 BUY vs LONG ‚úÖ

**OKX API:**
- `side: "buy"` ‚Üí –æ—Ç–∫—Ä—ã—Ç–∏–µ LONG –ø–æ–∑–∏—Ü–∏–∏
- `posSide: "long"` ‚Üí LONG –ø–æ–∑–∏—Ü–∏—è

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
# –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏:
if signal["side"] == "buy":
    pos_side = "long"  # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

# –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–∑–∏—Ü–∏–∏:
if position.get("posSide") == "long":
    # LONG –ø–æ–∑–∏—Ü–∏—è ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 6.2 SELL vs SHORT ‚úÖ

**OKX API:**
- `side: "sell"` ‚Üí –æ—Ç–∫—Ä—ã—Ç–∏–µ SHORT –ø–æ–∑–∏—Ü–∏–∏
- `posSide: "short"` ‚Üí SHORT –ø–æ–∑–∏—Ü–∏—è

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
# –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏:
if signal["side"] == "sell":
    pos_side = "short"  # ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

# –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –ø–æ–∑–∏—Ü–∏–∏:
if position.get("posSide") == "short":
    # SHORT –ø–æ–∑–∏—Ü–∏—è ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## 7. –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ò –¶–ï–ù

### 7.1 –î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è LONG ‚úÖ

**–õ–æ–≥–∏–∫–∞:**
- –ü–æ–∫—É–ø–∞–µ–º –ø–æ `best_ask` (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏)
- –î–æ–±–∞–≤–ª—è–µ–º –Ω–µ–±–æ–ª—å—à–æ–π offset –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
limit_price = best_ask * (1 + offset_percent / 100.0)
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø–æ–∫—É–ø–∞–µ–º –ø–æ best_ask
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 7.2 –î–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è SHORT ‚úÖ

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–æ–¥–∞–µ–º –ø–æ `best_bid` (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏)
- –í—ã—á–∏—Ç–∞–µ–º –Ω–µ–±–æ–ª—å—à–æ–π offset –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
limit_price = best_bid * (1 - offset_percent / 100.0)
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø—Ä–æ–¥–∞–µ–º –ø–æ best_bid
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 7.3 –î–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è LONG ‚úÖ

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–æ–¥–∞–µ–º –ø–æ `best_bid` (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
exit_price = best_bid
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∑–∞–∫—Ä—ã–≤–∞–µ–º LONG –ø–æ best_bid
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 7.4 –î–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è SHORT ‚úÖ

**–õ–æ–≥–∏–∫–∞:**
- –ü–æ–∫—É–ø–∞–µ–º –ø–æ `best_ask` (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
exit_price = best_ask
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∑–∞–∫—Ä—ã–≤–∞–µ–º SHORT –ø–æ best_ask
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## 8. –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ò –†–ê–ó–ú–ï–†–û–í

### 8.1 –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ ‚úÖ

**OKX API:**
- `pos` –≤ **–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö**

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
size = float(position.get("pos", "0"))  # –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã
size_in_coins = size * ct_val  # –ú–æ–Ω–µ—Ç—ã
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

### 8.2 –†–∞–∑–º–µ—Ä –æ—Ä–¥–µ—Ä–∞ ‚úÖ

**OKX API:**
- `sz` –≤ **–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞—Ö**

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
order_size = float(order.get("sz", "0"))  # –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã
size_in_coins = order_size * ct_val  # –ú–æ–Ω–µ—Ç—ã
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## 9. –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ò –í–†–ï–ú–ï–ù–ò

### 9.1 Timestamps ‚úÖ

**OKX API:**
- –§–æ—Ä–º–∞—Ç: **–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã** (Unix timestamp √ó 1000)
- –ü—Ä–∏–º–µ—Ä: `cTime: "1703001234567"`

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
timestamp_ms = int(position.get("cTime", "0"))
timestamp_sec = timestamp_ms / 1000.0
entry_time = datetime.fromtimestamp(timestamp_sec)
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∏–∑ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## 10. –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ò –ö–û–ú–ò–°–°–ò–ô

### 10.1 Maker/Taker ‚úÖ

**OKX API:**
- Maker: 0.02% (–¥–ª—è limit –æ—Ä–¥–µ—Ä–æ–≤ —Å post_only)
- Taker: 0.05% (–¥–ª—è market –æ—Ä–¥–µ—Ä–æ–≤)

**–ù–∞—à–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
```python
if entry_order_type == "limit" and entry_post_only:
    entry_commission_rate = maker_fee_rate  # 0.02%
else:
    entry_commission_rate = taker_fee_rate  # 0.05%
# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ–º maker/taker
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û

---

## üéØ –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### ‚úÖ –í–°–ï –°–ò–ì–ù–ê–¢–£–†–´ –ò –ò–ù–¢–ï–†–ü–†–ï–¢–ê–¶–ò–ò –ü–†–ê–í–ò–õ–¨–ù–´–ï (100%):

1. ‚úÖ –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ (–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã ‚Üí –º–æ–Ω–µ—Ç—ã —á–µ—Ä–µ–∑ ctVal)
2. ‚úÖ –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ (posSide: long/short)
3. ‚úÖ –ú–∞—Ä–∂–∞ (margin/imr)
4. ‚úÖ –ù–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL (upl/unrealizedPnl)
5. ‚úÖ –¶–µ–Ω—ã (best_bid/best_ask –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–π)
6. ‚úÖ –û—Ä–¥–µ—Ä–∞ (ordId/clOrdId, state, sz, px)
7. ‚úÖ –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã (ctVal, lotSz, minSz)
8. ‚úÖ –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (BUY‚ÜíLONG, SELL‚ÜíSHORT)
9. ‚úÖ –í—Ä–µ–º—è (–º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥—ã ‚Üí —Å–µ–∫—É–Ω–¥—ã)
10. ‚úÖ –ö–æ–º–∏—Å—Å–∏–∏ (maker/taker)

---

## üìä –í–´–í–û–î

**–í—Å–µ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ!** ‚úÖ

- ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ API OKX
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –µ–¥–∏–Ω–∏—Ü (–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã ‚Üî –º–æ–Ω–µ—Ç—ã)
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Ü–µ–Ω
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π

**–°–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç API OKX!** ‚úÖ

---

**–ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω!** ‚úÖ
