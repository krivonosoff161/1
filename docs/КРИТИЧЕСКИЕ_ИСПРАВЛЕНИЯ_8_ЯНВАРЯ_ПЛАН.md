# КРИТИЧЕСКИЕ ИСПРАВЛЕНИЯ - 8 ЯНВАРЯ 2026

## ПРОБЛЕМЫ ИЗ ЛОГОВ

### 1. ❌ Fallback баланс 1000 искажает риск
**Файл:** `src/strategies/scalping/futures/position_manager.py:906`
**Проблема:** При SSL ошибке используется fallback=1000 вместо hard-fail
**Исправление:** Заменить на hard-fail как в liquidation_guard

### 2. ❌ TCC падает на 'str' object has no attribute 'get'
**Файл:** `src/strategies/scalping/futures/core/trading_control_center.py:800`
**Проблема:** При SSL ошибке margin_status может быть строкой
**Статус:** Частично исправлено, нужно проверить все места

### 3. ❌ Ошибка 51006 - цена вне лимитов
**Файл:** `src/strategies/scalping/futures/order_executor.py:1615`
**Проблема:** Обработка есть, но нужно проверить работает ли
**Статус:** Код есть, нужно проверить логи

### 4. ❌ MTF недоступен на выходах
**Файл:** `src/strategies/scalping/futures/positions/exit_analyzer.py:1975`
**Проблема:** MTF фильтр недоступен → только SL/EMERGENCY выходы
**Исправление:** Проверить почему MTF недоступен и исправить инициализацию

### 5. ❌ SSL/timeout ошибки не обрабатываются gracefully
**Файл:** `src/clients/futures_client.py`
**Проблема:** Retry есть, но нужно улучшить обработку SSL ошибок
**Исправление:** Добавить специальную обработку SSL ошибок

### 6. ❌ Fallback цены искажают PnL
**Файл:** `src/strategies/scalping/futures/positions/entry_manager.py:350`
**Проблема:** Fallback цены используются при entry_price=0
**Исправление:** Hard-fail вместо fallback или более строгая валидация

## ПЛАН ИСПРАВЛЕНИЙ

1. ✅ Убрать fallback баланс 1000 → hard-fail
2. ✅ Улучшить обработку SSL ошибок в futures_client
3. ✅ Проверить и исправить MTF инициализацию
4. ✅ Улучшить валидацию данных от API (isinstance checks)
5. ✅ Добавить graceful degradation при деградации API
