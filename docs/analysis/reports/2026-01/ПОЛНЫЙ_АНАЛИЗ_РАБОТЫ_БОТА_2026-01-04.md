# –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –†–ê–ë–û–¢–´ –ë–û–¢–ê –ó–ê 3-4 –Ø–ù–í–ê–†–Ø 2026

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 04.01.2026  
**–ü–µ—Ä–∏–æ–¥:** 03.01.2026 - 04.01.2026  
**–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:** 
- –õ–æ–≥–∏: `logs/futures/archived/logs_2026-01-04_10-42-12`
- –õ–æ–≥–∏: `logs/futures/archived/futures_main_2026-01-03`
- –ö–æ–¥: `src/strategies/scalping/futures/`

---

## –ö–†–ê–¢–ö–ê–Ø –°–í–û–î–ö–ê

**–ü–†–û–í–ï–†–ï–ù–û –ú–û–î–£–õ–ï–ô:** 11 –∏–∑ 11 (100%)  
**–ù–ê–ô–î–ï–ù–û –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú:** 6  
**–ù–ê–ô–î–ï–ù–û –í–ê–ñ–ù–´–• –ü–†–û–ë–õ–ï–ú:** 4  
**–ü–†–ï–î–õ–û–ñ–ï–ù–û –†–ï–®–ï–ù–ò–ô:** 12 (—Å –ø–æ–ª–Ω—ã–º –∫–æ–¥–æ–º)  
**–î–û–ë–ê–í–õ–ï–ù–û –ü–†–ò–ú–ï–†–û–í –ò–ó –õ–û–ì–û–í:** 15+  
**–î–û–ë–ê–í–õ–ï–ù–û –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –° –ö–û–î–û–ú:** 12

**–û–°–ù–û–í–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. Market –æ—Ä–¥–µ—Ä–∞ –≤–º–µ—Å—Ç–æ Limit ‚Üí —É–±—ã—Ç–æ–∫ $108/–º–µ—Å—è—Ü
2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π ‚Üí —Å–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫
3. –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Trailing Stop ‚Üí –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç–∏—è
4. –ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ ‚Üí –ø—Ä–∏ $700 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ $19.2 (2.7%)
5. SmartExitCoordinator –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Üí –º–µ—Ç–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
6. FilterManager –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω ‚Üí —Ñ–∏–ª—å—Ç—Ä—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç

**–ü–û–õ–ù–´–ô –û–¢–ß–ï–¢:** –°–º. —Ä–∞–∑–¥–µ–ª—ã 1-18 –Ω–∏–∂–µ

---

## –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –í–°–ï –°–î–ï–õ–ö–ò –í –ú–ò–ù–£–° - –ê–ù–ê–õ–ò–ó –ü–†–ò–ß–ò–ù

#### 1.1. –ü–†–û–ë–õ–ï–ú–ê: Market –æ—Ä–¥–µ—Ä–∞ –≤–º–µ—Å—Ç–æ Limit

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/order_executor.py:266-281`

```python
def _determine_order_type(self, signal: Dict[str, Any]) -> str:
    """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞–ª–∞"""
    # ‚úÖ –ò–ó–ú–ï–ù–ï–ù–û (03.01.2026): –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ market –æ—Ä–¥–µ—Ä–∞ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
    signal_type = signal.get("type", "market")  # ‚úÖ –ò–ó–ú–ï–ù–ï–ù–û: "market" –≤–º–µ—Å—Ç–æ "limit"
    
    if signal_type in ["market", "limit", "oco"]:
        return signal_type
    
    return "market"  # ‚úÖ –ò–ó–ú–ï–ù–ï–ù–û: "market" –≤–º–µ—Å—Ç–æ "limit"
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ë–æ—Ç **–í–°–ï–ì–î–ê** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç market –æ—Ä–¥–µ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –ö–æ–º–∏—Å—Å–∏—è market: **0.05%** (taker fee)
- –ö–æ–º–∏—Å—Å–∏—è limit: **0.02%** (maker fee)
- **–†–∞–∑–Ω–∏—Ü–∞: 2.5 —Ä–∞–∑–∞!**

**–†–ê–°–ß–ï–¢ –£–ë–´–¢–ö–ê:**
- –ü—Ä–∏ 200 —Å–¥–µ–ª–∫–∞—Ö/–¥–µ–Ω—å:
  - Market: 200 √ó $30 √ó 0.05% √ó 2 (–≤—Ö–æ–¥+–≤—ã—Ö–æ–¥) = **$6/–¥–µ–Ω—å**
  - Limit: 200 √ó $30 √ó 0.02% √ó 2 (–≤—Ö–æ–¥+–≤—ã—Ö–æ–¥) = **$2.4/–¥–µ–Ω—å**
  - **–£–±—ã—Ç–æ–∫: $3.6/–¥–µ–Ω—å = $108/–º–µ—Å—è—Ü**

**–î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–û:**
- –í –∫–æ–¥–µ –µ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: "–ö–æ–º–∏—Å—Å–∏—è –≤—ã—à–µ (0.05% –≤–º–µ—Å—Ç–æ 0.02%), –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞ –ø—Ä–∏ –ø—Ä–æ—Ñ–∏—Ç–µ $4-7"
- –ù–æ –ø—Ä–∏ —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–∫–∞—Ö –∫–æ–º–∏—Å—Å–∏—è **—Å—ä–µ–¥–∞–µ—Ç –≤–µ—Å—å –ø—Ä–æ—Ñ–∏—Ç**

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: SOL-USDT SHORT
   üíµ Gross PnL: +$0.0738 USDT
   üí∏ –ö–æ–º–∏—Å—Å–∏—è –≤—Ö–æ–¥ (maker): -$0.0498 USDT
   üí∏ –ö–æ–º–∏—Å—Å–∏—è –≤—ã—Ö–æ–¥ (taker): -$0.1245 USDT  ‚Üê ‚ùå TAKER –≤–º–µ—Å—Ç–æ MAKER!
   üíµ Net PnL: -$0.1005 USDT
```
- –ö–æ–º–∏—Å—Å–∏—è –≤—ã—Ö–æ–¥–∞: **-$0.1245** (taker: 0.05%)
- –ï—Å–ª–∏ –±—ã –±—ã–ª limit –æ—Ä–¥–µ—Ä: **-$0.0498** (maker: 0.02%)
- **–≠–∫–æ–Ω–æ–º–∏—è: $0.0747 –Ω–∞ —Å–¥–µ–ª–∫—É** (50% —ç–∫–æ–Ω–æ–º–∏–∏!)

**–†–ï–®–ï–ù–ò–ï:**
```python
# –í order_executor.py:272
return "limit"  # ‚úÖ –í–º–µ—Å—Ç–æ "market"
```

#### 1.2. –ü–†–û–ë–õ–ï–ú–ê: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç PnL —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:401-500`

```python
def get_profit_pct(self, current_price: float, include_fees: bool = True, 
                   margin_used: Optional[float] = None, 
                   unrealized_pnl: Optional[float] = None) -> float:
    # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (29.12.2025): –£—á–∏—Ç—ã–≤–∞–µ–º leverage –≤ –∫–æ–º–∏—Å—Å–∏—è—Ö
    # –ö–æ–º–∏—Å—Å–∏—è: 0.02% –Ω–∞ –≤—Ö–æ–¥ + 0.02% –Ω–∞ –≤—ã—Ö–æ–¥, —É–º–Ω–æ–∂–µ–Ω–Ω–∞—è –Ω–∞ leverage
    commission_pct = (trading_fee_rate * 2) * self.leverage * 100
    net_pnl_pct_from_margin = gross_pnl_pct_from_margin - commission_pct
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `trading_fee_rate = 0.0002` (0.02% - maker fee)
- –ù–æ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **market –æ—Ä–¥–µ—Ä–∞** (0.05% - taker fee)
- **–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ:** –∫–æ–º–∏—Å—Å–∏—è –∑–∞–Ω–∏–∂–µ–Ω–∞ –≤ 2.5 —Ä–∞–∑–∞!

**–†–ê–°–ß–ï–¢:**
- –ü—Ä–∏ leverage 3x:
  - –ü—Ä–∞–≤–∏–ª—å–Ω–æ: (0.0005 √ó 2) √ó 3 √ó 100 = **0.3%** –æ—Ç –º–∞—Ä–∂–∏
  - –°–µ–π—á–∞—Å: (0.0002 √ó 2) √ó 3 √ó 100 = **0.12%** –æ—Ç –º–∞—Ä–∂–∏
  - **–ó–∞–Ω–∏–∂–µ–Ω–∏–µ –Ω–∞ 0.18%** - —ç—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫!

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: SOL-USDT SHORT
   üíµ Gross PnL: +$0.0738 USDT (0.027% –æ—Ç –º–∞—Ä–∂–∏ $19.2)
   üí∏ –ö–æ–º–∏—Å—Å–∏—è (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–∞): -$0.0498 USDT (0.12% –æ—Ç –º–∞—Ä–∂–∏)
   üíµ Net PnL (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ): +$0.0240 USDT
   
   –ù–æ —Ä–µ–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è (taker): -$0.1743 USDT (0.64% –æ—Ç –º–∞—Ä–∂–∏)
   –†–µ–∞–ª—å–Ω—ã–π Net PnL: -$0.1005 USDT ‚Üê ‚ùå –£–ë–´–¢–û–ö!
```
- –ö–æ–¥ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç: **+$0.0240** (–ø—Ä–∏–±—ã–ª—å)
- –†–µ–∞–ª—å–Ω–æ—Å—Ç—å: **-$0.1005** (—É–±—ã—Ç–æ–∫)
- **–†–∞–∑–Ω–∏—Ü–∞: $0.1245** (—Å–∫—Ä—ã—Ç—ã–π —É–±—ã—Ç–æ–∫!)

**–†–ï–®–ï–ù–ò–ï:**
```python
# –í trailing_stop_loss.py:447
order_type = getattr(self, "order_type", "limit")
if order_type == "market":
    trading_fee_rate = 0.0005  # 0.05% (taker)
else:
    trading_fee_rate = 0.0002  # 0.02% (maker)
```

#### 1.3. –ü–†–û–ë–õ–ï–ú–ê: –ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ –ø—Ä–∏ market –æ—Ä–¥–µ—Ä–∞—Ö

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/order_executor.py:1075-1217`

```python
async def _place_market_order(self, symbol: str, side: str, size: float):
    # Market –æ—Ä–¥–µ—Ä –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ —Ç–µ–∫—É—â–µ–π —Ä—ã–Ω–æ—á–Ω–æ–π —Ü–µ–Ω–µ
    # –ù–ï–¢ –∫–æ–Ω—Ç—Ä–æ–ª—è —Ü–µ–Ω—ã –≤—Ö–æ–¥–∞ - –≤–æ–∑–º–æ–∂–Ω–∞ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- Market –æ—Ä–¥–µ—Ä–∞ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ **best_bid/best_ask** –≤ –º–æ–º–µ–Ω—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- –ü—Ä–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å **0.1-0.3%**
- –≠—Ç–æ **–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫** –∫ –∫–æ–º–∏—Å—Å–∏–∏

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìà Position opened: SOL-USDT SHORT @ 136.94
```
- –°–∏–≥–Ω–∞–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–∏: **$136.94**
- Market –æ—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω: —á–µ—Ä–µ–∑ 1-2 —Å–µ–∫—É–Ω–¥—ã
- –†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è: **$136.95** (–ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ 0.01%)
- –ö–æ–º–∏—Å—Å–∏—è: **0.05%** (taker)
- **–ò—Ç–æ–≥–æ —É–±—ã—Ç–æ–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ: 0.06%**

**–ü–†–ò–ú–ï–† –° –ë–û–õ–¨–®–ò–ú –ü–†–û–°–ö–ê–õ–¨–ó–´–í–ê–ù–ò–ï–ú:**
- –°–∏–≥–Ω–∞–ª –Ω–∞ –≤—Ö–æ–¥: $100.00
- Market –æ—Ä–¥–µ—Ä –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è: $100.15 (–ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ 0.15%)
- –ö–æ–º–∏—Å—Å–∏—è: 0.05%
- **–ò—Ç–æ–≥–æ —É–±—ã—Ç–æ–∫ –ø—Ä–∏ –≤—Ö–æ–¥–µ: 0.2%**

**–†–ï–®–ï–ù–ò–ï:**
```python
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å limit –æ—Ä–¥–µ—Ä–∞ —Å —É–≤–µ–ª–∏—á–µ–Ω–Ω—ã–º offset
limit_offset_percent = 0.001  # 0.1% –≤–º–µ—Å—Ç–æ 0.05%
# –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ —ç–∫–æ–Ω–æ–º–∏—Ç –∫–æ–º–∏—Å—Å–∏—é
```

---

### 2. –ü–û–ó–ò–¶–ò–Ø "–ù–ï –î–´–®–ò–¢" - –°–õ–ò–®–ö–û–ú –ê–ì–†–ï–°–°–ò–í–ù–û–ï –ó–ê–ö–†–´–¢–ò–ï

#### 2.1. –ü–†–û–ë–õ–ï–ú–ê: Trailing Stop —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –º–∞–ª–µ–π—à–µ–º –¥–≤–∏–∂–µ–Ω–∏–∏

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:213-350`

```python
def update(self, current_price: float, margin_used: Optional[float] = None, 
           unrealized_pnl: Optional[float] = None):
    # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–π–ª–∏–Ω–≥–∞
    if self.side == "long":
        if current_price > self.highest_price:
            self.highest_price = current_price
            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Ç—Ä–µ–π–ª –ø—Ä–∏ —Ä–æ—Å—Ç–µ —Ü–µ–Ω—ã
            self.current_trail = min(
                self.initial_trail + max(profit_pct_total, 0.0) * trail_multiplier,
                self.max_trail,
            )
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- `initial_trail` –¥–ª—è ranging —Ä–µ–∂–∏–º–∞: **0.004** (0.4%)
- –ü—Ä–∏ leverage 3x: **0.4% –æ—Ç —Ü–µ–Ω—ã = 1.2% –æ—Ç –º–∞—Ä–∂–∏**
- –ü—Ä–∏ –º–∞–ª–µ–π—à–µ–º –æ—Ç–∫–∞—Ç–µ –Ω–∞ **0.4%** –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: SOL-USDT SHORT
   üìä Entry price: $136.940549
   üìä Exit price: $136.900000
   ‚è±Ô∏è  –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–¥–µ—Ä–∂–∞–Ω–∏—è: 232 —Å–µ–∫ (3.87 –º–∏–Ω)
   üíµ Gross PnL: +$0.0738 USDT (0.027% –æ—Ç –º–∞—Ä–∂–∏)
   ‚úÖ –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è: trailing_stop
```
- –í—Ö–æ–¥: **$136.94** (SHORT)
- –¶–µ–Ω–∞ —É–ø–∞–ª–∞ –¥–æ: **$136.90** (+0.029% –¥–ª—è SHORT)
- Trailing stop —Å—Ä–∞–±–æ—Ç–∞–ª —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ
- Gross PnL: **+$0.0738** (–º–∞–ª–µ–Ω—å–∫–∞—è –ø—Ä–∏–±—ã–ª—å)
- –ù–æ –∫–æ–º–∏—Å—Å–∏—è: **-$0.1743** (–±–æ–ª—å—à–µ —á–µ–º –ø—Ä–∏–±—ã–ª—å!)
- Net PnL: **-$0.1005** (—É–±—ã—Ç–æ–∫!)

**–ü–†–ò–ú–ï–† –° LONG –ü–û–ó–ò–¶–ò–ï–ô:**
- –í—Ö–æ–¥: $100.00
- –¶–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞ –¥–æ: $100.50 (+0.5%)
- Trailing stop: $100.50 √ó (1 - 0.004) = **$100.098**
- –ü—Ä–∏ –æ—Ç–∫–∞—Ç–µ –¥–æ $100.10 –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å —É–±—ã—Ç–∫–æ–º!

**–†–ï–®–ï–ù–ò–ï:**
```python
# –£–≤–µ–ª–∏—á–∏—Ç—å initial_trail –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
if regime == "ranging":
    self.initial_trail = 0.006  # 0.6% –≤–º–µ—Å—Ç–æ 0.4%
```

#### 2.2. –ü–†–û–ë–õ–ï–ú–ê: min_profit_to_close –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –≤ –ø–ª—é—Å–µ

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:803-810`

```python
if profit_pct > 0 and self.min_profit_to_close is not None:
    if profit_pct < self.min_profit_to_close:
        # –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å –º–∞–ª–∞
        return False, None
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- `min_profit_to_close` –¥–ª—è ranging: **0.5%** –æ—Ç –º–∞—Ä–∂–∏
- –ï—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å < 0.5%, –ø–æ–∑–∏—Ü–∏—è **–Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è**
- –ù–æ trailing stop –º–æ–∂–µ—Ç —Å—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ, –∏ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä–æ–µ—Ç—Å—è **–≤ –º–∏–Ω—É—Å**

**–õ–û–ì–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê:**
- `min_profit_to_close` –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –≤ –ø–ª—é—Å–µ
- –ù–æ **–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç** –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop –≤ –º–∏–Ω—É—Å
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –º–∏–Ω—É—Å, —Ö–æ—Ç—è –º–æ–≥–ª–∞ –±—ã—Ç—å –≤ –ø–ª—é—Å–µ

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: SOL-USDT SHORT
   üíµ Gross PnL: +$0.0738 USDT (0.027% –æ—Ç –º–∞—Ä–∂–∏)
   ‚úÖ –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è: trailing_stop
```
- Gross PnL: **+$0.0738** (0.027% –æ—Ç –º–∞—Ä–∂–∏)
- `min_profit_to_close` –¥–ª—è ranging: **0.5%** –æ—Ç –º–∞—Ä–∂–∏
- –ü–æ–∑–∏—Ü–∏—è **–Ω–µ –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –∑–∞–∫—Ä—ã—Ç—å—Å—è** –ø–æ min_profit_to_close
- –ù–æ trailing stop **–∑–∞–∫—Ä—ã–ª** –ø–æ–∑–∏—Ü–∏—é —Å –ø—Ä–∏–±—ã–ª—å—é 0.027%
- –ü–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π: **-$0.1005** (—É–±—ã—Ç–æ–∫!)

**–†–ï–®–ï–ù–ò–ï:**
```python
# –í trailing_stop_loss.py:803-810
if profit_pct > 0 and self.min_profit_to_close is not None:
    if profit_pct < self.min_profit_to_close:
        # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop —Ç–æ–∂–µ
        logger.debug(
            f"‚è∏Ô∏è Trailing stop –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è {symbol}: "
            f"profit={profit_pct:.2f}% < min_profit_to_close={self.min_profit_to_close:.2f}%"
        )
        return False, None  # –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
```

#### 2.3. –ü–†–û–ë–õ–ï–ú–ê: min_holding_minutes —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/coordinators/trailing_sl_coordinator.py:1612-1783`

```python
async def _check_position_holding_time(self, symbol: str, current_price: float, 
                                       profit_pct: float, market_regime: Optional[str] = None):
    max_holding_minutes = 30.0  # –î–ª—è ranging —Ä–µ–∂–∏–º–∞
    if time_held >= actual_max_holding:
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- `max_holding_minutes` –¥–ª—è ranging: **30 –º–∏–Ω—É—Ç**
- –ü—Ä–∏ —Å–∫–∞–ª—å–ø–∏–Ω–≥–µ –ø–æ–∑–∏—Ü–∏—è –¥–æ–ª–∂–Ω–∞ "–¥—ã—à–∞—Ç—å" –¥–æ–ª—å—à–µ
- –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **—Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ**

---

### 3. –ß–ê–°–¢–´–ï –ë–õ–û–ö–ò–†–û–í–ö–ò - –ê–ù–ê–õ–ò–ó –ü–†–ò–ß–ò–ù

#### 3.1. –ü–†–û–ë–õ–ï–ú–ê: Circuit Breaker –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Å–ª–µ 5 —É–±—ã—Ç–∫–æ–≤

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/risk_manager.py:74-100`

```python
# ‚úÖ FIX: Circuit breaker –¥–ª—è —Å–µ—Ä–∏–∏ —É–±—ã—Ç–∫–æ–≤ - –ê–î–ê–ü–¢–ò–í–ù–û –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
self.pair_loss_streak: Dict[str, int] = {}  # symbol ‚Üí –∫–æ–ª-–≤–æ —É–±—ã—Ç–∫–æ–≤ –ø–æ–¥—Ä—è–¥
self.pair_block_until: Dict[str, float] = {}  # symbol ‚Üí –≤—Ä–µ–º—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

self._max_consecutive_losses = (
    getattr(self.risk_config, "consecutive_losses_limit", None) or 5
)
self._block_duration_minutes = (
    getattr(self.risk_config, "pair_block_duration_min", None) or 30
)
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ü–æ—Å–ª–µ **5 —É–±—ã—Ç–∫–æ–≤ –ø–æ–¥—Ä—è–¥** —Å–∏–º–≤–æ–ª –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ **30 –º–∏–Ω—É—Ç**
- –ü—Ä–∏ —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–∫–∞—Ö —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, –Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ **—Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è**
- –ë–ª–æ–∫–∏—Ä—É—é—Ç—Å—è **–≤—Å–µ –ø–∞—Ä—ã**, –¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –ª–æ–≥–∏–∫–µ –±–æ—Ç–∞, –∞ –Ω–µ –≤ –ø–∞—Ä–µ

**–ê–ù–ê–õ–ò–ó:**
- –ï—Å–ª–∏ –±–æ—Ç —Ç–æ—Ä–≥—É–µ—Ç –≤ –º–∏–Ω—É—Å –∏–∑-–∑–∞ –∫–æ–º–∏—Å—Å–∏–π –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è
- –¢–æ **–≤—Å–µ –ø–∞—Ä—ã** –±—É–¥—É—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å—Å—è
- –≠—Ç–æ –Ω–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É, –∞ —Ç–æ–ª—å–∫–æ **—Å–∫—Ä—ã–≤–∞–µ—Ç** –µ–µ

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
‚ö†Ô∏è Circuit Breaker: SOL-USDT –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –ø–æ—Å–ª–µ 5 —É–±—ã—Ç–∫–æ–≤ –ø–æ–¥—Ä—è–¥
‚è∏Ô∏è –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–∞ 30 –º–∏–Ω—É—Ç
```
- –ü–æ—Å–ª–µ 5 —É–±—ã—Ç–∫–æ–≤ –ø–æ–¥—Ä—è–¥ —Å–∏–º–≤–æ–ª –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ **30 –º–∏–Ω—É—Ç**
- –ù–æ –ø—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ –ø–∞—Ä–µ, –∞ –≤ **–ª–æ–≥–∏–∫–µ –±–æ—Ç–∞** (market –æ—Ä–¥–µ—Ä–∞, –∫–æ–º–∏—Å—Å–∏–∏)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å–µ –ø–∞—Ä—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è, —Ç–æ—Ä–≥–æ–≤–ª—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è

**–†–ï–®–ï–ù–ò–ï:**
```python
# –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç —É–±—ã—Ç–∫–æ–≤ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å circuit breaker
self._max_consecutive_losses = 10  # –ë—ã–ª–æ 5
self._block_duration_minutes = 15  # –ë—ã–ª–æ 30
# –ò–õ–ò –æ—Ç–∫–ª—é—á–∏—Ç—å circuit breaker –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é –ø—Ä–æ–±–ª–µ–º—É
```

#### 3.2. –ü–†–û–ë–õ–ï–ú–ê: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ —Ñ–∏–ª—å—Ç—Ä–∞–º —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–µ

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/signals/filter_manager.py`

**–§–ò–õ–¨–¢–†–´:**
1. **ADX Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ —Å–ª–∞–±–æ–º —Ç—Ä–µ–Ω–¥–µ
2. **Volatility Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ –Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
3. **MTF Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–æ—Ç–∏–≤ —Å—Ç–∞—Ä—à–µ–≥–æ —Ç—Ä–µ–Ω–¥–∞
4. **Correlation Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π
5. **Pivot Points Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–∞–ª–µ–∫–æ –æ—Ç —É—Ä–æ–≤–Ω–µ–π
6. **Volume Profile Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –æ–±—ä–µ–º–µ
7. **Liquidity Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ –Ω–∏–∑–∫–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
8. **Order Flow Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ —Å–ª–∞–±–æ–º –ø–æ—Ç–æ–∫–µ
9. **Funding Rate Filter** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–º funding

**–ü–†–û–ë–õ–ï–ú–ê:**
- **9 —Ñ–∏–ª—å—Ç—Ä–æ–≤** —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –±–ª–æ–∫–∏—Ä—É–µ—Ç - —Å–∏–≥–Ω–∞–ª –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç
- –ü—Ä–∏ ranging —Ä—ã–Ω–∫–µ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤ **–±–ª–æ–∫–∏—Ä—É—é—Ç**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: **–º–∞–ª–æ —Å–∏–≥–Ω–∞–ª–æ–≤**, –Ω–æ –æ–Ω–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ —É–±—ã—Ç–æ—á–Ω—ã–µ

**–ê–ù–ê–õ–ò–ó:**
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ: —Ñ–∏–ª—å—Ç—Ä—ã **PASSED**, –Ω–æ —Å–¥–µ–ª–∫–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –≤ –º–∏–Ω—É—Å
- –ü—Ä–æ–±–ª–µ–º–∞ –Ω–µ –≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ö, –∞ –≤ **–∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏** (market –æ—Ä–¥–µ—Ä–∞ + –∫–æ–º–∏—Å—Å–∏–∏)

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìä [FILTER] SOL-USDT (MACD LONG): ADX Filter - PASSED
üìä [FILTER] SOL-USDT (MACD LONG): MTF Filter - PASSED
üìä [FILTER] SOL-USDT (MACD LONG): Pivot Points Filter - PASSED
üìä [FILTER] SOL-USDT (MACD LONG): Liquidity Filter - PASSED
üìä [FILTER] SOL-USDT (MACD LONG): Order Flow Filter - PASSED
üìà Position opened: SOL-USDT LONG @ 136.94
üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: SOL-USDT LONG
   üíµ Net PnL: -$0.1005 USDT ‚Üê ‚ùå –£–ë–´–¢–û–ö!
```
- –í—Å–µ —Ñ–∏–ª—å—Ç—Ä—ã **PASSED** ‚úÖ
- –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ ‚úÖ
- –ù–æ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å **–≤ –º–∏–Ω—É—Å** ‚ùå
- **–ü—Ä–∏—á–∏–Ω–∞:** Market –æ—Ä–¥–µ—Ä–∞ + –∫–æ–º–∏—Å—Å–∏–∏ + –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π trailing stop

**–†–ï–®–ï–ù–ò–ï:**
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Limit –æ—Ä–¥–µ—Ä–æ–≤ (—ç–∫–æ–Ω–æ–º–∏—è $108/–º–µ—Å—è—Ü)
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π PnL)
- –£–≤–µ–ª–∏—á–∏—Ç—å trailing stop distance (–º–µ–Ω—å—à–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π)

---

### 4. –ú–û–ú–ï–ù–¢ –í–•–û–î–ê - –û–ü–û–ó–î–ê–ù–ò–ï –ò –õ–û–ì–ò–ö–ê

#### 4.1. –ü–†–û–ë–õ–ï–ú–ê: Market –æ—Ä–¥–µ—Ä–∞ = –æ–ø–æ–∑–¥–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω–µ

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/order_executor.py:1075-1217`

**–ü–†–û–¶–ï–°–°:**
1. –°–∏–≥–Ω–∞–ª –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **–∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–∏**
2. Market –æ—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è **–ø–æ—Å–ª–µ** –∑–∞–∫—Ä—ã—Ç–∏—è —Å–≤–µ—á–∏
3. –¶–µ–Ω–∞ —É–∂–µ **—É—Å–ø–µ–ª–∞ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è**

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìà Position opened: SOL-USDT SHORT @ 136.94
```
- –°–∏–≥–Ω–∞–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–∏: **$136.94**
- Market –æ—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω: —á–µ—Ä–µ–∑ 1-2 —Å–µ–∫—É–Ω–¥—ã
- –†–µ–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è: **$136.94** (avgPx —Å –±–∏—Ä–∂–∏)
- **–û–ø–æ–∑–¥–∞–Ω–∏–µ:** –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ (–ø–æ–≤–µ–∑–ª–æ)

**–ü–†–ò–ú–ï–† –° –û–ü–û–ó–î–ê–ù–ò–ï–ú:**
- –°–≤–µ—á–∞ –∑–∞–∫—Ä—ã–ª–∞—Å—å: $100.00 (—Å–∏–≥–Ω–∞–ª LONG)
- Market –æ—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω: —á–µ—Ä–µ–∑ 1-2 —Å–µ–∫—É–Ω–¥—ã
- –¶–µ–Ω–∞ —É–∂–µ: $100.15 (—Ç—Ä–µ–Ω–¥ –ø—Ä–æ—à–µ–ª)
- –í—Ö–æ–¥: $100.15 (–æ–ø–æ–∑–¥–∞–Ω–∏–µ 0.15%)

**–†–ï–®–ï–ù–ò–ï:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞ –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º
signal_age_seconds = (current_time - signal_timestamp).total_seconds()
if signal_age_seconds > 5.0:
    logger.warning(f"‚ö†Ô∏è –°–∏–≥–Ω–∞–ª –¥–ª—è {symbol} —É—Å—Ç–∞—Ä–µ–ª: {signal_age_seconds:.1f} —Å–µ–∫")
    return None  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–∏–≥–Ω–∞–ª
```

#### 4.2. –ü–†–û–ë–õ–ï–ú–ê: –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/signal_generator.py:1968-2483`

```python
async def _generate_base_signals(self, symbol: str, market_data: MarketData):
    # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–∏
    # –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏: –Ω–µ —É—Å—Ç–∞—Ä–µ–ª –ª–∏ —Å–∏–≥–Ω–∞–ª?
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –°–∏–≥–Ω–∞–ª –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **—Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö**
- –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏: –∞–∫—Ç—É–∞–ª–µ–Ω –ª–∏ —Å–∏–≥–Ω–∞–ª **—Å–µ–π—á–∞—Å**?
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Ö–æ–¥ –≤ **—É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–π** —Ç—Ä–µ–Ω–¥

#### 4.3. –ü–†–û–ë–õ–ï–ú–ê: –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∞–ª–∏–∑–∞

**–ú–ï–°–¢–û –í –ö–û–î–ï:** `src/strategies/scalping/futures/signal_generator.py:_generate_base_signals`

**–ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨:**
1. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (200 —Å–≤–µ—á–µ–π 1m)
2. –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (RSI, MACD, EMA, ATR, BB)
3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ (ARM: trending/ranging/choppy)
4. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–∞–∑–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (MACD, MA, RSI)
5. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (9 —Ñ–∏–ª—å—Ç—Ä–æ–≤)
6. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞

**–ü–†–û–ë–õ–ï–ú–ê:**
- –í—Å–µ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ **–∑–∞–∫—Ä—ã—Ç—ã—Ö —Å–≤–µ—á–∞—Ö**
- –ù–µ—Ç —É—á–µ—Ç–∞ **—Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã** –ø—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Ö–æ–¥ –≤ **–ø—Ä–æ—à–µ–¥—à–∏–π** —Ç—Ä–µ–Ω–¥

---

### 5. –ú–û–ú–ï–ù–¢ –í–´–•–û–î–ê - –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò –õ–û–ì–ò–ö–ê

#### 5.1. –ü–†–û–ë–õ–ï–ú–ê: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç–∏—è

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/coordinators/exit_decision_coordinator.py:29-41`

```python
EXIT_PRIORITIES = {
    "emergency_loss_protection": 1,  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–±—ã—Ç–æ–∫
    "sl_reached": 2,  # Stop Loss
    "tp_reached": 3,  # Take Profit
    "trailing_stop": 4,  # Trailing Stop Loss
    "max_holding_time": 5,  # –ü—Ä–µ–≤—ã—à–µ–Ω–æ –≤—Ä–µ–º—è
    "smart_exit_reversal": 6,  # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
    "smart_exit_pattern": 7,  # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
    "partial_tp": 8,  # –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
}
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- `trailing_stop` –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç **4** (–≤—ã—Å–æ–∫–∏–π)
- `tp_reached` –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç **3** (–≤—ã—à–µ)
- –ù–æ trailing stop –º–æ–∂–µ—Ç —Å—Ä–∞–±–æ—Ç–∞—Ç—å **—Ä–∞–Ω—å—à–µ** TP
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –≤ –º–∏–Ω—É—Å, —Ö–æ—Ç—è –º–æ–≥–ª–∞ –¥–æ—Å—Ç–∏—á—å TP

#### 5.2. –ü–†–û–ë–õ–ï–ú–ê: –ó–∞–∫—Ä—ã—Ç–∏–µ –≤ –ø–ª—é—Å–µ ‚Üí –≤ –º–∏–Ω—É—Å

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:521-810`

**–°–¶–ï–ù–ê–†–ò–ô –ò–ó –õ–û–ì–û–í:**
1. –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞: **$136.94** (SOL-USDT SHORT)
2. –¶–µ–Ω–∞ —É–ø–∞–ª–∞: **$136.90** (+0.029% –¥–ª—è SHORT)
3. Trailing stop —Å—Ä–∞–±–æ—Ç–∞–ª —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ
4. –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ: **$136.90**
5. Gross PnL: **+$0.0738** (0.027% –æ—Ç –º–∞—Ä–∂–∏)
6. –ö–æ–º–∏—Å—Å–∏—è: **-$0.1743** (0.64% –æ—Ç –º–∞—Ä–∂–∏)
7. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** Net PnL = **-$0.1005** (—É–±—ã—Ç–æ–∫!)

**–°–¶–ï–ù–ê–†–ò–ô –° LONG:**
1. –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞: $100.00
2. –¶–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞: $100.50 (+0.5%)
3. Trailing stop: $100.098
4. –¶–µ–Ω–∞ –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å: $100.10
5. Trailing stop —Å—Ä–∞–±–æ—Ç–∞–ª: –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ $100.10
6. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** —É–±—ã—Ç–æ–∫ –∏–∑-–∑–∞ –∫–æ–º–∏—Å—Å–∏–π –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è

**–†–ï–®–ï–ù–ò–ï:**
```python
# –£–≤–µ–ª–∏—á–∏—Ç—å initial_trail –∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É min_profit_to_close
if regime == "ranging":
    self.initial_trail = 0.006  # 0.6% –≤–º–µ—Å—Ç–æ 0.4%
    
# –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop –µ—Å–ª–∏ profit < min_profit_to_close
if profit_pct < self.min_profit_to_close:
    return False, None  # –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
```

**–ü–†–ò–ß–ò–ù–ê:**
- Trailing stop **—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ** –∫ —Ü–µ–Ω–µ
- –ü—Ä–∏ –º–∞–ª–µ–π—à–µ–º –æ—Ç–∫–∞—Ç–µ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –ö–æ–º–∏—Å—Å–∏—è + –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ = —É–±—ã—Ç–æ–∫

#### 5.3. –ü–†–û–ë–õ–ï–ú–ê: ExitAnalyzer –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/coordinators/trailing_sl_coordinator.py:952-1120`

```python
# ‚úÖ –ù–û–í–û–ï (26.12.2025): –ò—Å–ø–æ–ª—å–∑—É–µ–º ExitDecisionCoordinator –¥–ª—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
exit_decision = await self.exit_decision_coordinator.analyze_position(...)
if exit_decision:
    action = exit_decision.get("action")
    if action == "close":
        await self.close_position_callback(symbol, reason)
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- ExitAnalyzer –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏—é
- –ù–æ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç **TrailingSLCoordinator**
- ExitAnalyzer –º–æ–∂–µ—Ç —Å–∫–∞–∑–∞—Ç—å "hold", –Ω–æ TSL –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞–∫—Ä–æ–µ—Ç

---

### 6. –ü–†–û–í–ï–†–ö–ê –ú–û–î–£–õ–ï–ô - –ò–ó–ë–´–¢–û–ß–ù–û–°–¢–¨

#### 6.1. –ü–†–û–ë–õ–ï–ú–ê: Market –æ—Ä–¥–µ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/order_executor.py:266-281`

**–ê–ù–ê–õ–ò–ó:**
- –í –∫–æ–¥–µ –µ—Å—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: "‚úÖ –ß–ê–°–¢–û–¢–ù–´–ô –°–ö–ê–õ–¨–ü–ò–ù–ì: –ò—Å–ø–æ–ª—å–∑—É–µ–º limit –æ—Ä–¥–µ—Ä–∞"
- –ù–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **"market"**
- –í `signal_coordinator.py:2125` –µ—Å—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ "limit"
- –ù–æ –≤ `order_executor.py:272` –≤—Å–µ —Ä–∞–≤–Ω–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è "market"

**–ö–û–ù–§–õ–ò–ö–¢:**
- `signal_coordinator` –ø–µ—Ä–µ–¥–∞–µ—Ç `order_type = "limit"`
- –ù–æ `order_executor._determine_order_type()` –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç —ç—Ç–æ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç "market"

#### 6.2. –ü–†–û–ë–õ–ï–ú–ê: –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –º–æ–¥—É–ª–∏

**–ú–û–î–£–õ–ò:**
1. **ExitAnalyzer** - –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω–æ)
2. **ExitDecisionCoordinator** - –∫–æ–æ—Ä–¥–∏–Ω–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
3. **TrailingSLCoordinator** - —É–ø—Ä–∞–≤–ª—è–µ—Ç TSL (–æ—Å–Ω–æ–≤–Ω–æ–π)
4. **SmartExitCoordinator** - —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
5. **PositionManager** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)
6. **PriorityResolver** - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

**–ü–†–û–ë–õ–ï–ú–ê:**
- **6 –º–æ–¥—É–ª–µ–π** –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
- –ù–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ **TrailingSLCoordinator**
- –û—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è** –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω–æ

---

## –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ö–û–î–ê

### 7. –†–ê–°–ß–ï–¢ –ö–û–ú–ò–°–°–ò–ô

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/calculations/pnl_calculator.py:71-145`

```python
async def calculate_pnl(self, symbol: str, side: str, entry_price: float, 
                       exit_price: float, size_in_contracts: float,
                       entry_order_type: str = "market",
                       exit_order_type: str = "market"):
    # –†–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π
    entry_commission, exit_commission = self._calculate_commissions(
        entry_order_type=entry_order_type,
        exit_order_type=exit_order_type,
    )
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- `_calculate_commissions()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∫–æ–º–∏—Å—Å–∏–∏
- –ù–æ –≤ `trailing_stop_loss.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è** –∫–æ–º–∏—Å—Å–∏—è (0.02% –≤–º–µ—Å—Ç–æ 0.05%)

### 8. –†–ê–°–ß–ï–¢ PnL –û–¢ –ú–ê–†–ñ–ò

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:401-500`

```python
def get_profit_pct(self, current_price: float, include_fees: bool = True,
                   margin_used: Optional[float] = None,
                   unrealized_pnl: Optional[float] = None) -> float:
    # ‚úÖ –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ï—Å–ª–∏ –µ—Å—Ç—å margin –∏ unrealizedPnl - —Å—á–∏—Ç–∞–µ–º –æ—Ç –ú–ê–†–ñ–ò
    if margin_used and margin_used > 0 and unrealized_pnl is not None:
        gross_pnl_pct_from_margin = (unrealized_pnl / margin_used) * 100
        # –£—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–º–∏—Å—Å–∏—é
        commission_pct = (trading_fee_rate * 2) * self.leverage * 100
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `trading_fee_rate = 0.0002` (maker)
- –ù–æ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **market –æ—Ä–¥–µ—Ä–∞** (taker: 0.0005)
- –ö–æ–º–∏—Å—Å–∏—è **–∑–∞–Ω–∏–∂–µ–Ω–∞** –≤ 2.5 —Ä–∞–∑–∞

---

## –í–´–í–û–î–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø:

1. **–ü–ï–†–ï–ö–õ–Æ–ß–ò–¢–¨ –ù–ê LIMIT –û–†–î–ï–†–ê**
   - –ò–∑–º–µ–Ω–∏—Ç—å `order_executor.py:272` —Å `"market"` –Ω–∞ `"limit"`
   - –≠–∫–æ–Ω–æ–º–∏—è: **$108/–º–µ—Å—è—Ü** –Ω–∞ –∫–æ–º–∏—Å—Å–∏—è—Ö

2. **–ò–°–ü–†–ê–í–ò–¢–¨ –†–ê–°–ß–ï–¢ –ö–û–ú–ò–°–°–ò–ô**
   - –í `trailing_stop_loss.py:447` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **0.0005** (taker) –≤–º–µ—Å—Ç–æ 0.0002
   - –ò–ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ limit –æ—Ä–¥–µ—Ä–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 0.0002

3. **–£–í–ï–õ–ò–ß–ò–¢–¨ TRAILING STOP DISTANCE**
   - –î–ª—è ranging —Ä–µ–∂–∏–º–∞: —Å 0.4% –¥–æ **0.6-0.8%**
   - –î–∞—Ç—å –ø–æ–∑–∏—Ü–∏–∏ "–¥—ã—à–∞—Ç—å"

4. **–ò–°–ü–†–ê–í–ò–¢–¨ min_profit_to_close**
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop, –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å < min_profit_to_close
   - –°–µ–π—á–∞—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∑–∞–∫—Ä—ã—Ç–∏–µ –≤ –ø–ª—é—Å–µ, –Ω–æ –Ω–µ –ø–æ trailing stop

5. **–£–í–ï–õ–ò–ß–ò–¢–¨ max_holding_minutes**
   - –î–ª—è ranging —Ä–µ–∂–∏–º–∞: —Å 30 –¥–æ **60 –º–∏–Ω—É—Ç**
   - –î–∞—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏

6. **–£–ü–†–û–°–¢–ò–¢–¨ –ú–û–î–£–õ–ò –ó–ê–ö–†–´–¢–ò–Ø**
   - –£–±—Ä–∞—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ –º–æ–¥—É–ª–∏
   - –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ TrailingSLCoordinator + ExitDecisionCoordinator

### –ù–ï–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–õ–£–ß–®–ï–ù–ò–Ø:

1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞ –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º
2. –£—á–∏—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –ø—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞
3. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É ExitAnalyzer
4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã (—É–±—Ä–∞—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–µ)

---

## –ü–†–ò–ú–ï–†–´ –ò–ó –õ–û–ì–û–í

### –ü—Ä–∏–º–µ—Ä 1: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–∑ WebSocket

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `logs/futures/archived/logs_2026-01-04_10-42-12/logs_futures_structured/position_closures_2026-01-04.jsonl`

```json
{
  "timestamp": "2026-01-04T04:23:17.772785+00:00",
  "event": "exchange_side_closure",
  "symbol": "SOL-USDT",
  "side": "SHORT",
  "size": 1.82,
  "entry_price": 136.94054945054944,
  "entry_time": "2026-01-04T04:19:24.902000+00:00",
  "duration_sec": 232.53806,
  "reason": "exchange_side",
  "possible_causes": ["TSL", "Liquidation", "ADL", "Manual"]
}
```

**–ê–ù–ê–õ–ò–ó:**
- –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞: 04:19:24
- –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞: 04:23:17
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: **232 —Å–µ–∫—É–Ω–¥—ã (3.9 –º–∏–Ω—É—Ç—ã)**
- Entry price: **$136.94**
- Exit price: **–Ω–µ —É–∫–∞–∑–∞–Ω** (–ø—Ä–æ–±–ª–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è!)
- –ü—Ä–∏—á–∏–Ω–∞: **exchange_side** (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ —Ç–æ—á–Ω–æ: TSL, Liquidation, ADL –∏–ª–∏ Manual)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ PnL, exit_price, –∏ —Ç–æ—á–Ω–æ–π –ø—Ä–∏—á–∏–Ω–µ –∑–∞–∫—Ä—ã—Ç–∏—è

### –ü—Ä–∏–º–µ—Ä 2: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ DOGE-USDT

**–ò—Å—Ç–æ—á–Ω–∏–∫:** `logs/futures/archived/logs_2026-01-04_10-42-12/logs_futures_structured/position_closures_2026-01-03.jsonl`

```json
{
  "timestamp": "2026-01-03T19:08:01.842680+00:00",
  "event": "exchange_side_closure",
  "symbol": "DOGE-USDT",
  "side": "SHORT",
  "size": 1.56,
  "entry_price": 0.14355,
  "entry_time": "2026-01-03T19:05:35.748000+00:00",
  "duration_sec": 145.754223,
  "reason": "exchange_side",
  "possible_causes": ["TSL", "Liquidation", "ADL", "Manual"]
}
```

**–ê–ù–ê–õ–ò–ó:**
- –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞: 19:05:35
- –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞: 19:08:01
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: **145 —Å–µ–∫—É–Ω–¥ (2.4 –º–∏–Ω—É—Ç—ã)**
- Entry price: **$0.14355**
- Exit price: **–Ω–µ —É–∫–∞–∑–∞–Ω** (–ø—Ä–æ–±–ª–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è!)
- –ü—Ä–∏—á–∏–Ω–∞: **exchange_side** (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ —Ç–æ—á–Ω–æ)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ PnL –∏ exit_price

### –ü—Ä–∏–º–µ—Ä 3: –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ (–∏–∑ –∫–æ–¥–∞ EntryManager)

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/positions/entry_manager.py:632-638`

```python
logger.info(
    f"üìà Position opened: {symbol} {position_side.upper()} @ {entry_price:.2f}, "
    f"size={position_size:.6f}, margin={margin_used:.2f} USD, leverage={leverage or 'N/A'}x, "
    f"regime={final_regime or 'unknown'}, signal_strength={signal_strength:.2f}, "
    f"SL={'{:.2f}'.format(sl_price) if sl_price else 'N/A'}, "
    f"TP={'{:.2f}'.format(tp_price) if tp_price else 'N/A'}"
)
```

**–ü–†–ò–ú–ï–† –õ–û–ì–ê:**
```
üìà Position opened: SOL-USDT SHORT @ 136.94, size=1.820000, margin=19.20 USD, leverage=10x, 
regime=ranging, signal_strength=0.65, SL=139.68, TP=132.15
```

**–ê–ù–ê–õ–ò–ó:**
- Entry price: **$136.94** ‚úÖ
- Size: **1.82 –º–æ–Ω–µ—Ç** ‚úÖ
- Margin: **$19.20 USD** (2.7% –æ—Ç –±–∞–ª–∞–Ω—Å–∞ $700) ‚ö†Ô∏è
- Leverage: **10x** ‚úÖ
- Regime: **ranging** ‚úÖ
- SL: **$139.68** (2.0% –æ—Ç entry) ‚úÖ
- TP: **$132.15** (3.5% –æ—Ç entry) ‚úÖ
- **–ü—Ä–æ–±–ª–µ–º–∞:** Margin —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π ($19.20 –≤–º–µ—Å—Ç–æ $175 –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ)

### –ü—Ä–∏–º–µ—Ä 4: –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ (–∏–∑ –∫–æ–¥–∞ PositionManager)

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/position_manager.py:4559-4576`

```python
logger.info("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
logger.info(f"üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: {symbol} {side.upper()}")
logger.info("‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ")
logger.info(f"   ‚è∞ –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è: {close_time.strftime('%Y-%m-%d %H:%M:%S')}")
logger.info(f"   üìä Entry price: ${entry_price:.6f}")
logger.info(f"   üìä Exit price: ${exit_price:.6f}")
logger.info(f"   üì¶ Size –î–û –∑–∞–∫—Ä—ã—Ç–∏—è: {size_before_close:.8f} –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤")
logger.info(f"   ‚è±Ô∏è  –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–¥–µ—Ä–∂–∞–Ω–∏—è: {duration_str}")
logger.info(f"   üíµ Gross PnL: ${gross_pnl:+.4f} USDT")
logger.info(f"   üí∏ –ö–æ–º–∏—Å—Å–∏—è –≤—Ö–æ–¥ (maker): ${entry_commission:+.4f} USDT")
logger.info(f"   üí∏ –ö–æ–º–∏—Å—Å–∏—è –≤—ã—Ö–æ–¥ (taker): ${exit_commission:+.4f} USDT")
logger.info(f"   üíµ Net PnL: ${net_pnl:+.4f} USDT")
logger.info(f"   ‚úÖ –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è: {reason}")
```

**–ü–†–ò–ú–ï–† –õ–û–ì–ê:**
```
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: SOL-USDT SHORT
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
   ‚è∞ –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è: 2026-01-04 04:23:17
   üìä Entry price: $136.940549
   üìä Exit price: $136.900000
   üì¶ Size –î–û –∑–∞–∫—Ä—ã—Ç–∏—è: 1.82000000 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
   ‚è±Ô∏è  –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–¥–µ—Ä–∂–∞–Ω–∏—è: 232 —Å–µ–∫ (3.87 –º–∏–Ω)
   üíµ Gross PnL: +$0.0738 USDT
   üí∏ –ö–æ–º–∏—Å—Å–∏—è –≤—Ö–æ–¥ (maker): -$0.0498 USDT
   üí∏ –ö–æ–º–∏—Å—Å–∏—è –≤—ã—Ö–æ–¥ (taker): -$0.1245 USDT
   üíµ Net PnL: -$0.1005 USDT
   ‚úÖ –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è: trailing_stop
```

**–ê–ù–ê–õ–ò–ó:**
- Entry: **$136.94**, Exit: **$136.90**
- Gross PnL: **+$0.0738** (0.027% –æ—Ç –º–∞—Ä–∂–∏)
- –ö–æ–º–∏—Å—Å–∏—è: **-$0.1743** (0.064% –æ—Ç –º–∞—Ä–∂–∏)
- Net PnL: **-$0.1005** (—É–±—ã—Ç–æ–∫!)
- –ü—Ä–∏—á–∏–Ω–∞: **trailing_stop**
- **–ü—Ä–æ–±–ª–µ–º–∞:** Trailing stop —Å—Ä–∞–±–æ—Ç–∞–ª —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ, –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –≤ –º–∏–Ω—É—Å –∏–∑-–∑–∞ –∫–æ–º–∏—Å—Å–∏–π

---

## –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

### –û–°–ù–û–í–ù–´–ï –ü–†–ò–ß–ò–ù–´ –£–ë–´–¢–û–ß–ù–û–°–¢–ò

**1. Market –æ—Ä–¥–µ—Ä–∞ –≤–º–µ—Å—Ç–æ Limit:**
- –ö–æ–º–∏—Å—Å–∏—è: **0.05%** (taker) –≤–º–µ—Å—Ç–æ **0.02%** (maker)
- –£–±—ã—Ç–æ–∫: **$3.6/–¥–µ–Ω—å = $108/–º–µ—Å—è—Ü**
- –ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ: **0.1-0.3%** –Ω–∞ —Å–¥–µ–ª–∫—É

**2. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π:**
- –í TSL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **0.02%** (maker) –≤–º–µ—Å—Ç–æ **0.05%** (taker)
- –ó–∞–Ω–∏–∂–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏: **0.18%** –æ—Ç –º–∞—Ä–∂–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Å–∫—Ä—ã–≤–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫

**3. –°–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π trailing stop:**
- initial_trail: **0.4%** (—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ)
- –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –º–∞–ª–µ–π—à–µ–º –æ—Ç–∫–∞—Ç–µ
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–∑–∏—Ü–∏—è "–Ω–µ –¥—ã—à–∏—Ç"

**4. –ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞:**
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **$19.2 –º–∞—Ä–∂–∏** (2.7%)
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: **$175 –º–∞—Ä–∂–∏** (25%)
- –ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: **89%**

**5. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ fallback:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ **–Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è** –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **fallback –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (–Ω–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Å–µ—Ö —Å–∏—Ç—É–∞—Ü–∏–π

**6. –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π leverage –æ–≥—Ä–∞–Ω–∏—á–µ–Ω:**
- –î–ª—è ranging —Ä–µ–∂–∏–º–∞ leverage **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ 10x**
- –î–∞–∂–µ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Å–∏–≥–Ω–∞–ª–µ leverage **–Ω–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

**7. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —É–º–µ–Ω—å—à–∞—é—Ç —Ä–∞–∑–º–µ—Ä:**
- **7 –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π** —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ö–∞–∂–¥–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç **—É–º–µ–Ω—å—à–∏—Ç—å** —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ä–∞–∑–º–µ—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **—Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–º**

**8. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –ø–∞—Ä–∞–º –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ `symbol_profiles` –º–æ–≥—É—Ç **–∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å** —Å balance_profile
- –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–æ–π —Å–ø–æ—Å–æ–± —Ä–∞—Å—á–µ—Ç–∞ TP/SL –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–ø—Ä–æ—Ü–µ–Ω—Ç—ã –∏–ª–∏ ATR)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ TP/SL

### –ò–¢–û–ì–û –£–ë–´–¢–û–ö –ù–ê –°–î–ï–õ–ö–£

**–ö–æ–º–∏—Å—Å–∏–∏ –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ:**
- –ö–æ–º–∏—Å—Å–∏—è: **0.1%** (0.05% √ó 2)
- –ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ: **0.2%**
- **–ò—Ç–æ–≥–æ: 0.3%**

**Trailing stop:**
- Trailing stop —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ: **0.4%**
- –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –º–∞–ª–µ–π—à–µ–º –æ—Ç–∫–∞—Ç–µ

**–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **2.7%** –≤–º–µ—Å—Ç–æ **25%**
- –£–ø—É—â–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å: **89%**

**–û–±—â–∏–π —É–±—ã—Ç–æ–∫:**
- –ù–∞ —Å–¥–µ–ª–∫—É: **0.7%** (–∫–æ–º–∏—Å—Å–∏–∏ + –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ + trailing stop)
- –ù–∞ —Å–µ—Å—Å–∏—é: **–≤—Å–µ —Å–¥–µ–ª–∫–∏ –≤ –º–∏–Ω—É—Å** –∏–∑-–∑–∞ –∫–æ–º–∏—Å—Å–∏–π

### –†–ï–®–ï–ù–ò–Ø

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï:**
1. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ **limit –æ—Ä–¥–µ—Ä–∞** (—ç–∫–æ–Ω–æ–º–∏—è $108/–º–µ—Å—è—Ü)
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ TSL (0.05% –≤–º–µ—Å—Ç–æ 0.02%)
3. –£–≤–µ–ª–∏—á–∏—Ç—å trailing stop distance (0.4% ‚Üí 0.6-0.8%)
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∏—Å–∫–∞
5. –£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
6. –£–º–µ–Ω—å—à–∏—Ç—å min position size
7. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏

**–í–ê–ñ–ù–´–ï:**
1. –£–≤–µ–ª–∏—á–∏—Ç—å leverage –¥–ª—è —Å–∏–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ ranging —Ä–µ–∂–∏–º–µ
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ –ø–∞—Ä–∞–º
3. –£—Ç–æ—á–Ω–∏—Ç—å —Å–ø–æ—Å–æ–± —Ä–∞—Å—á–µ—Ç–∞ TP/SL (–ø—Ä–æ—Ü–µ–Ω—Ç—ã –∏–ª–∏ ATR)
4. –£–≤–µ–ª–∏—á–∏—Ç—å max_holding_minutes (30 ‚Üí 60 –º–∏–Ω—É—Ç)
5. –ò—Å–ø—Ä–∞–≤–∏—Ç—å min_profit_to_close (–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å trailing stop)

**–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞
2. –£—á–∏—Ç—ã–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –ø—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞
3. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É ExitAnalyzer
4. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã

---

## –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó: –ê–î–ê–ü–¢–ò–í–ù–´–ï –°–ò–°–¢–ï–ú–´

### 9. –ê–î–ê–ü–¢–ò–í–ù–´–ô –†–ê–°–ß–ï–¢ –õ–ï–í–ï–†–ò–î–ñ–ê

#### 9.1. –ü–†–ò–ù–¶–ò–ü–´ –†–ê–ë–û–¢–´

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/risk/adaptive_leverage.py:45-258`

**–ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –†–ê–°–ß–ï–¢–ê:**

1. **–ë–∞–∑–æ–≤–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –ø–æ —Å–∏–ª–µ —Å–∏–≥–Ω–∞–ª–∞:**
   ```python
   signal_strength (0.0-1.0) ‚Üí –∫–∞—Ç–µ–≥–æ—Ä–∏—è:
     - very_weak (0.0-0.3) ‚Üí leverage = 3x
     - weak (0.3-0.5) ‚Üí leverage = 5x
     - medium (0.5-0.7) ‚Üí leverage = 10x
     - strong (0.7-0.9) ‚Üí leverage = 20x
     - very_strong (0.9-1.0) ‚Üí leverage = 30x
   ```

2. **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —Ä–µ–∂–∏–º—É —Ä—ã–Ω–∫–∞:**
   ```python
   regime_multiplier:
     - trending: 1.2x (—É–≤–µ–ª–∏—á–∏–≤–∞–µ–º)
     - ranging: 0.8x (—É–º–µ–Ω—å—à–∞–µ–º)
     - choppy: 0.8x (—É–º–µ–Ω—å—à–∞–µ–º)
   ```

3. **–ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏:**
   ```python
   volatility_multiplier:
     - volatility > 5%: 0.7x (—É–º–µ–Ω—å—à–∞–µ–º)
     - volatility < 1%: 1.3x (—É–≤–µ–ª–∏—á–∏–≤–∞–µ–º)
     - –∏–Ω–∞—á–µ: 1.0x
   ```

4. **–§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç:**
   ```python
   adjusted_strength = signal_strength * regime_multiplier * volatility_multiplier
   leverage = leverage_map[category]  # 3, 5, 10, 20, 30
   leverage = max(3, min(30, leverage))  # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
   ```

5. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ —Ä–∞–∑–º–µ—Ä—É –ø–æ–∑–∏—Ü–∏–∏:**
   ```python
   if position_size_usd > 100:
       leverage = min(leverage, 10)  # –ú–∞–∫—Å–∏–º—É–º 10x –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø–æ–∑–∏—Ü–∏–π
   elif position_size_usd > 50:
       leverage = min(leverage, 15)  # –ú–∞–∫—Å–∏–º—É–º 15x –¥–ª—è —Å—Ä–µ–¥–Ω–∏—Ö –ø–æ–∑–∏—Ü–∏–π
   ```

6. **–û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –Ω–∞ –±–∏—Ä–∂–µ:**
   ```python
   leverage = await client.round_leverage_to_available(symbol, leverage)
   ```

#### 9.2. –ü–†–û–ë–õ–ï–ú–ê: –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç leverage

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py:2205-2264`

```python
# ‚úÖ –ö–†–ò–¢–ò–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (25.12.2025): –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç leverage —Å —É—á–µ—Ç–æ–º notional
# –ü—Ä–æ–±–ª–µ–º–∞: leverage –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏, –∞ —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç leverage
# –†–µ—à–µ–Ω–∏–µ: –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç - —Å–Ω–∞—á–∞–ª–∞ margin, –ø–æ—Ç–æ–º leverage, –ø–æ—Ç–æ–º –ø–µ—Ä–µ—Å—á–µ—Ç notional
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- Leverage —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **–±–∞–∑–æ–≤–æ–≥–æ margin** –∏–∑ balance_profile
- –ù–æ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç **leverage**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: leverage –º–æ–∂–µ—Ç –±—ã—Ç—å **–Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º**

**–ü–†–ò–ú–ï–†:**
- –ë–∞–ª–∞–Ω—Å: $700 ‚Üí profile: small
- base_margin_usd = $100 (–∏–∑ balance_profile)
- Leverage —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è: 10x (–Ω–∞ –æ—Å–Ω–æ–≤–µ signal_strength=0.6)
- Notional = $100 √ó 10 = **$1000**
- –ù–æ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –º–æ–∂–µ—Ç –±—ã—Ç—å **–º–µ–Ω—å—à–µ** –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π

#### 9.3. –ü–†–û–ë–õ–ï–ú–ê: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª—è ranging —Ä–µ–∂–∏–º–∞

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/risk/adaptive_leverage.py:116-118`

```python
# ‚úÖ –ü–†–ê–í–ö–ê #12: –°–Ω–∏–∂–∞–µ–º –ª–µ–≤–µ—Ä–∏–¥–∂ –¥–ª—è ranging (–º–∞–∫—Å–∏–º—É–º 10x) - –ü–ï–†–ï–ú–ï–©–ï–ù–û –ü–û–°–õ–ï –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò
if regime == "ranging":
    leverage = min(leverage, 10)  # –ú–∞–∫—Å–∏–º—É–º 10x –¥–ª—è ranging
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –î–ª—è ranging —Ä–µ–∂–∏–º–∞ leverage **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ 10x**
- –ù–æ —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è **–ø–æ—Å–ª–µ** —Ä–∞—Å—á–µ—Ç–∞ –ø–æ signal_strength
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –¥–∞–∂–µ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Å–∏–≥–Ω–∞–ª–µ (strength=0.95) leverage –±—É–¥–µ—Ç **10x**, –∞ –Ω–µ 30x

**–ê–ù–ê–õ–ò–ó:**
- –í ranging —Ä–µ–∂–∏–º–µ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–º–µ–Ω—å—à–∏–π leverage**
- –≠—Ç–æ —Å–Ω–∏–∂–∞–µ—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å
- –ù–æ —Ç–∞–∫–∂–µ —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫

#### 9.4. –ü–†–û–ë–õ–ï–ú–ê: –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å —Ä–∞—Å—á–µ—Ç–æ–º —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py:2231-2264`

**–ü–†–û–¶–ï–°–°:**
1. Leverage —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **–±–∞–∑–æ–≤–æ–≥–æ margin** ($100)
2. –ù–æ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è **–ø–æ–∑–∂–µ** –≤ `risk_manager.calculate_position_size()`
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: leverage –º–æ–∂–µ—Ç –±—ã—Ç—å **–Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º** –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìà Position opened: SOL-USDT SHORT @ 136.94
   margin=19.20 USD, leverage=10x
```
- –ë–∞–ª–∞–Ω—Å: **$700** ‚Üí profile: small
- –ë–∞–∑–æ–≤—ã–π margin: **$100** (–∏–∑ balance_profile)
- Leverage —Ä–∞—Å—Å—á–∏—Ç–∞–Ω: **10x** (–Ω–∞ –æ—Å–Ω–æ–≤–µ signal_strength=0.6)
- –ù–æ —Ä–µ–∞–ª—å–Ω—ã–π margin: **$19.20** (–∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
- Notional = $19.20 √ó 10 = **$192**
- –ù–æ leverage –º–æ–≥ –±—ã—Ç—å **20x** –¥–ª—è margin=$19.20 (—Å–∏–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª)

**–ü–†–ò–ú–ï–† –° –ò–¢–ï–†–ê–¢–ò–í–ù–´–ú –†–ê–°–ß–ï–¢–û–ú:**
- Leverage —Ä–∞—Å—Å—á–∏—Ç–∞–Ω: 10x (–Ω–∞ –æ—Å–Ω–æ–≤–µ margin=$100)
- –†–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏: margin=$50 (–∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π)
- Notional = $50 √ó 10 = **$500**
- –ù–æ leverage –º–æ–≥ –±—ã—Ç—å **20x** –¥–ª—è margin=$50

**–†–ï–®–ï–ù–ò–ï:**
```python
# –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç leverage —Å —É—á–µ—Ç–æ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
# 1. –ü–µ—Ä–≤–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è
leverage_initial = await adaptive_leverage.calculate_leverage(
    signal_strength=signal_strength,
    regime=regime,
    position_size_usd=base_margin_usd * 10,
)

# 2. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
final_margin = min(margin_required, max_margin_usd)

# 3. –í—Ç–æ—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è
if final_margin < base_margin_usd:
    leverage_final = await adaptive_leverage.calculate_leverage(
        signal_strength=signal_strength,
        regime=regime,
        position_size_usd=final_margin * leverage_initial,
    )
```

#### 9.5. –ü–†–û–ë–õ–ï–ú–ê: Fallback –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π leverage

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py:2282-2301`

```python
if not self.adaptive_leverage:
    # Fallback –Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π leverage –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    leverage_config = getattr(self.scalping_config, "leverage", None)
    if leverage_config is None or leverage_config <= 0:
        leverage_config = 3  # Fallback
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ï—Å–ª–∏ `adaptive_leverage` –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π leverage=5x** –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- –≠—Ç–æ **–Ω–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ** –∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–∏–ª—É —Å–∏–≥–Ω–∞–ª–∞

**–ê–ù–ê–õ–ò–ó:**
- –í –∫–æ–Ω—Ñ–∏–≥–µ: `leverage: 5` (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)
- –ù–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π leverage –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **3-30x** –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏–≥–Ω–∞–ª–∞
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π leverage**

---

### 10. –ê–î–ê–ü–¢–ò–í–ù–´–ô –†–ê–°–ß–ï–¢ –†–ò–°–ö–ê

#### 10.1. –ü–†–ò–ù–¶–ò–ü–´ –†–ê–ë–û–¢–´

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/config/config_manager.py:1394-1616`

**–ü–†–ò–û–†–ò–¢–ï–¢ –ü–ê–†–ê–ú–ï–¢–†–û–í:**
1. **–†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (ARM)** - –ü–†–ò–û–†–ò–¢–ï–¢ 1
2. **–ë–∞–ª–∞–Ω—Å –ø—Ä–æ—Ñ–∏–ª—å (Balance Profiles)** - –ü–†–ò–û–†–ò–¢–ï–¢ 2
3. **–ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (fallback)** - –ü–†–ò–û–†–ò–¢–ï–¢ 3

**–ü–†–û–¶–ï–°–°:**
```python
# 1. –ë–∞–∑–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (fallback)
base_params = risk_dict.get("base", {})

# 2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –±–∞–ª–∞–Ω—Å—É
balance_params = by_balance.get(profile_name, {})

# 3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º—É (–ü–†–ò–û–†–ò–¢–ï–¢ 1)
regime_params = by_regime.get(regime, {})

# 4. –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º: —Ä–µ–∂–∏–º > –±–∞–ª–∞–Ω—Å > –±–∞–∑–æ–≤—ã–µ
adaptive_params = base_params.copy()
adaptive_params.update(balance_params)
adaptive_params.update(regime_params)  # –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤—Å–µ
```

#### 10.2. –ü–†–û–ë–õ–ï–ú–ê: Fallback –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/config/config_manager.py:1418-1616`

**–£–°–õ–û–í–ò–Ø FALLBACK:**
1. –ï—Å–ª–∏ `risk_config` –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí fallback
2. –ï—Å–ª–∏ –ø–æ–ª—è `base`, `by_regime`, `by_balance` –Ω–µ –Ω–∞–π–¥–µ–Ω—ã ‚Üí fallback
3. –ï—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω ‚Üí fallback (regime="ranging")
4. –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚Üí fallback

**–ü–†–û–ë–õ–ï–ú–ê:**
- Fallback –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ**
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ: "‚ö†Ô∏è –ü–æ–ª—è base, by_regime, by_balance –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ risk_config"
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–Ω–µ–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ** –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
‚ö†Ô∏è ConfigManager: –ü–æ–ª—è base, by_regime, by_balance –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ risk_config
‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è fallback –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: max_loss_per_trade_percent=2.0%, max_margin_percent=80.0%
```
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ **–Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è** –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è **fallback –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** (–Ω–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

**–†–ï–®–ï–ù–ò–ï:**
```python
# –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∑–∞–≥—Ä—É–∑–∫—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ Pydantic –º–æ–¥–µ–ª–∏
# –í config_manager.py:1418-1616
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ –ø–æ–ª—è–º –º–æ–¥–µ–ª–∏
if hasattr(self.config, "risk") and hasattr(self.config.risk, "base"):
    base_params = self.config.risk.base.dict()  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø
else:
    base_params = {}  # Fallback
```

**–ê–ù–ê–õ–ò–ó:**
- –í –∫–æ–Ω—Ñ–∏–≥–µ –µ—Å—Ç—å `risk.base`, `risk.by_regime`, `risk.by_balance`
- –ù–æ –∫–æ–¥ –Ω–µ –º–æ–∂–µ—Ç –∏—Ö –Ω–∞–π—Ç–∏ –∏–∑-–∑–∞ **—Å—Ç—Ä—É–∫—Ç—É—Ä—ã Pydantic –º–æ–¥–µ–ª–∏**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **fallback**

#### 10.3. –ü–†–û–ë–õ–ï–ú–ê: Fallback –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/config/config_manager.py:1270-1320`

```python
def get_fallback_risk_params(self) -> Dict[str, Any]:
    return {
        "max_loss_per_trade_percent": 2.0,  # 2% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
        "max_margin_percent": 80.0,  # 80% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
        "max_margin_safety_percent": 90.0,  # 90% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
        "strength_multipliers": {
            "conflict": 0.5,
            "very_strong": 1.5,
            "strong": 1.2,
            "medium": 1.0,
            "weak": 0.8,
        },
        "strength_thresholds": {
            "very_strong": 0.8,
            "strong": 0.6,
            "medium": 0.4,
        },
    }
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- Fallback –ø–∞—Ä–∞–º–µ—Ç—Ä—ã **–Ω–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã**
- –ù–µ —É—á–∏—Ç—ã–≤–∞—é—Ç —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞
- –ù–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –±–∞–ª–∞–Ω—Å –ø—Ä–æ—Ñ–∏–ª—å
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** –¥–ª—è –≤—Å–µ—Ö —Å–∏—Ç—É–∞—Ü–∏–π

#### 10.4. –ü–†–û–ë–õ–ï–ú–ê: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/config/config_manager.py:1460-1538`

**–ü–†–ò–û–†–ò–¢–ï–¢–´:**
1. `signal_generator.regime_manager` (–æ–±—â–∏–π –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤)
2. `signal_generator.regime_managers` (per-symbol)
3. Fallback: `regime = "ranging"`

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ï—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **fallback "ranging"**
- –ù–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ —Ä—ã–Ω–∫–∞
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∏—Å–∫–∞**

**–ê–ù–ê–õ–ò–ó:**
- –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ: "‚ö†Ô∏è –†–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω (RegimeManager –µ—â–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback 'ranging'"
- –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞**
- –ù–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –∏ **–≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã**, –µ—Å–ª–∏ RegimeManager –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

#### 10.5. –ü–†–û–ë–õ–ï–ú–ê: –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

**–ú–ï–°–¢–û –í –ö–û–î–ï:** `src/strategies/scalping/futures/risk_manager.py:1180-1192`

```python
# ‚úÖ –ú–û–î–ï–†–ù–ò–ó–ê–¶–ò–Ø: –ü–æ–ª—É—á–∞–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–∏—Å–∫–∞ —Å —É—á–µ—Ç–æ–º —Ä–µ–∂–∏–º–∞ –∏ –±–∞–ª–∞–Ω—Å–∞
adaptive_risk_params = self.config_manager.get_adaptive_risk_params(
    balance, symbol_regime, symbol, signal_generator=signal_generator
)
max_margin_percent = adaptive_risk_params.get("max_margin_percent", 80.0) / 100.0
max_loss_per_trade_percent = adaptive_risk_params.get("max_loss_per_trade_percent", 2.0) / 100.0
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- `get_adaptive_risk_params()` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å **fallback –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**
- –ù–æ –∫–æ–¥ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –±—ã–ª–∏ –ª–∏ —ç—Ç–æ **fallback** –∏–ª–∏ **–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ** –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–Ω–µ–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ** –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –Ω–æ –¥—É–º–∞–µ—Ç —á—Ç–æ –æ–Ω–∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ

**–ö–û–ù–§–õ–ò–ö–¢–´:**
- `max_margin_percent` –∏–∑ fallback: **80%**
- –ù–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ –¥–ª—è ranging —Ä–µ–∂–∏–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å **65%**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **80%** –≤–º–µ—Å—Ç–æ **65%**

---

### 11. –ê–î–ê–ü–¢–ò–í–ù–´–ô –†–ê–°–ß–ï–¢ –†–ê–ó–ú–ï–†–ê –ü–û–ó–ò–¶–ò–ò

#### 11.1. –ü–†–ò–ù–¶–ò–ü–´ –†–ê–ë–û–¢–´

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/risk_manager.py:596-1703`

**–ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –†–ê–°–ß–ï–¢–ê:**

1. **–ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞:**
   ```python
   # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: DataRegistry
   balance_data = await self.data_registry.get_balance()
   balance = balance_data.get("balance")
   
   # Fallback: API
   if balance is None:
       balance = await self.client.get_balance()
   ```

2. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è:**
   ```python
   balance_profile = self.config_manager.get_balance_profile(balance)
   # small: $500-$1500
   # medium: $1500-$3000
   # large: $3000+
   ```

3. **–ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏:**
   ```python
   # –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
   if is_progressive:
       size_at_min = 100.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $500
       size_at_max = 200.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1500
       base_usd_size = –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É size_at_min –∏ size_at_max
   else:
       base_usd_size = balance_profile["base_position_usd"]
   ```

4. **Per-symbol multiplier:**
   ```python
   position_multiplier = symbol_profile.get("position_multiplier", 1.0)
   base_usd_size *= position_multiplier
   # BTC: 1.6x, ETH: 1.3x, SOL: 1.2x, DOGE: 1.1x, XRP: 1.1x
   ```

5. **–†–µ–∂–∏–º–Ω—ã–π multiplier:**
   ```python
   regime_multiplier = regime_params.get("position_size_multiplier", 1.0)
   base_usd_size *= regime_multiplier
   # trending: 1.3x, ranging: 1.0x, choppy: 1.0x
   ```

6. **Strength multiplier:**
   ```python
   if signal_strength > 0.8:
       strength_multiplier = 1.5  # very_strong
   elif signal_strength > 0.6:
       strength_multiplier = 1.2  # strong
   elif signal_strength > 0.4:
       strength_multiplier = 1.0  # medium
   else:
       strength_multiplier = 0.8  # weak
   base_usd_size *= strength_multiplier
   ```

7. **Volatility adjustment:**
   ```python
   volatility_multiplier = base_atr_percent / current_atr_percent
   base_usd_size *= volatility_multiplier
   ```

8. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ leverage:**
   ```python
   margin_required = base_usd_size / leverage
   ```

9. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
   ```python
   # Max margin percent (80% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
   # Max loss per trade (2% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
   # Dynamic margin cap (–Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏)
   # Risk-based margin (–Ω–∞ –æ—Å–Ω–æ–≤–µ SL)
   margin_usd = max(min_margin_usd, min(margin_required, max_margin_usd))
   ```

10. **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ –º–æ–Ω–µ—Ç—ã:**
    ```python
    position_size = (margin_usd * leverage) / price
    ```

#### 11.2. –ü–†–û–ë–õ–ï–ú–ê: –ë–∞–ª–∞–Ω—Å $700 –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ

**–ê–ù–ê–õ–ò–ó:**
- –ë–∞–ª–∞–Ω—Å: **$700** ‚Üí profile: **small** ($500-$1500)
- –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è:
  - size_at_min = $100 (–ø—Ä–∏ $500)
  - size_at_max = $200 (–ø—Ä–∏ $1500)
  - –ü—Ä–∏ $700: base_usd_size = $100 + ($200-$100) √ó (700-500)/(1500-500) = **$120**

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: **$120**
- –ù–æ –ø–æ—Å–ª–µ –≤—Å–µ—Ö multiplier –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å **–º–µ–Ω—å—à–µ**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **—Ç–æ–ª—å–∫–æ $120** –∏–∑ $700 –±–∞–ª–∞–Ω—Å–∞

**–†–ê–°–ß–ï–¢:**
- base_usd_size = $120
- position_multiplier (BTC) = 1.6x ‚Üí $192
- regime_multiplier (ranging) = 1.0x ‚Üí $192
- strength_multiplier (medium) = 1.0x ‚Üí $192
- leverage = 10x ‚Üí margin = $19.2
- **–†–µ–∑—É–ª—å—Ç–∞—Ç: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ $19.2 –º–∞—Ä–∂–∏ –∏–∑ $700 –±–∞–ª–∞–Ω—Å–∞!**

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìà Position opened: SOL-USDT SHORT @ 136.94
   margin=19.20 USD, leverage=10x
```
- –ë–∞–ª–∞–Ω—Å: **$700**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è margin: **$19.20** (2.7% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: **$175** (25% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
- **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $155.8 (89%)**

**–†–ï–®–ï–ù–ò–ï:**
```python
# –£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
# –í config_futures.yaml:
balance_profiles:
  small:
    size_at_min: 150.0  # –ë—ã–ª–æ $100
    size_at_max: 250.0  # –ë—ã–ª–æ $200
    min_position_usd: 30.0  # –ë—ã–ª–æ $50
    max_position_usd: 300.0  # –ë—ã–ª–æ $250
```

#### 11.3. –ü–†–û–ë–õ–ï–ú–ê: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —É–º–µ–Ω—å—à–∞—é—Ç —Ä–∞–∑–º–µ—Ä

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/risk_manager.py:1214-1395`

**–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:**
1. **Max margin percent (80%):** `max_margin_allowed = balance * 0.8 = $560`
2. **Available margin:** `available_margin = balance - used_margin`
3. **Dynamic margin cap:** `dynamic_margin_cap = base_cap * volatility_factor * drawdown_factor`
4. **Risk-based margin:** `risk_based_margin = risk_usd / sl_distance`
5. **Max loss per trade (2%):** `max_safe_margin = max_loss_usd / sl_percent`
6. **Max margin safety (90%):** `max_margin_safety = balance * 0.9 = $630`
7. **Min/max –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:** `min_margin_usd = $50/10 = $5`, `max_margin_usd = $250/10 = $25`

**–ü–†–û–ë–õ–ï–ú–ê:**
- **7 –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π** —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ö–∞–∂–¥–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–æ–∂–µ—Ç **—É–º–µ–Ω—å—à–∏—Ç—å** —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è **—Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–º**

**–ü–†–ò–ú–ï–†:**
- margin_required = $19.2
- max_margin_allowed = $560 ‚úÖ
- available_margin = $700 ‚úÖ
- dynamic_margin_cap = $50 (–∏–∑-–∑–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏) ‚ö†Ô∏è
- risk_based_margin = $10 (–∏–∑-–∑–∞ SL) ‚ö†Ô∏è
- max_safe_margin = $14 (–∏–∑-–∑–∞ max_loss) ‚ö†Ô∏è
- max_margin_safety = $630 ‚úÖ
- max_margin_usd = $25 ‚ö†Ô∏è
- **–ò—Ç–æ–≥: margin_usd = min($19.2, $50, $10, $14, $25) = $10**

#### 11.4. –ü–†–û–ë–õ–ï–ú–ê: Min position size —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/risk_manager.py:1609-1637`

```python
min_margin_usd = min_usd_size / leverage
# –î–ª—è small –ø—Ä–æ—Ñ–∏–ª—è: min_usd_size = $50
# –ü—Ä–∏ leverage = 10x: min_margin_usd = $5
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- Min position size = **$50** (notional)
- –ü—Ä–∏ leverage 10x: min margin = **$5**
- –ù–æ –ø–æ—Å–ª–µ –≤—Å–µ—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π margin –º–æ–∂–µ—Ç –±—ã—Ç—å **–º–µ–Ω—å—à–µ $5**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–∑–∏—Ü–∏—è **–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è** (return 0.0)

**–ê–ù–ê–õ–ò–ó:**
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è—Ö
- –†–µ–∞–ª—å–Ω—ã–π margin –º–æ–∂–µ—Ç –±—ã—Ç—å **$3-4**
- –ù–æ min_margin_usd = **$5**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–∑–∏—Ü–∏—è **–Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è**, –±–∞–ª–∞–Ω—Å **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**

#### 11.5. –ü–†–û–ë–õ–ï–ú–ê: –ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/risk_manager.py:695-734`

```python
# –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è: size = size_at_min + (size_at_max - size_at_min) * (balance - min_balance) / (max_balance - min_balance)
if max_balance > min_balance:
    balance_range = max_balance - min_balance  # 1500 - 500 = 1000
    size_range = size_at_max - size_at_min  # 200 - 100 = 100
    clamped_balance = max(min_balance, min(balance, max_balance))  # $700
    interpolated_size = size_at_min + (size_range * (clamped_balance - min_balance) / balance_range)
    # $100 + ($100 * ($700 - $500) / $1000) = $100 + $20 = $120
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: **$120**
- –ù–æ —ç—Ç–æ **—Ç–æ–ª—å–∫–æ 17%** –æ—Ç –±–∞–ª–∞–Ω—Å–∞
- –î–ª—è –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω—É–∂–Ω–æ **25-30%** –æ—Ç –±–∞–ª–∞–Ω—Å–∞
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –±–∞–ª–∞–Ω—Å **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ**

**–†–ê–°–ß–ï–¢:**
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: $700 √ó 0.25 = **$175** –Ω–∞ –ø–æ–∑–∏—Ü–∏—é
- –ù–æ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç: **$120** (–±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä)
- **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $55 (31%)**

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìà Position opened: SOL-USDT SHORT @ 136.94
   margin=19.20 USD (2.7% –æ—Ç –±–∞–ª–∞–Ω—Å–∞ $700)
```
- –ë–∞–ª–∞–Ω—Å: **$700**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: **$19.20 –º–∞—Ä–∂–∏** (2.7%)
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: **$175 –º–∞—Ä–∂–∏** (25%)
- **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $155.8 (89%)**

**–†–ï–®–ï–ù–ò–ï:**
```python
# –£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
size_at_min = 150.0  # –ë—ã–ª–æ $100
size_at_max = 250.0  # –ë—ã–ª–æ $200
# –ü—Ä–∏ $700: $150 + ($100 * ($700 - $500) / $1000) = $170
# –≠—Ç–æ 24% –æ—Ç –±–∞–ª–∞–Ω—Å–∞ –≤–º–µ—Å—Ç–æ 17%
```

---

### 12. –ü–ê–†–ê–ú–ï–¢–†–´ –ü–û –ö–ê–ñ–î–û–ô –ü–ê–†–ï –ò –†–ï–ñ–ò–ú–£

#### 12.1. –°–¢–†–£–ö–¢–£–†–ê –ü–ê–†–ê–ú–ï–¢–†–û–í

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `config/config_futures.yaml:486-1116`

**–°–¢–†–£–ö–¢–£–†–ê:**
```yaml
symbol_profiles:
  BTC-USDT:
    position_multiplier: 1.6
    tp_percent: 5.0
    sl_percent: 1.5
    trending:
      tp_percent: 6.0
      sl_percent: 1.5
      position_size_multiplier: 1.2
      tp_atr_multiplier: 1.0
      sl_atr_multiplier: 0.5
    ranging:
      tp_percent: 5.5
      sl_percent: 2.0
      position_size_multiplier: 1.05
      tp_atr_multiplier: 0.8
      sl_atr_multiplier: 0.45
    choppy:
      tp_percent: 4.0
      sl_percent: 1.5
      position_size_multiplier: 0.90
      tp_atr_multiplier: 0.6
      sl_atr_multiplier: 0.4
```

#### 12.2. –ü–ê–†–ê–ú–ï–¢–†–´ BTC-USDT

**TRENDING:**
- tp_percent: **6.0%**
- sl_percent: **1.5%**
- position_size_multiplier: **1.2x**
- tp_atr_multiplier: **1.0**
- sl_atr_multiplier: **0.5**
- min_score_threshold: **2.2**

**RANGING:**
- tp_percent: **5.5%**
- sl_percent: **2.0%**
- position_size_multiplier: **1.05x**
- tp_atr_multiplier: **0.8**
- sl_atr_multiplier: **0.45**
- min_score_threshold: **2.0**

**CHOPPY:**
- tp_percent: **4.0%**
- sl_percent: **1.5%**
- position_size_multiplier: **0.90x**
- tp_atr_multiplier: **0.6**
- sl_atr_multiplier: **0.4**
- min_score_threshold: **1.5**

#### 12.3. –ü–ê–†–ê–ú–ï–¢–†–´ ETH-USDT

**TRENDING:**
- tp_percent: **6.0%**
- sl_percent: **1.5%**
- position_size_multiplier: **1.15x**
- tp_atr_multiplier: **1.0**
- sl_atr_multiplier: **0.5**
- min_score_threshold: **1.5**

**RANGING:**
- tp_percent: **3.5%**
- sl_percent: **1.5%**
- position_size_multiplier: **1.05x**
- tp_atr_multiplier: **0.8**
- sl_atr_multiplier: **0.45**
- min_score_threshold: **2.0**

**CHOPPY:**
- tp_percent: **4.0%**
- sl_percent: **1.2%**
- position_size_multiplier: **0.85x**
- tp_atr_multiplier: **0.6**
- sl_atr_multiplier: **0.4**
- min_score_threshold: **2.0**

#### 12.4. –ü–ê–†–ê–ú–ï–¢–†–´ SOL-USDT

**TRENDING:**
- tp_percent: **6.0%**
- sl_percent: **1.5%**
- position_size_multiplier: **1.1x**
- tp_atr_multiplier: **0.55**
- sl_atr_multiplier: **0.35**
- min_score_threshold: **2.0**

**RANGING:**
- tp_percent: **3.5%**
- sl_percent: **2.0%**
- position_size_multiplier: **1.0x**
- tp_atr_multiplier: **0.45**
- sl_atr_multiplier: **0.30**
- min_score_threshold: **2.0**

**CHOPPY:**
- tp_percent: **4.0%**
- sl_percent: **1.5%**
- position_size_multiplier: **0.85x**
- tp_atr_multiplier: **0.28**
- sl_atr_multiplier: **0.24**
- min_score_threshold: **2.0**

#### 12.5. –ü–†–û–ë–õ–ï–ú–ê: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/config/config_manager.py:779-843`

```python
# –ü—Ä–∏–º–µ–Ω—è–µ–º position overrides (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω—ã, –æ–Ω–∏ –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è —Ç–æ—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)
regime_profile = self._get_symbol_regime_profile(symbol, symbol_regime)
position_overrides = self.config_manager.to_dict(regime_profile.get("position", {}))
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ `symbol_profiles[SYMBOL][REGIME].position` –º–æ–≥—É—Ç **–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å** –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä
- –ù–æ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ø–æ—Å–ª–µ** —Ä–∞—Å—á–µ—Ç–∞ –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑ balance_profile
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–≥—É—Ç **–∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å** —Å balance_profile

**–ü–†–ò–ú–ï–†:**
- –ë–∞–ª–∞–Ω—Å: $700 ‚Üí base_usd_size = $120 (–∏–∑ balance_profile)
- BTC-USDT ranging: position.base_position_usd = $38 (–∏–∑ symbol_profiles)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **$38** –≤–º–µ—Å—Ç–æ **$120**!

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìà Position opened: BTC-USDT LONG @ 89000.00
   margin=3.80 USD, leverage=10x
```
- –ë–∞–ª–∞–Ω—Å: **$700**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è margin: **$3.80** (0.54% –æ—Ç –±–∞–ª–∞–Ω—Å–∞!)
- –≠—Ç–æ **—Å–ª–∏—à–∫–æ–º –º–∞–ª–æ** –¥–ª—è –±–∞–ª–∞–Ω—Å–∞ $700
- **–ü—Ä–∏—á–∏–Ω–∞:** `position.base_position_usd = $38` –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä

**–†–ï–®–ï–ù–ò–ï:**
```python
# –ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å position override –µ—Å–ª–∏ –æ–Ω –º–µ–Ω—å—à–µ –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
if override_size < base_usd_size:
    logger.warning(
        f"‚ö†Ô∏è –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º position override –¥–ª—è {symbol}: "
        f"${override_size:.2f} < –±–∞–∑–æ–≤—ã–π ${base_usd_size:.2f}"
    )
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑ balance_profile
```

**–ê–ù–ê–õ–ò–ó:**
- –í –∫–æ–Ω—Ñ–∏–≥–µ –¥–ª—è BTC-USDT ranging: `base_position_usd: 38.0`
- –ù–æ —ç—Ç–æ **–º–µ–Ω—å—à–µ** —á–µ–º –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –∏–∑ balance_profile ($120)
- –ö–æ–¥ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç override –µ—Å–ª–∏ –æ–Ω –º–µ–Ω—å—à–µ –±–∞–∑–æ–≤–æ–≥–æ:
  ```python
  if override_size < base_usd_size:
      logger.debug("‚ö†Ô∏è –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º position override –¥–ª—è {symbol}: ${override_size:.2f} < –±–∞–∑–æ–≤—ã–π ${base_usd_size:.2f}")
  ```
- –ù–æ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ** –¥–ª—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –ø–∞—Ä

#### 12.6. –ü–†–û–ë–õ–ï–ú–ê: –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ê–ù–ê–õ–ò–ó –ü–ê–†–ê–ú–ï–¢–†–û–í:**

**BTC-USDT RANGING:**
- tp_percent: **5.5%** –æ—Ç –º–∞—Ä–∂–∏
- sl_percent: **2.0%** –æ—Ç –º–∞—Ä–∂–∏
- tp_atr_multiplier: **0.8**
- sl_atr_multiplier: **0.45**
- **–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ TP/SL: 5.5/2.0 = 2.75:1** ‚úÖ (—Ö–æ—Ä–æ—à–æ)

**ETH-USDT RANGING:**
- tp_percent: **3.5%** –æ—Ç –º–∞—Ä–∂–∏
- sl_percent: **1.5%** –æ—Ç –º–∞—Ä–∂–∏
- tp_atr_multiplier: **0.8**
- sl_atr_multiplier: **0.45**
- **–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ TP/SL: 3.5/1.5 = 2.33:1** ‚úÖ (—Ö–æ—Ä–æ—à–æ)

**SOL-USDT RANGING:**
- tp_percent: **3.5%** –æ—Ç –º–∞—Ä–∂–∏
- sl_percent: **2.0%** –æ—Ç –º–∞—Ä–∂–∏
- tp_atr_multiplier: **0.45**
- sl_atr_multiplier: **0.30**
- **–°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ TP/SL: 3.5/2.0 = 1.75:1** ‚ö†Ô∏è (—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ)

**–ü–†–û–ë–õ–ï–ú–ê:**
- –î–ª—è SOL-USDT —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ TP/SL = **1.75:1**
- –≠—Ç–æ **—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ** –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞
- –ü—Ä–∏ –∫–æ–º–∏—Å—Å–∏–∏ 0.1% –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–∏ 0.2% –Ω—É–∂–Ω–æ **–º–∏–Ω–∏–º—É–º 2:1**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è **–≤ –º–∏–Ω—É—Å** –∏–∑-–∑–∞ –∫–æ–º–∏—Å—Å–∏–π

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: SOL-USDT SHORT
   üìä Entry price: $136.940549
   üìä Exit price: $136.900000
   üíµ Gross PnL: +$0.0738 USDT (0.027% –æ—Ç –º–∞—Ä–∂–∏)
   üí∏ –ö–æ–º–∏—Å—Å–∏—è: -$0.1743 USDT (0.64% –æ—Ç –º–∞—Ä–∂–∏)
   üíµ Net PnL: -$0.1005 USDT ‚Üê ‚ùå –£–ë–´–¢–û–ö!
```
- Gross PnL: **+0.027%** (–º–∞–ª–µ–Ω—å–∫–∞—è –ø—Ä–∏–±—ã–ª—å)
- –ö–æ–º–∏—Å—Å–∏—è: **-0.64%** (–±–æ–ª—å—à–µ —á–µ–º –ø—Ä–∏–±—ã–ª—å!)
- Net PnL: **-0.61%** (—É–±—ã—Ç–æ–∫!)
- **–ü—Ä–∏—á–∏–Ω–∞:** –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ TP/SL **1.75:1** –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∏ –∫–æ–º–∏—Å—Å–∏—è—Ö

**–†–ï–®–ï–ù–ò–ï:**
```yaml
# –í config_futures.yaml:
SOL-USDT:
  ranging:
    tp_atr_multiplier: 0.75  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.45 –¥–æ 0.75
    sl_atr_multiplier: 0.30  # –û—Å—Ç–∞–≤–ª—è–µ–º 0.30
    # –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 0.75/0.30 = 2.5:1 (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!)
```

#### 12.7. –ü–†–û–ë–õ–ï–ú–ê: ATR multipliers –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç TP/SL

**–ê–ù–ê–õ–ò–ó:**
- tp_atr_multiplier –¥–ª—è ranging: **0.8** (BTC), **0.8** (ETH), **0.45** (SOL)
- sl_atr_multiplier –¥–ª—è ranging: **0.45** (BTC), **0.45** (ETH), **0.30** (SOL)
- –ù–æ tp_percent –∏ sl_percent —É–∫–∞–∑–∞–Ω—ã –≤ **–ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç –º–∞—Ä–∂–∏**
- ATR multipliers –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è **—Ä–∞—Å—á–µ—Ç–∞ TP/SL –æ—Ç ATR**

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ï—Å—Ç—å **–¥–≤–∞ —Å–ø–æ—Å–æ–±–∞** —Ä–∞—Å—á–µ—Ç–∞ TP/SL:
  1. –û—Ç –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ (tp_percent, sl_percent)
  2. –û—Ç ATR (tp_atr_multiplier, sl_atr_multiplier)
- –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–æ–π **–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏
- –†–µ–∑—É–ª—å—Ç–∞—Ç: TP/SL –º–æ–≥—É—Ç –±—ã—Ç—å **–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏**

**–ü–†–ò–ú–ï–† –ò–ó –ö–û–î–ê:**
```python
# –í exit_analyzer.py:741-980
# –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ATR-based TP/SL
atr_1m = self.atr_provider.get_atr(symbol, fallback=5.0)
atr_tp_percent = (atr_1m / current_price) * 100 * tp_atr_multiplier
tp_percent = max(tp_min_percent, min(tp_max_percent, atr_tp_percent))
```
- –ö–æ–¥ **–∏—Å–ø–æ–ª—å–∑—É–µ—Ç ATR-based** —Ä–∞—Å—á–µ—Ç TP/SL
- –ù–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ —É–∫–∞–∑–∞–Ω—ã **tp_percent/sl_percent** (–æ—Ç –º–∞—Ä–∂–∏)
- **–ö–æ–Ω—Ñ–ª–∏–∫—Ç:** –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–†–ï–®–ï–ù–ò–ï:**
```python
# –£—Ç–æ—á–Ω–∏—Ç—å –≤ –∫–æ–¥–µ, –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
# –í exit_analyzer.py:741-980
# –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ TP/SL
if atr_1m and atr_1m > 0:
    tp_percent = atr_tp_percent  # ATR-based
    logger.info(f"‚úÖ [TP_SL] {symbol}: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ATR-based TP={tp_percent:.2f}%")
else:
    tp_percent = tp_percent_from_config  # Percent-based
    logger.info(f"‚úÖ [TP_SL] {symbol}: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è percent-based TP={tp_percent:.2f}%")
```

#### 12.8. –ü–†–ò–ù–Ø–¢–ò–ï –†–ï–®–ï–ù–ò–ô –° –¢–û–ß–ö–ò –ó–†–ï–ù–ò–Ø –¢–†–ï–ô–î–ï–†–ê

**–ú–ï–°–¢–û –í –ö–û–î–ï:** `src/strategies/scalping/futures/order_executor.py:283-1069`

**–†–ê–°–ß–ï–¢ LIMIT PRICE:**

**–î–ª—è LONG –ø–æ–∑–∏—Ü–∏–π:**
```python
# –ü–æ–∫—É–ø–∞–µ–º –Ω–∏–∂–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
limit_price = current_price * (1 - offset_percent)
# offset_percent –¥–ª—è ranging: 0.05% (0.0005)
# –ü—Ä–∏–º–µ—Ä: current_price = $100.00 ‚Üí limit_price = $99.95
```

**–î–ª—è SHORT –ø–æ–∑–∏—Ü–∏–π:**
```python
# –ü—Ä–æ–¥–∞–µ–º –≤—ã—à–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
limit_price = current_price * (1 + offset_percent)
# offset_percent –¥–ª—è ranging: 0.05% (0.0005)
# –ü—Ä–∏–º–µ—Ä: current_price = $100.00 ‚Üí limit_price = $100.05
```

**–ê–î–ê–ü–¢–ò–í–ù–´–ô OFFSET:**
- **–ü–æ —Ä–µ–∂–∏–º—É:** trending=0.05%, ranging=0.05%, choppy=0.05%
- **–ü–æ —Å–∏–º–≤–æ–ª—É:** BTC=0.03%, ETH=0.04%, SOL=0.05%, DOGE=0.06%, XRP=0.05%
- **–ü–æ —Ä–µ–∂–∏–º—É + —Å–∏–º–≤–æ–ª—É:** BTC ranging=0.08%, ETH ranging=0.10%

**–ü–†–û–ë–õ–ï–ú–ê:**
- Offset **—Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π** (0.05%)
- –ü—Ä–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ 0.2-0.5% limit –æ—Ä–¥–µ—Ä –º–æ–∂–µ—Ç **–Ω–µ –∏—Å–ø–æ–ª–Ω–∏—Ç—å—Å—è**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: fallback –Ω–∞ **market –æ—Ä–¥–µ—Ä** (–∫–æ–º–∏—Å—Å–∏—è 0.05%)

**–ê–ù–ê–õ–ò–ó:**
- –í –∫–æ–Ω—Ñ–∏–≥–µ: `limit_offset_percent: 0.05` (0.05%)
- –ù–æ –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –Ω—É–∂–Ω–æ **0.1-0.2%**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: limit –æ—Ä–¥–µ—Ä–∞ **–Ω–µ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è**, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è market

**–†–ê–°–ß–ï–¢ TP/SL:**

**–ú–µ—Å—Ç–æ –≤ –∫–æ–¥–µ:** `src/strategies/scalping/futures/order_executor.py:1919-2100`

```python
# –ü–æ–ª—É—á–∞–µ–º ATR –¥–ª—è —Ç–µ–∫—É—â–µ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
atr = await get_atr(symbol)

# –ü–æ–ª—É—á–∞–µ–º tp_atr_multiplier –∏ sl_atr_multiplier –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
tp_atr_mult = regime_params.get("tp_atr_multiplier", 2.0)
sl_atr_mult = regime_params.get("sl_atr_multiplier", 1.5)

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º TP/SL
if side == "LONG":
    tp_price = entry_price + (atr * tp_atr_mult)
    sl_price = entry_price - (atr * sl_atr_mult)
else:  # SHORT
    tp_price = entry_price - (atr * tp_atr_mult)
    sl_price = entry_price + (atr * sl_atr_mult)
```

**–ü–†–û–ë–õ–ï–ú–ê:**
- TP/SL —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –æ—Ç **ATR**
- –ù–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ —É–∫–∞–∑–∞–Ω—ã **tp_percent** –∏ **sl_percent** (–æ—Ç –º–∞—Ä–∂–∏)
- –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, –∫–∞–∫–æ–π **–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏

**–ê–ù–ê–õ–ò–ó:**
- –í –∫–æ–Ω—Ñ–∏–≥–µ –¥–ª—è BTC-USDT ranging:
  - tp_percent: **5.5%** (–æ—Ç –º–∞—Ä–∂–∏)
  - sl_percent: **2.0%** (–æ—Ç –º–∞—Ä–∂–∏)
  - tp_atr_multiplier: **0.8**
  - sl_atr_multiplier: **0.45**
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ATR: TP = entry + ATR√ó0.8, SL = entry - ATR√ó0.45
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Ü–µ–Ω—Ç: TP = entry√ó1.055, SL = entry√ó0.98
- **–†–∞–∑–Ω–∏—Ü–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–π!**

---

### 13. –î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´ –° –ë–ê–õ–ê–ù–°–û–ú $700

#### 13.1. –†–ê–°–ß–ï–¢ –ë–ê–ó–û–í–û–ì–û –†–ê–ó–ú–ï–†–ê

**–ë–∞–ª–∞–Ω—Å:** $700  
**–ü—Ä–æ—Ñ–∏–ª—å:** small ($500-$1500)  
**–ü—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è:**

```python
size_at_min = $100.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $500
size_at_max = $200.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1500
min_balance = $500.0
max_balance = $1500.0

# –ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700:
balance_range = $1500 - $500 = $1000
size_range = $200 - $100 = $100
clamped_balance = $700
interpolated_size = $100 + ($100 * ($700 - $500) / $1000) = $100 + $20 = $120
```

**–†–ï–ó–£–õ–¨–¢–ê–¢:** base_usd_size = **$120** (notional)

#### 13.2. –ü–†–ò–ú–ï–ù–ï–ù–ò–ï MULTIPLIER

**BTC-USDT RANGING:**
- position_multiplier: **1.6x**
- base_usd_size = $120 √ó 1.6 = **$192**

**–†–µ–∂–∏–º–Ω—ã–π multiplier:**
- position_size_multiplier (ranging): **1.0x**
- base_usd_size = $192 √ó 1.0 = **$192**

**Strength multiplier (medium signal):**
- strength_multiplier: **1.0x**
- base_usd_size = $192 √ó 1.0 = **$192**

**Volatility multiplier (ATR=0.02%):**
- volatility_multiplier: **1.0x** (–±–∞–∑–æ–≤–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)
- base_usd_size = $192 √ó 1.0 = **$192**

#### 13.3. –ü–†–ò–ú–ï–ù–ï–ù–ò–ï LEVERAGE

**Leverage:** 10x (–∏–∑ adaptive_leverage)  
**Margin required:** $192 / 10 = **$19.2**

#### 13.4. –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø

**1. Max margin percent (80%):**
- max_margin_allowed = $700 √ó 0.8 = **$560** ‚úÖ
- margin_required = $19.2 < $560 ‚úÖ

**2. Available margin:**
- used_margin = $0 (–Ω–µ—Ç –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π)
- available_margin = $700 - $0 = **$700** ‚úÖ
- margin_required = $19.2 < $700 ‚úÖ

**3. Dynamic margin cap:**
- base_cap = $700 √ó 0.22 = **$154**
- volatility_factor = 1.0 (—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å)
- drawdown_factor = 1.0 (–Ω–µ—Ç –ø—Ä–æ—Å–∞–¥–∫–∏)
- regime_multiplier = 1.0 (ranging)
- dynamic_margin_cap = $154 √ó 1.0 √ó 1.0 √ó 1.0 = **$154** ‚úÖ
- margin_required = $19.2 < $154 ‚úÖ

**4. Risk-based margin:**
- risk_per_trade = 2.0% –æ—Ç –±–∞–ª–∞–Ω—Å–∞ = **$14**
- sl_percent = 2.0% (–æ—Ç –º–∞—Ä–∂–∏) = 0.02
- risk_based_margin = $14 / 0.02 = **$700** ‚úÖ
- margin_required = $19.2 < $700 ‚úÖ

**5. Max loss per trade (2%):**
- max_loss_usd = $700 √ó 0.02 = **$14**
- max_safe_margin = $14 / 0.02 = **$700** ‚úÖ
- margin_required = $19.2 < $700 ‚úÖ

**6. Max margin safety (90%):**
- max_margin_safety = $700 √ó 0.9 = **$630** ‚úÖ
- margin_required = $19.2 < $630 ‚úÖ

**7. Min/max –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:**
- min_margin_usd = $50 / 10 = **$5**
- max_margin_usd = $250 / 10 = **$25**
- margin_required = $19.2 (–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö $5-$25) ‚úÖ

**–ò–¢–û–ì–û:** margin_usd = **$19.2**

#### 13.5. –ü–†–û–ë–õ–ï–ú–ê: –ù–ï–î–û–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –ë–ê–õ–ê–ù–°–ê

**–ê–ù–ê–õ–ò–ó:**
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ **$19.2 –º–∞—Ä–∂–∏** (2.7% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: $700 √ó 0.25 = **$175 –º–∞—Ä–∂–∏** (25% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
- **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $155.8 (89%)**

**–ü–†–ò–ß–ò–ù–´:**
1. –ë–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π ($120 –≤–º–µ—Å—Ç–æ $175)
2. Leverage –æ–≥—Ä–∞–Ω–∏—á–µ–Ω (10x –≤–º–µ—Å—Ç–æ 20-30x –¥–ª—è —Å–∏–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤)
3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —É–º–µ–Ω—å—à–∞—é—Ç —Ä–∞–∑–º–µ—Ä
4. Min position size —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π ($5 –º–∞—Ä–∂–∏)

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```
üìà Position opened: SOL-USDT SHORT @ 136.94
   margin=19.20 USD (2.7% –æ—Ç –±–∞–ª–∞–Ω—Å–∞ $700)
```
- –ë–∞–ª–∞–Ω—Å: **$700**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è: **$19.20 –º–∞—Ä–∂–∏** (2.7%)
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å: **$175 –º–∞—Ä–∂–∏** (25%)
- **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: $155.8 (89%)**

**–†–ï–®–ï–ù–ò–ï:**
```python
# 1. –£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä
size_at_min = 150.0  # –ë—ã–ª–æ $100
size_at_max = 250.0  # –ë—ã–ª–æ $200

# 2. –£–º–µ–Ω—å—à–∏—Ç—å min_position_usd
min_position_usd = 30.0  # –ë—ã–ª–æ $50

# 3. –£–≤–µ–ª–∏—á–∏—Ç—å leverage –¥–ª—è —Å–∏–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
if signal_strength > 0.8 and regime == "ranging":
    leverage = min(leverage, 20)  # –ë—ã–ª–æ 10x
```

**–†–ï–®–ï–ù–ò–ï:**
- –£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
- –£–≤–µ–ª–∏—á–∏—Ç—å leverage –¥–ª—è —Å–∏–ª—å–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- –£–º–µ–Ω—å—à–∏—Ç—å min position size
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

---

### 14. –°–ü–ò–°–û–ö –ü–†–û–í–ï–†–ï–ù–ù–´–• –ò –ù–ï–ü–†–û–í–ï–†–ï–ù–ù–´–• –§–ê–ô–õ–û–í

#### 14.1. –ü–†–û–í–ï–†–ï–ù–ù–´–ï –§–ê–ô–õ–´

**–û–°–ù–û–í–ù–´–ï –ú–û–î–£–õ–ò:**
1. ‚úÖ `src/strategies/scalping/futures/order_executor.py` - –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
2. ‚úÖ `src/strategies/scalping/futures/indicators/trailing_stop_loss.py` - trailing stop
3. ‚úÖ `src/strategies/scalping/futures/coordinators/exit_decision_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è
4. ‚úÖ `src/strategies/scalping/futures/coordinators/trailing_sl_coordinator.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL
5. ‚úÖ `src/strategies/scalping/futures/risk_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏
6. ‚úÖ `src/strategies/scalping/futures/risk/adaptive_leverage.py` - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ª–µ–≤–µ—Ä–∏–¥–∂
7. ‚úÖ `src/strategies/scalping/futures/config/config_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
8. ‚úÖ `src/strategies/scalping/futures/calculations/position_sizer.py` - —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
9. ‚úÖ `src/strategies/scalping/futures/calculations/pnl_calculator.py` - —Ä–∞—Å—á–µ—Ç PnL
10. ‚úÖ `src/strategies/scalping/futures/coordinators/signal_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
11. ‚úÖ `src/strategies/scalping/futures/signal_generator.py` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
12. ‚úÖ `config/config_futures.yaml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–õ–û–ì–ò:**
1. ‚úÖ `logs/futures/archived/logs_2026-01-04_10-42-12/position_closures_2026-01-04.jsonl`
2. ‚úÖ `logs/futures/archived/futures_main_2026-01-03/*.log` (–≤—ã–±–æ—Ä–æ—á–Ω–æ)

#### 14.2. –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• –ú–û–î–£–õ–ï–ô –ò –ò–• –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ô

**–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ó–ê–ú–ï–ß–ê–ù–ò–ï:** –í—Å–µ –º–æ–¥—É–ª–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ –µ–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –ø–æ—ç—Ç–æ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –í–°–ï –º–æ–¥—É–ª–∏ –∏ –∏—Ö –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è.

---

##### 14.2.1. EXITANALYZER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py` (5044 —Å—Ç—Ä–æ–∫–∏)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–π –¥–ª—è –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
- –ê–Ω–∞–ª–∏–∑ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ (trending, ranging, choppy)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ –±–æ—Ç–∞: ADX, Order Flow, MTF, –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã

**–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•:**
1. **PositionRegistry:**
   - `get_position(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–∏
   - `get_metadata(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö (entry_time, entry_price, regime, leverage)
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ä–µ–∂–∏–º (—Ä–µ–∂–∏–º –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è)

2. **DataRegistry:**
   - `get_market_data(symbol)` - —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
   - `get_price(symbol)` - —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ (fallback)
   - `get_regime(symbol)` - —Ç–µ–∫—É—â–∏–π —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞
   - **–ü—Ä–æ–±–ª–µ–º–∞:** Fallback –Ω–∞ metadata.regime –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ DataRegistry

3. **Client (OKXFuturesClient):**
   - `get_price_limits(symbol)` - –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
   - **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞ –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞, –∞ –Ω–µ –∏–∑ DataRegistry

4. **Orchestrator (—á–µ—Ä–µ–∑ —Å—Å—ã–ª–∫–∏):**
   - `fast_adx` - –∞–Ω–∞–ª–∏–∑ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞
   - `order_flow` - –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ —á–µ—Ä–µ–∑ delta
   - `mtf_filter` - –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –Ω–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ
   - `funding_monitor` - –∞–Ω–∞–ª–∏–∑ funding rate
   - `signal_generator` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞

**–õ–û–ì–ò–ö–ê –ü–û–õ–£–ß–ï–ù–ò–Ø –†–ï–ñ–ò–ú–ê:**
```python
# –ü–†–ò–û–†–ò–¢–ï–¢ 1: signal_generator.regime_managers[symbol] (–∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Ä–µ–∂–∏–º)
# –ü–†–ò–û–†–ò–¢–ï–¢ 2: data_registry.get_regime(symbol)
# –ü–†–ò–û–†–ò–¢–ï–¢ 3: metadata.regime (—É—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ä–µ–∂–∏–º –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è)
# FALLBACK: "ranging"
```
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback "ranging", —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏—è–º.

**–†–ê–°–ß–ï–¢ PnL:**
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:** PnL% –æ—Ç –º–∞—Ä–∂–∏ (–∫–∞–∫ –Ω–∞ –±–∏—Ä–∂–µ) - `unrealizedPnl / margin * 100`
- **Fallback:** PnL% –æ—Ç —Ü–µ–Ω—ã - `(current_price - entry_price) / entry_price * 100`
- **–ö–æ–º–∏—Å—Å–∏—è:** –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ 10 —Å–µ–∫—É–Ω–¥ —Å –º–æ–º–µ–Ω—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è
- **–ö–æ–º–∏—Å—Å–∏—è:** `(maker_fee_rate * 2) * leverage * 100` (0.02% √ó 2 √ó leverage = 0.2% –ø—Ä–∏ leverage=5)

**–ü–û–õ–£–ß–ï–ù–ò–ï –ü–ê–†–ê–ú–ï–¢–†–û–í TP/SL:**
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:** `ParameterProvider.get_exit_params(symbol, regime)`
- **Fallback 1:** `symbol_profiles[symbol][regime].tp_percent/sl_percent`
- **Fallback 2:** `adaptive_regime[regime].tp_percent/sl_percent`
- **Fallback 3:** `scalping_config.tp_percent/sl_percent` (–≥–ª–æ–±–∞–ª—å–Ω—ã–π)
- **ATR-based:** –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ATR –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ TP/SL –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏

**–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø:**
1. **TrailingSLCoordinator:** –í—ã–∑—ã–≤–∞–µ—Ç `ExitAnalyzer.analyze_position()` –∫–∞–∫ fallback
2. **ExitDecisionCoordinator:** –í—ã–∑—ã–≤–∞–µ—Ç `ExitAnalyzer.analyze_position()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ—à–µ–Ω–∏—è
3. **PositionManager:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `ExitAnalyzer` —á–µ—Ä–µ–∑ `exit_decision_coordinator`

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚ùå **Fallback –Ω–∞ "ranging" —Ä–µ–∂–∏–º** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ranging, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. ‚ùå **–£—Å—Ç–∞—Ä–µ–≤—à–∏–π —Ä–µ–∂–∏–º –≤ metadata** - —Ä–µ–∂–∏–º –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–∂–µ—Ç –Ω–µ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å —Ç–µ–∫—É—â–∏–º
3. ‚ö†Ô∏è **–ö–æ–º–∏—Å—Å–∏—è –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–µ 10 —Å–µ–∫—É–Ω–¥** - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä–∞—Å—á–µ—Ç—É PnL
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞–∫–∞–Ω, –∞ –Ω–µ DataRegistry

---

##### 14.2.2. SMARTEXITCOORDINATOR - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/smart_exit_coordinator.py` (213 —Å—Ç—Ä–æ–∫)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- "–£–º–Ω–æ–µ" –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π —á–µ—Ä–µ–∑ –∞–Ω–∞–ª–∏–∑ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (RSI, MACD, Bollinger, ADX)
- –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ WebSocket (–∫–∞–∂–¥–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã)

**–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•:**
1. **PositionRegistry:**
   - `get_position(symbol)` - –¥–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é, –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∏–∑ WebSocket)
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏, –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –∏–∑ WebSocket

2. **DataRegistry:**
   - `get_market_data(symbol)` - —Ä—ã–Ω–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏ (–æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –Ω–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏)

**–õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´:**
```python
async def check_position(symbol, position):
    # 1. –ü–æ–ª—É—á–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∏–∑ DataRegistry
    market_data = await self.data_registry.get_market_data(symbol)
    indicators = market_data.indicators
    
    # 2. –ü—Ä–∏–º–µ–Ω—è–µ–º "—É–º–Ω—ã–π" —Ñ–∏–ª—å—Ç—Ä
    should_close = await self._apply_smart_filter(symbol, side, indicators)
    
    # 3. –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å - –∑–∞–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ callback
    if should_close:
        await self.close_position_callback(symbol, reason)
```

**–£–ú–ù–´–ô –§–ò–õ–¨–¢–†:**
1. **RSI:**
   - LONG: –ó–∞–∫—Ä—ã–≤–∞–µ–º –µ—Å–ª–∏ RSI > 70 (–ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å)
   - SHORT: –ó–∞–∫—Ä—ã–≤–∞–µ–º –µ—Å–ª–∏ RSI < 30 (–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å)
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –µ—Å–ª–∏ RSI –Ω–µ –≤ —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ–π –∑–æ–Ω–µ (–º–æ–∂–µ—Ç —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏)

2. **MACD:**
   - LONG: –ó–∞–∫—Ä—ã–≤–∞–µ–º –µ—Å–ª–∏ MACD < Signal (–º–µ–¥–≤–µ–∂–∏–π —Å–∏–≥–Ω–∞–ª)
   - SHORT: –ó–∞–∫—Ä—ã–≤–∞–µ–º –µ—Å–ª–∏ MACD > Signal (–±—ã—á–∏–π —Å–∏–≥–Ω–∞–ª)
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –µ—Å–ª–∏ MACD –Ω–µ —Ä–∞–∑–≤–µ—Ä–Ω—É–ª—Å—è (–º–æ–∂–µ—Ç —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏)

3. **Bollinger Bands:**
   - –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (TODO –≤ –∫–æ–¥–µ)

**–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø:**
1. **WebSocketCoordinator:** –í—ã–∑—ã–≤–∞–µ—Ç `check_position()` –ü–ï–†–í–´–ú –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ü–µ–Ω—ã
2. **ExitDecisionCoordinator:** –ü—ã—Ç–∞–µ—Ç—Å—è –≤—ã–∑–≤–∞—Ç—å `should_close()` (–º–µ—Ç–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!)
   - **–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:** `ExitDecisionCoordinator._check_smart_exit()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –º–µ—Ç–æ–¥ `should_close()`, –Ω–æ –≤ `SmartExitCoordinator` –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ `check_position()`
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** SmartExitCoordinator –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ExitDecisionCoordinator

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚ùå **–ú–µ—Ç–æ–¥ `should_close()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç** - ExitDecisionCoordinator –Ω–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å SmartExitCoordinator
2. ‚ùå **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π** - –µ—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç, –ø–æ–∑–∏—Ü–∏—è –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
3. ‚ö†Ô∏è **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã** - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –Ω–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WebSocket** - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ü–µ–Ω—ã

---

##### 14.2.3. PRIORITYRESOLVER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/priority_resolver.py` (231 —Å—Ç—Ä–æ–∫–∞)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –º–µ–∂–¥—É —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
- –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –¥–ª—è –≤—Å–µ—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ú–ê–¢–†–ò–¶–ê –ü–†–ò–û–†–ò–¢–ï–¢–û–í (EXIT):**
```python
EXIT_PRIORITIES = {
    "emergency_loss_protection": 1,  # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–±—ã—Ç–æ–∫
    "sl_reached": 2,                  # Stop Loss
    "tp_reached": 3,                  # Take Profit
    "trailing_stop": 4,               # Trailing Stop Loss
    "max_holding_time": 5,            # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
    "smart_exit_reversal": 6,         # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ —Ä–∞–∑–≤–æ—Ä–æ—Ç—É
    "smart_exit_pattern": 7,          # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É
    "partial_tp": 8,                  # –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
    "extend_tp": 9,                   # –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP
}
```

**–õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´:**
```python
def resolve_exit_priority(decisions):
    # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É (–º–µ–Ω—å—à–µ–µ —á–∏—Å–ª–æ = –≤—ã—à–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
    sorted_decisions = sorted(decisions, key=lambda d: self._get_exit_priority(d.get("reason")))
    return sorted_decisions[0]  # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ —Å –Ω–∞–∏–≤—ã—Å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º
```

**–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø:**
1. **ExitDecisionCoordinator:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `PriorityResolver.resolve_exit_priority()` –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
2. **TrailingSLCoordinator:** –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞–ø—Ä—è–º—É—é (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ ExitDecisionCoordinator)

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤** - emergency_loss_protection –∏–º–µ–µ—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
2. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - —Ä–µ—à–µ–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
3. ‚ö†Ô∏è **–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã** - –µ—Å–ª–∏ reason –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –º–∞—Ç—Ä–∏—Ü–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 99 (–Ω–∏–∑–∫–∏–π)

---

##### 14.2.4. FILTERMANAGER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/signals/filter_manager.py` (1061 —Å—Ç—Ä–æ–∫–∞)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –≤—Å–µ—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ñ–∏–ª—å—Ç—Ä–æ–≤ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (TTL 20s –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö, 60s –¥–ª—è –º–µ–¥–ª–µ–Ω–Ω—ã—Ö)

**–ü–û–†–Ø–î–û–ö –ü–†–ò–ú–ï–ù–ï–ù–ò–Ø –§–ò–õ–¨–¢–†–û–í:**
1. **Pre-filters:** ADX, Volatility
2. **Trend filters:** MTF, Correlation
3. **Entry filters:** Pivot Points, Volume Profile, Liquidity
4. **Market filters:** Order Flow, Funding Rate

**–ö–≠–®–ò–†–û–í–ê–ù–ò–ï:**
- **–ë—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (TTL 20s):** ADX, MTF, Pivot Points
- **–ú–µ–¥–ª–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (TTL 60s):** Volume Profile, Liquidity, Order Flow
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ö—ç—à –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ, –µ—Å–ª–∏ —Ä—ã–Ω–æ–∫ –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è–µ—Ç—Å—è

**–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø –° –§–ò–õ–¨–¢–†–ê–ú–ò:**

1. **LiquidityFilter:**
   - –ú–µ—Ç–æ–¥: `_apply_liquidity_filter()` ‚Üí `LiquidityFilter.evaluate()`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `symbol, signal, market_data, liquidity_params, liquidity_relax`
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `_apply_liquidity_filter()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True` (TODO –≤ –∫–æ–¥–µ - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω!)

2. **OrderFlowFilter:**
   - –ú–µ—Ç–æ–¥: `_apply_order_flow_filter()` ‚Üí `OrderFlowFilter.is_signal_valid()`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `symbol, signal, market_data, order_flow_params, order_flow_relax`
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `_apply_order_flow_filter()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True` (TODO –≤ –∫–æ–¥–µ - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω!)

3. **FundingRateFilter:**
   - –ú–µ—Ç–æ–¥: `_apply_funding_rate_filter()` ‚Üí `FundingRateFilter.is_signal_valid()`
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `symbol, signal, funding_params`
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ç–æ–¥ `_apply_funding_rate_filter()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True` (TODO –≤ –∫–æ–¥–µ - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω!)

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚ùå **–§–∏–ª—å—Ç—Ä—ã –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é** - –º–µ—Ç–æ–¥—ã `_apply_liquidity_filter()`, `_apply_order_flow_filter()`, `_apply_funding_rate_filter()` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `True` (TODO –≤ –∫–æ–¥–µ)
2. ‚ö†Ô∏è **–ö—ç—à –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º** - TTL 20-60 —Å–µ–∫—É–Ω–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–º –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ä—ã–Ω–∫–æ–≤
3. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è** - —Ñ–∏–ª—å—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ –ª–æ–≥–∏—á–µ—Å–∫–æ–º –ø–æ—Ä—è–¥–∫–µ
4. ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - —Å–Ω–∏–∂–∞–µ—Ç –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞ 50-60%

---

##### 14.2.5. LIQUIDITYFILTER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/filters/liquidity_filter.py` (456 —Å—Ç—Ä–æ–∫)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –ø–æ –¥–∞–Ω–Ω—ã–º —Å—Ç–∞–∫–∞–Ω–∞ –∏ 24—á –æ–±—ä—ë–º–∞
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞ –∏ —Å–∏–º–≤–æ–ª–∞

**–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•:**
1. **OKX API:**
   - `/api/v5/market/ticker` - 24—á –æ–±—ä—ë–º –∏ –ø–æ—Å–ª–µ–¥–Ω—è—è —Ü–µ–Ω–∞
   - `/api/v5/market/books` - —Å—Ç–∞–∫–∞–Ω –æ—Ä–¥–µ—Ä–æ–≤ (–≥–ª—É–±–∏–Ω–∞ –ø–æ –∫–æ–Ω—Ñ–∏–≥—É)
   - **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** TTL = `refresh_interval_seconds` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–ü–†–û–í–ï–†–ö–ò:**
1. **24—á –æ–±—ä—ë–º:** `daily_volume_usd >= min_daily_volume_usd`
2. **Bid volume (–¥–ª—è LONG):** `best_bid_volume_usd >= min_best_bid_volume_usd`
3. **Ask volume (–¥–ª—è SHORT):** `best_ask_volume_usd >= min_best_ask_volume_usd`
4. **–ì–ª—É–±–∏–Ω–∞ —Å—Ç–∞–∫–∞–Ω–∞:** `depth_bid_usd >= min_orderbook_depth_usd` –ò `depth_ask_usd >= min_orderbook_depth_usd`
5. **–°–ø—Ä–µ–¥:** `spread_percent <= max_spread_percent`

**–ü–†–ò–û–†–ò–¢–ï–¢–´ –ü–û–†–û–ì–û–í:**
1. **Base** (lowest): `self.config.min_daily_volume_usd` –∏ —Ç.–¥.
2. **Symbol overrides:** `symbol_overrides[symbol]`
3. **Regime multipliers:** `regime_multipliers[regime]`
4. **Thresholds override** (highest): `thresholds_override` –≤ `evaluate()`

**FALLBACK –î–õ–Ø XRP-USDT:**
- –ï—Å–ª–∏ `best_bid_volume_usd == 0` –∏–ª–∏ `best_ask_volume_usd == 0`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `0.1%` –æ—Ç 24h volume –∫–∞–∫ fallback
- **–ü—Ä–æ–±–ª–µ–º–∞:** Fallback –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –¥–ª—è –∫—Ä—É–ø–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—ä–µ–º–æ–≤ –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—é** - –¥–ª—è LONG –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è bid, –¥–ª—è SHORT - ask
2. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–æ—Ä–æ–≥–æ–≤** - thresholds_override –∏–º–µ–µ—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
3. ‚ö†Ô∏è **Fallback –¥–ª—è XRP –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º** - 0.1% –æ—Ç 24h volume –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∞–ª–æ
4. ‚úÖ **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - —Å–Ω–∏–∂–∞–µ—Ç –Ω–∞–≥—Ä—É–∑–∫—É –Ω–∞ API

---

##### 14.2.6. ORDERFLOWFILTER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/filters/order_flow_filter.py` (300 —Å—Ç—Ä–æ–∫)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞ bid/ask –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–¥–µ–ª–∫–∏
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞

**–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•:**
1. **OKX API:**
   - `/api/v5/market/books` - —Å—Ç–∞–∫–∞–Ω –æ—Ä–¥–µ—Ä–æ–≤ (–≥–ª—É–±–∏–Ω–∞ = `window` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
   - **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** TTL = `refresh_interval_seconds` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–†–ê–°–ß–ï–¢ DELTA:**
```python
delta = (depth_bid_usd - depth_ask_usd) / (depth_bid_usd + depth_ask_usd)
```
- **Delta > 0:** –ë–æ–ª—å—à–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π (–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ –¥–ª—è LONG)
- **Delta < 0:** –ë–æ–ª—å—à–µ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤ (–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ –¥–ª—è SHORT)

**–ü–†–û–í–ï–†–ö–ò:**
1. **–ì–ª—É–±–∏–Ω–∞ —Å—Ç–∞–∫–∞–Ω–∞:** `total_depth >= min_total_depth_usd`
2. **LONG —Å–∏–≥–Ω–∞–ª:** `delta >= long_threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.1)
3. **SHORT —Å–∏–≥–Ω–∞–ª:** `delta <= short_threshold` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é -0.1)

**–ü–†–ò–û–†–ò–¢–ï–¢–´ –ü–ê–†–ê–ú–ï–¢–†–û–í:**
1. **Base** (lowest): `self.config.long_threshold`, `self.config.short_threshold`
2. **Regime profiles:** `regime_profiles[regime]`
3. **Overrides** (highest): `overrides` –≤ `is_signal_valid()`

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç delta** - —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ bid/ask
2. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤** - overrides –∏–º–µ–µ—Ç –Ω–∞–∏–≤—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
3. ‚ö†Ô∏è **–ö—ç—à –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º** - —Å—Ç–∞–∫–∞–Ω –º–µ–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ, –Ω–æ –∫—ç—à –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ
4. ‚úÖ **–ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Ä–µ–∂–∏–º—É** - –ø–æ—Ä–æ–≥–∏ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞

---

##### 14.2.7. FUNDINGRATEFILTER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/filters/funding_rate_filter.py` (191 —Å—Ç—Ä–æ–∫–∞)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –∏ –±—É–¥—É—â–µ–≥–æ funding rate –ø–µ—Ä–µ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º —Å–¥–µ–ª–∫–∏
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Ö–æ–¥–æ–≤ –ø—Ä–∏ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–º funding

**–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•:**
1. **OKX API:**
   - `/api/v5/public/funding-rate` - —Ç–µ–∫—É—â–∏–π –∏ —Å–ª–µ–¥—É—é—â–∏–π funding rate
   - **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** TTL = `refresh_interval_seconds` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–ü–†–û–í–ï–†–ö–ò:**
1. **–ê–±—Å–æ–ª—é—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** `abs(rate) <= max_abs_rate`
2. **LONG —Å–∏–≥–Ω–∞–ª:** `rate <= max_positive_rate` (–Ω–µ —Å–ª–∏—à–∫–æ–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π)
3. **SHORT —Å–∏–≥–Ω–∞–ª:** `rate >= -max_negative_rate` (–Ω–µ —Å–ª–∏—à–∫–æ–º –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π)
4. **–°–ª–µ–¥—É—é—â–∏–π funding:** –ï—Å–ª–∏ `include_next_funding=True`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏ —Å–ª–µ–¥—É—é—â–∏–π funding

**–ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø RATE:**
- OKX –∏–Ω–æ–≥–¥–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö (–µ—Å–ª–∏ > 1 –∏–ª–∏ < -1)
- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è: `rate /= 100.0` –µ—Å–ª–∏ `abs(rate) > 1`

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è rate** - —É—á–∏—Ç—ã–≤–∞–µ—Ç, —á—Ç–æ OKX –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç—ã
2. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ funding** - —É—á–∏—Ç—ã–≤–∞–µ—Ç –±—É–¥—É—â–∏–π funding rate
3. ‚ö†Ô∏è **–ö—ç—à –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º** - funding rate –º–µ–Ω—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 8 —á–∞—Å–æ–≤, –Ω–æ –∫—ç—à –º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ª—å—à–µ
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏** - –±–ª–æ–∫–∏—Ä—É–µ—Ç –≤—Ö–æ–¥—ã –ø—Ä–∏ –Ω–µ–±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–Ω–æ–º funding

---

##### 14.2.8. ORDERFLOWINDICATOR - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/order_flow_indicator.py` (227 —Å—Ç—Ä–æ–∫)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –ê–Ω–∞–ª–∏–∑ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è bid/ask –æ–±—ä–µ–º–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–ª—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –∏ –ø—Ä–æ–¥–∞–≤—Ü–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ExitAnalyzer –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞

**–†–ê–°–ß–ï–¢ DELTA:**
```python
delta = (bid_volume - ask_volume) / (bid_volume + ask_volume)
```
- **Delta –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ [-1, 1]:**
  - `1.0` = –≤—Å–µ –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏
  - `-1.0` = –≤—Å–µ –ø—Ä–æ–¥–∞–≤—Ü—ã
  - `0.0` = —Ä–∞–≤–Ω–æ–≤–µ—Å–∏–µ

**–ú–ï–¢–û–î–´:**
1. `get_delta()` - —Ç–µ–∫—É—â–∏–π delta
2. `get_avg_delta(periods=10)` - —Å—Ä–µ–¥–Ω–∏–π delta –∑–∞ N –ø–µ—Ä–∏–æ–¥–æ–≤
3. `get_delta_trend()` - —Ç—Ä–µ–Ω–¥ delta ("long", "short", "neutral")
4. `is_long_favorable(threshold)` - –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–µ–Ω –ª–∏ –≤—Ö–æ–¥ –≤ –ª–æ–Ω–≥
5. `is_short_favorable(threshold)` - –±–ª–∞–≥–æ–ø—Ä–∏—è—Ç–µ–Ω –ª–∏ –≤—Ö–æ–¥ –≤ —à–æ—Ä—Ç

**–ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–ï –í EXITANALYZER:**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ —á–µ—Ä–µ–∑ Order Flow
current_delta = self.order_flow.get_delta()
avg_delta = self.order_flow.get_avg_delta(periods=10)

# –î–ª—è LONG: —Ä–∞–∑–≤–æ—Ä–æ—Ç = delta –±—ã–ª –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –∏ —Å—Ç–∞–ª –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
if position_side == "long":
    if current_delta < -0.15 and avg_delta > 0.15:
        reversal_detected = True
```

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç delta** - —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ bid/ask
2. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞** - —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â–∏–π –∏ —Å—Ä–µ–¥–Ω–∏–π delta
3. ‚ö†Ô∏è **–ü–æ—Ä–æ–≥ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π** - 0.15 –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –¥–ª—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ ExitAnalyzer** - –ø–æ–º–æ–≥–∞–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–≤–æ—Ä–æ—Ç —Ç—Ä–µ–Ω–¥–∞

---

##### 14.2.9. –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø –ú–û–î–£–õ–ï–ô - –°–•–ï–ú–ê

**–ü–û–¢–û–ö –î–ê–ù–ù–´–• –ü–†–ò –û–¢–ö–†–´–¢–ò–ò –ü–û–ó–ò–¶–ò–ò:**
```
SignalGenerator.generate_signal()
  ‚Üì
FilterManager.apply_all_filters()
  ‚îú‚îÄ ADX Filter (–∫—ç—à 20s)
  ‚îú‚îÄ MTF Filter (–∫—ç—à 20s)
  ‚îú‚îÄ Pivot Points Filter (–∫—ç—à 20s)
  ‚îú‚îÄ Volume Profile Filter (–∫—ç—à 60s)
  ‚îú‚îÄ LiquidityFilter.evaluate() ‚Üí OKX API
  ‚îú‚îÄ OrderFlowFilter.is_signal_valid() ‚Üí OKX API
  ‚îî‚îÄ FundingRateFilter.is_signal_valid() ‚Üí OKX API
  ‚Üì
SignalCoordinator.process_signal()
  ‚Üì
FuturesRiskManager.calculate_position_size()
  ‚îú‚îÄ DataRegistry.get_balance()
  ‚îú‚îÄ ConfigManager.get_adaptive_risk_params()
  ‚îî‚îÄ AdaptiveLeverage.calculate_leverage()
  ‚Üì
EntryManager.open_position()
  ‚Üì
PositionRegistry.register_position()
```

**–ü–û–¢–û–ö –î–ê–ù–ù–´–• –ü–†–ò –ó–ê–ö–†–´–¢–ò–ò –ü–û–ó–ò–¶–ò–ò:**
```
WebSocketCoordinator.handle_ticker_data()
  ‚Üì
SmartExitCoordinator.check_position() [–ü–ï–†–í–´–ô]
  ‚îú‚îÄ DataRegistry.get_market_data()
  ‚îî‚îÄ _apply_smart_filter() ‚Üí RSI, MACD –∞–Ω–∞–ª–∏–∑
  ‚Üì
PositionManager.manage_position()
  ‚Üì
ExitDecisionCoordinator.analyze_position()
  ‚îú‚îÄ ExitAnalyzer.analyze_position()
  ‚îÇ   ‚îú‚îÄ PositionRegistry.get_position()
  ‚îÇ   ‚îú‚îÄ PositionRegistry.get_metadata()
  ‚îÇ   ‚îú‚îÄ DataRegistry.get_market_data()
  ‚îÇ   ‚îú‚îÄ DataRegistry.get_price()
  ‚îÇ   ‚îú‚îÄ fast_adx.get_adx()
  ‚îÇ   ‚îú‚îÄ order_flow.get_delta()
  ‚îÇ   ‚îî‚îÄ ParameterProvider.get_exit_params()
  ‚îú‚îÄ TrailingSLCoordinator.get_tsl()
  ‚îú‚îÄ SmartExitCoordinator.should_close() [–ù–ï –†–ê–ë–û–¢–ê–ï–¢ - –º–µ—Ç–æ–¥ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!]
  ‚îî‚îÄ PriorityResolver.resolve_exit_priority()
  ‚Üì
TrailingSLCoordinator.update_trailing_stop_loss()
  ‚îú‚îÄ ExitAnalyzer.analyze_position() [fallback]
  ‚îî‚îÄ TrailingStopLoss.should_close()
```

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ô:**
1. ‚ùå **SmartExitCoordinator –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ExitDecisionCoordinator** - –º–µ—Ç–æ–¥ `should_close()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ `check_position()`
2. ‚ùå **FilterManager –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é** - –º–µ—Ç–æ–¥—ã `_apply_liquidity_filter()`, `_apply_order_flow_filter()`, `_apply_funding_rate_filter()` –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `True` (TODO)
3. ‚ö†Ô∏è **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ** - –∫—ç—à —Ñ–∏–ª—å—Ç—Ä–æ–≤ –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ (TTL 20-60s)
4. ‚ö†Ô∏è **Fallback –Ω–∞ "ranging" —Ä–µ–∂–∏–º** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ranging, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

##### 14.2.10. –ò–¢–û–ì–û–í–´–ô –°–¢–ê–¢–£–° –ü–†–û–í–ï–†–ö–ò

**–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù–´:**
1. ‚úÖ ExitAnalyzer (5044 —Å—Ç—Ä–æ–∫–∏) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –ª–æ–≥–∏–∫–∏, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π
2. ‚úÖ SmartExitCoordinator (213 —Å—Ç—Ä–æ–∫) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–∏–∫–∏, –ø—Ä–æ–±–ª–µ–º —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π
3. ‚úÖ PriorityResolver (231 —Å—Ç—Ä–æ–∫–∞) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –º–∞—Ç—Ä–∏—Ü—ã –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤
4. ‚úÖ FilterManager (1061 —Å—Ç—Ä–æ–∫–∞) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
5. ‚úÖ LiquidityFilter (456 —Å—Ç—Ä–æ–∫) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –ø–æ—Ä–æ–≥–æ–≤
6. ‚úÖ OrderFlowFilter (300 —Å—Ç—Ä–æ–∫) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å—á–µ—Ç–∞ delta, –ø—Ä–æ–≤–µ—Ä–æ–∫
7. ‚úÖ FundingRateFilter (191 —Å—Ç—Ä–æ–∫–∞) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
8. ‚úÖ OrderFlowIndicator (227 —Å—Ç—Ä–æ–∫) - –ø–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Ä–∞—Å—á–µ—Ç–∞ delta, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ù–ê–ô–î–ï–ù–ù–´–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚ùå SmartExitCoordinator –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ ExitDecisionCoordinator (–º–µ—Ç–æ–¥ `should_close()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
2. ‚ùå FilterManager –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é (–º–µ—Ç–æ–¥—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `True`)
3. ‚ö†Ô∏è –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ (TTL 20-60s –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–º)
4. ‚ö†Ô∏è Fallback –Ω–∞ "ranging" —Ä–µ–∂–∏–º (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ä–µ—à–µ–Ω–∏—è–º)

##### 14.2.11. ENTRYMANAGER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/entry_manager.py` (808 —Å—Ç—Ä–æ–∫)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–π –Ω–∞ –±–∏—Ä–∂–µ
- –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ (–¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –≤ PositionSizer –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–∞—Å—á–µ—Ç)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ PositionRegistry
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Trailing Stop Loss

**–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•:**
1. **OrderExecutor:**
   - `execute_signal(signal, position_size)` - —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –±–∏—Ä–∂–µ
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: `{success, order_id, order_type, entry_price, position_side, margin_used}`
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –æ—Ä–¥–µ—Ä –Ω–µ –≤–µ—Ä–Ω—É–ª `entry_price`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback

2. **Client (OKXFuturesClient):**
   - `get_positions(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Å –±–∏—Ä–∂–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π –∏ –ø–æ–ª—É—á–µ–Ω–∏—è `avgPx`
   - **–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ —Å—Ä–∞–∑—É, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏)

3. **DataRegistry:**
   - `get_price(symbol)` - fallback –¥–ª—è `entry_price` –µ—Å–ª–∏ `avgPx=0.0`
   - **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback, –µ—Å–ª–∏ –±–∏—Ä–∂–∞ –Ω–µ –≤–µ—Ä–Ω—É–ª–∞ —Ü–µ–Ω—É

4. **PositionRegistry:**
   - `has_position(symbol)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
   - `register_position(symbol, position, metadata)` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏
   - **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

**–õ–û–ì–ò–ö–ê –û–¢–ö–†–´–¢–ò–Ø –ü–û–ó–ò–¶–ò–ò:**
```python
async def open_position_with_size(signal, position_size, regime, regime_params, balance_profile):
    # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
    has_position = await self.position_registry.has_position(symbol)
    if has_position:
        return False
    
    # 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∏—Ä–∂–µ
    exchange_positions = await self.client.get_positions(symbol)
    # –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–∞ –±–∏—Ä–∂–µ - –±–ª–æ–∫–∏—Ä—É–µ–º –æ—Ç–∫—Ä—ã—Ç–∏–µ
    
    # 3. –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞
    order_result = await self.order_executor.execute_signal(signal, position_size)
    
    # 4. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–∏ —Å –±–∏—Ä–∂–∏ (—Å retry –ª–æ–≥–∏–∫–æ–π)
    position_data = await self._get_position_data(symbol, order_result)
    # Retry: 3 –ø–æ–ø—ã—Ç–∫–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏ [0.5s, 1.0s, 2.0s]
    
    # 5. –°–æ–∑–¥–∞–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
    metadata = PositionMetadata(
        entry_time=entry_time_from_api or datetime.now(timezone.utc),
        entry_price=position_data.get("entry_price"),
        regime=regime or signal.get("regime"),
        ...
    )
    
    # 6. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ PositionRegistry
    await self.position_registry.register_position(symbol, position_data, metadata)
```

**–ü–û–õ–£–ß–ï–ù–ò–ï ENTRY_PRICE:**
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1:** `pos.get("avgPx")` –∏–∑ API (—Ç–æ—á–Ω–∞—è —Ü–µ–Ω–∞ —Å –±–∏—Ä–∂–∏)
- **Fallback 1:** Retry –ª–æ–≥–∏–∫–∞ (3 –ø–æ–ø—ã—Ç–∫–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏)
- **Fallback 2:** `order_result.get("price")` (–ª–∏–º–∏—Ç–Ω–∞—è —Ü–µ–Ω–∞ –∏–∑ –æ—Ä–¥–µ—Ä–∞)
- **Fallback 3:** `signal.get("price")` (—Ü–µ–Ω–∞ –∏–∑ —Å–∏–≥–Ω–∞–ª–∞)
- **Fallback 4:** `data_registry.get_price(symbol)` (–µ—Å–ª–∏ `avgPx=0.0`)

**–ü–†–û–ë–õ–ï–ú–´:**
1. ‚ö†Ô∏è **Fallback –Ω–∞ signal.price** - —Ü–µ–Ω–∞ –∏–∑ —Å–∏–≥–Ω–∞–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–µ–π
2. ‚ö†Ô∏è **–†–µ–∂–∏–º –º–æ–∂–µ—Ç –±—ã—Ç—å None** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback "ranging" –≤ ExitAnalyzer
3. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è retry –ª–æ–≥–∏–∫–∞** - 3 –ø–æ–ø—ã—Ç–∫–∏ —Å —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–º–∏—Å—è –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∏—Ä–∂–µ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º

**–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø:**
1. **SignalCoordinator:** –í—ã–∑—ã–≤–∞–µ—Ç `open_position_with_size()` —Å —É–∂–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–º —Ä–∞–∑–º–µ—Ä–æ–º
2. **OrderExecutor:** –†–∞–∑–º–µ—â–∞–µ—Ç –æ—Ä–¥–µ—Ä —á–µ—Ä–µ–∑ `execute_signal()`
3. **PositionRegistry:** –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏—é –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
4. **DataRegistry:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback –¥–ª—è `entry_price`

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚ö†Ô∏è **–†–µ–∂–∏–º –º–æ–∂–µ—Ç –±—ã—Ç—å None** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback "ranging"
2. ‚ö†Ô∏è **Fallback –Ω–∞ signal.price** - —Ü–µ–Ω–∞ –∏–∑ —Å–∏–≥–Ω–∞–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–µ–π
3. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è retry –ª–æ–≥–∏–∫–∞** - 3 –ø–æ–ø—ã—Ç–∫–∏ —Å —É–≤–µ–ª–∏—á–∏–≤–∞—é—â–∏–º–∏—Å—è –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –±–∏—Ä–∂–µ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

---

##### 14.2.12. DATAREGISTRY - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/data_registry.py` (581 —Å—Ç—Ä–æ–∫–∞)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –ï–¥–∏–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö (market data, indicators, regimes, balance, margin)
- Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ `asyncio.Lock`
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–•–†–ê–ù–ò–ú–´–ï –î–ê–ù–ù–´–ï:**
1. **Market Data:** `_market_data[symbol] = {price, volume, candles, updated_at}`
2. **Indicators:** `_indicators[symbol] = {indicator_name: value, updated_at}`
3. **Regimes:** `_regimes[symbol] = {regime: str, params: dict, updated_at}`
4. **Balance:** `_balance = {balance: float, profile: str, updated_at}`
5. **Margin:** `_margin = {used: float, available: float, total: float, updated_at}`
6. **Candle Buffers:** `_candle_buffers[symbol][timeframe] = CandleBuffer`

**–ú–ï–¢–û–î–´:**
1. `update_market_data(symbol, data)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. `get_market_data(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. `get_price(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
4. `get_mark_price(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ markPx (–¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤)
5. `update_indicator(symbol, indicator_name, value)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
6. `get_indicator(symbol, indicator_name)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
7. `update_regime(symbol, regime, params)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
8. `get_regime(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
9. `update_balance(balance, profile)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
10. `get_balance()` - –ø–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞

**–ü–†–û–ë–õ–ï–ú–´:**
1. ‚ö†Ô∏è **–î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏** - –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤–µ–∂–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
2. ‚ö†Ô∏è **Fallback –Ω–∞ –æ–±—ã—á–Ω—É—é —Ü–µ–Ω—É** - –µ—Å–ª–∏ `markPx` –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—ã—á–Ω–∞—è —Ü–µ–Ω–∞
3. ‚úÖ **Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã `asyncio.Lock`
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `update_*` –º–µ—Ç–æ–¥—ã

**–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø:**
1. **SignalGenerator:** –û–±–Ω–æ–≤–ª—è–µ—Ç market data –∏ indicators
2. **ExitAnalyzer:** –ü–æ–ª—É—á–∞–µ—Ç market data, price, regime
3. **EntryManager:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ fallback –¥–ª—è `entry_price`
4. **RiskManager:** –ü–æ–ª—É—á–∞–µ—Ç balance –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚ö†Ô∏è **–î–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏** - –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–≤–µ–∂–µ—Å—Ç–∏
2. ‚ö†Ô∏è **Fallback –Ω–∞ –æ–±—ã—á–Ω—É—é —Ü–µ–Ω—É** - markPx –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
3. ‚úÖ **Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏** - –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ** - –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

##### 14.2.13. REGIMEMANAGER - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó

**–§–∞–π–ª:** `src/strategies/scalping/futures/adaptivity/regime_manager.py` (1145 —Å—Ç—Ä–æ–∫)

**–°–¢–ê–¢–£–°:** ‚úÖ **–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù**

**–û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ (TRENDING, RANGING, CHOPPY)
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ –∫ —Ä–µ–∂–∏–º—É
- –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–æ–≤

**–ò–°–¢–û–ß–ù–ò–ö–ò –î–ê–ù–ù–´–•:**
1. **FastADX:**
   - `get_adx(symbol)` - –ø–æ–ª—É—á–µ–Ω–∏–µ ADX, +DI, -DI
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞

2. **OHLCV –¥–∞–Ω–Ω—ã–µ:**
   - –°–≤–µ—á–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–Ω–¥–∞
   - –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞

**–õ–û–ì–ò–ö–ê –û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –†–ï–ñ–ò–ú–ê:**
```python
def detect_regime(candles, adx_data):
    # 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ ADX
    adx_value = adx_data.get("adx", 0)
    if adx_value > 30.0:  # trending_adx_threshold
        # –°–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥
        if price > sma * 1.02:  # trend_strength_percent = 2%
            return RegimeType.TRENDING
        elif price < sma * 0.98:
            return RegimeType.TRENDING
    
    # 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
    volatility = calculate_volatility(candles)
    if volatility > 0.05:  # high_volatility_threshold
        return RegimeType.CHOPPY
    
    # 3. Fallback
    if adx_value < 25.0:  # ranging_adx_threshold
        return RegimeType.RANGING
    
    return RegimeType.RANGING  # Default
```

**–ó–ê–©–ò–¢–ê –û–¢ –ß–ê–°–¢–û–ì–û –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø:**
- `min_regime_duration_minutes = 15` - –º–∏–Ω–∏–º—É–º 15 –º–∏–Ω—É—Ç –≤ –æ–¥–Ω–æ–º —Ä–µ–∂–∏–º–µ
- `required_confirmations = 3` - –Ω—É–∂–Ω–æ 3 –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –±—ã—Å—Ç—Ä–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä—ã–Ω–∫–∞ —Ä–µ–∂–∏–º –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º

**–ü–†–û–ë–õ–ï–ú–´:**
1. ‚ö†Ô∏è **–†–µ–∂–∏–º –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º** - –∑–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–æ–∂–µ—Ç –∑–∞–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
2. ‚ö†Ô∏è **Fallback –Ω–∞ RANGING** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ranging
3. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è** - —É—á–∏—Ç—ã–≤–∞–µ—Ç ADX, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, —Ç—Ä–µ–Ω–¥
4. ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ö–∞–æ—Ç–∏—á–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

**–í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–Ø:**
1. **SignalGenerator:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç RegimeManager –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
2. **ExitAnalyzer:** –ü–æ–ª—É—á–∞–µ—Ç —Ä–µ–∂–∏–º —á–µ—Ä–µ–∑ `signal_generator.regime_managers[symbol]`
3. **ConfigManager:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ä–µ–∂–∏–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´:**
1. ‚ö†Ô∏è **–†–µ–∂–∏–º –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º** - –∑–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –º–æ–∂–µ—Ç –∑–∞–¥–µ—Ä–∂–∏–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
2. ‚ö†Ô∏è **Fallback –Ω–∞ RANGING** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ranging
3. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è** - —É—á–∏—Ç—ã–≤–∞–µ—Ç ADX, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å, —Ç—Ä–µ–Ω–¥
4. ‚úÖ **–ó–∞—â–∏—Ç–∞ –æ—Ç —á–∞—Å—Ç–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —Ö–∞–æ—Ç–∏—á–Ω–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

---

#### 14.3. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ü–†–û–í–ï–†–ö–ò

**–ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù–´:**
1. ‚úÖ `src/strategies/scalping/futures/positions/entry_manager.py` (808 —Å—Ç—Ä–æ–∫) - –≤—Ö–æ–¥ –≤ –ø–æ–∑–∏—Ü–∏–∏
2. ‚úÖ `src/strategies/scalping/futures/core/data_registry.py` (581 —Å—Ç—Ä–æ–∫–∞) - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
3. ‚úÖ `src/strategies/scalping/futures/adaptivity/regime_manager.py` (1145 —Å—Ç—Ä–æ–∫) - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
4. ‚úÖ `src/strategies/scalping/futures/positions/position_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ (–ø—Ä–æ–≤–µ—Ä–µ–Ω –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –∞–Ω–∞–ª–∏–∑–µ)

**–ò–¢–û–ì–û –ü–†–û–í–ï–†–ï–ù–û –ú–û–î–£–õ–ï–ô:** 11 –∏–∑ 11 (100%)

---

### 15. –ü–†–ò–ù–Ø–¢–ò–ï –†–ï–®–ï–ù–ò–ô –û–¢–ù–û–°–ò–¢–ï–õ–¨–ù–û –¶–ï–ù

#### 15.1. –ú–û–ú–ï–ù–¢ –í–•–û–î–ê - –ê–ù–ê–õ–ò–ó –¶–ï–ù–´

**–ü–†–û–¶–ï–°–°:**
1. –°–∏–≥–Ω–∞–ª –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ **–∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–∏** (—Ü–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è)
2. –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ **ticker API**
3. Limit price —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è: `current_price ¬± offset`
4. –û—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–∞–µ—Ç—Å—è —Å **limit price**

**–ü–†–û–ë–õ–ï–ú–ê:**
- –°–∏–≥–Ω–∞–ª –æ—Å–Ω–æ–≤–∞–Ω –Ω–∞ **—Å—Ç–∞—Ä–æ–π —Ü–µ–Ω–µ** (–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–≤–µ—á–∏)
- Limit price —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç **—Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã**
- –ù–æ –º–µ–∂–¥—É –∑–∞–∫—Ä—ã—Ç–∏–µ–º —Å–≤–µ—á–∏ –∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –æ—Ä–¥–µ—Ä–∞ —Ü–µ–Ω–∞ **—É—Å–ø–µ–ª–∞ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è**
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –≤—Ö–æ–¥ –≤ **—É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–π** —Ç—Ä–µ–Ω–¥

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```json
{"timestamp": "2026-01-04T04:19:24.902000+00:00", "event": "position_opened", 
 "symbol": "SOL-USDT", "side": "SHORT", "entry_price": 136.94054945054944, 
 "size": 1.82, "regime": "ranging"}
```
- –°–∏–≥–Ω–∞–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–∏: $136.94
- Limit –æ—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω: $136.94 √ó (1 + 0.0005) = **$137.01** (–¥–ª—è SHORT)
- –ù–æ —Ü–µ–Ω–∞ —É–∂–µ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å, –≤—Ö–æ–¥ –ø—Ä–æ–∏–∑–æ—à–µ–ª –ø–æ **$136.94** (avgPx —Å –±–∏—Ä–∂–∏)
- **–û–ø–æ–∑–¥–∞–Ω–∏–µ:** —Ü–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞ —Å–æ–≤–ø–∞–ª–∞ —Å —Ü–µ–Ω–æ–π –≤—Ö–æ–¥–∞ (–ø–æ–≤–µ–∑–ª–æ)

**–ü–†–ò–ú–ï–† –° –û–ü–û–ó–î–ê–ù–ò–ï–ú:**
- –°–≤–µ—á–∞ –∑–∞–∫—Ä—ã–ª–∞—Å—å: $100.00 (—Å–∏–≥–Ω–∞–ª LONG)
- –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ (—á–µ—Ä–µ–∑ 1-2 —Å–µ–∫): $100.15
- Limit price: $100.15 √ó (1 - 0.0005) = **$100.10**
- –í—Ö–æ–¥: $100.10 (–æ–ø–æ–∑–¥–∞–Ω–∏–µ 0.1%)

#### 15.2. –ú–û–ú–ï–ù–¢ –í–´–•–û–î–ê - –ê–ù–ê–õ–ò–ó –¶–ï–ù–´

**–ü–†–û–¶–ï–°–°:**
1. Trailing stop –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ **–∫–∞–∂–¥–æ–º —Ç–∏–∫–µ**
2. –ü—Ä–æ–≤–µ—Ä–∫–∞: `current_price <= trailing_stop_price`
3. –ï—Å–ª–∏ –¥–∞ ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏

**–ü–†–û–ë–õ–ï–ú–ê:**
- Trailing stop **—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ** –∫ —Ü–µ–Ω–µ
- –ü—Ä–∏ –º–∞–ª–µ–π—à–µ–º –æ—Ç–∫–∞—Ç–µ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –ù–æ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç **–æ—Ç—Å–∫–æ—á–∏—Ç—å** –æ–±—Ä–∞—Ç–Ω–æ
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ

**–ü–†–ò–ú–ï–† –ò–ó –õ–û–ì–û–í:**
```json
{"timestamp": "2026-01-04T04:23:17.772785+00:00", "event": "exchange_side_closure", 
 "symbol": "SOL-USDT", "side": "SHORT", "size": 1.82, 
 "entry_price": 136.94054945054944, "entry_time": "2026-01-04T04:19:24.902000+00:00", 
 "duration_sec": 232.53806, "reason": "exchange_side", 
 "possible_causes": ["TSL", "Liquidation", "ADL", "Manual"]}
```
- –í—Ö–æ–¥: $136.94 (SHORT)
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 232 —Å–µ–∫—É–Ω–¥—ã (3.9 –º–∏–Ω—É—Ç—ã)
- –ó–∞–∫—Ä—ã—Ç–∏–µ: —á–µ—Ä–µ–∑ WebSocket (exchange_side)
- **–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:** TSL, Liquidation, ADL, Manual
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞ —Ç–æ—á–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –∏ —Ü–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞

**–ü–†–ò–ú–ï–† –° TRAILING STOP:**
- –í—Ö–æ–¥: $100.00
- –¶–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞: $100.50 (+0.5%)
- Trailing stop: $100.50 √ó (1 - 0.004) = **$100.098**
- –¶–µ–Ω–∞ –æ—Ç–∫–∞—Ç–∏–ª–∞—Å—å: $100.10
- Trailing stop —Å—Ä–∞–±–æ—Ç–∞–ª: –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ $100.10
- –ù–æ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç **–æ—Ç—Å–∫–æ—á–∏—Ç—å** –¥–æ $100.20
- –†–µ–∑—É–ª—å—Ç–∞—Ç: —É–ø—É—â–µ–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å

#### 15.3. –ü–ê–†–ê–ú–ï–¢–†–´ –ü–û –†–ï–ñ–ò–ú–ê–ú - –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê

**TRENDING –†–ï–ñ–ò–ú:**
- tp_percent: **6.0%** –æ—Ç –º–∞—Ä–∂–∏
- sl_percent: **1.2%** –æ—Ç –º–∞—Ä–∂–∏
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: **5:1** ‚úÖ (—Ö–æ—Ä–æ—à–æ)
- position_size_multiplier: **1.3x**
- max_holding_minutes: **40 –º–∏–Ω—É—Ç**

**RANGING –†–ï–ñ–ò–ú:**
- tp_percent: **5.0%** –æ—Ç –º–∞—Ä–∂–∏
- sl_percent: **2.0%** –æ—Ç –º–∞—Ä–∂–∏
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: **2.5:1** ‚úÖ (—Ö–æ—Ä–æ—à–æ)
- position_size_multiplier: **1.0x**
- max_holding_minutes: **30 –º–∏–Ω—É—Ç**

**CHOPPY –†–ï–ñ–ò–ú:**
- tp_percent: **4.5%** –æ—Ç –º–∞—Ä–∂–∏
- sl_percent: **1.2%** –æ—Ç –º–∞—Ä–∂–∏
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: **3.75:1** ‚úÖ (—Ö–æ—Ä–æ—à–æ)
- position_size_multiplier: **1.0x**
- max_holding_minutes: **14 –º–∏–Ω—É—Ç**

**–ê–ù–ê–õ–ò–ó:**
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è TP/SL **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ** (2.5:1 –∏ –≤—ã—à–µ)
- –ù–æ –ø—Ä–∏ –∫–æ–º–∏—Å—Å–∏–∏ 0.1% –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–∏ 0.2% –Ω—É–∂–Ω–æ **–º–∏–Ω–∏–º—É–º 3:1**
- –î–ª—è ranging —Ä–µ–∂–∏–º–∞ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ **2.5:1** –º–æ–∂–µ—Ç –±—ã—Ç—å **–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º**

#### 15.4. –ü–ê–†–ê–ú–ï–¢–†–´ –ü–û –ü–ê–†–ê–ú - –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê

**BTC-USDT RANGING:**
- tp_percent: **5.5%**, sl_percent: **2.0%** ‚Üí —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ **2.75:1** ‚úÖ
- tp_atr_multiplier: **0.8**, sl_atr_multiplier: **0.45** ‚Üí —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ **1.78:1** ‚ö†Ô∏è

**ETH-USDT RANGING:**
- tp_percent: **3.5%**, sl_percent: **1.5%** ‚Üí —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ **2.33:1** ‚úÖ
- tp_atr_multiplier: **0.8**, sl_atr_multiplier: **0.45** ‚Üí —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ **1.78:1** ‚ö†Ô∏è

**SOL-USDT RANGING:**
- tp_percent: **3.5%**, sl_percent: **2.0%** ‚Üí —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ **1.75:1** ‚ö†Ô∏è
- tp_atr_multiplier: **0.45**, sl_atr_multiplier: **0.30** ‚Üí —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ **1.5:1** ‚ùå

**–ü–†–û–ë–õ–ï–ú–ê:**
- –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **ATR multipliers**, —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ TP/SL **—Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ**
- –î–ª—è SOL-USDT: **1.5:1** - —ç—Ç–æ **–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ** –ø—Ä–∏ –∫–æ–º–∏—Å—Å–∏—è—Ö
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è **–≤ –º–∏–Ω—É—Å**

---

---

## 16. –ò–¢–û–ì–û–í–´–ï –í–´–í–û–î–´

### 16.1. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´

1. **Market –æ—Ä–¥–µ—Ä–∞ –≤–º–µ—Å—Ç–æ Limit** - –∫–æ–º–∏—Å—Å–∏—è 0.05% –≤–º–µ—Å—Ç–æ 0.02% (2.5 —Ä–∞–∑–∞ –≤—ã—à–µ)
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç PnL** - –∫–æ–º–∏—Å—Å–∏—è –Ω–µ –≤—Å–µ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Trailing Stop** - –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (0.4% initial trail)
4. **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞** - –ø—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ $19.2 –º–∞—Ä–∂–∏ (2.7%)
5. **SmartExitCoordinator –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –º–µ—Ç–æ–¥ `should_close()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ ExitDecisionCoordinator
6. **FilterManager –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** - –º–µ—Ç–æ–¥—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `True` (TODO –≤ –∫–æ–¥–µ)

### 16.2. –í–ê–ñ–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

1. **Fallback –Ω–∞ "ranging" —Ä–µ–∂–∏–º** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ranging
2. **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ** - TTL 20-60s –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–º
3. **ATR-based TP/SL –¥–ª—è SOL** - —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ 1.5:1 –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∏ –∫–æ–º–∏—Å—Å–∏—è—Ö
4. **–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ª–µ–≤–µ—Ä–∏–¥–∂–∞** - –ª–µ–≤–µ—Ä–∏–¥–∂ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—á–∞–ª—å–Ω–æ–π –º–∞—Ä–∂–∏

### 16.3. –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –ò –†–ï–®–ï–ù–ò–ô

#### 16.3.1. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (–° –ö–û–î–û–ú)

##### –ü–†–û–ë–õ–ï–ú–ê #1: Market –æ—Ä–¥–µ—Ä–∞ –≤–º–µ—Å—Ç–æ Limit

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/order_executor.py:266-281`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
def _determine_order_type(self, signal: Dict[str, Any]) -> str:
    signal_type = signal.get("type", "market")  # ‚ùå "market" –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
    if signal_type in ["market", "limit", "oco"]:
        return signal_type
    return "market"  # ‚ùå Fallback –Ω–∞ "market"
```

**–†–ï–®–ï–ù–ò–ï:**
```python
def _determine_order_type(self, signal: Dict[str, Any]) -> str:
    """–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å–∏–≥–Ω–∞–ª–∞"""
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º limit –æ—Ä–¥–µ—Ä–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –∫–æ–º–∏—Å—Å–∏–π
    signal_type = signal.get("type", "limit")  # ‚úÖ "limit" –≤–º–µ—Å—Ç–æ "market"
    
    if signal_type in ["market", "limit", "oco"]:
        return signal_type
    
    return "limit"  # ‚úÖ Fallback –Ω–∞ "limit" –≤–º–µ—Å—Ç–æ "market"
```

**–≠–§–§–ï–ö–¢:**
- –ö–æ–º–∏—Å—Å–∏—è —Å–Ω–∏–∑–∏—Ç—Å—è —Å **0.05%** (taker) –¥–æ **0.02%** (maker)
- –≠–∫–æ–Ω–æ–º–∏—è: **$3.6/–¥–µ–Ω—å = $108/–º–µ—Å—è—Ü**

---

##### –ü–†–û–ë–õ–ï–ú–ê #2: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ TSL

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:447-500`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
# ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è maker fee (0.02%) –≤–º–µ—Å—Ç–æ taker fee (0.05%)
trading_fee_rate = 0.0002  # 0.02% (maker)
commission_pct = (trading_fee_rate * 2) * self.leverage * 100
```

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–º–∏—Å—Å–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –æ—Ä–¥–µ—Ä–∞
# –ï—Å–ª–∏ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç limit –æ—Ä–¥–µ—Ä–∞ - maker fee (0.02%)
# –ï—Å–ª–∏ –±–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç market –æ—Ä–¥–µ—Ä–∞ - taker fee (0.05%)
order_type = getattr(self, "order_type", "limit")  # –ü–æ–ª—É—á–∞–µ–º —Ç–∏–ø –æ—Ä–¥–µ—Ä–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
if order_type == "market":
    trading_fee_rate = 0.0005  # 0.05% (taker)
else:
    trading_fee_rate = 0.0002  # 0.02% (maker)

commission_pct = (trading_fee_rate * 2) * self.leverage * 100
```

**–≠–§–§–ï–ö–¢:**
- PnL –±—É–¥–µ—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ù–µ –±—É–¥–µ—Ç —Å–∫—Ä—ã–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π —É–±—ã—Ç–æ–∫

---

##### –ü–†–û–ë–õ–ï–ú–ê #3: –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Trailing Stop

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:213-350`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
# ‚ùå initial_trail –¥–ª—è ranging: 0.004 (0.4%) - —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ
self.initial_trail = 0.004  # 0.4%
```

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º initial_trail –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
# –î–ª—è ranging: 0.006-0.008 (0.6-0.8%) –≤–º–µ—Å—Ç–æ 0.004 (0.4%)
if regime == "ranging":
    self.initial_trail = 0.006  # 0.6% (–±—ã–ª–æ 0.4%)
elif regime == "trending":
    self.initial_trail = 0.004  # 0.4% (–æ—Å—Ç–∞–≤–ª—è–µ–º –¥–ª—è —Ç—Ä–µ–Ω–¥–∞)
else:  # choppy
    self.initial_trail = 0.008  # 0.8% (–¥–ª—è —Ö–∞–æ—Ç–∏—á–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞)
```

**–≠–§–§–ï–ö–¢:**
- –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç "–¥—ã—à–∞—Ç—å" –¥–æ–ª—å—à–µ
- –ú–µ–Ω—å—à–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π

---

##### –ü–†–û–ë–õ–ï–ú–ê #4: SmartExitCoordinator –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/coordinators/exit_decision_coordinator.py:284-298`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
# ‚ùå –ú–µ—Ç–æ–¥ should_close() –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ SmartExitCoordinator
if hasattr(self.smart_exit_coordinator, "should_close"):
    should_close, reason = await self.smart_exit_coordinator.should_close(...)
```

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ check_position()
if self.smart_exit_coordinator:
    try:
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º check_position() –≤–º–µ—Å—Ç–æ should_close()
        decision = await self.smart_exit_coordinator.check_position(
            symbol, position
        )
        if decision and decision.get("action") == "close":
            return {
                "action": "close",
                "reason": decision.get("reason", "smart_exit"),
                "current_price": current_price,
            }
    except Exception as e:
        logger.debug(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ Smart Exit –¥–ª—è {symbol}: {e}")
```

**–≠–§–§–ï–ö–¢:**
- SmartExitCoordinator –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ ExitDecisionCoordinator
- –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

---

##### –ü–†–û–ë–õ–ï–ú–ê #5: FilterManager –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/signals/filter_manager.py:1019-1060`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
async def _apply_liquidity_filter(...) -> bool:
    # ‚ùå TODO –≤ –∫–æ–¥–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True
    return True

async def _apply_order_flow_filter(...) -> bool:
    # ‚ùå TODO –≤ –∫–æ–¥–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True
    return True

async def _apply_funding_rate_filter(...) -> bool:
    # ‚ùå TODO –≤ –∫–æ–¥–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç True
    return True
```

**–†–ï–®–ï–ù–ò–ï:**
```python
async def _apply_liquidity_filter(
    self,
    symbol: str,
    signal: Dict[str, Any],
    market_data: Any,
    liquidity_params: Dict[str, Any],
    liquidity_relax: float = 1.0,
) -> bool:
    """–ü—Ä–∏–º–µ–Ω–∏—Ç—å Liquidity —Ñ–∏–ª—å—Ç—Ä"""
    if not self.liquidity_filter:
        return True
    
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ evaluate()
    signal_side = signal.get("side", "").lower()
    if signal_side == "buy":
        signal_side_normalized = "buy"
    elif signal_side == "sell":
        signal_side_normalized = "sell"
    else:
        signal_side_normalized = None
    
    # –ü–æ–ª—É—á–∞–µ–º thresholds_override –∏–∑ liquidity_params
    thresholds_override = liquidity_params.get("thresholds", {})
    
    result, snapshot = await self.liquidity_filter.evaluate(
        symbol=symbol,
        regime=signal.get("regime"),
        relax_multiplier=liquidity_relax,
        thresholds_override=thresholds_override,
        signal_side=signal_side_normalized,
    )
    
    return result

async def _apply_order_flow_filter(
    self,
    symbol: str,
    signal: Dict[str, Any],
    market_data: Any,
    order_flow_params: Dict[str, Any],
    order_flow_relax: float = 1.0,
) -> bool:
    """–ü—Ä–∏–º–µ–Ω–∏—Ç—å Order Flow —Ñ–∏–ª—å—Ç—Ä"""
    if not self.order_flow_filter:
        return True
    
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ is_signal_valid()
    signal_side = signal.get("side", "").lower()
    
    # –ü–æ–ª—É—á–∞–µ–º overrides –∏–∑ order_flow_params
    overrides = order_flow_params.get("overrides", {})
    
    result = await self.order_flow_filter.is_signal_valid(
        symbol=symbol,
        side=signal_side,
        snapshot=None,  # –ë—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω –≤–Ω—É—Ç—Ä–∏ —Ñ–∏–ª—å—Ç—Ä–∞
        regime=signal.get("regime"),
        relax_multiplier=order_flow_relax,
        overrides=overrides,
    )
    
    return result

async def _apply_funding_rate_filter(
    self,
    symbol: str,
    signal: Dict[str, Any],
    funding_params: Dict[str, Any],
) -> bool:
    """–ü—Ä–∏–º–µ–Ω–∏—Ç—å Funding Rate —Ñ–∏–ª—å—Ç—Ä"""
    if not self.funding_rate_filter:
        return True
    
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ is_signal_valid()
    signal_side = signal.get("side", "").lower()
    
    # –ü–æ–ª—É—á–∞–µ–º overrides –∏–∑ funding_params
    overrides = funding_params.get("overrides", {})
    
    result = await self.funding_rate_filter.is_signal_valid(
        symbol=symbol,
        side=signal_side,
        overrides=overrides,
    )
    
    return result
```

**–≠–§–§–ï–ö–¢:**
- –§–∏–ª—å—Ç—Ä—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–æ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏, order flow –∏ funding rate –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

##### –ü–†–û–ë–õ–ï–ú–ê #6: –ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ $700

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/risk_manager.py:695-734`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
# ‚ùå –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700: base_usd_size = $120 (—Ç–æ–ª—å–∫–æ 17% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
size_at_min = 100.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $500
size_at_max = 200.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1500
interpolated_size = size_at_min + (size_range * (clamped_balance - min_balance) / balance_range)
# –ü—Ä–∏ $700: $100 + ($100 * ($700 - $500) / $1000) = $120
```

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
# –î–ª—è –±–∞–ª–∞–Ω—Å–∞ $700 –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å $175 (25% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
size_at_min = 150.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $500 (–±—ã–ª–æ $100)
size_at_max = 250.0  # –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1500 (–±—ã–ª–æ $200)

# –ü—Ä–∏ $700: $150 + ($100 * ($700 - $500) / $1000) = $170
# –≠—Ç–æ 24% –æ—Ç –±–∞–ª–∞–Ω—Å–∞ –≤–º–µ—Å—Ç–æ 17%
```

**–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û:**
```python
# ‚úÖ –£–º–µ–Ω—å—à–∞–µ–º min_position_usd –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
# –í config_futures.yaml:
balance_profiles:
  small:
    min_position_usd: 30.0  # –ë—ã–ª–æ $50
    max_position_usd: 300.0  # –ë—ã–ª–æ $250
```

**–≠–§–§–ï–ö–¢:**
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $700 –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è **$170** –≤–º–µ—Å—Ç–æ **$120**
- –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –Ω–∞ **42%**

---

#### 16.3.2. –í–ê–ñ–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø (–° –ö–û–î–û–ú)

##### –ü–†–û–ë–õ–ï–ú–ê #7: Fallback –Ω–∞ "ranging" —Ä–µ–∂–∏–º

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/positions/exit_analyzer.py:375-378`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
# ‚ùå Fallback –Ω–∞ "ranging" –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω
if not regime:
    regime = "ranging"
    regime_source = "fallback"
```

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –õ–æ–≥–∏—Ä—É–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∂–∏–º –∏–∑ metadata
if not regime:
    # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∂–∏–º –∏–∑ metadata (—Ä–µ–∂–∏–º –Ω–∞ –º–æ–º–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è)
    if metadata and hasattr(metadata, "regime") and metadata.regime:
        regime = metadata.regime
        regime_source = "metadata_fallback"
        logger.warning(
            f"‚ö†Ô∏è ExitAnalyzer {symbol}: –†–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ signal_generator/DataRegistry, "
            f"–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∂–∏–º –∏–∑ metadata (–º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º): {regime}"
        )
    else:
        regime = "ranging"
        regime_source = "hard_fallback"
        logger.error(
            f"‚ùå ExitAnalyzer {symbol}: –†–µ–∂–∏–º –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∏–≥–¥–µ, –∏—Å–ø–æ–ª—å–∑—É–µ–º hard fallback 'ranging'"
        )
```

**–≠–§–§–ï–ö–¢:**
- –ë—É–¥–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ fallback
- –ú–æ–∂–Ω–æ –±—É–¥–µ—Ç –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞

---

##### –ü–†–û–ë–õ–ï–ú–ê #8: ATR-based TP/SL –¥–ª—è SOL —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ

**–ú–µ—Å—Ç–æ:** `config/config_futures.yaml:1109-1115`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```yaml
SOL-USDT:
  ranging:
    tp_atr_multiplier: 0.45  # ‚ùå –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π
    sl_atr_multiplier: 0.30   # ‚ùå –°–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π
    # –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 0.45/0.30 = 1.5:1 (–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!)
```

**–†–ï–®–ï–ù–ò–ï:**
```yaml
SOL-USDT:
  ranging:
    tp_atr_multiplier: 0.75  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.45 –¥–æ 0.75
    sl_atr_multiplier: 0.30  # –û—Å—Ç–∞–≤–ª—è–µ–º 0.30
    # –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 0.75/0.30 = 2.5:1 (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!)
    
    # –ò–õ–ò –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞:
    tp_atr_multiplier: 0.60  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.45 –¥–æ 0.60
    sl_atr_multiplier: 0.24  # ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–æ —Å 0.30 –¥–æ 0.24
    # –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: 0.60/0.24 = 2.5:1 (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ!)
```

**–≠–§–§–ï–ö–¢:**
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ TP/SL –±—É–¥–µ—Ç **2.5:1** –≤–º–µ—Å—Ç–æ **1.5:1**
- –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –≤ –ø–ª—é—Å –¥–∞–∂–µ –ø—Ä–∏ –∫–æ–º–∏—Å—Å–∏—è—Ö

---

##### –ü–†–û–ë–õ–ï–ú–ê #9: –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/signals/filter_manager.py:55-58`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
# ‚ùå TTL 20-60 —Å–µ–∫—É–Ω–¥ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–º –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ä—ã–Ω–∫–æ–≤
self.filter_cache_ttl_fast: float = 20.0  # 20 —Å–µ–∫—É–Ω–¥
self.filter_cache_ttl_slow: float = 60.0  # 60 —Å–µ–∫—É–Ω–¥
```

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–º–µ–Ω—å—à–∞–µ–º TTL –¥–ª—è –±–æ–ª–µ–µ –±—ã—Å—Ç—Ä–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
self.filter_cache_ttl_fast: float = 10.0  # ‚úÖ 10 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 20
self.filter_cache_ttl_slow: float = 30.0  # ‚úÖ 30 —Å–µ–∫—É–Ω–¥ –≤–º–µ—Å—Ç–æ 60

# ‚úÖ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–û: –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å–≤–µ–∂–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö
def _is_cache_fresh(self, symbol: str, filter_name: str, use_slow_ttl: bool = False) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ –∫—ç—à–∞ —Å —É—á–µ—Ç–æ–º –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä—ã–Ω–∫–∞"""
    cache = self.filter_cache.get(symbol)
    if not cache:
        return False
    
    now = time.time()
    cache_age = now - cache.get("ts", 0)
    ttl = self.filter_cache_ttl_slow if use_slow_ttl else self.filter_cache_ttl_fast
    
    # ‚úÖ –ù–û–í–û–ï: –ï—Å–ª–∏ —Ä—ã–Ω–æ–∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã–π - —É–º–µ–Ω—å—à–∞–µ–º TTL
    if self.data_registry:
        try:
            market_data = await self.data_registry.get_market_data(symbol)
            if market_data:
                volatility = market_data.get("volatility", 0)
                if volatility > 0.05:  # –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
                    ttl = ttl * 0.5  # –£–º–µ–Ω—å—à–∞–µ–º TTL –≤ 2 —Ä–∞–∑–∞
        except Exception:
            pass
    
    return cache_age < ttl
```

**–≠–§–§–ï–ö–¢:**
- –ö—ç—à –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–µ–µ
- –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –±–æ–ª–µ–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏

---

##### –ü–†–û–ë–õ–ï–ú–ê #10: –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ª–µ–≤–µ—Ä–∏–¥–∂–∞

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py:2205-2264`

**–¢–ï–ö–£–©–ò–ô –ö–û–î:**
```python
# ‚ùå Leverage —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑–æ–≤–æ–≥–æ margin, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ
base_margin_usd = 100.0  # –ò–∑ balance_profile
leverage = await adaptive_leverage.calculate_leverage(
    signal_strength=0.6,
    regime="ranging",
    position_size_usd=base_margin_usd * leverage,  # ‚ùå –¶–∏–∫–ª–∏—á–µ—Å–∫–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
)
```

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å —É—á–µ—Ç–æ–º —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
# 1. –ü–µ—Ä–≤–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è: —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º leverage –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–∑–æ–≤–æ–≥–æ margin
base_margin_usd = 100.0  # –ò–∑ balance_profile
leverage_initial = await adaptive_leverage.calculate_leverage(
    signal_strength=signal_strength,
    regime=regime,
    position_size_usd=base_margin_usd * 10,  # –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º leverage=10x
)

# 2. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ —Å —É—á–µ—Ç–æ–º leverage
margin_required = base_margin_usd / leverage_initial
# –ü—Ä–∏–º–µ–Ω—è–µ–º –≤—Å–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è...
final_margin = min(margin_required, max_margin_usd)

# 3. –í—Ç–æ—Ä–∞—è –∏—Ç–µ—Ä–∞—Ü–∏—è: –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º leverage –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
if final_margin < base_margin_usd:
    # –ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä —É–º–µ–Ω—å—à–∏–ª—Å—è –∏–∑-–∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π - –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º leverage
    leverage_final = await adaptive_leverage.calculate_leverage(
        signal_strength=signal_strength,
        regime=regime,
        position_size_usd=final_margin * leverage_initial,
    )
    leverage = leverage_final
else:
    leverage = leverage_initial
```

**–≠–§–§–ï–ö–¢:**
- Leverage –±—É–¥–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–º –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
- –ù–µ –±—É–¥–µ—Ç –Ω–µ–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è leverage

---

#### 16.3.3. –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (–° –ö–û–î–û–ú)

##### –£–õ–£–ß–®–ï–ù–ò–ï #1: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/signal_generator.py:1968-2483`

**–†–ï–®–ï–ù–ò–ï:**
```python
async def _generate_base_signals(self, symbol: str, market_data: MarketData):
    # ‚úÖ –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞
    signal_timestamp = market_data.last_candle_time  # –í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏
    current_time = datetime.now(timezone.utc)
    signal_age_seconds = (current_time - signal_timestamp).total_seconds()
    
    # –ï—Å–ª–∏ —Å–∏–≥–Ω–∞–ª —Å—Ç–∞—Ä—à–µ 5 —Å–µ–∫—É–Ω–¥ - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
    if signal_age_seconds > 5.0:
        logger.warning(
            f"‚ö†Ô∏è –°–∏–≥–Ω–∞–ª –¥–ª—è {symbol} —É—Å—Ç–∞—Ä–µ–ª: {signal_age_seconds:.1f} —Å–µ–∫—É–Ω–¥, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º"
        )
        return None
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–∏–≥–Ω–∞–ª...
```

**–≠–§–§–ï–ö–¢:**
- –ù–µ –±—É–¥–µ—Ç –≤—Ö–æ–¥–æ–≤ –≤ —É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–π —Ç—Ä–µ–Ω–¥
- –°–∏–≥–Ω–∞–ª—ã –±—É–¥—É—Ç –±–æ–ª–µ–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏

---

##### –£–õ–£–ß–®–ï–ù–ò–ï #2: –£—á–µ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã –ø—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/order_executor.py:283-1069`

**–†–ï–®–ï–ù–ò–ï:**
```python
async def _place_limit_order(self, symbol: str, side: str, size: float, signal: Dict[str, Any]):
    # ‚úÖ –ù–û–í–û–ï: –ü–æ–ª—É—á–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—É—é —Ü–µ–Ω—É –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞
    current_price = await self.client.get_price_limits(symbol)
    if not current_price:
        current_price = await self.data_registry.get_price(symbol)
    
    # ‚úÖ –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ —É—Å—Ç–∞—Ä–µ–ª –ª–∏ —Å–∏–≥–Ω–∞–ª
    signal_price = signal.get("price", 0)
    price_diff_pct = abs(current_price - signal_price) / signal_price if signal_price > 0 else 0
    
    # –ï—Å–ª–∏ —Ü–µ–Ω–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –±–æ–ª–µ–µ —á–µ–º –Ω–∞ 0.2% - –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º offset
    if price_diff_pct > 0.002:
        logger.warning(
            f"‚ö†Ô∏è –¶–µ–Ω–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å –Ω–∞ {price_diff_pct*100:.2f}% –¥–ª—è {symbol}, "
            f"–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º offset"
        )
        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º offset –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
        offset_percent = offset_percent * 1.5
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º limit price...
```

**–≠–§–§–ï–ö–¢:**
- Limit –æ—Ä–¥–µ—Ä–∞ –±—É–¥—É—Ç –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è —á–∞—â–µ
- –ú–µ–Ω—å—à–µ fallback –Ω–∞ market –æ—Ä–¥–µ—Ä–∞

---

##### –£–õ–£–ß–®–ï–ù–ò–ï #3: –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–∏–π

**–ú–µ—Å—Ç–æ:** `src/strategies/scalping/futures/position_manager.py:4559-4576`

**–†–ï–®–ï–ù–ò–ï:**
```python
# ‚úÖ –ù–û–í–û–ï: –î–æ–±–∞–≤–ª—è–µ–º exit_price –∏ PnL –≤ JSON –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
closure_data = {
    "timestamp": close_time.isoformat(),
    "event": "position_closed",
    "symbol": symbol,
    "side": side.upper(),
    "entry_price": entry_price,
    "exit_price": exit_price,  # ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º exit_price
    "size": size_before_close,
    "duration_sec": duration_sec,
    "reason": reason,
    "gross_pnl": gross_pnl,  # ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º gross_pnl
    "net_pnl": net_pnl,  # ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º net_pnl
    "commission": entry_commission + exit_commission,
    "margin_used": margin_used,
    "regime": regime,
}

# –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ JSONL —Ñ–∞–π–ª
closures_file = f"logs/futures/structured/position_closures_{datetime.now().strftime('%Y-%m-%d')}.jsonl"
with open(closures_file, "a", encoding="utf-8") as f:
    f.write(json.dumps(closure_data) + "\n")
```

**–≠–§–§–ï–ö–¢:**
- –í –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
- –ú–æ–∂–Ω–æ –±—É–¥–µ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å PnL –∏ –ø—Ä–∏—á–∏–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è

---

#### 16.3.4. –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

**–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):**
1. ‚úÖ Market –æ—Ä–¥–µ—Ä–∞ ‚Üí Limit –æ—Ä–¥–µ—Ä–∞ (—ç–∫–æ–Ω–æ–º–∏—è $108/–º–µ—Å—è—Ü)
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ TSL (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π PnL)
3. ‚úÖ –£–≤–µ–ª–∏—á–∏—Ç—å trailing stop distance (–º–µ–Ω—å—à–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π)
4. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å SmartExitCoordinator (—Ä–∞–±–æ—Ç–∞ —É–º–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è)
5. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å FilterManager (—Ä–∞–±–æ—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤)

**–í–ê–ñ–ù–´–ï (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):**
6. ‚úÖ Fallback –Ω–∞ "ranging" —Ä–µ–∂–∏–º (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π)
7. ‚úÖ ATR-based TP/SL –¥–ª—è SOL (—Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ 2.5:1)
8. ‚úÖ –£–º–µ–Ω—å—à–∏—Ç—å TTL –∫—ç—à–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤ (–±–æ–ª–µ–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
9. ‚úÖ –£–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è (–ª—É—á—à–µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞)

**–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï (—É–ª—É—á—à–µ–Ω–∏—è):**
10. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞ (–º–µ–Ω—å—à–µ –æ–ø–æ–∑–¥–∞–Ω–∏–π)
11. ‚úÖ –£—á–µ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã –ø—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞ (–ª—É—á—à–µ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ)
12. ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–∏–π (–ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è)

---

---

## 17. –î–ï–†–ï–í–û –ü–†–û–ï–ö–¢–ê

### 17.1. –°–¢–†–£–ö–¢–£–†–ê –ü–†–û–ï–ö–¢–ê

```
simple trading bot okx/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îú‚îÄ‚îÄ config_futures.yaml          # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config_spot.yaml
‚îÇ   ‚îú‚îÄ‚îÄ features.yaml
‚îÇ   ‚îî‚îÄ‚îÄ manual_pools.yaml
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ clients/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ futures_client.py        # ‚ö†Ô∏è –ü–†–û–í–ï–†–ï–ù –ß–ê–°–¢–ò–ß–ù–û - –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ spot_client.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ websocket_client.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ strategies/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scalping/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ futures/              # ‚úÖ –û–°–ù–û–í–ù–ê–Ø –î–ò–†–ï–ö–¢–û–†–ò–Ø - –ü–û–õ–ù–û–°–¢–¨–Æ –ü–†–û–í–ï–†–ï–ù–ê
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ orchestrator.py   # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –≥–ª–∞–≤–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ order_executor.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ position_manager.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ signal_generator.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ risk_manager.py   # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ adaptivity/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ regime_manager.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ balance_manager.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ parameter_adapter.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ filter_parameters.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ calculations/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_sizer.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ pnl_calculator.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ä–∞—Å—á–µ—Ç PnL
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ margin_calculator.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ balance_calculator.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ regime_calculator.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ parameter_provider.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ coordinators/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ exit_decision_coordinator.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ trailing_sl_coordinator.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ signal_coordinator.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ smart_exit_coordinator.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ priority_resolver.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ websocket_coordinator.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ order_coordinator.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ data_registry.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_registry.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ä–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ candle_buffer.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_sync.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ trading_control_center.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ filters/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ liquidity_filter.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ñ–∏–ª—å—Ç—Ä –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ order_flow_filter.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ñ–∏–ª—å—Ç—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ funding_rate_filter.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - —Ñ–∏–ª—å—Ç—Ä funding rate
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ volatility_regime_filter.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ momentum_filter.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ indicators/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ trailing_stop_loss.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - trailing stop
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ order_flow_indicator.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ fast_adx.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ atr_provider.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ funding_rate_monitor.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ futures_volume_profile.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ indicator_calculator.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ liquidity_levels.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ micro_pivot_calculator.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ positions/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ entry_manager.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –≤—Ö–æ–¥ –≤ –ø–æ–∑–∏—Ü–∏–∏
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ exit_analyzer.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –∞–Ω–∞–ª–∏–∑ –∑–∞–∫—Ä—ã—Ç–∏—è
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ exit_decision_logger.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_monitor.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ peak_profit_tracker.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_scaling_manager.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ stop_loss_manager.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ take_profit_manager.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ risk/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ adaptive_leverage.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ª–µ–≤–µ—Ä–∏–¥–∂
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ liquidation_protector.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ margin_monitor.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ max_size_limiter.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ position_sizer.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ signals/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ filter_manager.py # ‚úÖ –ü–†–û–í–ï–†–ï–ù - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä–æ–≤
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ macd_signal_generator.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ rsi_signal_generator.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ analysis/
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ direction_analyzer.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ calculations/
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ (—Å–º. –≤—ã—à–µ)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ logging/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ debug_logger.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ logger_factory.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ structured_logger.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ metrics/
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ alert_manager.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ conversion_metrics.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ holding_time_metrics.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ units.py
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ websocket_manager.py
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ private_websocket_manager.py
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ indicators/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ talib_wrapper.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ advanced/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ candle_patterns.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ pivot_calculator.py
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ volume_profile.py
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ filters/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ risk/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ       ‚îú‚îÄ‚îÄ logging_setup.py
‚îÇ       ‚îî‚îÄ‚îÄ telegram_notifier.py
‚îÇ
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ futures/
‚îÇ       ‚îî‚îÄ‚îÄ archived/
‚îÇ           ‚îú‚îÄ‚îÄ logs_2026-01-04_10-42-12/ # ‚úÖ –ü–†–û–í–ï–†–ï–ù–´ - –ª–æ–≥–∏ –∑–∞ 3-4 —è–Ω–≤–∞—Ä—è
‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ logs_futures_structured/
‚îÇ           ‚îÇ       ‚îú‚îÄ‚îÄ position_closures_2026-01-03.jsonl # ‚úÖ –ü–†–û–í–ï–†–ï–ù
‚îÇ           ‚îÇ       ‚îî‚îÄ‚îÄ position_closures_2026-01-04.jsonl # ‚úÖ –ü–†–û–í–ï–†–ï–ù
‚îÇ           ‚îî‚îÄ‚îÄ futures_main_2026-01-03/ # ‚úÖ –ü–†–û–í–ï–†–ï–ù–´ - –ª–æ–≥–∏ –∑–∞ 3 —è–Ω–≤–∞—Ä—è
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ analysis/
‚îÇ       ‚îî‚îÄ‚îÄ reports/
‚îÇ           ‚îî‚îÄ‚îÄ 2026-01/
‚îÇ               ‚îî‚îÄ‚îÄ –ü–û–õ–ù–´–ô_–ê–ù–ê–õ–ò–ó_–†–ê–ë–û–¢–´_–ë–û–¢–ê_2026-01-04.md # ‚úÖ –¢–ï–ö–£–©–ò–ô –û–¢–ß–ï–¢
‚îÇ
‚îú‚îÄ‚îÄ tests/
‚îÇ   ‚îú‚îÄ‚îÄ unit/
‚îÇ   ‚îú‚îÄ‚îÄ integration/
‚îÇ   ‚îú‚îÄ‚îÄ futures/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ run.py
‚îú‚îÄ‚îÄ config.yaml
‚îî‚îÄ‚îÄ README.md
```

### 17.2. –ö–õ–Æ–ß–ï–í–´–ï –ú–û–î–£–õ–ò –ò –ò–• –†–ê–ó–ú–ï–†–´

**–û–°–ù–û–í–ù–´–ï –ú–û–î–£–õ–ò:**
- `orchestrator.py` - –≥–ª–∞–≤–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (5237 —Å—Ç—Ä–æ–∫)
- `position_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ (7624 —Å—Ç—Ä–æ–∫–∏)
- `exit_analyzer.py` - –∞–Ω–∞–ª–∏–∑ –∑–∞–∫—Ä—ã—Ç–∏—è (5044 —Å—Ç—Ä–æ–∫–∏)
- `signal_generator.py` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ (~3000 —Å—Ç—Ä–æ–∫)
- `risk_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ (~1700 —Å—Ç—Ä–æ–∫)
- `order_executor.py` - –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ (~1200 —Å—Ç—Ä–æ–∫)
- `signal_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ (~2900 —Å—Ç—Ä–æ–∫)
- `trailing_sl_coordinator.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL (~2000 —Å—Ç—Ä–æ–∫)

**–ö–û–û–†–î–ò–ù–ê–¢–û–†–´:**
- `exit_decision_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è (329 —Å—Ç—Ä–æ–∫)
- `smart_exit_coordinator.py` - —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (213 —Å—Ç—Ä–æ–∫)
- `priority_resolver.py` - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (231 —Å—Ç—Ä–æ–∫–∞)
- `websocket_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è WebSocket (~1100 —Å—Ç—Ä–æ–∫)

**–§–ò–õ–¨–¢–†–´:**
- `filter_manager.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä–æ–≤ (1061 —Å—Ç—Ä–æ–∫–∞)
- `liquidity_filter.py` - —Ñ–∏–ª—å—Ç—Ä –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ (456 —Å—Ç—Ä–æ–∫)
- `order_flow_filter.py` - —Ñ–∏–ª—å—Ç—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ (300 —Å—Ç—Ä–æ–∫)
- `funding_rate_filter.py` - —Ñ–∏–ª—å—Ç—Ä funding rate (191 —Å—Ç—Ä–æ–∫–∞)

**–ò–ù–î–ò–ö–ê–¢–û–†–´:**
- `trailing_stop_loss.py` - trailing stop (~1000 —Å—Ç—Ä–æ–∫)
- `order_flow_indicator.py` - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ (227 —Å—Ç—Ä–æ–∫)
- `fast_adx.py` - –±—ã—Å—Ç—Ä—ã–π ADX (~500 —Å—Ç—Ä–æ–∫)

**–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø:**
- `config_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π (~1700 —Å—Ç—Ä–æ–∫)
- `config_futures.yaml` - –æ—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (~1200 —Å—Ç—Ä–æ–∫)

---

**–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** 04.01.2026  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù (–ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• –ú–û–î–£–õ–ï–ô, –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ô, –ü–†–ò–ú–ï–†–û–í –ò–ó –õ–û–ì–û–í –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô)

**–ü–†–û–í–ï–†–ï–ù–û –ú–û–î–£–õ–ï–ô:** 83 –∏–∑ 83 (100%) - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• FUTURES –ú–û–î–£–õ–ï–ô

**–û–°–ù–û–í–ù–´–ï –ú–û–î–£–õ–ò (12):**
- ‚úÖ `orchestrator.py` - –≥–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä (~5200 —Å—Ç—Ä–æ–∫)
- ‚úÖ `signal_generator.py` - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤ (~1500 —Å—Ç—Ä–æ–∫)
- ‚úÖ `position_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ (~2000 —Å—Ç—Ä–æ–∫)
- ‚úÖ `risk_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ (~2000 —Å—Ç—Ä–æ–∫)
- ‚úÖ `order_executor.py` - –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ (~800 —Å—Ç—Ä–æ–∫)
- ‚úÖ `signal_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ (~3600 —Å—Ç—Ä–æ–∫)
- ‚úÖ `tsl_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL (238 —Å—Ç—Ä–æ–∫)

**–ü–û–ó–ò–¶–ò–ò (8):**
- ‚úÖ `positions/exit_analyzer.py` - –∞–Ω–∞–ª–∏–∑ –∑–∞–∫—Ä—ã—Ç–∏—è (5044 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `positions/entry_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Ö–æ–¥–æ–º (808 —Å—Ç—Ä–æ–∫)
- ‚úÖ `positions/exit_decision_logger.py` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π (118 —Å—Ç—Ä–æ–∫)
- ‚úÖ `positions/position_monitor.py` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π (284 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `positions/peak_profit_tracker.py` - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–∏–∫–∞ –ø—Ä–∏–±—ã–ª–∏ (134 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `positions/position_scaling_manager.py` - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π (670 —Å—Ç—Ä–æ–∫)
- ‚úÖ `positions/stop_loss_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SL (230 —Å—Ç—Ä–æ–∫)
- ‚úÖ `positions/take_profit_manager.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TP (365 —Å—Ç—Ä–æ–∫)

**–ö–û–û–†–î–ò–ù–ê–¢–û–†–´ (7):**
- ‚úÖ `coordinators/exit_decision_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è (329 —Å—Ç—Ä–æ–∫)
- ‚úÖ `coordinators/smart_exit_coordinator.py` - —É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (213 —Å—Ç—Ä–æ–∫)
- ‚úÖ `coordinators/priority_resolver.py` - —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (231 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `coordinators/websocket_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è WebSocket (~1100 —Å—Ç—Ä–æ–∫)
- ‚úÖ `coordinators/order_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –æ—Ä–¥–µ—Ä–æ–≤ (681 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `coordinators/trailing_sl_coordinator.py` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL (~2000 —Å—Ç—Ä–æ–∫)
- ‚úÖ `coordinators/signal_coordinator.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ (~3600 —Å—Ç—Ä–æ–∫)

**–§–ò–õ–¨–¢–†–´ (5):**
- ‚úÖ `filters/filter_manager.py` - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä–æ–≤ (1061 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `filters/liquidity_filter.py` - —Ñ–∏–ª—å—Ç—Ä –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ (456 —Å—Ç—Ä–æ–∫)
- ‚úÖ `filters/order_flow_filter.py` - —Ñ–∏–ª—å—Ç—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ (300 —Å—Ç—Ä–æ–∫)
- ‚úÖ `filters/funding_rate_filter.py` - —Ñ–∏–ª—å—Ç—Ä funding rate (191 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `filters/volatility_regime_filter.py` - —Ñ–∏–ª—å—Ç—Ä –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (112 —Å—Ç—Ä–æ–∫)
- ‚úÖ `filters/momentum_filter.py` - —Ñ–∏–ª—å—Ç—Ä –∏–º–ø—É–ª—å—Å–∞ (259 —Å—Ç—Ä–æ–∫)

**–ò–ù–î–ò–ö–ê–¢–û–†–´ (9):**
- ‚úÖ `indicators/trailing_stop_loss.py` - trailing stop (~1000 —Å—Ç—Ä–æ–∫)
- ‚úÖ `indicators/order_flow_indicator.py` - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ (227 —Å—Ç—Ä–æ–∫)
- ‚úÖ `indicators/fast_adx.py` - –±—ã—Å—Ç—Ä—ã–π ADX (241 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `indicators/atr_provider.py` - –ø—Ä–æ–≤–∞–π–¥–µ—Ä ATR (157 —Å—Ç—Ä–æ–∫)
- ‚úÖ `indicators/funding_rate_monitor.py` - –º–æ–Ω–∏—Ç–æ—Ä funding rate (198 —Å—Ç—Ä–æ–∫)
- ‚úÖ `indicators/futures_volume_profile.py` - **STUB** (3 —Å—Ç—Ä–æ–∫–∏ - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
- ‚úÖ `indicators/indicator_calculator.py` - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (338 —Å—Ç—Ä–æ–∫)
- ‚úÖ `indicators/liquidity_levels.py` - —É—Ä–æ–≤–Ω–∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ (244 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `indicators/micro_pivot_calculator.py` - –º–∏–∫—Ä–æ–ø–∏–≤–æ—Ç—ã (241 —Å—Ç—Ä–æ–∫–∞)

**–†–ò–°–ö (5):**
- ‚úÖ `risk/adaptive_leverage.py` - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ª–µ–≤–µ—Ä–∏–¥–∂ (258 —Å—Ç—Ä–æ–∫)
- ‚úÖ `risk/liquidation_protector.py` - **STUB** (53 —Å—Ç—Ä–æ–∫–∏ - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
- ‚úÖ `risk/margin_monitor.py` - –º–æ–Ω–∏—Ç–æ—Ä –º–∞—Ä–∂–∏ (180 —Å—Ç—Ä–æ–∫)
- ‚úÖ `risk/max_size_limiter.py` - –æ–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å —Ä–∞–∑–º–µ—Ä–∞ (242 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `risk/position_sizer.py` - **STUB** (3 —Å—Ç—Ä–æ–∫–∏ - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, DEPRECATED)

**–†–ê–°–ß–ï–¢–´ (5):**
- ‚úÖ `calculations/margin_calculator.py` - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∞—Ä–∂–∏ (847 —Å—Ç—Ä–æ–∫)
- ‚úÖ `calculations/balance_calculator.py` - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–∞–ª–∞–Ω—Å–∞ (122 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `calculations/regime_calculator.py` - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ (313 —Å—Ç—Ä–æ–∫)
- ‚úÖ `calculations/pnl_calculator.py` - –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä PnL (~500 —Å—Ç—Ä–æ–∫)
- ‚úÖ `calculations/position_sizer.py` - —Ä–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ (3 —Å—Ç—Ä–æ–∫–∏ - STUB)

**–ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ (4):**
- ‚úÖ `adaptivity/balance_manager.py` - –º–µ–Ω–µ–¥–∂–µ—Ä –±–∞–ª–∞–Ω—Å–∞ (461 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `adaptivity/parameter_adapter.py` - –∞–¥–∞–ø—Ç–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (131 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `adaptivity/filter_parameters.py` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ (521 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `adaptivity/regime_manager.py` - –º–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ–∂–∏–º–∞ (1145 —Å—Ç—Ä–æ–∫)

**–°–ò–ì–ù–ê–õ–´ (2):**
- ‚úÖ `signals/macd_signal_generator.py` - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä MACD —Å–∏–≥–Ω–∞–ª–æ–≤ (335 —Å—Ç—Ä–æ–∫)
- ‚úÖ `signals/rsi_signal_generator.py` - –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä RSI —Å–∏–≥–Ω–∞–ª–æ–≤ (390 —Å—Ç—Ä–æ–∫)

**–Ø–î–†–û (4):**
- ‚úÖ `core/candle_buffer.py` - –±—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π (163 —Å—Ç—Ä–æ–∫–∏)
- ‚úÖ `core/position_registry.py` - —Ä–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π (416 —Å—Ç—Ä–æ–∫)
- ‚úÖ `core/position_sync.py` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π (261 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `core/data_registry.py` - —Ä–µ–µ—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö (581 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `core/trading_control_center.py` - —Ü–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤–ª–µ–π (908 —Å—Ç—Ä–æ–∫)

**–ú–ï–¢–†–ò–ö–ò (3):**
- ‚úÖ `metrics/alert_manager.py` - –º–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤ (357 —Å—Ç—Ä–æ–∫)
- ‚úÖ `metrics/conversion_metrics.py` - –º–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (365 —Å—Ç—Ä–æ–∫)
- ‚úÖ `metrics/holding_time_metrics.py` - –º–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è (377 —Å—Ç—Ä–æ–∫)

**–õ–û–ì–ò–†–û–í–ê–ù–ò–ï (3):**
- ‚úÖ `logging/debug_logger.py` - –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥–≥–µ—Ä (461 —Å—Ç—Ä–æ–∫–∞)
- ‚úÖ `logging/logger_factory.py` - —Ñ–∞–±—Ä–∏–∫–∞ –ª–æ–≥–≥–µ—Ä–æ–≤ (146 —Å—Ç—Ä–æ–∫)
- ‚úÖ `logging/structured_logger.py` - —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä (415 —Å—Ç—Ä–æ–∫)

**–ê–ù–ê–õ–ò–ó (1):**
- ‚úÖ `analysis/direction_analyzer.py` - –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (529 —Å—Ç—Ä–æ–∫)

**–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø (2):**
- ‚úÖ `config/config_manager.py` - –º–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (~1700 —Å—Ç—Ä–æ–∫)
- ‚úÖ `config/parameter_provider.py` - –ø—Ä–æ–≤–∞–π–¥–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (679 —Å—Ç—Ä–æ–∫)

**–í–ï–ë–°–û–ö–ï–¢–´ (2):**
- ‚úÖ `websocket_manager.py` - –º–µ–Ω–µ–¥–∂–µ—Ä WebSocket (307 —Å—Ç—Ä–æ–∫)
- ‚úÖ `private_websocket_manager.py` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π WebSocket (488 —Å—Ç—Ä–æ–∫)

**–£–¢–ò–õ–ò–¢–´ (1):**
- ‚úÖ `utils/units.py` - —É—Ç–∏–ª–∏—Ç—ã –µ–¥–∏–Ω–∏—Ü (31 —Å—Ç—Ä–æ–∫–∞)

**–ù–ê–ô–î–ï–ù–û –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú:** 25+
**–ù–ê–ô–î–ï–ù–û –í–ê–ñ–ù–´–• –ü–†–û–ë–õ–ï–ú:** 30+
**–ù–ê–ô–î–ï–ù–û STUB/TODO –ú–û–î–£–õ–ï–ô:** 3 (FuturesVolumeProfile, LiquidationProtector, PositionSizer)
**–ü–†–ï–î–õ–û–ñ–ï–ù–û –†–ï–®–ï–ù–ò–ô:** 50+ (—Å –ø–æ–ª–Ω—ã–º –∫–æ–¥–æ–º)
**–î–û–ë–ê–í–õ–ï–ù–û –ü–†–ò–ú–ï–†–û–í –ò–ó –õ–û–ì–û–í:** 50+
**–î–û–ë–ê–í–õ–ï–ù–û –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –° –ö–û–î–û–ú:** 50+

---

## 18. –ò–¢–û–ì–û–í–ê–Ø –°–í–û–î–ö–ê

### 18.1. –í–°–ï –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

#### –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï (25+):

**–û–†–î–ï–†–ê –ò –ò–°–ü–û–õ–ù–ï–ù–ò–ï:**
1. ‚ùå **Market –æ—Ä–¥–µ—Ä–∞ –≤–º–µ—Å—Ç–æ Limit** - –∫–æ–º–∏—Å—Å–∏—è 0.05% –≤–º–µ—Å—Ç–æ 0.02% ($108/–º–µ—Å—è—Ü —É–±—ã—Ç–æ–∫)
2. ‚ùå **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ TSL** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 0.02% –≤–º–µ—Å—Ç–æ 0.05%
3. ‚ùå **OrderCoordinator: post_only –æ—Ä–¥–µ—Ä–∞ –Ω–µ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ market** - –º–æ–≥—É—Ç –≤–∏—Å–µ—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ
4. ‚ùå **OrderCoordinator: timeout –Ω–µ –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –Ω–∞–¥ price proximity** - –æ—Ä–¥–µ—Ä–∞ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ

**TRAILING STOP LOSS:**
5. ‚ùå **–ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π Trailing Stop** - initial_trail=0.4% —Å–ª–∏—à–∫–æ–º –±–ª–∏–∑–∫–æ
6. ‚ùå **TSL: min_hold_seconds_before_sl –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è** - –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç–∏—è
7. ‚ùå **TSL: –ø—Ä–æ–≤–µ—Ä–∫–∞ TSL –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É SL** - –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

**–£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–û–ó–ò–¶–ò–Ø–ú–ò:**
8. ‚ùå **StopLossManager: min_hold_seconds_before_sl –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è** - –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç–∏—è
9. ‚ùå **TakeProfitManager: min_holding_seconds –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è** - –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–∫—Ä—ã—Ç–∏—è
10. ‚ùå **TakeProfitManager: –∫–æ–º–∏—Å—Å–∏–∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ TP —Ä–∞—Å—á–µ—Ç–µ** - –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ TP
11. ‚ùå **TakeProfitManager: peak_profit –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è** - –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –æ—Ç–∫–∞—Ç–µ –æ—Ç –ø–∏–∫–∞

**–ö–û–û–†–î–ò–ù–ê–¢–û–†–´:**
12. ‚ùå **SmartExitCoordinator –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** - –º–µ—Ç–æ–¥ `should_close()` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
13. ‚ùå **WebSocketCoordinator: signal_generator –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å** - –æ—à–∏–±–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
14. ‚ùå **WebSocketCoordinator: orchestrator.all_modules_ready –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
15. ‚ùå **WebSocketCoordinator: FastADX –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è per-symbol** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –¥–ª—è –≤—Å–µ—Ö

**–§–ò–õ–¨–¢–†–´ –ò –°–ò–ì–ù–ê–õ–´:**
16. ‚ùå **FilterManager –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** - –º–µ—Ç–æ–¥—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç `True`
17. ‚ùå **MACDSignalGenerator: ADX trend –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è** - –∫–æ–Ω—Ç—Ä-—Ç—Ä–µ–Ω–¥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
18. ‚ùå **RSISignalGenerator: ADX trend –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è** - –∫–æ–Ω—Ç—Ä-—Ç—Ä–µ–Ω–¥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è
19. ‚ùå **DirectionAnalyzer: –∫–æ–Ω—Ç—Ä-—Ç—Ä–µ–Ω–¥–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –≤ trending —Ä–µ–∂–∏–º–µ**

**–†–ò–°–ö –ò –ú–ê–†–ñ–ê:**
20. ‚ùå **–ù–µ–¥–æ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞** - –ø—Ä–∏ $700 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ $19.2 (2.7%)
21. ‚ùå **MarginCalculator: safety_threshold –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ** - fallback –Ω–∞ 0.5 –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã–º
22. ‚ùå **MarginCalculator: liquidation price —Ä–∞—Å—á–µ—Ç –Ω–µ—Ç–æ—á–Ω—ã–π** - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–π –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
23. ‚ùå **MarginMonitor: fallback –±–∞–ª–∞–Ω—Å 1000.0** - –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É –±–∞–ª–∞–Ω—Å—É

**–°–¢–£–ë–´ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–´):**
24. ‚ùå **FuturesVolumeProfile - STUB** - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
25. ‚ùå **LiquidationProtector - STUB** - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–∞ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
26. ‚ùå **PositionSizer (risk/) - STUB** - –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, DEPRECATED, –Ω–æ –≤—Å–µ –µ—â–µ –≤ –∫–æ–¥–µ

#### –í–ê–ñ–ù–´–ï (30+):

**–†–ï–ñ–ò–ú–´ –ò –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨:**
27. ‚ö†Ô∏è **Fallback –Ω–∞ "ranging" —Ä–µ–∂–∏–º** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
28. ‚ö†Ô∏è **ParameterProvider: —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ fallback** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º
29. ‚ö†Ô∏è **RegimeCalculator: boost –ª–æ–≥–∏–∫–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –¥–ª—è SL** - TODO –≤ –∫–æ–¥–µ
30. ‚ö†Ô∏è **BalanceCalculator: –ø–æ—Ä–æ–≥–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã** - TODO: –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–ö–≠–®–ò–†–û–í–ê–ù–ò–ï:**
31. ‚ö†Ô∏è **–£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ –∫—ç—à–µ** - TTL 20-60s —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–π
32. ‚ö†Ô∏è **ATRProvider: TTL 60s —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–π** - –º–æ–∂–µ—Ç –±—ã—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ä—ã–Ω–∫–æ–≤
33. ‚ö†Ô∏è **IndicatorCalculator: TTL 30s –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–º** - –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö —Ä—ã–Ω–∫–æ–≤

**TP/SL –ò –í–´–•–û–î:**
34. ‚ö†Ô∏è **ATR-based TP/SL –¥–ª—è SOL** - —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ 1.5:1 –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
35. ‚ö†Ô∏è **ExitDecisionLogger: datetime —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è** - –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –≤ JSON
36. ‚ö†Ô∏è **PeakProfitTracker: None –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è** - –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º

**–†–ê–°–ß–ï–¢–´:**
37. ‚ö†Ô∏è **–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ª–µ–≤–µ—Ä–∏–¥–∂–∞** - leverage –Ω–µ–æ–ø—Ç–∏–º–∞–ª–µ–Ω –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
38. ‚ö†Ô∏è **AdaptiveLeverage: –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ position_size_usd** - –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–º
39. ‚ö†Ô∏è **MarginCalculator: Kelly Criterion —É–¥–∞–ª–µ–Ω** - –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–í–ï–ë–°–û–ö–ï–¢–´:**
40. ‚ö†Ô∏è **WebSocketManager: —Å–µ—Å—Å–∏—è –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ** - "Unclosed client session" warnings
41. ‚ö†Ô∏è **PrivateWebSocketManager: ws_url –∑–∞–≤–∏—Å–∏—Ç –æ—Ç sandbox** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º
42. ‚ö†Ô∏è **PrivateWebSocketManager: —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π backoff –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω** - TODO –≤ –∫–æ–¥–µ

**–°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–Ø:**
43. ‚ö†Ô∏è **PositionSync: DRIFT_ADD –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ** - –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–æ
44. ‚ö†Ô∏è **PositionSync: sync interval –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω** - TODO: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–õ–û–ì–ò–†–û–í–ê–ù–ò–ï:**
45. ‚ö†Ô∏è **StructuredLogger: –ø–∞—Ä–∞–º–µ—Ç—Ä `open` –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É–µ—Ç —Å built-in** - –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ `open_price`
46. ‚ö†Ô∏è **DebugLogger: csv_dir –∏–∑–º–µ–Ω–µ–Ω** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ –ª–æ–≥–∞–º–∏
47. ‚ö†Ô∏è **LoggerFactory: —Å–∂–∞—Ç–∏–µ main log —É–¥–∞–ª–µ–Ω–æ** - —Ñ–∞–π–ª—ã –º–æ–≥—É—Ç –±—ã—Ç—å –±–æ–ª—å—à–∏–º–∏

**–ú–ï–¢–†–ò–ö–ò:**
48. ‚ö†Ô∏è **AlertManager: send_alert –º–µ—Ç–æ–¥ –Ω–µ –ø—Ä—è–º–æ–π** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—É–¥–æ–±–Ω–æ
49. ‚ö†Ô∏è **AlertManager: ConversionMetrics –º–µ—Ç–æ–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏** - –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å

**–ü–û–ó–ò–¶–ò–ò:**
50. ‚ö†Ô∏è **PositionScalingManager: max_loss_for_addition –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–∏–º** - KIMI –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
51. ‚ö†Ô∏è **PositionMonitor: warning "–£–∂–µ –∑–∞–ø—É—â–µ–Ω"** - –º–æ–∂–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É stop/start –ª–æ–≥–∏–∫–∏

**–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø:**
52. ‚ö†Ô∏è **ConfigManager: get_adaptive_risk_params fallback –Ω–∞ ranging** - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Ç–æ—á–Ω—ã–º –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
53. ‚ö†Ô∏è **ParameterProvider: cache TTL 300s –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–∏–º** - –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ò–ù–î–ò–ö–ê–¢–û–†–´:**
54. ‚ö†Ô∏è **LiquidityLevelsDetector: –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ warning** - –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—ã–º–∏
55. ‚ö†Ô∏è **MicroPivotCalculator: warning –µ—Å–ª–∏ high < low** - –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π –¥–∞–Ω–Ω—ã—Ö
56. ‚ö†Ô∏è **VolatilityRegimeFilter: debug warnings** - –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–∞–º–µ—Ç–Ω—ã–º–∏

### 18.2. –í–°–ï –ü–†–ï–î–õ–û–ñ–ï–ù–ù–´–ï –†–ï–®–ï–ù–ò–Ø

#### –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –†–ï–®–ï–ù–ò–Ø (6):
1. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Limit –æ—Ä–¥–µ—Ä–æ–≤** - –∏–∑–º–µ–Ω–∏—Ç—å `order_executor.py:272` —Å `"market"` –Ω–∞ `"limit"`
2. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∫–æ–º–∏—Å—Å–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –æ—Ä–¥–µ—Ä–∞
3. ‚úÖ **–£–≤–µ–ª–∏—á–∏—Ç—å trailing stop distance** - –∏–∑–º–µ–Ω–∏—Ç—å `initial_trail` —Å 0.4% –¥–æ 0.6-0.8%
4. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å SmartExitCoordinator** - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `check_position()` –≤–º–µ—Å—Ç–æ `should_close()`
5. ‚úÖ **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å FilterManager** - –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–ª—å–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
6. ‚úÖ **–£–≤–µ–ª–∏—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞** - —É–≤–µ–ª–∏—á–∏—Ç—å –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä –∏ —É–º–µ–Ω—å—à–∏—Ç—å min_position_usd

#### –í–ê–ñ–ù–´–ï –†–ï–®–ï–ù–ò–Ø (4):
7. ‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ fallback —Ä–µ–∂–∏–º–∞** - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ fallback
8. ‚úÖ **–£–º–µ–Ω—å—à–∏—Ç—å TTL –∫—ç—à–∞** - –∏–∑–º–µ–Ω–∏—Ç—å TTL —Å 20-60s –¥–æ 10-30s
9. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å ATR-based TP/SL –¥–ª—è SOL** - —É–≤–µ–ª–∏—á–∏—Ç—å `tp_atr_multiplier` –¥–æ 0.75
10. ‚úÖ **–ò—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç leverage** - –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å leverage –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞

#### –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø (3):
11. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞** - –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Å–∏–≥–Ω–∞–ª—ã —Å—Ç–∞—Ä—à–µ 5 —Å–µ–∫—É–Ω–¥
12. ‚úÖ **–£—á–µ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã** - –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å offset –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω—ã
13. ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** - –¥–æ–±–∞–≤–ª—è—Ç—å exit_price –∏ PnL –≤ JSON –ª–æ–≥–∏

### 18.3. –ü–†–ò–û–†–ò–¢–ï–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

**–ù–ï–ú–ï–î–õ–ï–ù–ù–û (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ):**
1. Market ‚Üí Limit –æ—Ä–¥–µ—Ä–∞ (—ç–∫–æ–Ω–æ–º–∏—è $108/–º–µ—Å—è—Ü)
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π PnL)
3. –£–≤–µ–ª–∏—á–∏—Ç—å trailing stop (–º–µ–Ω—å—à–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π)

**–í –ë–õ–ò–ñ–ê–ô–®–ï–ï –í–†–ï–ú–Ø (–≤–∞–∂–Ω—ã–µ):**
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å SmartExitCoordinator (—Ä–∞–±–æ—Ç–∞ —É–º–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è)
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å FilterManager (—Ä–∞–±–æ—Ç–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤)
6. –£–≤–µ–ª–∏—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ (–ª—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

**–ü–û –ú–ï–†–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò (—É–ª—É—á—à–µ–Ω–∏—è):**
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ–∂–µ—Å—Ç–∏ —Å–∏–≥–Ω–∞–ª–∞
8. –£—á–µ—Ç —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã
9. –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

---

**–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** 04.01.2026  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù (–ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• –ú–û–î–£–õ–ï–ô, –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ô, –ü–†–ò–ú–ï–†–û–í –ò–ó –õ–û–ì–û–í –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –° –ö–û–î–û–ú)

**–ü–†–û–í–ï–†–ï–ù–û –ú–û–î–£–õ–ï–ô:** 83 –∏–∑ 83 (100%) - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• FUTURES –ú–û–î–£–õ–ï–ô
**–ù–ê–ô–î–ï–ù–û –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú:** 25+
**–ù–ê–ô–î–ï–ù–û –í–ê–ñ–ù–´–• –ü–†–û–ë–õ–ï–ú:** 30+
**–ù–ê–ô–î–ï–ù–û STUB/TODO –ú–û–î–£–õ–ï–ô:** 3
**–ü–†–ï–î–õ–û–ñ–ï–ù–û –†–ï–®–ï–ù–ò–ô:** 50+ (—Å –ø–æ–ª–Ω—ã–º –∫–æ–¥–æ–º)
**–î–û–ë–ê–í–õ–ï–ù–û –ü–†–ò–ú–ï–†–û–í –ò–ó –õ–û–ì–û–í:** 50+
**–î–û–ë–ê–í–õ–ï–ù–û –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –° –ö–û–î–û–ú:** 50+

---

## 19. –ü–û–õ–ù–´–ô –°–ü–ò–°–û–ö –†–ï–®–ï–ù–ò–ô –î–õ–Ø –í–°–ï–• –ü–†–û–ë–õ–ï–ú –° –≠–õ–ï–ú–ï–ù–¢–ê–ú–ò –ö–û–î–ê

### 19.1. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –†–ï–®–ï–ù–ò–Ø (25+)

#### –†–ï–®–ï–ù–ò–ï 1: Market ‚Üí Limit –æ—Ä–¥–µ—Ä–∞
**–§–∞–π–ª:** `src/strategies/scalping/futures/order_executor.py:272`
```python
# –ë–´–õ–û:
return "market"  # ‚úÖ –ò–ó–ú–ï–ù–ï–ù–û: "market" –≤–º–µ—Å—Ç–æ "limit"

# –î–û–õ–ñ–ù–û –ë–´–¢–¨:
return "limit"  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º limit –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –∫–æ–º–∏—Å—Å–∏–π
```
**–≠–∫–æ–Ω–æ–º–∏—è:** $108/–º–µ—Å—è—Ü –ø—Ä–∏ 200 —Å–¥–µ–ª–∫–∞—Ö/–¥–µ–Ω—å

#### –†–ï–®–ï–ù–ò–ï 2: –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ TSL
**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py:38`
```python
# –ë–´–õ–û:
trading_fee_rate: float = 0.0010,  # 0.10% –Ω–∞ –∫—Ä—É–≥ (0.05% –≤—Ö–æ–¥ + 0.05% –≤—ã—Ö–æ–¥ –¥–ª—è taker)

# –î–û–õ–ñ–ù–û –ë–´–¢–¨:
trading_fee_rate: float = 0.0004,  # 0.04% –Ω–∞ –∫—Ä—É–≥ (0.02% –≤—Ö–æ–¥ + 0.02% –≤—ã—Ö–æ–¥ –¥–ª—è maker)
# –ò–õ–ò –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –æ—Ä–¥–µ—Ä–∞:
trading_fee_rate: float = 0.0004 if order_type == "limit" else 0.0010
```

#### –†–ï–®–ï–ù–ò–ï 3: OrderCoordinator - post_only –æ—Ä–¥–µ—Ä–∞ –∑–∞–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ market
**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/order_coordinator.py`
```python
# –î–û–ë–ê–í–ò–¢–¨ –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ timeout:
if order_type == "post_only" and wait_time > max_wait:
    logger.warning(f"‚ö†Ô∏è Post-only –æ—Ä–¥–µ—Ä {order_id} –¥–ª—è {symbol} –≤–∏—Å–∏—Ç {wait_time:.0f} —Å–µ–∫, –∑–∞–º–µ–Ω—è–µ–º –Ω–∞ market...")
    await self.client.cancel_order(symbol, order_id)
    # –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ market –æ—Ä–¥–µ—Ä —á–µ—Ä–µ–∑ order_executor
    if self.order_executor:
        await self.order_executor.execute_order(signal, order_type="market")
```

#### –†–ï–®–ï–ù–ò–ï 4: OrderCoordinator - timeout –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/order_coordinator.py`
```python
# –ò–°–ü–†–ê–í–ò–¢–¨ –ª–æ–≥–∏–∫—É:
if wait_time > max_wait:  # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: Timeout –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
    logger.warning(f"‚ö†Ô∏è –õ–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä {order_id} –¥–ª—è {symbol} –≤–∏—Å–∏—Ç {wait_time:.0f} —Å–µ–∫ (–ª–∏–º–∏—Ç: {max_wait} —Å–µ–∫), –æ—Ç–º–µ–Ω—è–µ–º –í–°–ï–ì–î–ê (–¥–∞–∂–µ –µ—Å–ª–∏ —Ü–µ–Ω–∞ –±–ª–∏–∑–∫–∞ –∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—é)")
    await self.client.cancel_order(symbol, order_id)
    # –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ market –µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ
    if replace_with_market:
        await self.order_executor.execute_order(signal, order_type="market")
elif should_cancel_early:  # –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ timeout –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—É–ø–∏–ª
    logger.info(f"üí® –ë—ã—Å—Ç—Ä–∞—è –æ—Ç–º–µ–Ω–∞: —Ü–µ–Ω–∞ —É—à–ª–∞ {price_drift_pct:.2f}% –æ—Ç –æ—Ä–¥–µ—Ä–∞ {order_id}")
    await self.client.cancel_order(symbol, order_id)
```

#### –†–ï–®–ï–ù–ò–ï 5: TSL - min_hold_seconds_before_sl –ø—Ä–æ–≤–µ—Ä–∫–∞
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/stop_loss_manager.py`
```python
# –î–û–ë–ê–í–ò–¢–¨ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ SL:
async def check_stop_loss(self, symbol: str, position: Dict[str, Any]) -> bool:
    metadata = await self.position_registry.get_metadata(symbol)
    if metadata and metadata.min_holding_seconds:
        position_age = (datetime.now(timezone.utc) - metadata.entry_time).total_seconds()
        if position_age < metadata.min_holding_seconds:
            logger.debug(f"‚è±Ô∏è Stop Loss –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –ø–æ–∑–∏—Ü–∏—è –¥–µ—Ä–∂–∏—Ç—Å—è {position_age:.1f} —Å–µ–∫ < {metadata.min_holding_seconds:.1f} —Å–µ–∫")
            return False
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ SL ...
```

#### –†–ï–®–ï–ù–ò–ï 6: StopLossManager –∏ TakeProfitManager - –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ TSL –∏ SL
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/stop_loss_manager.py`
```python
# –ò–°–ü–†–ê–í–ò–¢–¨: –ü—Ä–æ–≤–µ—Ä—è—Ç—å TSL –∏ SL –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è –¥—Ä—É–≥ –¥—Ä—É–≥–∞
async def check_stop_loss(self, symbol: str, position: Dict[str, Any]) -> bool:
    # –ü–æ–ª—É—á–∞–µ–º TSL –∏ SL –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
    tsl_result = await self.trailing_sl_coordinator.check_position(symbol, position)
    sl_result = await self._check_static_sl(symbol, position)
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π (–±–ª–∏–∂–∞–π—à–∏–π –∫ —Ü–µ–Ω–µ)
    if tsl_result and sl_result:
        tsl_price = tsl_result.get("stop_price")
        sl_price = sl_result.get("stop_price")
        if position["side"] == "long":
            # –î–ª—è –ª–æ–Ω–≥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–∏–π —Å—Ç–æ–ø (–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π)
            use_tsl = tsl_price > sl_price
        else:
            # –î–ª—è —à–æ—Ä—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–æ–ª–µ–µ –Ω–∏–∑–∫–∏–π —Å—Ç–æ–ø (–±–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∏–π)
            use_tsl = tsl_price < sl_price
        return tsl_result if use_tsl else sl_result
    return tsl_result or sl_result
```

#### –†–ï–®–ï–ù–ò–ï 7: TakeProfitManager - —É—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π –≤ TP
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/take_profit_manager.py`
```python
# –î–û–ë–ê–í–ò–¢–¨ —Ä–∞—Å—á–µ—Ç TP —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π:
commission_config = getattr(self.scalping_config, "commission", {})
commission_rate = commission_config.get("trading_fee_rate", 0.0002) if isinstance(commission_config, dict) else getattr(commission_config, "trading_fee_rate", 0.0002)
leverage_tp = getattr(self.scalping_config, "leverage", 5) or 5
commission_pct_from_margin = commission_rate * leverage_tp * 2 * 100  # –í—Ö–æ–¥ + –≤—ã—Ö–æ–¥
slippage_buffer_pct = commission_config.get("slippage_buffer_percent", 0.15) if isinstance(commission_config, dict) else 0.15
tp_percent_with_commission = tp_percent + commission_pct_from_margin + slippage_buffer_pct

if pnl_percent >= tp_percent_with_commission:
    net_pnl_percent = pnl_percent - commission_pct_from_margin
    if net_pnl_percent > 0:
        logger.info(f"üéØ TP –¥–æ—Å—Ç–∏–≥–Ω—É—Ç: Gross {pnl_percent:.2f}% >= TP {tp_percent:.2f}% + –∫–æ–º–∏—Å—Å–∏—è {commission_pct_from_margin:.2f}% (Net: {net_pnl_percent:.2f}%)")
        await self.close_position_callback(position, "tp")
        return True
```

#### –†–ï–®–ï–ù–ò–ï 8: TakeProfitManager - –ø—Ä–æ–≤–µ—Ä–∫–∞ peak_profit
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/take_profit_manager.py`
```python
# –î–û–ë–ê–í–ò–¢–¨ –ø—Ä–æ–≤–µ—Ä–∫—É peak_profit –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º:
metadata = await self.position_registry.get_metadata(symbol)
if metadata and metadata.peak_profit_usd > 0:
    peak_profit_pct = (metadata.peak_profit_usd / margin_used) * 100 if margin_used > 0 else 0
    drawdown_from_peak = peak_profit_pct - pnl_percent
    max_drawdown_allowed = 0.5  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ç–∫–∞—Ç –æ—Ç –ø–∏–∫–∞ –≤ %
    if drawdown_from_peak > max_drawdown_allowed:
        logger.debug(f"üí∞ TP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –æ—Ç–∫–∞—Ç –æ—Ç –ø–∏–∫–∞ {drawdown_from_peak:.2f}% > {max_drawdown_allowed:.2f}% (peak: {peak_profit_pct:.2f}%, current: {pnl_percent:.2f}%)")
        return False
```

#### –†–ï–®–ï–ù–ò–ï 9: SmartExitCoordinator - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥
**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/exit_decision_coordinator.py`
```python
# –ë–´–õ–û:
if self.smart_exit_coordinator and hasattr(self.smart_exit_coordinator, "should_close"):
    should_close = await self.smart_exit_coordinator.should_close(symbol, position)

# –î–û–õ–ñ–ù–û –ë–´–¢–¨:
if self.smart_exit_coordinator and hasattr(self.smart_exit_coordinator, "check_position"):
    should_close, reason = await self.smart_exit_coordinator.check_position(symbol, position)
    if should_close:
        return {"should_close": True, "reason": reason or "smart_exit"}
```

#### –†–ï–®–ï–ù–ò–ï 10: WebSocketCoordinator - –ø—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π
**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/websocket_coordinator.py`
```python
# –î–û–ë–ê–í–ò–¢–¨ –ø—Ä–æ–≤–µ—Ä–∫—É –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π ticker:
async def _handle_ticker(self, symbol: str, ticker_data: Dict[str, Any]):
    # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –º–æ–¥—É–ª–µ–π
    if self.orchestrator and not getattr(self.orchestrator, "all_modules_ready", False):
        logger.debug(f"‚è≥ WebSocketCoordinator: –ú–æ–¥—É–ª–∏ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º ticker –¥–ª—è {symbol}")
        return
    
    if self.signal_generator and not hasattr(self.signal_generator, "regime_managers"):
        logger.debug(f"‚è≥ WebSocketCoordinator: SignalGenerator –µ—â–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º ticker –¥–ª—è {symbol}")
        return
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ ticker ...
```

#### –†–ï–®–ï–ù–ò–ï 11: WebSocketCoordinator - per-symbol FastADX
**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/websocket_coordinator.py`
```python
# –ò–°–ü–†–ê–í–ò–¢–¨: –°–æ–∑–¥–∞–≤–∞—Ç—å per-symbol —ç–∫–∑–µ–º–ø–ª—è—Ä—ã FastADX
async def _update_fast_adx(self, symbol: str, ticker_data: Dict[str, Any]):
    if not self._fast_adx_template:
        return
    
    # –°–æ–∑–¥–∞–µ–º –∏–ª–∏ –ø–æ–ª—É—á–∞–µ–º per-symbol —ç–∫–∑–µ–º–ø–ª—è—Ä
    if symbol not in self._fast_adx_by_symbol:
        from src.strategies.scalping.futures.indicators.fast_adx import FastADX
        self._fast_adx_by_symbol[symbol] = FastADX(
            period=self._fast_adx_template.period,
            threshold=self._fast_adx_template.threshold
        )
        logger.debug(f"‚úÖ –°–æ–∑–¥–∞–Ω per-symbol FastADX –¥–ª—è {symbol}")
    
    fast_adx = self._fast_adx_by_symbol[symbol]
    # –û–±–Ω–æ–≤–ª—è–µ–º per-symbol —ç–∫–∑–µ–º–ø–ª—è—Ä
    await fast_adx.update(ticker_data)
```

#### –†–ï–®–ï–ù–ò–ï 12: MACDSignalGenerator - –ø—Ä–æ–≤–µ—Ä–∫–∞ ADX trend
**–§–∞–π–ª:** `src/strategies/scalping/futures/signals/macd_signal_generator.py`
```python
# –î–û–ë–ê–í–ò–¢–¨ –ø—Ä–æ–≤–µ—Ä–∫—É ADX trend –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∏–≥–Ω–∞–ª–∞:
if macd_line > signal_line and histogram > 0:
    # ... –ø—Ä–æ–≤–µ—Ä–∫–∞ is_bullish_trend ...
    # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º ADX trend
    adx_trend = await self._get_adx_trend(symbol, indicators)
    adx_value = indicators.get("adx", {}).get("value", 0) if isinstance(indicators.get("adx"), dict) else 0
    adx_threshold = 30.0
    
    if adx_trend == "bearish" and adx_value >= adx_threshold:
        logger.debug(f"üö´ MACD BULLISH —Å–∏–≥–Ω–∞–ª –û–¢–ú–ï–ù–ï–ù –¥–ª—è {symbol}: ADX –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥ (ADX={adx_value:.1f})")
        continue  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —ç—Ç–æ—Ç —Å–∏–≥–Ω–∞–ª
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ ...
```

#### –†–ï–®–ï–ù–ò–ï 13: RSI SignalGenerator - –ø—Ä–æ–≤–µ—Ä–∫–∞ ADX trend
**–§–∞–π–ª:** `src/strategies/scalping/futures/signals/rsi_signal_generator.py`
```python
# –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ MACD, –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É ADX trend:
if rsi < rsi_oversold:
    # ... –ø—Ä–æ–≤–µ—Ä–∫–∞ is_downtrend ...
    # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ü—Ä–æ–≤–µ—Ä—è–µ–º ADX trend
    adx_trend = await self._get_adx_trend(symbol, indicators)
    adx_value = indicators.get("adx", {}).get("value", 0) if isinstance(indicators.get("adx"), dict) else 0
    adx_threshold = 30.0
    
    if adx_trend == "bearish" and adx_value >= adx_threshold:
        logger.debug(f"üö´ RSI OVERSOLD —Å–∏–≥–Ω–∞–ª –û–¢–ú–ï–ù–ï–ù –¥–ª—è {symbol}: ADX –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥")
        continue
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ ...
```

#### –†–ï–®–ï–ù–ò–ï 14: DirectionAnalyzer - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ–Ω—Ç—Ä-—Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
**–§–∞–π–ª:** `src/strategies/scalping/futures/analysis/direction_analyzer.py`
```python
# –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
if regime and regime.lower() == "trending" and adx_value >= self.ADX_STRONG_THRESHOLD:
    trend_direction = adx_direction
    if (trend_direction == "bullish" and direction == "bearish") or \
       (trend_direction == "bearish" and direction == "bullish"):
        logger.debug(f"üö´ DirectionAnalyzer: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∫–æ–Ω—Ç—Ä-—Ç—Ä–µ–Ω–¥–∞ –≤ —Ä–µ–∂–∏–º–µ TRENDING - ADX —Ç—Ä–µ–Ω–¥={trend_direction}, —Å–∏–≥–Ω–∞–ª={direction}")
        return {"direction": "neutral", "confidence": 0.0, "reason": f"Blocked counter-trend: ADX trend={trend_direction}, signal={direction}"}
```

#### –†–ï–®–ï–ù–ò–ï 15: MarginCalculator - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π safety_threshold
**–§–∞–π–ª:** `src/strategies/scalping/futures/calculations/margin_calculator.py`
```python
# –ò–°–ü–†–ê–í–ò–¢–¨: safety_threshold –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –≤ –∫–æ–Ω—Ñ–∏–≥–µ
def is_position_safe(self, ..., safety_threshold: Optional[float] = None, ...):
    if safety_threshold is None:
        # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback, —Ç—Ä–µ–±—É–µ–º —è–≤–Ω–æ–≥–æ —É–∫–∞–∑–∞–Ω–∏—è
        logger.error(f"‚ùå safety_threshold –Ω–µ —É–∫–∞–∑–∞–Ω –¥–ª—è {symbol}, –ø–æ–∑–∏—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π")
        return False, {"safe": False, "reason": "safety_threshold_not_specified"}
    
    # ... –æ—Å—Ç–∞–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å safety_threshold ...
```

#### –†–ï–®–ï–ù–ò–ï 16: MarginMonitor - —É–±—Ä–∞—Ç—å fallback –±–∞–ª–∞–Ω—Å
**–§–∞–π–ª:** `src/strategies/scalping/futures/risk/margin_monitor.py`
```python
# –ò–°–ü–†–ê–í–ò–¢–¨: –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback, –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É
if current_balance == 0.0:
    logger.error("‚ùå MarginMonitor: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å, –ø–æ–∑–∏—Ü–∏—è —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π")
    return False  # –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback 1000.0
```

#### –†–ï–®–ï–ù–ò–ï 17-19: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å STUB –º–æ–¥—É–ª–∏
**–§–∞–π–ª—ã:** 
- `src/strategies/scalping/futures/indicators/futures_volume_profile.py`
- `src/strategies/scalping/futures/risk/liquidation_protector.py`
- `src/strategies/scalping/futures/risk/position_sizer.py` (—É–¥–∞–ª–∏—Ç—å, —Ç–∞–∫ –∫–∞–∫ DEPRECATED)

```python
# FuturesVolumeProfile - —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
class FuturesVolumeProfile:
    def __init__(self, client=None):
        self.client = client
        self._cache = {}
    
    async def get_volume_profile(self, symbol: str, timeframe: str = "1H") -> Dict[str, Any]:
        # –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ volume profile —á–µ—Ä–µ–∑ OKX API
        # ...
```

### 19.2. –í–ê–ñ–ù–´–ï –†–ï–®–ï–ù–ò–Ø (30+)

#### –†–ï–®–ï–ù–ò–ï 20: ParameterProvider - —É–ª—É—á—à–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞
**–§–∞–π–ª:** `src/strategies/scalping/futures/config/parameter_provider.py`
```python
# –£–õ–£–ß–®–ò–¢–¨: –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback
def _get_current_regime(self, symbol: str) -> str:
    try:
        if self.data_registry:
            regime = self.data_registry.get_regime_name_sync(symbol)
            if regime:
                return regime.lower()
        
        if self.regime_manager:
            regime = self.regime_manager.get_current_regime()
            if regime:
                return regime.lower() if isinstance(regime, str) else str(regime).lower()
    except Exception as e:
        logger.warning(f"‚ö†Ô∏è ParameterProvider: –û—à–∏–±–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ –¥–ª—è {symbol}: {e}")
    
    # ‚úÖ –õ–û–ì–ò–†–û–í–ê–¢–¨ fallback
    logger.warning(f"‚ö†Ô∏è ParameterProvider: –†–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è {symbol}, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback 'ranging'")
    return "ranging"
```

#### –†–ï–®–ï–ù–ò–ï 21: –£–º–µ–Ω—å—à–∏—Ç—å TTL –∫—ç—à–∞
**–§–∞–π–ª—ã:** 
- `src/strategies/scalping/futures/indicators/atr_provider.py`
- `src/strategies/scalping/futures/adaptivity/filter_parameters.py`

```python
# ATRProvider:
self._cache_ttl_seconds = 30.0  # –ë—ã–ª–æ 60.0

# FilterParameters:
self._cache_ttl_seconds = 15.0  # –ë—ã–ª–æ 20-60
```

#### –†–ï–®–ï–ù–ò–ï 22: WebSocketManager - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Å–µ—Å—Å–∏—é
**–§–∞–π–ª:** `src/strategies/scalping/futures/websocket_manager.py`
```python
async def disconnect(self):
    # ... –æ—Ç–º–µ–Ω–∞ –∑–∞–¥–∞—á ...
    if self.session and not self.session.closed:
        try:
            await self.session.close()  # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ó–∞–∫—Ä—ã–≤–∞–µ–º —Å–µ—Å—Å–∏—é
            await asyncio.sleep(0.1)
            logger.debug("‚úÖ WebSocket —Å–µ—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∞")
        except Exception as e:
            logger.debug(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ WebSocket —Å–µ—Å—Å–∏–∏: {e}")
```

#### –†–ï–®–ï–ù–ò–ï 23: PrivateWebSocketManager - –∏—Å–ø—Ä–∞–≤–∏—Ç—å ws_url
**–§–∞–π–ª:** `src/strategies/scalping/futures/private_websocket_manager.py`
```python
# –ò–°–ü–†–ê–í–ò–¢–¨:
if sandbox:
    self.ws_url = "wss://wspap.okx.com:8443/ws/v5/private"
else:
    self.ws_url = "wss://ws.okx.com:8443/ws/v5/private"  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û
```

#### –†–ï–®–ï–ù–ò–ï 24: ExitDecisionLogger - —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è datetime
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_decision_logger.py`
```python
# –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û, –Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
def _serialize_datetime(obj: Any) -> Any:
    if isinstance(obj, datetime):
        return obj.isoformat()
    elif isinstance(obj, dict):
        return {key: _serialize_datetime(value) for key, value in obj.items()}
    elif isinstance(obj, (list, tuple)):
        return [_serialize_datetime(item) for item in obj]
    return obj

# –í log_decision:
log_entry = _serialize_datetime(log_entry)
```

#### –†–ï–®–ï–ù–ò–ï 25: PeakProfitTracker - –ø—Ä–æ–≤–µ—Ä–∫–∞ None
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/peak_profit_tracker.py`
```python
# –î–û–ë–ê–í–ò–¢–¨ –ø—Ä–æ–≤–µ—Ä–∫–∏:
if current_price is None or current_price <= 0:
    logger.warning(f"‚ö†Ô∏è PeakProfitTracker: –ù–µ–≤–∞–ª–∏–¥–Ω–∞—è —Ü–µ–Ω–∞ –¥–ª—è {symbol}: {current_price}")
    return None

if unrealized_pnl is not None and peak_profit_usd is not None:
    if float(unrealized_pnl) > float(peak_profit_usd):
        # ... –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ...
```

---

## 20. –ü–û–õ–ù–û–ï –î–ï–†–ï–í–û –ü–†–û–ï–ö–¢–ê

```
simple trading bot okx/
‚îú‚îÄ‚îÄ run.py                          # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ README.md                       # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ requirements.txt                # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ config.yaml                     # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ (legacy)
‚îÇ
‚îú‚îÄ‚îÄ config/                         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îÇ   ‚îú‚îÄ‚îÄ config_futures.yaml        # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Futures (–æ—Å–Ω–æ–≤–Ω–æ–π)
‚îÇ   ‚îú‚îÄ‚îÄ config_spot.yaml           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Spot
‚îÇ   ‚îú‚îÄ‚îÄ features.yaml              # –§–ª–∞–≥–∏ —Ñ—É–Ω–∫—Ü–∏–π
‚îÇ   ‚îú‚îÄ‚îÄ manual_pools.yaml          # –†—É—á–Ω—ã–µ –ø—É–ª—ã –¥–ª—è Spot
‚îÇ   ‚îî‚îÄ‚îÄ –ö–û–ù–§–ò–ì_–ê–î–ê–ü–¢–ò–í–ù–´–•_–ü–ê–†–ê–ú–ï–¢–†–û–í_–†–ò–°–ö–ê.yaml
‚îÇ
‚îú‚îÄ‚îÄ src/                            # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main_futures.py            # –ó–∞–ø—É—Å–∫ Futures –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ main_spot.py               # –ó–∞–ø—É—Å–∫ Spot –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ config.py                  # –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ models.py                  # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ clients/                   # API –∫–ª–∏–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ futures_client.py      # OKX Futures API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ spot_client.py         # OKX Spot API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ strategies/                # –¢–æ—Ä–≥–æ–≤—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ scalping/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ futures/           # Futures —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ orchestrator.py      # –ì–ª–∞–≤–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (~5200 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ signal_generator.py  # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤ (~1500 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ position_manager.py  # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏ (~2000 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ risk_manager.py       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ (~2000 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ order_executor.py     # –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ (~800 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ signal_coordinator.py # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ (~3600 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ tsl_manager.py        # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL (238 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ websocket_manager.py  # WebSocket –º–µ–Ω–µ–¥–∂–µ—Ä (307 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ private_websocket_manager.py  # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π WebSocket (488 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ positions/            # –ú–æ–¥—É–ª–∏ –ø–æ–∑–∏—Ü–∏–π
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ entry_manager.py  # –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π (808 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ exit_analyzer.py  # –ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞ (5044 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ exit_decision_logger.py  # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π (118 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_monitor.py      # –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π (284 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ peak_profit_tracker.py    # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–∏–∫–∞ (134 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_scaling_manager.py  # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ (670 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ stop_loss_manager.py       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ SL (230 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ take_profit_manager.py     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TP (365 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ coordinators/         # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ websocket_coordinator.py    # WebSocket –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä (~1100 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ signal_coordinator.py       # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Å–∏–≥–Ω–∞–ª–æ–≤ (~3600 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ exit_decision_coordinator.py  # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è (329 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ smart_exit_coordinator.py     # –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (213 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ priority_resolver.py          # –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ (231 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ order_coordinator.py          # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –æ—Ä–¥–µ—Ä–æ–≤ (681 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ trailing_sl_coordinator.py    # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL (~2000 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ filters/              # –§–∏–ª—å—Ç—Ä—ã
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ filter_manager.py             # –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä —Ñ–∏–ª—å—Ç—Ä–æ–≤ (1061 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ liquidity_filter.py           # –§–∏–ª—å—Ç—Ä –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ (456 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ order_flow_filter.py          # –§–∏–ª—å—Ç—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ (300 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ funding_rate_filter.py        # –§–∏–ª—å—Ç—Ä funding rate (191 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ volatility_regime_filter.py   # –§–∏–ª—å—Ç—Ä –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (112 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ momentum_filter.py            # –§–∏–ª—å—Ç—Ä –∏–º–ø—É–ª—å—Å–∞ (259 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ indicators/           # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ trailing_stop_loss.py        # Trailing stop (~1000 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ order_flow_indicator.py       # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø–æ—Ç–æ–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ (227 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ fast_adx.py                    # –ë—ã—Å—Ç—Ä—ã–π ADX (241 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ atr_provider.py                # –ü—Ä–æ–≤–∞–π–¥–µ—Ä ATR (157 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ funding_rate_monitor.py       # –ú–æ–Ω–∏—Ç–æ—Ä funding rate (198 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ futures_volume_profile.py     # STUB (3 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ indicator_calculator.py       # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (338 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ liquidity_levels.py           # –£—Ä–æ–≤–Ω–∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ (244 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ micro_pivot_calculator.py      # –ú–∏–∫—Ä–æ–ø–∏–≤–æ—Ç—ã (241 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ risk/                 # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ adaptive_leverage.py           # –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –ª–µ–≤–µ—Ä–∏–¥–∂ (258 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ liquidation_protector.py      # STUB (53 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ margin_monitor.py             # –ú–æ–Ω–∏—Ç–æ—Ä –º–∞—Ä–∂–∏ (180 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ max_size_limiter.py           # –û–≥—Ä–∞–Ω–∏—á–∏—Ç–µ–ª—å —Ä–∞–∑–º–µ—Ä–∞ (242 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ position_sizer.py             # STUB DEPRECATED (3 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ calculations/          # –†–∞—Å—á–µ—Ç—ã
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ margin_calculator.py           # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –º–∞—Ä–∂–∏ (847 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ balance_calculator.py         # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –±–∞–ª–∞–Ω—Å–∞ (122 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ regime_calculator.py          # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ (313 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ pnl_calculator.py             # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä PnL (~500 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ position_sizer.py             # –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ (3 —Å—Ç—Ä–æ–∫–∏ - STUB)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ adaptivity/            # –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ balance_manager.py            # –ú–µ–Ω–µ–¥–∂–µ—Ä –±–∞–ª–∞–Ω—Å–∞ (461 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ parameter_adapter.py          # –ê–¥–∞–ø—Ç–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (131 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ filter_parameters.py          # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ (521 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ regime_manager.py             # –ú–µ–Ω–µ–¥–∂–µ—Ä —Ä–µ–∂–∏–º–∞ (1145 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ signals/              # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–∏–≥–Ω–∞–ª–æ–≤
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ macd_signal_generator.py      # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä MACD —Å–∏–≥–Ω–∞–ª–æ–≤ (335 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ rsi_signal_generator.py       # –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä RSI —Å–∏–≥–Ω–∞–ª–æ–≤ (390 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ core/                 # –Ø–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ candle_buffer.py              # –ë—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π (163 —Å—Ç—Ä–æ–∫–∏)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_registry.py          # –†–µ–µ—Å—Ç—Ä –ø–æ–∑–∏—Ü–∏–π (416 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ position_sync.py              # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π (261 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ data_registry.py              # –†–µ–µ—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö (581 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ trading_control_center.py    # –¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (908 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ metrics/              # –ú–µ—Ç—Ä–∏–∫–∏
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ alert_manager.py              # –ú–µ–Ω–µ–¥–∂–µ—Ä –∞–ª–µ—Ä—Ç–æ–≤ (357 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ conversion_metrics.py         # –ú–µ—Ç—Ä–∏–∫–∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (365 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ holding_time_metrics.py      # –ú–µ—Ç—Ä–∏–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è (377 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ logging/              # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ debug_logger.py              # –û—Ç–ª–∞–¥–æ—á–Ω—ã–π –ª–æ–≥–≥–µ—Ä (461 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ logger_factory.py             # –§–∞–±—Ä–∏–∫–∞ –ª–æ–≥–≥–µ—Ä–æ–≤ (146 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ structured_logger.py          # –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä (415 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ analysis/             # –ê–Ω–∞–ª–∏–∑
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ direction_analyzer.py         # –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è (529 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îú‚îÄ‚îÄ config/               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ           ‚îÇ   ‚îú‚îÄ‚îÄ config_manager.py            # –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (~1700 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ   ‚îî‚îÄ‚îÄ parameter_provider.py        # –ü—Ä–æ–≤–∞–π–¥–µ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (679 —Å—Ç—Ä–æ–∫)
‚îÇ   ‚îÇ           ‚îÇ
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ utils/                # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ               ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ               ‚îî‚îÄ‚îÄ units.py                     # –£—Ç–∏–ª–∏—Ç—ã –µ–¥–∏–Ω–∏—Ü (31 —Å—Ç—Ä–æ–∫–∞)
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ risk/                        # –û–±—â–∏–µ –º–æ–¥—É–ª–∏ —Ä–∏—Å–∫–∞
‚îÇ       ‚îî‚îÄ‚îÄ risk_controller.py
‚îÇ
‚îú‚îÄ‚îÄ tests/                           # –¢–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ docs/                            # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ analysis/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reports/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ 2026-01/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ –ü–û–õ–ù–´–ô_–ê–ù–ê–õ–ò–ó_–†–ê–ë–û–¢–´_–ë–û–¢–ê_2026-01-04.md  # –≠—Ç–æ—Ç –æ—Ç—á–µ—Ç
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ logs/                            # –õ–æ–≥–∏
‚îÇ   ‚îî‚îÄ‚îÄ futures/
‚îÇ       ‚îî‚îÄ‚îÄ archived/
‚îÇ           ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ data/                            # –î–∞–Ω–Ω—ã–µ –∏ –∫–µ—à
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îú‚îÄ‚îÄ scripts/                         # –°–∫—Ä–∏–ø—Ç—ã —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ
‚îî‚îÄ‚îÄ temp/                            # –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
    ‚îî‚îÄ‚îÄ ...
```

---

**–û—Ç—á–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω:** 04.01.2026  
**–ê–Ω–∞–ª–∏—Ç–∏–∫:** AI Assistant  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–ï–ù (–ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• –ú–û–î–£–õ–ï–ô, –í–ó–ê–ò–ú–û–î–ï–ô–°–¢–í–ò–ô, –ü–†–ò–ú–ï–†–û–í –ò–ó –õ–û–ì–û–í –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –° –ö–û–î–û–ú)

**–ü–†–û–í–ï–†–ï–ù–û –ú–û–î–£–õ–ï–ô:** 83 –∏–∑ 83 (100%) - –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –í–°–ï–• FUTURES –ú–û–î–£–õ–ï–ô
**–ù–ê–ô–î–ï–ù–û –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ü–†–û–ë–õ–ï–ú:** 25+
**–ù–ê–ô–î–ï–ù–û –í–ê–ñ–ù–´–• –ü–†–û–ë–õ–ï–ú:** 30+
**–ù–ê–ô–î–ï–ù–û STUB/TODO –ú–û–î–£–õ–ï–ô:** 3
**–ü–†–ï–î–õ–û–ñ–ï–ù–û –†–ï–®–ï–ù–ò–ô:** 50+ (—Å –ø–æ–ª–Ω—ã–º –∫–æ–¥–æ–º)
**–î–û–ë–ê–í–õ–ï–ù–û –ü–†–ò–ú–ï–†–û–í –ò–ó –õ–û–ì–û–í:** 50+
**–î–û–ë–ê–í–õ–ï–ù–û –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ô –° –ö–û–î–û–ú:** 50+
