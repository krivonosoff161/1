# ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á—Ç–µ–Ω–∏—è SL –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

## üîç –ü—Ä–æ–±–ª–µ–º–∞

**–ò–∑ –ª–æ–≥–æ–≤:**
```
22:40:03.120 | ExitAnalyzer: –†–µ—à–µ–Ω–∏–µ –¥–ª—è ETH-USDT: action=close, reason=sl_reached, PnL=-0.86%
SL=0.80%  # ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
SL threshold=-0.85%  # 0.80% + 0.05% spread_buffer
```

**–í –∫–æ–Ω—Ñ–∏–≥–µ:**
```yaml
adaptive_regime:
  ranging:
    sl_percent: 1.0  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ExitAnalyzer –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `self.scalping_config.by_regime` –≤–º–µ—Å—Ç–æ `self.scalping_config.adaptive_regime`
- –í –∫–æ–Ω—Ñ–∏–≥–µ `sl_percent` –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `adaptive_regime.ranging.sl_percent`
- –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ –Ω–µ –Ω–∞—Ö–æ–¥–∏–ª –∑–Ω–∞—á–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª fallback, –Ω–æ –ø–æ—á–µ–º—É-—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ—Å—å 0.80%

---

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`

**–ú–µ—Ç–æ–¥:** `_get_sl_percent()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ —á—Ç–µ–Ω–∏–µ –∏–∑ `adaptive_regime.{regime}.sl_percent` (–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥–∞)
2. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω fallback –Ω–∞ `by_regime` –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á—Ç–µ–Ω–∏—è:**
1. `symbol_profiles[symbol][regime].sl_percent` (per-symbol per-regime)
2. `adaptive_regime[regime].sl_percent` (per-regime) ‚úÖ **–ù–û–í–û–ï**
3. `by_regime[regime].sl_percent` (fallback –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
4. `scalping_config.sl_percent` (–≥–ª–æ–±–∞–ª—å–Ω—ã–π)
5. `2.0%` (hardcoded fallback)

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç

**–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- SL = 0.80% (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ)
- SL threshold = -0.85% (0.80% + 0.05% spread_buffer)
- –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —É–±—ã—Ç–∫–µ -0.86% (—Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ)

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
- SL = 1.0% (–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
- SL threshold = -1.05% (1.0% + 0.05% spread_buffer)
- –ü–æ–∑–∏—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ —É–±—ã—Ç–∫–µ -1.05% (–±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—Ç–∫–∞—Ç–æ–≤)

**–£–ª—É—á—à–µ–Ω–∏–µ:**
- ‚úÖ –ù–∞ 0.20% –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—Ç–∫–∞—Ç–æ–≤ (1.0% –≤–º–µ—Å—Ç–æ 0.80%)
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –Ω–µ –±—É–¥—É—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è —Ç–∞–∫ —Ä–∞–Ω–æ
- ‚úÖ –ë–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞

- ‚úÖ –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —Ä—ã–Ω–∫–µ
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ª–æ–≥–∏ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ SL
3. **–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞** - –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å SL –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤

---

**–î–∞—Ç–∞:** 2025-12-23  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é





