# –†–ï–®–ï–ù–ò–ï: –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ –¢–ï–ö–£–©–£–Æ –¶–ï–ù–£ –ò–ó –°–¢–ê–ö–ê–ù–ê –î–õ–Ø –°–ò–ì–ù–ê–õ–û–í

**–î–∞—Ç–∞:** 2025-12-18  
**–°—Ç–∞—Ç—É—Å:** üí° –†–ï–®–ï–ù–ò–ï

---

## ‚úÖ –ü–†–û–ë–õ–ï–ú–ê –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ê

**–¢—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –ø—Ä–∞–≤!** –°–∏–≥–Ω–∞–ª—ã —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è –Ω–∞ **–∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ**, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.

---

## üîç –¢–ï–ö–£–©–ê–Ø –õ–û–ì–ò–ö–ê (–ü–†–û–ë–õ–ï–ú–ê)

### –ì–¥–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Ü–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞:

**–§–∞–π–ª:** `signal_generator.py`

**–°—Ç—Ä–æ–∫–∞ 1297:**
```python
current_price = market_data.ohlcv_data[-1].close  # ‚ùå –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏
```

**–°—Ç—Ä–æ–∫–∏ 2063, 2187, 2338, 2415, 2566, 2655, 3263, 3329, 3477:**
```python
"price": market_data.ohlcv_data[-1].close  # ‚ùå –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–≤–µ—á–∏
```

### –ü—Ä–æ–±–ª–µ–º–∞:
1. –°–∏–≥–Ω–∞–ª –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å —Ü–µ–Ω–æ–π **–∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–∏** (–Ω–∞–ø—Ä–∏–º–µ—Ä, `2840.27`)
2. –ü—Ä–æ—Ö–æ–¥–∏—Ç –≤—Ä–µ–º—è (1-5 —Å–µ–∫—É–Ω–¥) –¥–æ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
3. –†—ã–Ω–æ–∫ –¥–≤–∏–Ω—É–ª—Å—è: `current_price = 2809.91`
4. –õ–∏–º–∏—Ç–Ω–∞—è —Ü–µ–Ω–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç **—Ç–µ–∫—É—â–µ–π** —Ü–µ–Ω—ã (`best_ask = 2809.91`)
5. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –û—Ä–¥–µ—Ä —Å—Ç–∞–≤–∏—Ç—Å—è –ø–æ `2809.91`, –Ω–æ —Å–∏–≥–Ω–∞–ª –±—ã–ª –Ω–∞ `2840.27` (—Ä–∞–∑–Ω–∏—Ü–∞ 1.07%)

---

## ‚úÖ –†–ï–®–ï–ù–ò–ï

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–∞

**–õ–æ–≥–∏–∫–∞:**
- –ü–æ–ª—É—á–∞—Ç—å `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞ (`best_ask` –¥–ª—è BUY, `best_bid` –¥–ª—è SELL) –∏–ª–∏ —Ç–∏–∫–µ—Ä–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ü–µ–Ω—É –≤ `signal["price"]`
- –≠—Ç–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ü–µ–Ω—É —Å–∏–≥–Ω–∞–ª–∞ —Å —Ü–µ–Ω–æ–π —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```python
# –í–º–µ—Å—Ç–æ:
current_price = market_data.ohlcv_data[-1].close

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
price_limits = await self.client.get_price_limits(symbol)
current_price = price_limits.get("current_price", market_data.ohlcv_data[-1].close)
# –ò–ª–∏ –¥–ª—è BUY: best_ask, –¥–ª—è SELL: best_bid
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `signal["price"]` –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω—ã

**–õ–æ–≥–∏–∫–∞:**
- –ï—Å–ª–∏ `signal["price"]` –∞–∫—Ç—É–∞–ª—å–Ω–∞ (–Ω–µ–¥–∞–≤–Ω–æ –ø–æ–ª—É—á–µ–Ω–∞, —Ä–∞–∑–Ω–∏—Ü–∞ —Å `current_price` < 0.5%)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `signal["price"]` –∫–∞–∫ –æ—Å–Ω–æ–≤—É –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω—ã
- –ï—Å–ª–∏ —É—Å—Ç–∞—Ä–µ–ª–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ `order_executor.py:_calculate_limit_price()`:**
```python
# –ü–æ–ª—É—á–∞–µ–º signal_price –∏–∑ —Å–∏–≥–Ω–∞–ª–∞
signal_price = signal.get("price", 0.0) if signal else 0.0

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å
if signal_price > 0:
    price_diff_pct = abs(signal_price - current_price) / current_price * 100
    if price_diff_pct < 0.5:  # –†–∞–∑–Ω–∏—Ü–∞ < 0.5% - —Å–∏–≥–Ω–∞–ª –∞–∫—Ç—É–∞–ª–µ–Ω
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º signal_price –∫–∞–∫ –æ—Å–Ω–æ–≤—É
        base_price = signal_price
    else:
        # –°–∏–≥–Ω–∞–ª —É—Å—Ç–∞—Ä–µ–ª, –∏—Å–ø–æ–ª—å–∑—É–µ–º current_price
        base_price = current_price
else:
    base_price = current_price

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∏–º–∏—Ç–Ω—É—é —Ü–µ–Ω—É –æ—Ç base_price
if side.lower() == "buy":
    limit_price = base_price * (1 + offset_percent / 100.0)  # –í—ã—à–µ base_price
else:
    limit_price = base_price * (1 - offset_percent / 100.0)  # –ù–∏–∂–µ base_price
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)

**–õ–æ–≥–∏–∫–∞:**
1. –ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞
2. –ü—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å `signal["price"]`
3. –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ > 0.5% ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å market order –≤–º–µ—Å—Ç–æ limit

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ü–µ–Ω—ã —Å–∏–≥–Ω–∞–ª–∞ —Å —Ä—ã–Ω–∫–æ–º
- –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
- –ë—ã—Å—Ç—Ä—ã–π –≤—Ö–æ–¥ –ø—Ä–∏ –±–æ–ª—å—à–æ–º —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–∏

---

## üìã –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤
- –ü–æ–ª—É—á–∞—Ç—å `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞ (—Ç–∏–∫–µ—Ä –∏–ª–∏ `get_price_limits`)
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ü–µ–Ω—É –≤ `signal["price"]`

### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å `signal["price"]`
- –ï—Å–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ –æ—Å–Ω–æ–≤—É
- –ï—Å–ª–∏ —É—Å—Ç–∞—Ä–µ–ª–∞ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞

### –®–∞–≥ 3: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–µ—Ä–µ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º
- –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å `signal["price"]` —Å `current_price`
- –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ > 0.5% ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å market order

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ú–û–ú–ï–ù–¢–´

### –î–ª—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã (RSI, MACD, BB) –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—É –∑–∞–∫—Ä—ã—Ç–∏—è —Å–≤–µ—á–∏
- –ù–æ **—Ü–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞** –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ç–µ–∫—É—â–µ–π –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞

### –î–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤:
- –§–∏–ª—å—Ç—Ä—ã –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—É –∑–∞–∫—Ä—ã—Ç–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ª–æ–≤–∏–π
- –ù–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–∏–≥–Ω–∞–ª–∞ —Ü–µ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π

### –î–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞:
- –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –≤—Ö–æ–¥–∞
- –†–∞–∑–Ω–∏—Ü–∞ –¥–∞–∂–µ 0.1% –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É–ø—É—â–µ–Ω–Ω–æ–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

---

## üéØ –í–´–í–û–î

**–î–∞, –Ω—É–∂–Ω–æ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª –Ω–µ –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ, –∞ –Ω–∞ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω–µ –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞!**

–≠—Ç–æ —Ä–µ—à–∏—Ç –ø—Ä–æ–±–ª–µ–º—É —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –º–µ–∂–¥—É —Ü–µ–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∞ –∏ —Ü–µ–Ω–æ–π —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞.

---

**–ì–æ—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è!** ‚úÖ
