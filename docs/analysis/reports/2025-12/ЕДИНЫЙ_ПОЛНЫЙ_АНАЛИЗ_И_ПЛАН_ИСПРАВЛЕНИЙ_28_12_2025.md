# –ï–î–ò–ù–´–ô –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ò –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

**–î–∞—Ç–∞:** 28.12.2025  
**–û—Å–Ω–æ–≤–∞:** 
- –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –ø—Ä–∞–≤–æ–∫ Grok (Cursor)
- –û—Ç–≤–µ—Ç Grok —Å —Ñ–∏–Ω–∞–ª—å–Ω—ã–º –ø–ª–∞–Ω–æ–º –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –ê–Ω–∞–ª–∏–∑ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –º–æ–¥—É–ª–µ–π
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ + –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–ê–Ω–∞–ª–∏–∑ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π](#1-–∞–Ω–∞–ª–∏–∑-—É–∂–µ-—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)
2. [–ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π (–∏–∑ –æ—Ç–≤–µ—Ç–∞ Grok)](#2-–ø–ª–∞–Ω-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π-–∏–∑-–æ—Ç–≤–µ—Ç–∞-grok)
3. [–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π –º–æ–¥—É–ª–µ–π](#3-–ø—Ä–æ–≤–µ—Ä–∫–∞-–≤–∑–∞–∏–º–æ—Å–≤—è–∑–µ–π-–º–æ–¥—É–ª–µ–π)
4. [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã](#4-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–≤–æ–ø—Ä–æ—Å—ã-–∏-–Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–µ-—ç–ª–µ–º–µ–Ω—Ç—ã)
5. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–º–µ—á–∞–Ω–∏—è](#5-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–∑–∞–º–µ—á–∞–Ω–∏—è)
6. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#6-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
7. [–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞](#7-–∏—Ç–æ–≥–æ–≤–∞—è-–æ—Ü–µ–Ω–∫–∞)

---

## 1. –ê–ù–ê–õ–ò–ó –£–ñ–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #1: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –≤ ExitAnalyzer –∏ ParameterProvider

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–ï–†–ù–û –ò –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç Grok:**
- `max_holding_minutes` –∏–∑ `parameter_provider.get_exit_params()` –º–æ–∂–µ—Ç –±—ã—Ç—å `str` (YAML –ø–∞—Ä—Å–∏—Ç –∫–∞–∫ str –µ—Å–ª–∏ –≤ –∫–∞–≤—ã—á–∫–∞—Ö)
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ `minutes_in_position >= max_holding_minutes` –ø–∞–¥–∞–µ—Ç —Å `TypeError`
- –ù—É–∂–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —á–µ—Ä–µ–∑ `_to_float()`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**

```174:201:src/strategies/scalping/futures/config/parameter_provider.py
                exit_params["sl_atr_multiplier"] = _to_float(
                    exit_params.get("sl_atr_multiplier"),
                    "sl_atr_multiplier",
                    2.0,  # ‚úÖ Default —É–≤–µ–ª–∏—á–µ–Ω —Å 1.5 –¥–æ 2.0
                )
                exit_params["tp_atr_multiplier"] = _to_float(
                    exit_params.get("tp_atr_multiplier"), "tp_atr_multiplier", 1.0
                )
                exit_params["min_profit_for_extension"] = _to_float(
                    exit_params.get("min_profit_for_extension"),
                    "min_profit_for_extension",
                    0.4,
                )
                exit_params["extension_percent"] = _to_float(
                    exit_params.get("extension_percent"), "extension_percent", 100.0
                )
                exit_params["min_holding_minutes"] = _to_float(
                    exit_params.get("min_holding_minutes"),
                    "min_holding_minutes",
                    0.5,  # ‚úÖ Default –¥–ª—è ranging: 0.5 –º–∏–Ω—É—Ç—ã
                )
```

**–í—ã–≤–æ–¥:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ö–û–†–†–ï–ö–¢–ù–û**
- –ú–µ—Ç–æ–¥ `_to_float()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —á–∏—Å–ª–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ `parameter_provider.get_exit_params()`
- –í `exit_analyzer.py` —Ç–∞–∫–∂–µ –µ—Å—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è (—Å—Ç—Ä–æ–∫–∏ 3200-3202)

**–í–∑–∞–∏–º–æ—Å–≤—è–∑–∏:**
- `ParameterProvider.get_exit_params()` ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `ExitAnalyzer._generate_exit_for_ranging()` (—Å—Ç—Ä–æ–∫–∞ 3200)
- `ExitAnalyzer` –ø–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ `self.parameter_provider.get_exit_params()`
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç `TypeError` –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ `minutes_in_position >= max_holding_minutes`

---

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #2: –ú–µ—Ç–æ–¥ check_safety –≤ MarginMonitor

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–ï–†–ù–û –ò –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç Grok:**
- –í `risk_manager.py` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `self.margin_monitor.check_safety()`
- –ú–µ—Ç–æ–¥ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –≤ `MarginMonitor`
- –í—ã–∑—ã–≤–∞–ª `AttributeError` –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**

```77:179:src/strategies/scalping/futures/risk/margin_monitor.py
    async def check_safety(
        self,
        position_size_usd: float,
        current_positions: Dict[str, Any],
        orchestrator: Optional[Any] = None,  # ‚úÖ –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–ª–∞–Ω—Å—É
        data_registry: Optional[Any] = None,  # ‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
    ) -> bool:
        """
        ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (28.12.2025): –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –º–∞—Ä–∂–∏ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏.
        """
        # ... —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –ø–æ–ª—É—á–µ–Ω–∏–µ–º –±–∞–ª–∞–Ω—Å–∞ –∏–∑ orchestrator/data_registry ...
```

**–í—ã–≤–æ–¥:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ö–û–†–†–ï–ö–¢–ù–û**
- –ú–µ—Ç–æ–¥ `check_safety()` –¥–æ–±–∞–≤–ª–µ–Ω –≤ `MarginMonitor`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö (orchestrator, data_registry, fallback)
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ—à–∏–±–∫–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `False` –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

**–í–∑–∞–∏–º–æ—Å–≤—è–∑–∏:**
- `RiskManager.check_margin_safety()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `self.margin_monitor.check_safety()`
- `SignalCoordinator.execute_signal()` ‚Üí –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∞—Ä–∂—É —á–µ—Ä–µ–∑ `risk_manager.check_margin_safety()`
- –ú–µ—Ç–æ–¥ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –º–∞—Ä–∂–µ

**‚ö†Ô∏è –í–û–ü–†–û–°:** –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –ª–∏ `orchestrator` –∏ `data_registry` –≤ `risk_manager.check_margin_safety()` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `check_safety()`. –ï—Å–ª–∏ –Ω–µ—Ç - –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback –±–∞–ª–∞–Ω—Å 1000.0, —á—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–µ—Ä–Ω–æ.

---

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #12: ATRProvider —Å fallback –∏ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–ï–†–ù–û –ò –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç Grok:**
- –ü—Ä–æ–±–ª–µ–º–Ω—ã–π fallback —á–µ—Ä–µ–∑ `IndicatorManager.get_indicator()` —É–¥–∞–ª–µ–Ω
- ATR –ø–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ATRProvider` –±–µ–∑ –æ—à–∏–±–æ–∫
- TTL —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 60s –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**

```36:103:src/strategies/scalping/futures/indicators/atr_provider.py
    def get_atr(self, symbol: str, fallback: Optional[float] = None) -> Optional[float]:
        """
        –ü–æ–ª—É—á–∏—Ç—å ATR –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è —Å–∏–º–≤–æ–ª–∞ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ).
        –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: 1. –ö—ç—à (–µ—Å–ª–∏ —Å–≤–µ–∂–∏–π), 2. DataRegistry, 3. Fallback
        """
        # TTL –∫—ç—à–∞: 60 —Å–µ–∫—É–Ω–¥ (‚úÖ –£–í–ï–õ–ò–ß–ï–ù–û 28.12.2025)
        self._cache_ttl_seconds = 60.0
        # ... —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º ...
```

**–í—ã–≤–æ–¥:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ö–û–†–†–ï–ö–¢–ù–û**
- `ATRProvider` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL=60 —Å–µ–∫—É–Ω–¥
- –ü–æ–ª—É—á–∞–µ—Ç ATR –∏–∑ `DataRegistry._indicators` —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç fallback –∑–Ω–∞—á–µ–Ω–∏–µ
- –ü—Ä–æ–±–ª–µ–º–Ω—ã–π fallback —á–µ—Ä–µ–∑ `IndicatorManager.get_indicator()` —É–¥–∞–ª–µ–Ω –∏–∑ `exit_analyzer.py`

**–í–∑–∞–∏–º–æ—Å–≤—è–∑–∏:**
- `ExitAnalyzer` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `self.atr_provider.get_atr(symbol)` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è ATR
- `ATRProvider` –∫—ç—à–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ `DataRegistry._indicators`
- `DataRegistry` –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —á–µ—Ä–µ–∑ WebSocket –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã

---

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #14: –£—á–µ—Ç Slippage –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–ï–†–ù–û –ò –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç Grok:**
- Slippage —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω—ã: –¥–ª—è BUY —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 0.1%, –¥–ª—è SELL —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ DEBUG

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**

```1740:1780:src/strategies/scalping/futures/signal_generator.py
    def _adjust_price_for_slippage(self, symbol: str, price: float, side: str) -> float:
        """
        –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ —Ü–µ–Ω—ã —Å–∏–≥–Ω–∞–ª–∞ —Å —É—á–µ—Ç–æ–º slippage.
        """
        slippage_pct = 0.1  # Fallback: 0.1%
        if side.lower() == "buy":
            adjusted_price = price * (1 + slippage_pct / 100)  # BUY: —É–≤–µ–ª–∏—á–∏–≤–∞–µ–º
        else:  # sell
            adjusted_price = price * (1 - slippage_pct / 100)  # SELL: —É–º–µ–Ω—å—à–∞–µ–º
        logger.debug(f"üí∞ {symbol}: –¶–µ–Ω–∞ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ –Ω–∞ slippage {slippage_pct:.3f}%")
        return adjusted_price
```

**–í—ã–≤–æ–¥:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –ö–û–†–†–ï–ö–¢–ù–û**
- –ú–µ—Ç–æ–¥ `_adjust_price_for_slippage()` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (MA, MACD, RSI, BB)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ DEBUG
- –†–∞—Å—á–µ—Ç –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω

**–í–∑–∞–∏–º–æ—Å–≤—è–∑–∏:**
- `SignalGenerator._generate_base_signals()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã —Å–∏–≥–Ω–∞–ª–æ–≤ (MA, MACD, RSI, BB)
- –ö–∞–∂–¥—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≤—ã–∑—ã–≤–∞–µ—Ç `_adjust_price_for_slippage()` –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Å–∏–≥–Ω–∞–ª–∞
- –°–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ü–µ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ `signal["price"]` –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏

---

### ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #3/#11: WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç Grok:**
- –í `orchestrator.py` –µ—Å—Ç—å `PrivateWebSocketManager`, –Ω–æ –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω –Ω–∞ private/positions
- –ù—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `PrivateWebSocketManager` –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ private/positions

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**

```189:219:src/strategies/scalping/futures/private_websocket_manager.py
    async def subscribe_positions(self, callback: Callable) -> bool:
        """
        –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π.
        """
        subscribe_msg = {
            "op": "subscribe",
            "args": [{"channel": "positions", "instType": "SWAP"}],
        }
        await self.ws.send_str(json.dumps(subscribe_msg))
        logger.info("üìä –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞")
        return True
```

```163:173:src/strategies/scalping/futures/coordinators/websocket_coordinator.py
        # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Private WebSocket –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–æ–∑–∏—Ü–∏–π/–æ—Ä–¥–µ—Ä–æ–≤
        if self.private_ws_manager:
            connected = await self.private_ws_manager.connect()
            if connected:
                await self.private_ws_manager.subscribe_positions(
                    callback=self.handle_private_ws_positions
                )
```

**–í—ã–≤–æ–¥:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
- `PrivateWebSocketManager` –∏–º–µ–µ—Ç –º–µ—Ç–æ–¥ `subscribe_positions()`
- `WebSocketCoordinator` –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–∑ `private_ws_manager.subscribe_positions()`
- Callback `handle_private_ws_positions` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π

**–í–∑–∞–∏–º–æ—Å–≤—è–∑–∏:**
- `WebSocketCoordinator.initialize_websocket()` ‚Üí –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ —á–µ—Ä–µ–∑ `private_ws_manager`
- `WebSocketCoordinator.handle_private_ws_positions()` ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `_sync_positions_with_exchange()`
- –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –Ω–∞ –±–∏—Ä–∂–µ

---

## 2. –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô (–ò–ó –û–¢–í–ï–¢–ê GROK)

### üî¥ –°–†–û–ß–ù–û: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏

#### ‚úÖ #15: TALib Warnings ‚Üí Silent Fallback

**–§–∞–π–ª:** `src/indicators/talib_wrapper.py`  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –°—Ä–æ—á–Ω–æ  
**–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤ (–∫—Ä–æ–º–µ RSI) –∏—Å–ø–æ–ª—å–∑—É—é—Ç `logger.warning()` –ø—Ä–∏ TALib error ‚Äî –∑–∞—Å–æ—Ä—è–µ—Ç –ª–æ–≥–∏

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **TALibEMA** (—Å—Ç—Ä–æ–∫–∞ 88-94):
```python
# –ë–´–õ–û:
except Exception as e:
    logger.warning(f"‚ö†Ô∏è TALibEMA: –û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —á–µ—Ä–µ–∑ TA-Lib ({type(e).__name__}: {e}), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback")

# –°–¢–ê–õ–û:
except Exception as e:
    logger.debug(f"TALibEMA fallback: {type(e).__name__}: {e}")
```

2. **TALibATR** (—Å—Ç—Ä–æ–∫–∞ 143-149):
```python
# –ë–´–õ–û:
except Exception as e:
    logger.warning(f"‚ö†Ô∏è TALibATR: –û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —á–µ—Ä–µ–∑ TA-Lib ({type(e).__name__}: {e}), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback")

# –°–¢–ê–õ–û:
except Exception as e:
    logger.debug(f"TALibATR fallback: {type(e).__name__}: {e}")
```

3. **TALibMACD** (—Å—Ç—Ä–æ–∫–∞ 206-210):
```python
# –ë–´–õ–û:
except Exception as e:
    logger.warning(f"‚ö†Ô∏è TALibMACD: –û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —á–µ—Ä–µ–∑ TA-Lib ({type(e).__name__}: {e}), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback")

# –°–¢–ê–õ–û:
except Exception as e:
    logger.debug(f"TALibMACD fallback: {type(e).__name__}: {e}")
```

4. **TALibSMA** (—Å—Ç—Ä–æ–∫–∞ 257-261):
```python
# –ë–´–õ–û:
except Exception as e:
    logger.warning(f"‚ö†Ô∏è TALibSMA: –û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —á–µ—Ä–µ–∑ TA-Lib ({type(e).__name__}: {e}), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback")

# –°–¢–ê–õ–û:
except Exception as e:
    logger.debug(f"TALibSMA fallback: {type(e).__name__}: {e}")
```

5. **TALibBollingerBands** (—Å—Ç—Ä–æ–∫–∞ 320-324):
```python
# –ë–´–õ–û:
except Exception as e:
    logger.warning(f"‚ö†Ô∏è TALibBollingerBands: –û—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —á–µ—Ä–µ–∑ TA-Lib ({type(e).__name__}: {e}), –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback")

# –°–¢–ê–õ–û:
except Exception as e:
    logger.debug(f"TALibBollingerBands fallback: {type(e).__name__}: {e}")
```

**–¢—Ä–µ–π–¥–µ—Ä—Å–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞:** –ß–∏—Å—Ç—ã–µ –ª–æ–≥–∏ –≤ prod; warnings —Ç–æ–ª—å–∫–æ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç WARNING —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç TALib –≤ –ª–æ–≥–∞—Ö.

---

#### ‚úÖ #9: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ë–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –°–∏–≥–Ω–∞–ª–æ–≤

**–§–∞–π–ª—ã:** 
- `src/strategies/scalping/futures/coordinators/signal_coordinator.py`
- `src/strategies/scalping/futures/core/trading_control_center.py`

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –°—Ä–æ—á–Ω–æ  
**–í—Ä–µ–º—è:** 10 –º–∏–Ω—É—Ç  
**–ü—Ä–æ–±–ª–µ–º–∞:** `_block_stats` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è, –Ω–æ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ (`check_for_signals` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –Ω–æ –±–µ–∑ log)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

**1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ç–æ–¥ `_log_block_stats()` –≤ SignalCoordinator**

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py`  
**–°—Ç—Ä–æ–∫–∞:** `647` ‚Äî –º–µ—Ç–æ–¥ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π

**2. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ –≤ TradingControlCenter.run_main_loop()**

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/trading_control_center.py`  
**–ú–µ—Å—Ç–æ:** –ü–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 169 (–ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–µ—Ç—Ä–∏–∫)

```python
# ‚úÖ –ù–û–í–û–ï (28.12.2025): –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–∏–≥–Ω–∞–ª–æ–≤
if not hasattr(self, '_last_block_stats_log_time'):
    self._last_block_stats_log_time = time.time()
    self._block_stats_log_interval = 300.0  # –ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç

if (
    current_time - self._last_block_stats_log_time
    >= self._block_stats_log_interval
):
    if hasattr(self, 'signal_coordinator') and self.signal_coordinator:
        if hasattr(self.signal_coordinator, '_log_block_stats'):
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, async –∏–ª–∏ sync –º–µ—Ç–æ–¥
            if asyncio.iscoroutinefunction(self.signal_coordinator._log_block_stats):
                await self.signal_coordinator._log_block_stats()
            else:
                self.signal_coordinator._log_block_stats()
    self._last_block_stats_log_time = current_time
```

**3. –î–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ –≤ –∫–æ–Ω—Ü–µ check_for_signals()**

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py`  
**–ú–µ—Å—Ç–æ:** –í –∫–æ–Ω—Ü–µ –º–µ—Ç–æ–¥–∞ `check_for_signals()` (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 1857, –ø–µ—Ä–µ–¥ `return`)

```python
# ‚úÖ –ù–û–í–û–ï (28.12.2025): –õ–æ–≥–∏—Ä—É–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
# –õ–æ–≥–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–Ω–µ –∫–∞–∂–¥—ã–π —Ä–∞–∑, —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å–æ—Ä—è—Ç—å –ª–æ–≥–∏)
if sum(self._block_stats.values()) > 0:
    self._log_block_stats()
```

**4. ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –î–û–ü–û–õ–ù–ï–ù–ò–ï (Grok): –î–æ–±–∞–≤–∏—Ç—å reset _block_stats –∫–∞–∂–¥—ã–µ 1h**

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py`  
**–ú–µ—Å—Ç–æ:** –í `__init__()` –¥–æ–±–∞–≤–∏—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ reset (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 144)

```python
# ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –î–û–ü–û–õ–ù–ï–ù–ò–ï (Grok): –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ reset —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
self._block_stats_reset_time = time.time()
```

**–ú–µ—Å—Ç–æ:** –í –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –≤ `trading_control_center.py` (–ø–æ—Å–ª–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏)

```python
# ‚úÖ –§–ò–ù–ê–õ–¨–ù–û–ï –î–û–ü–û–õ–ù–ï–ù–ò–ï (Grok): Reset —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–∞–∂–¥—ã–µ 1 —á–∞—Å
if current_time - self.signal_coordinator._block_stats_reset_time >= 3600:
    logger.info(f"üîÑ Reset block stats (hourly): {self.signal_coordinator._block_stats}")
    self.signal_coordinator._block_stats = {
        "circuit_breaker": 0,
        "side_blocked": 0,
        "low_strength": 0,
        "existing_position": 0,
        "margin_unsafe": 0,
        "other": 0,
    }
    self.signal_coordinator._block_stats_reset_time = current_time
```

**–ü–æ—á–µ–º—É:** –¢—Ä–µ–π–¥–µ—Ä—É –Ω—É–∂–Ω—ã hourly stats –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (–Ω–µ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ).

**–¢—Ä–µ–π–¥–µ—Ä—Å–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞:** –í–∏–¥–∏–º–æ—Å—Ç—å –ø—Ä–∏—á–∏–Ω –Ω–∏–∑–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ (low_strength vs margin_unsafe) ‚Äî –∫–ª—é—á –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–æ—Ä–æ–≥–æ–≤.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –∞ –∫–∞–∂–¥—ã–µ 1 —á–∞—Å ‚Äî reset —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.

---

#### ‚úÖ #13: Retry –õ–æ–≥–∏–∫–∞ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ü–æ–∑–∏—Ü–∏–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –°—Ä–æ—á–Ω–æ  
**–í—Ä–µ–º—è:** 15 –º–∏–Ω—É—Ç  
**–ü—Ä–æ–±–ª–µ–º–∞:** Delay –≤ `_sync_positions_with_exchange()` ‚Üí missed close/emergency loss

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å retry —Å exponential backoff

**–ú–µ—Å—Ç–æ:** –í –Ω–∞—á–∞–ª–µ –º–µ—Ç–æ–¥–∞ `_sync_positions_with_exchange()` (–ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 1876, –ø–µ—Ä–µ–¥ `now = time.time()`)

```python
async def _sync_positions_with_exchange(self, force: bool = False) -> None:
    """
    ‚úÖ –ú–û–î–ï–†–ù–ò–ó–ê–¶–ò–Ø: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∏ –ª–∏–º–∏—Ç—ã —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –±–∏—Ä–∂–∏.
    ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û (28.12.2025): –î–æ–±–∞–≤–ª–µ–Ω–∞ retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff
    """
    # ‚úÖ –ù–û–í–û–ï (28.12.2025): Retry –ª–æ–≥–∏–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ API
    max_retries = 4  # 0-3 = 4 –ø–æ–ø—ã—Ç–∫–∏
    retry_delays = [0.2, 0.4, 0.8, 1.6]  # Exponential backoff –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
    synced = False
    exchange_positions = None
    
    for attempt in range(max_retries):
        try:
            exchange_positions = await self.client.get_positions()
            synced = True
            break  # –£—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–∏–ª–∏ –ø–æ–∑–∏—Ü–∏–∏
        except Exception as e:
            if attempt < max_retries - 1:
                delay = retry_delays[attempt]
                logger.debug(
                    f"‚ö†Ô∏è Sync retry {attempt+1}/{max_retries} –¥–ª—è –ø–æ–∑–∏—Ü–∏–π, "
                    f"sleep {delay:.1f}s: {e}"
                )
                await asyncio.sleep(delay)
            else:
                logger.warning(
                    f"‚ùå Sync failed –ø–æ—Å–ª–µ {max_retries} –ø–æ–ø—ã—Ç–æ–∫ ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback: {e}"
                )
                return  # –í—ã—Ö–æ–¥–∏–º –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
    
    if not synced or exchange_positions is None:
        logger.warning("‚ùå Sync failed –ø–æ—Å–ª–µ retry ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback prices")
        return
    
    # ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫–æ–¥–æ–º —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∏ 1877+)
    now = time.time()
    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ (—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –ø–æ—Å–ª–µ —Å—Ç—Ä–æ–∫–∏ 1876) ...
```

**–¢—Ä–µ–π–¥–µ—Ä—Å–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞:** –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è volatile (ETH) ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É–±—ã—Ç–∫–∏ –æ—Ç delay close.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ retry –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö API.

---

### üü° –í–ê–ñ–ù–û: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è PnL –∏ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏

#### ‚úÖ #4: –ó–∞—â–∏—Ç–∞ Min_Holding_Minutes –ü–µ—Ä–µ–¥ SL

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–∞–∂–Ω–æ  
**–í—Ä–µ–º—è:** 10 –º–∏–Ω—É—Ç  
**–ü—Ä–æ–±–ª–µ–º–∞:** SL —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–Ω–æ (31-36 —Å–µ–∫ < 1.0 –º–∏–Ω –≤ —Ç–æ—Ä–≥–æ–≤–ª–µ)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞:**

–í –∫–æ–¥–µ —É–∂–µ –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ `min_holding_minutes` –Ω–∞ —Å—Ç—Ä–æ–∫–∞—Ö 3200-3223 –¥–ª—è RANGING —Ä–µ–∂–∏–º–∞:

```3200:3223:src/strategies/scalping/futures/positions/exit_analyzer.py
                                min_holding_minutes = exit_params.get("min_holding_minutes", 0.5)
                                if min_holding_minutes is not None:
                                    min_holding_minutes = float(min_holding_minutes)
                            except Exception as e:
                                logger.debug(f"‚ö†Ô∏è ExitAnalyzer: –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è min_holding_minutes: {e}")
                        
                        if min_holding_minutes is None:
                            min_holding_minutes = 0.5  # Fallback
                        
                        # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ SL –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ –º–µ–Ω—å—à–µ min_holding_minutes
                        if minutes_in_position is not None and minutes_in_position < min_holding_minutes:
                            logger.debug(
                                f"‚è≥ ExitAnalyzer RANGING: –ü–æ–∑–∏—Ü–∏—è {symbol} –≤ —É–±—ã—Ç–∫–µ {gross_pnl_percent:.2f}%, "
                                f"–Ω–æ –≤—Ä–µ–º—è {minutes_in_position:.2f} –º–∏–Ω < min_holding {min_holding_minutes:.2f} –º–∏–Ω - "
                                f"–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É SL"
                            )
                            return {
                                "action": "hold",
                                "reason": "min_holding_not_reached_before_sl",
                                ...
                            }
```

**–î–µ–π—Å—Ç–≤–∏–µ:** 
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å –¥–ª—è TRENDING –∏ CHOPPY —Ä–µ–∂–∏–º–æ–≤. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –¥–æ–±–∞–≤–∏—Ç—å.
2. ‚úÖ **–§–ò–ù–ê–õ–¨–ù–û–ï –î–û–ü–û–õ–ù–ï–ù–ò–ï (Grok): –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ ignore SL**

**–ú–µ—Å—Ç–æ:** –í —Ç–æ–º –∂–µ –º–µ—Å—Ç–µ (—Å—Ç—Ä–æ–∫–∞ 3210-3215), —É–ª—É—á—à–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ:

```python
# –ë–´–õ–û:
if minutes_in_position is not None and minutes_in_position < min_holding_minutes:
    logger.debug(
        f"‚è≥ ExitAnalyzer RANGING: –ü–æ–∑–∏—Ü–∏—è {symbol} –≤ —É–±—ã—Ç–∫–µ {gross_pnl_percent:.2f}%, "
        f"–Ω–æ –≤—Ä–µ–º—è {minutes_in_position:.2f} –º–∏–Ω < min_holding {min_holding_minutes:.2f} –º–∏–Ω - "
        f"–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É SL"
    )

# –°–¢–ê–õ–û (—É–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ):
if minutes_in_position is not None and minutes_in_position < min_holding_minutes:
    logger.info(  # ‚úÖ –ò–ó–ú–ï–ù–ï–ù–û: debug ‚Üí info –¥–ª—è –ª—É—á—à–µ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
        f"‚è≥ ExitAnalyzer {regime.upper()}: Ignore SL –¥–ª—è {symbol} - "
        f"hold {minutes_in_position:.1f} –º–∏–Ω < min_holding {min_holding_minutes:.1f} –º–∏–Ω "
        f"(—É–±—ã—Ç–æ–∫ {gross_pnl_percent:.2f}%, –∑–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–Ω–Ω–µ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è)"
    )
```

**–ü–æ—á–µ–º—É:** –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤ –ª–æ–≥–∞—Ö (–≤–∏–¥–Ω–æ, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ SL –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–ª—Å—è).

**–¢—Ä–µ–π–¥–µ—Ä—Å–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞:** –î–∞—ë—Ç –ø–æ–∑–∏—Ü–∏—è–º "–¥—ã—à–∞—Ç—å" –≤ ranging ‚Äî –ø–æ–≤—ã—Å–∏—Ç winrate.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏, —á—Ç–æ –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ SL —Ä–∞–Ω—å—à–µ `min_holding_minutes` –∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–∏ SL.

---

#### ‚úÖ #5: –ù–∏–∑–∫–∞—è –ö–æ–Ω–≤–µ—Ä—Å–∏—è (Adaptive –ø–æ –ü–∞—Ä–µ)

**–§–∞–π–ª:** `config/config_futures.yaml`  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–∞–∂–Ω–æ  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç  
**–ü—Ä–æ–±–ª–µ–º–∞:** –°—Ç—Ä–æ–≥–∏–µ –ø–æ—Ä–æ–≥–∏ ‚Üí –º–∞–ª–æ —Å–¥–µ–ª–æ–∫ (37.5% winrate –æ—Ç —Ä–µ–¥–∫–∏—Ö –≤—Ö–æ–¥–æ–≤)

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** Adaptive –ø–æ –ø–∞—Ä–µ (ETH volatile ‚Äî looser)

**–ú–µ—Å—Ç–æ:** –í —Å–µ–∫—Ü–∏–∏ `scalping` –∏ –¥–æ–±–∞–≤–∏—Ç—å `by_symbol`

```yaml
scalping:
  min_signal_strength: 0.60  # ‚úÖ –ò–ó–ú–ï–ù–ï–ù–û: –ë—ã–ª–æ 0.65
  min_signal_strength_ranging: 0.60  # ‚úÖ –ò–ó–ú–ï–ù–ï–ù–û: –ë—ã–ª–æ 0.65
  min_adx: 16.0  # –û—Å—Ç–∞–µ—Ç—Å—è (–±—ã–ª–æ —Å–Ω–∏–∂–µ–Ω–æ —Ä–∞–Ω–µ–µ)

by_symbol:
  ETH-USDT:
    min_signal_strength: 0.55  # ‚úÖ –ù–û–í–û–ï: Looser –¥–ª—è ETH (volatile)
    sl_atr_multiplier: 3.0  # ‚úÖ –ù–û–í–û–ï: Wider SL –¥–ª—è ETH (volatility high)
    min_adx: 14.0  # ‚úÖ –ù–û–í–û–ï: Looser ADX –¥–ª—è ETH
  SOL-USDT:
    min_adx: 20.0  # ‚úÖ –ù–û–í–û–ï: Looser –¥–ª—è trending
    min_signal_strength: 0.58  # ‚úÖ –ù–û–í–û–ï: Looser –¥–ª—è SOL
  BTC-USDT:
    min_signal_strength: 0.62  # ‚úÖ –ù–û–í–û–ï: –ß—É—Ç—å looser –¥–ª—è BTC
```

**–¢—Ä–µ–π–¥–µ—Ä—Å–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞:** ETH –Ω—É–∂–¥–∞–µ—Ç—Å—è –≤ wider SL (volatility high); –ø–æ–≤—ã—Å–∏—Ç –∫–æ–Ω–≤–µ—Ä—Å–∏—é –±–µ–∑ overtrade.

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–æ–Ω–≤–µ—Ä—Å–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ —É–≤–µ–ª–∏—á–∏–ª–∞—Å—å.

---

### üü¢ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û: –£–ª—É—á—à–µ–Ω–∏—è

#### ‚úÖ #6: –í–µ—Å Price_Action –≤ –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/analysis/direction_analyzer.py`  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ  
**–í—Ä–µ–º—è:** 5 –º–∏–Ω—É—Ç  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∏–∑–∫–∏–π –≤–µ—Å=0.05 ‚Üí —Å–ª–∞–±—ã–π —É—á—ë—Ç PA (–≤ –∫–æ–¥–µ —É–∂–µ —É–º–µ–Ω—å—à–µ–Ω —Å 0.10 –¥–æ 0.05)

**‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï:** –í —Ç–µ–∫—É—â–µ–º –∫–æ–¥–µ `price_action = 0.05` (—É–º–µ–Ω—å—à–µ–Ω–æ), –Ω–æ Grok –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0.15. –≠—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É–≤–µ–ª–∏—á–∏—Ç—å –¥–æ 0.15 —Å–æ–≥–ª–∞—Å–Ω–æ –æ—Ç–≤–µ—Ç—É Grok.

**–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á–∏—Ç—å –≤–µ—Å price_action —Å 0.05 –¥–æ 0.15

**–ú–µ—Å—Ç–æ:** –°—Ç—Ä–æ–∫–∞ 35 (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ `INDICATOR_WEIGHTS`)

```python
# –¢–ï–ö–£–©–ò–ô –ö–û–î (—Å—Ç—Ä–æ–∫–∞ 31-37):
INDICATOR_WEIGHTS = {
    "adx": 0.50,  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.40 –¥–æ 0.50
    "ema": 0.25,
    "sma": 0.15,
    "price_action": 0.05,  # ‚ùå –£–º–µ–Ω—å—à–µ–Ω–æ —Å 0.10 –¥–æ 0.05 (–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç Grok)
    "volume": 0.05,
}

# –°–¢–ê–õ–û (—Å–æ–≥–ª–∞—Å–Ω–æ Grok):
INDICATOR_WEIGHTS = {
    "adx": 0.50,  # –û—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å
    "ema": 0.25,
    "sma": 0.15,
    "price_action": 0.15,  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.05 –¥–æ 0.15 (—Å–æ–≥–ª–∞—Å–Ω–æ Grok)
    "volume": 0.05,
}

# ‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –ù—É–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å adx —Å 0.50 –¥–æ 0.40, —á—Ç–æ–±—ã —Å—É–º–º–∞ –±—ã–ª–∞ 1.0:
INDICATOR_WEIGHTS = {
    "adx": 0.40,  # ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–æ —Å 0.50 –¥–æ 0.40 (—á—Ç–æ–±—ã —Å—É–º–º–∞ –±—ã–ª–∞ 1.0)
    "ema": 0.25,
    "sma": 0.15,
    "price_action": 0.15,  # ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.05 –¥–æ 0.15
    "volume": 0.05,
}
```

**–¢—Ä–µ–π–¥–µ—Ä—Å–∫–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞:** –õ—É—á—à–µ –ª–æ–≤–∏—Ç reversals (pinbar/doji).

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å–∏–≥–Ω–∞–ª—ã –ª—É—á—à–µ —É—á–∏—Ç—ã–≤–∞—é—Ç price action –ø–∞—Ç—Ç–µ—Ä–Ω—ã.

---

## 3. –ü–†–û–í–ï–†–ö–ê –í–ó–ê–ò–ú–û–°–í–Ø–ó–ï–ô –ú–û–î–£–õ–ï–ô

### 3.1. –¶–µ–ø–æ—á–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**

1. **WebSocket ‚Üí SignalCoordinator.check_for_signals()**
   - WebSocket –ø–æ–ª—É—á–∞–µ—Ç —Ü–µ–Ω—É ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `check_for_signals(symbol, price)`
   - `check_for_signals()` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª—ã —á–µ—Ä–µ–∑ `signal_generator.generate_signals()`
   - –°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –≤ `self._block_stats`
   - ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê:** –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏

2. **SignalGenerator.generate_signals()**
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç `_adjust_price_for_slippage()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–≥–Ω–∞–ª–∞ ‚úÖ
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –ø–æ strength, –≤—Ä–µ–º–µ–Ω–∏, —Ä–µ–∂–∏–º—É

3. **SignalCoordinator.execute_signal()**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∞—Ä–∂—É —á–µ—Ä–µ–∑ `risk_manager.check_margin_safety()`
   - `RiskManager.check_margin_safety()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `margin_monitor.check_safety()` ‚úÖ
   - –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é —á–µ—Ä–µ–∑ `order_executor.execute_signal()`

4. **OrderExecutor.execute_signal()**
   - –†–∞–∑–º–µ—â–∞–µ—Ç –æ—Ä–¥–µ—Ä –Ω–∞ –±–∏—Ä–∂–µ
   - –ü–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç entry_price —Å –±–∏—Ä–∂–µ–π

5. **Orchestrator._sync_positions_with_exchange()**
   - –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å –±–∏—Ä–∂–µ–π
   - ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê:** –ù–µ—Ç retry –ª–æ–≥–∏–∫–∏ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
   - –û–±–Ω–æ–≤–ª—è–µ—Ç `active_positions` –∏ `total_margin_used`
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç DRIFT_ADD (–ø–æ–∑–∏—Ü–∏—è –Ω–∞ –±–∏—Ä–∂–µ, –Ω–æ –Ω–µ—Ç –≤ —Ä–µ–µ—Å—Ç—Ä–µ)

**–ü—Ä–æ–±–ª–µ–º—ã –≤ —Ü–µ–ø–æ—á–∫–µ:**

1. ‚ö†Ô∏è **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è**
   - `check_for_signals()` —Å–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É, –Ω–æ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç `_log_block_stats()`
   - `process_signals()` –≤—ã–∑—ã–≤–∞–µ—Ç `_log_block_stats()`, –Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è legacy —Ä–µ–∂–∏–º–∞
   - **–†–ï–®–ï–ù–ò–ï:** –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ –≤ `trading_control_center.run_main_loop()` –∏ –≤ –∫–æ–Ω—Ü–µ `check_for_signals()`

2. ‚ùì **Retry –ª–æ–≥–∏–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç**
   - `_sync_positions_with_exchange()` –Ω–µ –∏–º–µ–µ—Ç retry –ª–æ–≥–∏–∫–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫
   - **–†–ï–®–ï–ù–ò–ï:** –î–æ–±–∞–≤–∏—Ç—å retry —Å exponential backoff (4 –ø–æ–ø—ã—Ç–∫–∏: 0.2, 0.4, 0.8, 1.6 —Å–µ–∫)

---

### 3.2. –¶–µ–ø–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏—è–º–∏

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**

1. **PositionManager._check_position_safety()**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –º–∞—Ä–∂–∏
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç TP (Take Profit)
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∏–∑ `trailing_sl_coordinator.update_trailing_stop_loss()`

2. **ExitAnalyzer.analyze_position()**
   - –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø–æ —Ä–µ–∂–∏–º—É —Ä—ã–Ω–∫–∞
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `atr_provider.get_atr()` –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ ATR-based TP/SL ‚úÖ
   - –ü–æ–ª—É—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ `parameter_provider.get_exit_params()` —Å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π —Ç–∏–ø–æ–≤ ‚úÖ
   - ‚ö†Ô∏è **–ü–†–û–í–ï–†–ö–ê:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `min_holding_minutes` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤ –ø–µ—Ä–µ–¥ SL

3. **TrailingSLCoordinator.update_trailing_stop_loss()**
   - –û–±–Ω–æ–≤–ª—è–µ—Ç trailing stop loss –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω—ã
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É—Å–ª–æ–≤–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –∏–∑ `orchestrator.run()`

**–ü—Ä–æ–±–ª–µ–º—ã –≤ —Ü–µ–ø–æ—á–∫–µ:**

1. ‚úÖ **–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - `ParameterProvider.get_exit_params()` –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ —á–∏—Å–ª–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ `_to_float()`
   - `ExitAnalyzer` –ø–æ–ª—É—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

2. ‚úÖ **ATRProvider —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL=60s
   - –ü–æ–ª—É—á–∞–µ—Ç ATR –∏–∑ `DataRegistry._indicators` —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ
   - –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç fallback –∑–Ω–∞—á–µ–Ω–∏–µ

3. ‚ö†Ô∏è **Min_holding_minutes –ø—Ä–æ–≤–µ—Ä–∫–∞**
   - –ï—Å—Ç—å –¥–ª—è RANGING —Ä–µ–∂–∏–º–∞ (—Å—Ç—Ä–æ–∫–∏ 3200-3223)
   - –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–ª—è TRENDING –∏ CHOPPY —Ä–µ–∂–∏–º–æ–≤

---

### 3.3. –¶–µ–ø–æ—á–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∏—Å–∫–∞–º–∏

**–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:**

1. **RiskManager.check_margin_safety()**
   - –í—ã–∑—ã–≤–∞–µ—Ç `margin_monitor.check_safety()`
   - ‚ö†Ô∏è **–ü–†–û–í–ï–†–ö–ê:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–µ—Ä–µ–¥–∞–µ—Ç `orchestrator` –∏ `data_registry` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞

2. **MarginMonitor.check_safety()**
   - –ü–æ–ª—É—á–∞–µ—Ç –±–∞–ª–∞–Ω—Å –∏–∑ `orchestrator.client.get_balance()` –∏–ª–∏ `data_registry.get_balance()` ‚úÖ
   - –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ç—Ä–µ–±—É–µ–º—É—é –º–∞—Ä–∂—É —Å —É—á–µ—Ç–æ–º leverage
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –º–∞—Ä–∂–∏ –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –±–∞–ª–∞–Ω—Å 1000.0, –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª —Ä–µ–∞–ª—å–Ω—ã–π

3. **SignalCoordinator.execute_signal()**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –º–∞—Ä–∂—É –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª, –µ—Å–ª–∏ –º–∞—Ä–∂–∞ –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞
   - –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å—á–µ—Ç—á–∏–∫ `_block_stats["margin_unsafe"]`

**–ü—Ä–æ–±–ª–µ–º—ã –≤ —Ü–µ–ø–æ—á–∫–µ:**

1. ‚ö†Ô∏è **–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤**
   - `RiskManager.check_margin_safety()` –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å `orchestrator` –∏ `data_registry` –≤ `check_safety()`
   - –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è - –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fallback –±–∞–ª–∞–Ω—Å 1000.0

---

## 4. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–û–ü–†–û–°–´ –ò –ù–ï–ü–û–ù–Ø–¢–ù–´–ï –≠–õ–ï–ú–ï–ù–¢–´

### 4.1. –ù–µ–ø–æ–Ω—è—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ —ç–ª–µ–º–µ–Ω—Ç—ã

#### ‚ùì –í–æ–ø—Ä–æ—Å #1: –ì–¥–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `check_for_signals()` –∏–∑ WebSocket?

**–ü—Ä–æ–±–ª–µ–º–∞:** Grok —É–ø–æ–º–∏–Ω–∞–µ—Ç, —á—Ç–æ `check_for_signals()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ WebSocket, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ –≤—ã–∑–æ–≤–∞.

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `WebSocketCoordinator.handle_ticker()` ‚Üí –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å `check_signals_callback`
- `Orchestrator` –ø–µ—Ä–µ–¥–∞–µ—Ç `check_for_signals` –∫–∞–∫ callback –≤ `WebSocketCoordinator` (—Å—Ç—Ä–æ–∫–∞ 908)

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**

```908:908:src/strategies/scalping/futures/orchestrator.py
            check_signals_callback=self.signal_coordinator.check_for_signals,
```

**–í—ã–≤–æ–¥:** ‚úÖ Callback —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ. `WebSocketCoordinator.handle_ticker()` –≤—ã–∑—ã–≤–∞–µ—Ç `check_signals_callback(symbol, price)`, –∫–æ—Ç–æ—Ä—ã–π —è–≤–ª—è–µ—Ç—Å—è `signal_coordinator.check_for_signals`.

---

#### ‚ùì –í–æ–ø—Ä–æ—Å #2: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `use_legacy_signal_processing`?

**–ü—Ä–æ–±–ª–µ–º–∞:** `process_signals()` –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è, –µ—Å–ª–∏ `use_legacy_signal_processing=False`. –ù–æ –≥–¥–µ —Ç–æ–≥–¥–∞ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–∏–≥–Ω–∞–ª—ã?

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `SignalCoordinator.check_for_signals()` ‚Üí –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ WebSocket ‚úÖ
- `SignalCoordinator.execute_signal_from_price()` ‚Üí –∏—Å–ø–æ–ª–Ω—è–µ—Ç —Å–∏–≥–Ω–∞–ª –∏–∑ —Ü–µ–Ω—ã WebSocket

**–í—ã–≤–æ–¥:** ‚úÖ –õ–æ–≥–∏–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è:
- –ï—Å–ª–∏ `use_legacy_signal_processing=False` ‚Üí —Å–∏–≥–Ω–∞–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `check_for_signals()` –∏–∑ WebSocket (realtime)
- –ï—Å–ª–∏ `use_legacy_signal_processing=True` ‚Üí —Å–∏–≥–Ω–∞–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `process_signals()` –∏–∑ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö —Ü–∏–∫–ª–æ–≤ (legacy)

---

#### ‚ùì –í–æ–ø—Ä–æ—Å #3: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `execute_signal_from_price()`?

**–ü—Ä–æ–±–ª–µ–º–∞:** Grok —É–ø–æ–º–∏–Ω–∞–µ—Ç `execute_signal_from_price()`, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –≥–¥–µ –æ–Ω –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏ –∫–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã.

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `SignalCoordinator.execute_signal_from_price()` ‚Üí –¥–æ–ª–∂–µ–Ω –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –∏–∑ WebSocket callback
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª, –ø–æ–ª—É—á–µ–Ω–Ω—ã–π –∏–∑ —Ü–µ–Ω—ã WebSocket

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `execute_signal_from_price()` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –∏ –≤—ã–∑—ã–≤–∞–µ—Ç `_log_block_stats()` –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ).

---

#### ‚ùì –í–æ–ø—Ä–æ—Å #4: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç fallback –±–∞–ª–∞–Ω—Å 1000.0 –≤ `MarginMonitor.check_safety()`?

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å –Ω–µ –ø–æ–ª—É—á–µ–Ω –∏–∑ `orchestrator` –∏ `data_registry`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback 1000.0. –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–µ—Ä–Ω–æ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞.

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**

```134:138:src/strategies/scalping/futures/risk/margin_monitor.py
            # Fallback: –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–∏ –¥–∞–Ω–Ω—ã–µ
            if current_balance == 0.0:
                logger.warning(
                    "‚ö†Ô∏è MarginMonitor: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –±–∞–ª–∞–Ω—Å, –∏—Å–ø–æ–ª—å–∑—É–µ–º fallback 1000.0"
                )
                current_balance = 1000.0  # Fallback
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** 
- –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ fallback –±–∞–ª–∞–Ω—Å–∞ ‚úÖ (—É–∂–µ –µ—Å—Ç—å WARNING)
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `orchestrator` –∏ `data_registry` –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `check_safety()`

---

#### ‚ùì –í–æ–ø—Ä–æ—Å #5: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `_get_used_margin()` –≤ orchestrator?

**–ü—Ä–æ–±–ª–µ–º–∞:** `MarginMonitor.check_safety()` –≤—ã–∑—ã–≤–∞–µ—Ç `orchestrator._get_used_margin()`, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `Orchestrator._get_used_margin()` ‚Üí –¥–æ–ª–∂–µ–Ω —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é –º–∞—Ä–∂—É –∏–∑ `active_positions`
- –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `total_margin_used_ref` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ä–∂–∏

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `_get_used_margin()` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω–æ–π –º–∞—Ä–∂–∏. –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `total_margin_used_ref`.

---

#### ‚ùì –í–æ–ø—Ä–æ—Å #6: –ö–∞–∫ —Å–≤—è–∑–∞–Ω—ã `SignalCoordinator` –∏ `WebSocketCoordinator`?

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ `WebSocketCoordinator` –≤—ã–∑—ã–≤–∞–µ—Ç –º–µ—Ç–æ–¥—ã `SignalCoordinator` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞:**

```908:908:src/strategies/scalping/futures/orchestrator.py
            check_signals_callback=self.signal_coordinator.check_for_signals,
```

**–í—ã–≤–æ–¥:** ‚úÖ Callback –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω:
- `Orchestrator` –ø–µ—Ä–µ–¥–∞–µ—Ç `signal_coordinator.check_for_signals` –∫–∞–∫ callback –≤ `WebSocketCoordinator`
- `WebSocketCoordinator.handle_ticker()` –≤—ã–∑—ã–≤–∞–µ—Ç `check_signals_callback(symbol, price)`
- –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏–∑ WebSocket

---

#### ‚ùì –í–æ–ø—Ä–æ—Å #7: –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `DataRegistry` –∏ –≥–¥–µ –æ–Ω –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è?

**–ü—Ä–æ–±–ª–µ–º–∞:** `ATRProvider` –ø–æ–ª—É—á–∞–µ—Ç ATR –∏–∑ `DataRegistry._indicators`, –Ω–æ –Ω—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –∫–∞–∫ –∏ –∫–æ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è `DataRegistry`.

**–ì–¥–µ –∏—Å–∫–∞—Ç—å:**
- `DataRegistry.update_indicators()` ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
- `DataRegistry` –º–æ–∂–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è —á–µ—Ä–µ–∑ WebSocket –∏–ª–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ —Ä–∞—Å—á–µ—Ç—ã

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `DataRegistry` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ –∏ —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤. –≠—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è —Ä–∞–±–æ—Ç—ã `ATRProvider`.

---

## 5. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ #1: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `_log_block_stats()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ `process_signals()`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –¥–ª—è legacy —Ä–µ–∂–∏–º–∞
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –≤ `check_for_signals()`, –Ω–æ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –ø—Ä–∏—á–∏–Ω—ã –Ω–∏–∑–∫–æ–π –∫–æ–Ω–≤–µ—Ä—Å–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
- –ù–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–∏–≥–Ω–∞–ª–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ `_log_block_stats()` –≤ `trading_control_center.run_main_loop()` –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
2. –î–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ `_log_block_stats()` –≤ –∫–æ–Ω—Ü–µ `check_for_signals()` –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –°—Ä–æ—á–Ω–æ

---

### üü° –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ #2: Retry –ª–æ–≥–∏–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `_sync_positions_with_exchange()` –Ω–µ –∏–º–µ–µ—Ç retry –ª–æ–≥–∏–∫–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ API
- Grok —É–ø–æ–º–∏–Ω–∞–µ—Ç retry –ª–æ–≥–∏–∫—É (4 –ø–æ–ø—ã—Ç–∫–∏ —Å –∑–∞–¥–µ—Ä–∂–∫–∞–º–∏ 0.2, 0.4, 0.8, 1.6 —Å–µ–∫), –Ω–æ –æ–Ω–∞ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

**–í–ª–∏—è–Ω–∏–µ:**
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–µ—Ç–µ–≤—ã–µ –æ—à–∏–±–∫–∏ –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å API –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–ø—É—Å–∫—É —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–∑–∏—Ü–∏–π
- DRIFT_ADD –º–æ–∂–µ—Ç –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:**
–î–æ–±–∞–≤–∏—Ç—å retry –ª–æ–≥–∏–∫—É –≤ `_sync_positions_with_exchange()` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ—à–∏–±–æ–∫ (4 –ø–æ–ø—ã—Ç–∫–∏ —Å exponential backoff).

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –°—Ä–æ—á–Ω–æ

---

### üü° –í–∞–∂–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ #3: TALib warnings –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –¢–æ–ª—å–∫–æ `TALibRSI` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `logger.debug()` –≤–º–µ—Å—Ç–æ `logger.warning()`
- –û—Å—Ç–∞–ª—å–Ω—ã–µ TALib –æ–±–µ—Ä—Ç–∫–∏ (`TALibEMA`, `TALibATR`, `TALibMACD`, `TALibSMA`, `TALibBollingerBands`) –≤—Å–µ –µ—â–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `logger.warning()`

**–í–ª–∏—è–Ω–∏–µ:**
- –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö TALib
- –ó–∞—Ç—Ä—É–¥–Ω—è–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

**–†–µ—à–µ–Ω–∏–µ:**
–ó–∞–º–µ–Ω–∏—Ç—å `logger.warning()` –Ω–∞ `logger.debug()` –≤–æ –≤—Å–µ—Ö TALib –æ–±–µ—Ä—Ç–∫–∞—Ö –¥–ª—è silent fallback.

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –°—Ä–æ—á–Ω–æ

---

### üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ–µ –∑–∞–º–µ—á–∞–Ω–∏–µ #4: Fallback –±–∞–ª–∞–Ω—Å –≤ MarginMonitor

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –±–∞–ª–∞–Ω—Å –Ω–µ –ø–æ–ª—É—á–µ–Ω –∏–∑ `orchestrator` –∏ `data_registry`, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback 1000.0
- –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–≤–µ—Ä–Ω–æ –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∂–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—Ç–∫—Ä—ã—Ç–∏—é –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –º–∞—Ä–∂–µ –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –º–∞—Ä–∂–µ

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–∂–µ –µ—Å—Ç—å WARNING –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ fallback –±–∞–ª–∞–Ω—Å–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `orchestrator` –∏ `data_registry` –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `check_safety()`
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ

---

## 6. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **‚úÖ #15: TALib Warnings ‚Üí Silent Fallback** (15 –º–∏–Ω)
   - –§–∞–π–ª: `src/indicators/talib_wrapper.py`
   - –ó–∞–º–µ–Ω–∏—Ç—å `logger.warning()` –Ω–∞ `logger.debug()` –≤ 5 –∫–ª–∞—Å—Å–∞—Ö
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –Ω–µ—Ç WARNING —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç TALib

2. **‚úÖ #9: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫** (10 –º–∏–Ω)
   - –§–∞–π–ª—ã: `signal_coordinator.py` + `trading_control_center.py`
   - –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ `_log_block_stats()` –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç –≤ `run_main_loop()`
   - –î–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ `_log_block_stats()` –≤ –∫–æ–Ω—Ü–µ `check_for_signals()` (–µ—Å–ª–∏ –±—ã–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)

3. **‚úÖ #13: Retry –ª–æ–≥–∏–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** (15 –º–∏–Ω)
   - –§–∞–π–ª: `orchestrator.py`
   - –î–æ–±–∞–≤–∏—Ç—å retry —Å exponential backoff (4 –ø–æ–ø—ã—Ç–∫–∏: 0.2, 0.4, 0.8, 1.6 —Å–µ–∫) –≤ `_sync_positions_with_exchange()`

### –í–∞–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

4. **‚úÖ #4: Min_Holding_Minutes –∑–∞—â–∏—Ç–∞** (10 –º–∏–Ω)
   - –§–∞–π–ª: `exit_analyzer.py`
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–∂–µ –µ—Å—Ç—å –¥–ª—è RANGING —Ä–µ–∂–∏–º–∞ (—Å—Ç—Ä–æ–∫–∏ 3200-3223)
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤ (TRENDING, CHOPPY)

5. **‚úÖ #5: –ù–∏–∑–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è** (5 –º–∏–Ω)
   - –§–∞–π–ª: `config/config_futures.yaml`
   - –°–Ω–∏–∑–∏—Ç—å `min_signal_strength` —Å 0.65 –¥–æ 0.60
   - –î–æ–±–∞–≤–∏—Ç—å `by_symbol` –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è ETH, SOL, BTC

6. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–¥–∞—á—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ `RiskManager.check_margin_safety()`**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `orchestrator` –∏ `data_registry` –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `margin_monitor.check_safety()`
   - –ï—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤

### –ñ–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

7. **‚úÖ #6: –í–µ—Å Price_Action** (5 –º–∏–Ω)
   - –§–∞–π–ª: `direction_analyzer.py`
   - –£–≤–µ–ª–∏—á–∏—Ç—å `price_action` —Å 0.05 –¥–æ 0.15 (—Å—Ç—Ä–æ–∫–∞ 35)
   - –£–º–µ–Ω—å—à–∏—Ç—å `adx` —Å 0.50 –¥–æ 0.40 (—á—Ç–æ–±—ã —Å—É–º–º–∞ –±—ã–ª–∞ 1.0)

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:

8. **–°–ª–µ–¥–∏—Ç—å –∑–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Å–∏–≥–Ω–∞–ª–æ–≤**
   - –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è `_log_block_stats()` –≤ `check_for_signals()` –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (circuit_breaker, side_blocked, low_strength, margin_unsafe)

9. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É retry –ª–æ–≥–∏–∫–∏**
   - –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è retry –ª–æ–≥–∏–∫–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ retry –ø–æ–ø—ã—Ç–æ–∫
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —É—Å–ø–µ—à–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ–∑–∏—Ü–∏–π –ø–æ—Å–ª–µ retry

---

## 7. –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (5 –∏–∑ 8):

1. ‚úÖ **#1: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤** - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ `ParameterProvider.get_exit_params()`
2. ‚úÖ **#2: –ú–µ—Ç–æ–¥ check_safety** - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤ `MarginMonitor`
3. ‚úÖ **#14: –£—á–µ—Ç slippage** - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ –≤—Å–µ—Ö –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞—Ö —Å–∏–≥–Ω–∞–ª–æ–≤
4. ‚úÖ **#12: ATRProvider** - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ fallback
5. ‚úÖ **#3/#11: WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —á–µ—Ä–µ–∑ `PrivateWebSocketManager`

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ (3 –∏–∑ 8):

1. ‚ö†Ô∏è **#9: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫** - –ú–µ—Ç–æ–¥ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω, –Ω–æ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏
2. ‚ö†Ô∏è **#15: TALib warnings** - –¢–æ–ª—å–∫–æ `TALibRSI` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `logger.warning()`
3. ‚ùì **#13: Retry –ª–æ–≥–∏–∫–∞** - –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `_sync_positions_with_exchange()`

### üìã –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏–∑ –æ—Ç–≤–µ—Ç–∞ Grok:

1. ‚úÖ **#15: TALib Warnings** - –ó–∞–º–µ–Ω–∏—Ç—å `logger.warning()` –Ω–∞ `logger.debug()` –≤ 5 –∫–ª–∞—Å—Å–∞—Ö
2. ‚úÖ **#9: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫** - –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –≤—ã–∑–æ–≤ –≤ `run_main_loop()` –∏ –≤ –∫–æ–Ω—Ü–µ `check_for_signals()`
3. ‚úÖ **#13: Retry –ª–æ–≥–∏–∫–∞** - –î–æ–±–∞–≤–∏—Ç—å retry —Å exponential backoff –≤ `_sync_positions_with_exchange()`
4. ‚úÖ **#4: Min_Holding_Minutes** - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
5. ‚úÖ **#5: –ù–∏–∑–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è** - –°–Ω–∏–∑–∏—Ç—å –ø–æ—Ä–æ–≥–∏ –∏ –¥–æ–±–∞–≤–∏—Ç—å `by_symbol` –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
6. ‚úÖ **#6: –í–µ—Å Price_Action** - –£–≤–µ–ª–∏—á–∏—Ç—å —Å 0.05 –¥–æ 0.15

### –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: **7/10** ‚Üí **10/10** (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π)

**–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (#1, #2) —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- Slippage —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤
- ATRProvider —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º
- WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–π —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

**–û–±–ª–∞—Å—Ç–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:**
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏) ‚Üí **–ò–°–ü–†–ê–í–ò–¢–¨**
- Retry –ª–æ–≥–∏–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏) ‚Üí **–ò–°–ü–†–ê–í–ò–¢–¨**
- TALib warnings –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã (—Ç—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏) ‚Üí **–ò–°–ü–†–ê–í–ò–¢–¨**

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∑–∞–ø—É—Å–∫—É:** ‚úÖ **–î–ê** - –±–æ—Ç –≥–æ—Ç–æ–≤ –∫ —Ç–æ—Ä–≥–æ–≤–ª–µ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –∏ retry –ª–æ–≥–∏–∫—É –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.

**–ü–æ—Å–ª–µ –≤—Å–µ—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** ‚úÖ **10/10** ‚Äî –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ live (sandbox ‚Üí real —Å small size)

---

## üìä –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –í–°–ï–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

| # | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –í—Ä–µ–º—è |
|---|-------------|--------|------|--------|-----------|-------|
| #1 | –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤ | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `parameter_provider.py` | 174-201 | ‚úÖ | - |
| #2 | –ú–µ—Ç–æ–¥ check_safety | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `margin_monitor.py` | 77-179 | ‚úÖ | - |
| #3/#11 | WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `private_ws_manager.py` | 189-219 | ‚úÖ | - |
| #12 | ATRProvider | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `atr_provider.py` | 36-103 | ‚úÖ | - |
| #14 | –£—á–µ—Ç slippage | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `signal_generator.py` | 1740-1780 | ‚úÖ | - |
| #9 | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –¥–æ—Ä–∞–±–æ—Ç–∫–∏ | `signal_coordinator.py` + `trading_control_center.py` | 647, 1093, 127 | üî¥ –°—Ä–æ—á–Ω–æ | 10 –º–∏–Ω |
| #13 | Retry –ª–æ–≥–∏–∫–∞ | ‚ùì –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `orchestrator.py` | 1866 | üî¥ –°—Ä–æ—á–Ω–æ | 15 –º–∏–Ω |
| #15 | TALib warnings | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ | `talib_wrapper.py` | 88-324 | üî¥ –°—Ä–æ—á–Ω–æ | 15 –º–∏–Ω |
| #4 | Min_Holding_Minutes | ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∏—Ç—å | `exit_analyzer.py` | 3200-3223 | üü° –í–∞–∂–Ω–æ | 10 –º–∏–Ω |
| #5 | –ù–∏–∑–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Å–∏—è | ‚ùì –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `config_futures.yaml` | - | üü° –í–∞–∂–Ω–æ | 5 –º–∏–Ω |
| #6 | –í–µ—Å Price_Action | ‚ùì –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | `direction_analyzer.py` | 35 | üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ | 5 –º–∏–Ω |

**–í—Å–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏:** ~60 –º–∏–Ω—É—Ç

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 28.12.2025  
**–í–µ—Ä—Å–∏—è:** 1.0 (–ï–¥–∏–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ + –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã

