# üõ°Ô∏è –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è –≤ Profit Drawdown (30.11.2025)

## ‚ùì –í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

> "–ê –∫–∞–∫ –∂–µ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è? –ï—Å–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–∫–∞—á–æ–∫ –≤ –¥—Ä—É–≥—É—é —Å—Ç–æ—Ä–æ–Ω—É, –Ω–æ –ø–æ—Ç–æ–º —Ç–∞–∫ –∂–µ –¥–≤–∏–∂–µ–Ω–∏–µ? –ò–ª–∏ –±–æ—Ç –ø–æ –∞–Ω–∞–ª–∏–∑—É –∑–∞–∫—Ä–æ–µ—Ç –∫–∞–∫ –±—ã –∏ —Ö–æ—Ç–µ–ª–∏?"

---

## üîç –ü—Ä–æ–±–ª–µ–º–∞

### –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:

**Profit Drawdown** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞ (`best_bid`/`best_ask`), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç **–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–∫–∞–∫–∞—Ç—å** –∏–∑-–∑–∞:

1. **–ü—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è** - –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∫–∏ —Ü–µ–Ω—ã –≤ —Å—Ç–∞–∫–∞–Ω–µ
2. **–ù–∏–∑–∫–æ–π –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏** - –±–æ–ª—å—à–∏–µ –æ—Ä–¥–µ—Ä–∞ –≤—ã–∑—ã–≤–∞—é—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∫–∏
3. **–†—ã–Ω–æ—á–Ω–æ–≥–æ —à—É–º–∞** - —Å–ª—É—á–∞–π–Ω—ã–µ –∫–æ–ª–µ–±–∞–Ω–∏—è –≤ —Å—Ç–∞–∫–∞–Ω–µ

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º—ã:

```
–ü–æ–∑–∏—Ü–∏—è: ETH-USDT SHORT, entry=$2998.00, peak_profit=$-0.20

1. –¶–µ–Ω–∞ –≤ —Å—Ç–∞–∫–∞–Ω–µ: $2997.50 (–Ω–æ—Ä–º–∞–ª—å–Ω–æ)
2. –í—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫: $2999.00 (–ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ, 0.5 —Å–µ–∫—É–Ω–¥—ã)
3. Profit Drawdown –≤–∏–¥–∏—Ç: —É–±—ã—Ç–æ–∫ —É–≤–µ–ª–∏—á–∏–ª—Å—è —Å $-0.20 –¥–æ $-0.50
4. ‚ùå –ó–ê–ö–†–´–í–ê–ï–¢ –ø–æ–∑–∏—Ü–∏—é (–ª–æ–∂–Ω–æ–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ!)
5. –¶–µ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è: $2997.50 (–ø–æ–∑–∏—Ü–∏—è –±—ã–ª–∞ –±—ã –ø—Ä–∏–±—ã–ª—å–Ω–æ–π)
```

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `markPx` –≤–º–µ—Å—Ç–æ `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞

**`markPx` (–º–∞—Ä–∫–∏—Ä–æ–≤–æ—á–Ω–∞—è —Ü–µ–Ω–∞)** - —ç—Ç–æ —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è —Ü–µ–Ω–∞, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω–∞—è –±–∏—Ä–∂–µ–π:
- ‚úÖ **–§–∏–ª—å—Ç—Ä—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∫–∏** –≤ —Å—Ç–∞–∫–∞–Ω–µ
- ‚úÖ **–ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞** - –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏–µ
- ‚úÖ **–û—Ç—Ä–∞–∂–∞–µ—Ç —Ä–µ–∞–ª—å–Ω—É—é —Ü–µ–Ω—É** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ PnL –Ω–∞ –±–∏—Ä–∂–µ
- ‚úÖ **–û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ** - –Ω–æ –Ω–µ —Ç–∞–∫ —á–∞—Å—Ç–æ, –∫–∞–∫ —Å—Ç–∞–∫–∞–Ω

### –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:

```python
# ‚úÖ –ó–ê–©–ò–¢–ê –û–¢ –ü–†–û–°–ö–ê–õ–¨–ó–´–í–ê–ù–ò–Ø:
# 1. –ò—Å–ø–æ–ª—å–∑—É–µ–º markPx –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ü–µ–Ω–∞)
# 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É —Å current_price –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞
# 3. –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ > 1% - —ç—Ç–æ –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º markPx
# 4. –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ 0.5-1% - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
# 5. –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ < 0.5% - markPx –∞–∫—Ç—É–∞–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ
```

---

## üìä –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è (—Ä–∞–∑–Ω–∏—Ü–∞ < 0.5%)

```
markPx = $2997.50
current_price (—Å—Ç–∞–∫–∞–Ω) = $2997.48
–†–∞–∑–Ω–∏—Ü–∞ = 0.007% < 0.5%

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º markPx = $2997.50
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫ (—Ä–∞–∑–Ω–∏—Ü–∞ > 1%)

```
markPx = $2997.50
current_price (—Å—Ç–∞–∫–∞–Ω) = $2999.00 (–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫!)
–†–∞–∑–Ω–∏—Ü–∞ = 0.05% > 1%

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º markPx = $2997.50 (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–∫–∞—á–æ–∫)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –°—Ä–µ–¥–Ω—è—è —Ä–∞–∑–Ω–∏—Ü–∞ (0.5-1%)

```
markPx = $2997.50
current_price (—Å—Ç–∞–∫–∞–Ω) = $2998.00
–†–∞–∑–Ω–∏—Ü–∞ = 0.017% (0.5-1%)

‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–µ–µ = ($2997.50 + $2998.00) / 2 = $2997.75
```

---

## üéØ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

### 1. **–ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è**

- ‚úÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∫–∏ –≤ —Å—Ç–∞–∫–∞–Ω–µ –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- ‚úÖ `markPx` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —Ä—ã–Ω–æ—á–Ω—ã–π —à—É–º
- ‚úÖ –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –æ –∑–∞–∫—Ä—ã—Ç–∏–∏

### 2. **–¢–æ—á–Ω–æ—Å—Ç—å**

- ‚úÖ `markPx` –æ—Ç—Ä–∞–∂–∞–µ—Ç —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤—É—é —Ü–µ–Ω—É
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∏—Ä–∂–µ–π –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ PnL
- ‚úÖ –ù–µ –ø–æ–¥–≤–µ—Ä–∂–µ–Ω –º–∞–Ω–∏–ø—É–ª—è—Ü–∏—è–º –≤ —Å—Ç–∞–∫–∞–Ω–µ

### 3. **–ë–∞–ª–∞–Ω—Å**

- ‚úÖ –ü—Ä–∏ –Ω–µ–±–æ–ª—å—à–æ–π —Ä–∞–∑–Ω–∏—Ü–µ (< 0.5%) –∏—Å–ø–æ–ª—å–∑—É–µ–º `markPx`
- ‚úÖ –ü—Ä–∏ —Å—Ä–µ–¥–Ω–µ–π —Ä–∞–∑–Ω–∏—Ü–µ (0.5-1%) –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- ‚úÖ –ü—Ä–∏ –±–æ–ª—å—à–æ–π —Ä–∞–∑–Ω–∏—Ü–µ (> 1%) –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–∫–∞—á–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º `markPx`

---

## üìù –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py`

**–ú–µ—Ç–æ–¥:** `_check_profit_drawdown`

**–°—Ç—Ä–æ–∫–∏:** 3735-3775

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º `markPx` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–≤–º–µ—Å—Ç–æ `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É `markPx` –∏ `current_price`
- ‚úÖ –ü—Ä–∏ —Ä–∞–∑–Ω–∏—Ü–µ > 1% - –∏—Å–ø–æ–ª—å–∑—É–µ–º `markPx` (–∑–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è)
- ‚úÖ –ü—Ä–∏ —Ä–∞–∑–Ω–∏—Ü–µ 0.5-1% - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- ‚úÖ –ü—Ä–∏ —Ä–∞–∑–Ω–∏—Ü–µ < 0.5% - –∏—Å–ø–æ–ª—å–∑—É–µ–º `markPx`

---

## ‚úÖ –ò—Ç–æ–≥

**–ü—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–µ–Ω–∞!** Profit Drawdown —Ç–µ–ø–µ—Ä—å –∑–∞—â–∏—â–µ–Ω –æ—Ç –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è:

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `markPx` (–±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ü–µ–Ω–∞)
- ‚úÖ –§–∏–ª—å—Ç—Ä—É–µ—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–∫–∞—á–∫–∏ –≤ —Å—Ç–∞–∫–∞–Ω–µ
- ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –∏–∑-–∑–∞ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è
- ‚úÖ –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è –æ –∑–∞–∫—Ä—ã—Ç–∏–∏

**–ï—Å–ª–∏ —Ü–µ–Ω–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ —Å–∫–∞–∫–Ω–µ—Ç, –Ω–æ –ø–æ—Ç–æ–º –≤–µ—Ä–Ω–µ—Ç—Å—è - –±–æ—Ç –ù–ï –∑–∞–∫—Ä–æ–µ—Ç –ø–æ–∑–∏—Ü–∏—é!** üéâ

---

## üîÑ –°—Ä–∞–≤–Ω–µ–Ω–∏–µ

### –ë–´–õ–û (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª current_price –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞):

```
–í—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫ ‚Üí Profit Drawdown –≤–∏–¥–∏—Ç —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —É–±—ã—Ç–∫–∞ ‚Üí ‚ùå –ó–ê–ö–†–´–í–ê–ï–¢
```

### –°–¢–ê–õ–û (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç markPx):

```
–í—Ä–µ–º–µ–Ω–Ω—ã–π —Å–∫–∞—á–æ–∫ ‚Üí markPx –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí ‚úÖ –ù–ï –ó–ê–ö–†–´–í–ê–ï–¢
–†–µ–∞–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ ‚Üí markPx –∏–∑–º–µ–Ω–∏–ª—Å—è ‚Üí ‚úÖ –ó–ê–ö–†–´–í–ê–ï–¢ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```

---

## üìå –í–∞–∂–Ω–æ

**`markPx` vs `current_price` –∏–∑ —Å—Ç–∞–∫–∞–Ω–∞:**

- **`markPx`** - —Å–ø—Ä–∞–≤–µ–¥–ª–∏–≤–∞—è —Ü–µ–Ω–∞ –±–∏—Ä–∂–∏, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç —à—É–º, –±–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–∞
- **`current_price`** - —Ü–µ–Ω–∞ –≤ —Å—Ç–∞–∫–∞–Ω–µ, –º–æ–∂–µ—Ç —Å–∫–∞–∫–∞—Ç—å, –ø–æ–¥–≤–µ—Ä–∂–µ–Ω–∞ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—é

**–î–ª—è Profit Drawdown –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `markPx`** - –æ–Ω –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π! ‚úÖ





