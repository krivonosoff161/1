# üö® –ü–†–û–ë–õ–ï–ú–ê: –†–∞–Ω–Ω–µ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∏ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–π

## üìä –§–ê–ö–¢–´

**–ü–æ–∑–∏—Ü–∏—è SOL-USDT:**
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 04.12.2025, 23:19:58
- **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è:** 04.12.2025, 23:20:33
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 35 —Å–µ–∫—É–Ω–¥ (0.58 –º–∏–Ω—É—Ç—ã)
- **–í—Ö–æ–¥–Ω–∞—è —Ü–µ–Ω–∞:** 140.11 USDT
- **–¶–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞:** 140.25 USDT
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PnL:** +0.00 USDT (+0.01%)
- **–†–∞–∑–º–µ—Ä:** 0.72 SOL

**–°—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è:**
- –í 23:20:58 –æ—Ç–∫—Ä—ã–ª–∞—Å—å –Ω–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è SOL-USDT LONG
- –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –∑–∞–∫—Ä—ã—Ç–∏–µ–º –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º

## ‚ö†Ô∏è –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. **–ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å —á–µ—Ä–µ–∑ **35 —Å–µ–∫—É–Ω–¥** (0.58 –º–∏–Ω—É—Ç—ã)
- `min_holding_minutes` –¥–ª—è ranging —Ä–µ–∂–∏–º–∞ = **35.0 –º–∏–Ω—É—Ç**
- –î–∞–∂–µ —Å `adaptive_min_holding` (—Å–Ω–∏–∂–∞–µ—Ç –¥–æ 0.5 –º–∏–Ω—É—Ç –ø—Ä–∏ –ø—Ä–∏–±—ã–ª–∏ >= 0.5%) –ø–æ–∑–∏—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã–ª–∞ –¥–µ—Ä–∂–∞—Ç—å—Å—è –º–∏–Ω–∏–º—É–º **30 —Å–µ–∫—É–Ω–¥**
- –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å —á–µ—Ä–µ–∑ 35 —Å–µ–∫—É–Ω–¥, —á—Ç–æ **—á—É—Ç—å –±–æ–ª—å—à–µ** –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ min_holding, –Ω–æ **–Ω–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ** —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ min_holding

**–ü—Ä–∏—á–∏–Ω–∞:**
- –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –∑–∞–∫—Ä—ã–ª–æ –ø–æ–∑–∏—Ü–∏—é (–Ω–µ—Ç –ª–æ–≥–æ–≤ –∑–∞–∫—Ä—ã—Ç–∏—è)
- –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
  - Trailing Stop Loss (–Ω–æ PnL –±—ã–ª +0.01%, –Ω–µ —É–±—ã—Ç–æ–∫)
  - Exit Analyzer (–Ω–æ –≤ –ª–æ–≥–∞—Ö –±—ã–ª–æ `action=hold, reason=partial_tp_min_holding_wait`)
  - –î—Ä—É–≥–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –∑–∞–∫—Ä—ã—Ç–∏—è

### 2. **–ù–µ—Ç cooldown –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è
- –ï—Å—Ç—å —Ç–æ–ª—å–∫–æ `signal_cooldown_seconds: 60.0` –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–∞–º–∏, –Ω–æ —ç—Ç–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞, –∫–æ—Ç–æ—Ä—ã–π –±—ã –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –æ—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–π –ø–æ–∑–∏—Ü–∏–∏ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è

**–¢–µ–∫—É—â–∏–π –∫–æ–¥:**
```python
# src/strategies/scalping/futures/coordinators/signal_coordinator.py:419-439
# ‚úÖ RATE LIMIT: per-symbol cooldown –º–µ–∂–¥—É –≤—Ö–æ–¥–∞–º–∏
cooldown = getattr(self.scalping_config, "signal_cooldown_seconds", 0.0) or 0.0
if cooldown and cooldown > 0:
    now_ts = datetime.utcnow().timestamp()
    last_ts = self._last_signal_time.get(symbol)
    if last_ts and (now_ts - last_ts) < cooldown:
        # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –≤—Ö–æ–¥
        return
    self._last_signal_time[symbol] = now_ts
```

**–ü—Ä–æ–±–ª–µ–º–∞:** `_last_signal_time` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ **–ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞**, –∞ –Ω–µ –ø—Ä–∏ **–∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏**. –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å, –∞ –Ω–æ–≤—ã–π —Å–∏–≥–Ω–∞–ª –ø—Ä–∏—à–µ–ª —Å—Ä–∞–∑—É, cooldown –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç.

### 3. **–ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤ –Ω–æ–ª—å**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- PnL: +0.01% (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–æ–ª—å)
- –ü–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π –ø—Ä–∏–±—ã–ª—å –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–π
- –≠—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ç–æ, —á—Ç–æ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –Ω–µ –ø–æ –ø—Ä–∏–±—ã–ª–∏, –∞ –ø–æ –∫–∞–∫–æ–π-—Ç–æ –¥—Ä—É–≥–æ–π –ø—Ä–∏—á–∏–Ω–µ

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. **–î–æ–±–∞–≤–∏—Ç—å cooldown –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏**

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å `cooldown_after_close_seconds` –≤ –∫–æ–Ω—Ñ–∏–≥
- –û–±–Ω–æ–≤–ª—è—Ç—å `_last_signal_time` –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏ (–Ω–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –≤—Ö–æ–¥–∞)
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è —Å–∏–º–≤–æ–ª–∞ –Ω–∞ –≤—Ä–µ–º—è cooldown –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è

**–ö–æ–¥ –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
```python
# –í signal_coordinator.py
async def on_position_closed(self, symbol: str):
    """–í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏"""
    if not hasattr(self, "_last_signal_time"):
        self._last_signal_time = {}
    cooldown = getattr(self.scalping_config, "cooldown_after_close_seconds", 0.0) or 0.0
    if cooldown > 0:
        self._last_signal_time[symbol] = datetime.utcnow().timestamp()
        logger.info(f"‚è≥ Cooldown –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è {symbol}: {cooldown} —Å–µ–∫")
```

### 2. **–£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π**

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è –≤ `position_manager.close_position_manually()`
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞–∫—Ä—ã—Ç–∏—è (TP, SL, TSL, Exit Analyzer, Timeout, etc.)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏

### 3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å min_holding –∑–∞—â–∏—Ç—É**

**–†–µ—à–µ–Ω–∏–µ:**
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç `min_holding` –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
- –ò—Å–∫–ª—é—á–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ `loss_cut` –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å —Ä–∞–Ω—å—à–µ min_holding (–ø–æ—Å–ª–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ 5 —Å–µ–∫)
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å, –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Ä–∞–Ω—å—à–µ min_holding (–∫—Ä–æ–º–µ loss_cut)

### 4. **–î–æ–±–∞–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π PnL –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è**

**–†–µ—à–µ–Ω–∏–µ:**
- –ù–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é, –µ—Å–ª–∏ PnL < –∫–æ–º–∏—Å—Å–∏–π (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤ –Ω–æ–ª—å)
- –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `min_pnl_to_close_percent` –≤ –∫–æ–Ω—Ñ–∏–≥
- –ï—Å–ª–∏ PnL < `min_pnl_to_close_percent`, –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å (–∫—Ä–æ–º–µ loss_cut –∏ emergency)

## üìù –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø

**–¢–µ–∫—É—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
```yaml
scalping:
  signal_cooldown_seconds: 60.0  # Cooldown –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–∞–º–∏
  trailing_stop_loss:
    by_regime:
      ranging:
        min_holding_minutes: 35.0  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
```yaml
scalping:
  signal_cooldown_seconds: 60.0  # Cooldown –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–∞–º–∏
  cooldown_after_close_seconds: 120.0  # ‚úÖ –ù–û–í–û–ï: Cooldown –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏ (2 –º–∏–Ω—É—Ç—ã)
  min_pnl_to_close_percent: 0.05  # ‚úÖ –ù–û–í–û–ï: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π PnL –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è (0.05% = –∫–æ–º–∏—Å—Å–∏–∏)
  trailing_stop_loss:
    by_regime:
      ranging:
        min_holding_minutes: 35.0  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
```

## üîç –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó

**–ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ß—Ç–æ –∑–∞–∫—Ä—ã–ª–æ –ø–æ–∑–∏—Ü–∏—é SOL-USDT (–Ω–µ—Ç –ª–æ–≥–æ–≤ –∑–∞–∫—Ä—ã—Ç–∏—è)
2. –ü–æ—á–µ–º—É Exit Analyzer –ø–æ–∫–∞–∑–∞–ª `hold`, –Ω–æ –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å
3. –†–∞–±–æ—Ç–∞–µ—Ç –ª–∏ min_holding –∑–∞—â–∏—Ç–∞ –≤–æ –≤—Å–µ—Ö –º–µ—Ö–∞–Ω–∏–∑–º–∞—Ö –∑–∞–∫—Ä—ã—Ç–∏—è
4. –ï—Å—Ç—å –ª–∏ –¥—Ä—É–≥–∏–µ —Å–ª—É—á–∞–∏ —Ä–∞–Ω–Ω–µ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –≤ –ª–æ–≥–∞—Ö

## ‚úÖ –ü–†–ò–û–†–ò–¢–ï–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

1. **‚úÖ –í–´–ü–û–õ–ù–ï–ù–û:** –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `_close_position_by_reason`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `close_position_manually`
   - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `handle_position_closed_via_ws`
   - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è: –ø—Ä–∏—á–∏–Ω–∞, —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞, entry/exit —Ü–µ–Ω–∞, —Ä–∞–∑–º–µ—Ä, –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è, Gross/Net PnL, PnL% –æ—Ç –º–∞—Ä–∂–∏ –∏ –æ—Ç —Ü–µ–Ω—ã, –∫–æ–º–∏—Å—Å–∏–∏, funding fee, slippage
2. **–°–†–ï–î–ù–ò–ô:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å min_holding –∑–∞—â–∏—Ç—É
3. **–ù–ò–ó–ö–ò–ô:** –î–æ–±–∞–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π PnL –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** Cooldown –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ –Ω—É–∂–µ–Ω –≤ —Å–∫–∞–ª—å–ø–∏–Ω–≥–µ, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø–æ—Ç–µ—Ä–µ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏.

