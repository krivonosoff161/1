# –û—Ç–≤–µ—Ç –Ω–∞ –∞—É–¥–∏—Ç Kimi: –ê–Ω–∞–ª–∏–∑ –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç–∏ –ø—Ä–æ–±–ª–µ–º —Å —É—á–µ—Ç–æ–º –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞:** 2025-12-07  
**–ê—É–¥–∏—Ç–æ—Ä:** Kimi  
**–ê–Ω–∞–ª–∏–∑:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–≥–æ –ø—É–Ω–∫—Ç–∞ —Å —É—á–µ—Ç–æ–º –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –±–æ—Ç–∞

---

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –∞—É–¥–∏—Ç–∞

**–¢–æ—á–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê‚≠ê (4/5) - –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∑–∞–º–µ—á–∞–Ω–∏–π –≤–µ—Ä–Ω—ã, –Ω–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã  
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** ‚≠ê‚≠ê‚≠ê (3/5) - –ï—Å—Ç—å –≤–∞–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ –Ω–µ –≤—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è —Ç–µ–∫—É—â–µ–π —Ä–∞–±–æ—Ç—ã  
**–£—á–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏:** ‚≠ê‚≠ê (2/5) - –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ —É—á—Ç–µ–Ω–∞, –Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é

---

## üî¥ 1. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –±—ç–∫—Ç–µ—Å—Ç–∞ = "—Å–ª–µ–ø–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è"

### ‚úÖ –í–µ—Ä–Ω–æ, –Ω–æ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ

**–ê–Ω–∞–ª–∏–∑:**

1. **Sandbox –∫–∞–∫ –∑–∞–º–µ–Ω–∞ –±—ç–∫—Ç–µ—Å—Ç–∞:**
   - –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç OKX sandbox –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
   - –≠—Ç–æ —Ä–µ–∞–ª—å–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è –Ω–∞ –¥–µ–º–æ-—Å—á–µ—Ç–µ, —á—Ç–æ –ª—É—á—à–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –±—ç–∫—Ç–µ—Å—Ç–∞
   - –ù–æ –Ω–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –Ω–∞ –±–æ–ª—å—à–∏—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö

2. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç:**
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ–¥ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
   - Per-symbol –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã
   - –ù–æ —ç—Ç–æ –Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°—Ä–µ–¥–Ω—è—è (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç live-—Ç–æ—Ä–≥–æ–≤–ª—é, –Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å backtesting –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sandbox –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥: backtest ‚Üí sandbox ‚Üí live

---

## üî¥ 2. Kelly Criterion –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚úÖ –í–ï–†–ù–û - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞:**

```python
# –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (margin_calculator.py:624-625)
kelly_fraction_safe = min(kelly_fraction * 0.25, 0.1)  # –ú–∞–∫—Å–∏–º—É–º 10% –æ—Ç –±–∞–ª–∞–Ω—Å–∞
kelly_multiplier = max(0.5, min(2.0, kelly_fraction_safe / risk_percentage))
adjusted_risk_percentage = risk_percentage * kelly_multiplier
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

1. **Kelly –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –º–Ω–æ–∂–∏—Ç–µ–ª—å –∫ —É–∂–µ –∑–∞–¥–∞–Ω–Ω–æ–º—É risk%:**
   - –ï—Å–ª–∏ `risk_percentage = 0.03` (3%) –∏ `kelly_fraction_safe = 0.05` (5%)
   - –¢–æ `kelly_multiplier = 0.05 / 0.03 = 1.67`
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∏—Å–∫: `0.03 * 1.67 = 0.05` (5%)
   - **–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!** Kelly —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏, –µ—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ö–æ—Ä–æ—à–∞—è

2. **–ù–û –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–µ–π:**
   - –ï—Å–ª–∏ `kelly_fraction_safe = 0.1` (10%) –∏ `risk_percentage = 0.03` (3%)
   - –¢–æ `kelly_multiplier = min(2.0, 0.1 / 0.03) = 2.0` (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω —Å–≤–µ—Ä—Ö—É)
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∏—Å–∫: `0.03 * 2.0 = 0.06` (6%)
   - **–ù–æ Kelly –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –º–æ–∂–Ω–æ —Ä–∏—Å–∫–æ–≤–∞—Ç—å 10%, –∞ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ 6%**

3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è:**
   - Kelly —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ä–µ–∂–∏–º—É (trending/ranging/choppy)
   - –ù–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ä–µ–∂–∏–º–∞–º –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞
   - –ë—ã—Å—Ç—Ä–æ —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç –∏–∑-–∑–∞ —á–∞—Å—Ç—ã—Ö —Å–¥–µ–ª–æ–∫

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ –í—ã—Å–æ–∫–∞—è (–∏—Å–∫–∞–∂–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Kelly –Ω–∞–ø—Ä—è–º—É—é –∫–∞–∫ `risk_percentage = kelly_fraction_safe`
- ‚úÖ –ò–ª–∏ —É–±—Ä–∞—Ç—å Kelly –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞ (—Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä–æ —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Kelly —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

---

## üî¥ 3. ATR –∏ % TP/SL ‚Äî –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ –ø–æ–¥—Ö–æ–¥—ã

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –≤–µ—Ä–Ω–æ, –Ω–æ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É

**–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞:**

```python
# position_manager.py:_get_adaptive_tp_percent()
# –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
# 1. Per-regime TP (–µ—Å–ª–∏ —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω)
# 2. Per-symbol TP (fallback)
# 3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π TP (fallback)
# 4. ATR-based TP (—É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è, –Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)
```

**–†–µ–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**

1. **ATR-based TP –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é:**
   - –í –∫–æ–¥–µ –µ—Å—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ ATR-based —Ä–∞—Å—á–µ—Ç–∞ (—Å—Ç—Ä–æ–∫–∞ 220-264)
   - –ù–æ –æ–Ω –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º —Ä–∞—Å—á–µ—Ç–µ
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π % –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

2. **–ù–û –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç:**
   - **Per-symbol TP:** BTC-USDT –∏–º–µ–µ—Ç `tp_percent: 5.0%` –≤ trending, DOGE-USDT –∏–º–µ–µ—Ç –¥—Ä—É–≥–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
   - **Per-regime TP:** Trending = 2.5%, Ranging = 2.0%, Choppy = 1.5%
   - –≠—Ç–æ —É–∂–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä –∏ —Ä–µ–∂–∏–º–æ–≤

3. **–ü—Ä–æ–±–ª–µ–º–∞ –æ—Å—Ç–∞–µ—Ç—Å—è:**
   - –í–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞ –∏ —Å–∏–º–≤–æ–ª–∞ TP —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
   - –ù–µ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ —Ç–µ–∫—É—â–µ–π ATR
   - –ù–∞ –≤—ã—Å–æ–∫–æ–≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–∞—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–º

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°—Ä–µ–¥–Ω—è—è (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–∞–µ—Ç, –Ω–æ ATR-based –±—ã–ª –±—ã –ª—É—á—à–µ)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å ATR-based TP/SL —Ä–∞—Å—á–µ—Ç
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `max(base_tp_percent, atr_tp_percent)` –∫–∞–∫ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–æ –≤ –∞—É–¥–∏—Ç–µ
- ‚úÖ –ò–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ ATR-based —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏/–º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º–∏ –≥—Ä–∞–Ω–∏—Ü–∞–º–∏

---

## üî¥ 4. RSI + EMA –∫–æ–Ω—Ñ–ª–∏–∫—Ç –Ω–µ —Ä–µ—à—ë–Ω –ª–æ–≥–∏—á–µ—Å–∫–∏

### ‚úÖ –í–ï–†–ù–û - –ü—Ä–æ–±–ª–µ–º–∞ –µ—Å—Ç—å, –Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–∞

**–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞:**

```python
# signal_generator.py:2005-2047
if is_downtrend:  # RSI oversold, –Ω–æ EMA bearish
    strength *= conflict_multiplier  # –û–±—ã—á–Ω–æ 0.5
    confidence = normal_conf * 0.5  # 50% –æ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π
    has_conflict = True
    # –ù–û —Å–∏–≥–Ω–∞–ª –≤—Å–µ —Ä–∞–≤–Ω–æ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è!

# –ù–û –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ ADX:
if adx_trend == "bearish" and adx_value >= adx_threshold:
    # –°–∏–ª—å–Ω—ã–π –Ω–∏—Å—Ö–æ–¥—è—â–∏–π —Ç—Ä–µ–Ω–¥ - –ù–ï –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º BUY —Å–∏–≥–Ω–∞–ª
    logger.debug("üö´ RSI OVERSOLD —Å–∏–≥–Ω–∞–ª –û–¢–ú–ï–ù–ï–ù")
else:
    signals.append(...)  # –°–∏–≥–Ω–∞–ª –≤—Å–µ —Ä–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è
```

**–ü—Ä–æ–±–ª–µ–º–∞:**

1. **–í trending —Ä–µ–∂–∏–º–µ:**
   - –ï—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ ADX, –∫–æ—Ç–æ—Ä–∞—è –º–æ–∂–µ—Ç –æ—Ç–º–µ–Ω–∏—Ç—å —Å–∏–≥–Ω–∞–ª
   - –ù–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `adx_trend == "bearish"` –ò `adx_value >= threshold`
   - –ï—Å–ª–∏ ADX —Å–ª–∞–±—ã–π, —Å–∏–≥–Ω–∞–ª –≤—Å–µ —Ä–∞–≤–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç

2. **–í ranging/choppy —Ä–µ–∂–∏–º–∞—Ö:**
   - –ù–µ—Ç —Å—Ç—Ä–æ–≥–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ç—Ä–µ–Ω–¥–∞
   - –°–∏–≥–Ω–∞–ª –æ—Å–ª–∞–±–ª—è–µ—Ç—Å—è, –Ω–æ –Ω–µ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è

3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:**
   - `conflict_multiplier` –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ —Ä–µ–∂–∏–º–∞–º
   - –ù–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é = 0.5 –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
   - –í trending —Ä–µ–∂–∏–º–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å = 0.0 (–ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°—Ä–µ–¥–Ω—è—è (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ —á–µ—Ä–µ–∑ ADX, –Ω–æ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –í trending —Ä–µ–∂–∏–º–µ: `conflict_multiplier = 0.0` (–ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–æ—Ç–∏–≤–æ—Ç—Ä–µ–Ω–¥–æ–≤—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤)
- ‚úÖ –í ranging —Ä–µ–∂–∏–º–µ: `conflict_multiplier = 0.3` (—Å–∏–ª—å–Ω–æ–µ –æ—Å–ª–∞–±–ª–µ–Ω–∏–µ)
- ‚úÖ –í choppy —Ä–µ–∂–∏–º–µ: `conflict_multiplier = 0.5` (—É–º–µ—Ä–µ–Ω–Ω–æ–µ –æ—Å–ª–∞–±–ª–µ–Ω–∏–µ)
- ‚úÖ –ò–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–∏–≥–Ω–∞–ª –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ –≤ trending

---

## üü† 5. –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫ –Ω–∞ —Å–¥–µ–ª–∫—É: 3%

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –≤–µ—Ä–Ω–æ, –Ω–æ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–Ω–∏–∂–∞–µ—Ç —Ä–∏—Å–∫

**–ê–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:**

```yaml
# config_futures.yaml
base_risk_percentage: 0.03  # 3% (–≥–ª–æ–±–∞–ª—å–Ω—ã–π)
risk_per_trade_percent: 1.5  # 1.5% (–≤ risk —Å–µ–∫—Ü–∏–∏)

# –ê–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º–∞–º:
by_regime:
  trending:
    max_loss_per_trade_percent: 1.5  # 1.5%
  ranging:
    max_loss_per_trade_percent: 2.0  # 2.0%
  choppy:
    max_loss_per_trade_percent: 2.5  # 2.5%
```

**–†–µ–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**

1. **–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫:**
   - `base_risk_percentage: 0.03` (3%) - —ç—Ç–æ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
   - `risk_per_trade_percent: 1.5` (1.5%) - —ç—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø–æ—Ç–µ—Ä—è –Ω–∞ —Å–¥–µ–ª–∫—É
   - **–†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ª–µ–π!**

2. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∏—Å–∫ –ø–æ —Ä–µ–∂–∏–º–∞–º:**
   - Trending: 1.5% (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–æ)
   - Ranging: 2.0% (—É–º–µ—Ä–µ–Ω–Ω–æ)
   - Choppy: 2.5% (–±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ, –Ω–æ —Ä–µ–∂–µ —Å–¥–µ–ª–∫–∏)

3. **–ü—Ä–æ–±–ª–µ–º–∞:**
   - `base_risk_percentage: 0.03` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏
   - –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –≤—ã—Å–æ–∫–æ –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞
   - –ù–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —Ä–µ–∂–∏–º–∞–º —Å–Ω–∏–∂–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∏—Å–∫

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü° –°—Ä–µ–¥–Ω—è—è (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç, –Ω–æ –±–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫ –≤—ã—Å–æ–∫)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –°–Ω–∏–∑–∏—Ç—å `base_risk_percentage` –¥–æ 0.01-0.015 (1-1.5%)
- ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —Ä–µ–∂–∏–º–∞–º –∫–∞–∫ –µ—Å—Ç—å
- ‚úÖ –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, —É–±—Ä–∞–≤ –≥–ª–æ–±–∞–ª—å–Ω—ã–π

---

## üü† 6. –ù–µ—Ç —É—á—ë—Ç–∞ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –∏ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è

### ‚ùå –ù–ï–í–ï–†–ù–û - –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è!

**–ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞:**

```python
# filters/liquidity_filter.py
async def evaluate(self, symbol, regime, ...):
    # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç:
    # 1. min_best_bid_volume_usd (–¥–ª—è LONG)
    # 2. min_best_ask_volume_usd (–¥–ª—è SHORT)
    # 3. min_orderbook_depth_usd (–≥–ª—É–±–∏–Ω–∞ —Å—Ç–∞–∫–∞–Ω–∞)
    # 4. max_spread_percent (—Å–ø—Ä–µ–¥)
    
    if snapshot.best_bid_volume_usd < thresholds["min_best_bid_volume_usd"]:
        return False, snapshot  # –°–∏–≥–Ω–∞–ª –æ—Ç–∫–ª–æ–Ω–µ–Ω
    
    if snapshot.depth_bid_usd < thresholds["min_orderbook_depth_usd"]:
        return False, snapshot  # –°–∏–≥–Ω–∞–ª –æ—Ç–∫–ª–æ–Ω–µ–Ω
```

**–†–µ–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**

1. **LiquidityFilter —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±—ä–µ–º –Ω–∞ –ª—É—á—à–∏—Ö —Ü–µ–Ω–∞—Ö (bid/ask)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–ª—É–±–∏–Ω—É —Å—Ç–∞–∫–∞–Ω–∞
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–ø—Ä–µ–¥
   - **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º–∞–º –∏ —Å–∏–º–≤–æ–ª–∞–º!**

2. **Slippage Guard:**
   - –ï—Å—Ç—å `slippage_guard` –≤ `order_executor.py`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç slippage –ø–µ—Ä–µ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –æ—Ä–¥–µ—Ä–∞
   - –ù–æ –Ω–µ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç –µ–≥–æ –∑–∞—Ä–∞–Ω–µ–µ

3. **Min lot size:**
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ `order_executor.py:836`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `minSz` –∏–∑ instrument details

**–ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:**

- ‚ùå –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ slippage –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –æ—Ä–¥–µ—Ä–∞
- ‚ùå –ü—Ä–æ–≤–µ—Ä–∫–∞, —Ö–≤–∞—Ç–∏—Ç –ª–∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –Ω–∞ –Ω—É–∂–Ω—ã–π –æ–±—ä–µ–º
- ‚ùå –†–∞—Å—á–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–≥–æ slippage –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º

**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üü¢ –ù–∏–∑–∫–∞—è (–±–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å, –Ω–æ –º–æ–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ä–∞—Å—á–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–≥–æ slippage –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å, —á—Ç–æ `orderbook_depth_at_price(target_price, size) >= required_volume`
- ‚úÖ –£–ª—É—á—à–∏—Ç—å –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ slippage

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ —Å —É—á–µ—Ç–æ–º –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ –±–ª–∞–≥–æ–¥–∞—Ä—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏:

1. **Per-symbol –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - BTC-USDT: `tp_percent: 5.0%` –≤ trending
   - DOGE-USDT: –¥—Ä—É–≥–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
   - –≠—Ç–æ —É–∂–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å

2. **Per-regime –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:**
   - Trending: –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - Ranging: —É–º–µ—Ä–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   - Choppy: –±–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ, –Ω–æ —Ä–µ–∂–µ —Å–¥–µ–ª–∫–∏

3. **–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∏—Å–∫:**
   - –ü–æ —Ä–µ–∂–∏–º–∞–º: 1.5% / 2.0% / 2.5%
   - –ü–æ –±–∞–ª–∞–Ω—Å—É: micro/small/medium/large

### ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:

1. **Kelly Criterion** - –∫—Ä–∏—Ç–∏—á–Ω–æ, –∏—Å–∫–∞–∂–∞–µ—Ç —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–π
2. **RSI + EMA –∫–æ–Ω—Ñ–ª–∏–∫—Ç** - –≤ trending —Ä–µ–∂–∏–º–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
3. **ATR-based TP/SL** - –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
4. **–ë–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫ 3%** - —Å–Ω–∏–∑–∏—Ç—å –¥–æ 1-1.5%

### üü¢ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ª—É—á—à–µ, —á–µ–º –æ–ø–∏—Å–∞–Ω–æ –≤ –∞—É–¥–∏—Ç–µ:

1. **–õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ LiquidityFilter
2. **Min lot size** - –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º –æ—Ä–¥–µ—Ä–∞
3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å** - –±–æ–ª–µ–µ —Ä–∞–∑–≤–∏—Ç–∞, —á–µ–º —É—á—Ç–µ–Ω–æ –≤ –∞—É–¥–∏—Ç–µ

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):

1. **Kelly Criterion** - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∏–ª–∏ —É–±—Ä–∞—Ç—å
2. **RSI + EMA –≤ trending** - –ø–æ–ª–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–µ

### üü° –í–∞–∂–Ω–æ (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):

3. **ATR-based TP/SL** - –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é
4. **–ë–∞–∑–æ–≤—ã–π —Ä–∏—Å–∫ 3%** - —Å–Ω–∏–∑–∏—Ç—å –¥–æ 1-1.5%

### üü¢ –£–ª—É—á—à–µ–Ω–∏—è (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å):

5. **–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ slippage** - —É–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç
6. **Backtesting –º–æ–¥—É–ª—å** - –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ê—É–¥–∏—Ç Kimi –≤ —Ü–µ–ª–æ–º –≤–µ—Ä–µ–Ω**, –Ω–æ **–Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É—á–∏—Ç—ã–≤–∞–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã**:

- ‚úÖ –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –ø—Ä–æ–±–ª–µ–º —Ä–µ–∞–ª—å–Ω—ã
- ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–≤—ã—à–µ–Ω–∞ –∏–∑-–∑–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –≤ —Ü–µ–ª–æ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ
- ‚ö†Ô∏è –ù–æ –Ω—É–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ —Å–∏—Å—Ç–µ–º–∞ —É–∂–µ —á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—ã —á–µ—Ä–µ–∑ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–ì–ª–∞–≤–Ω—ã–π –≤—ã–≤–æ–¥:**

–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ **—á–∞—Å—Ç–∏—á–Ω–æ –∫–æ–º–ø–µ–Ω—Å–∏—Ä—É–µ—Ç** –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –Ω–æ **–Ω–µ —Ä–µ—à–∞–µ—Ç –∏—Ö –ø–æ–ª–Ω–æ—Å—Ç—å—é**. –ù—É–∂–Ω–æ:

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã (Kelly, RSI+EMA –∫–æ–Ω—Ñ–ª–∏–∫—Ç)
2. –î–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å (ATR-based TP/SL)
3. –î–æ–±–∞–≤–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ (backtesting, —É–ª—É—á—à–µ–Ω–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ slippage)

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ live-—Ç–æ—Ä–≥–æ–≤–ª–µ:** ‚≠ê‚≠ê‚≠ê (3/5) - –ú–æ–∂–Ω–æ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –Ω–∞ sandbox, –Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ø–µ—Ä–µ–¥ live

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-12-07

