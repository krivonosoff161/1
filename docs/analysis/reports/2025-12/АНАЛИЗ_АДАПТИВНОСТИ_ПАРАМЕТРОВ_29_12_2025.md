# –ê–ù–ê–õ–ò–ó –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–ò –ü–ê–†–ê–ú–ï–¢–†–û–í –í EXITANALYZER (29.12.2025)

**–î–∞—Ç–∞:** 29.12.2025  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤—Å–µ –ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø–æ —Ä–µ–∂–∏–º–∞–º –∏ –ø–∞—Ä–∞–º

---

## ‚úÖ –ß–¢–û –†–ê–ë–û–¢–ê–ï–¢ –ê–î–ê–ü–¢–ò–í–ù–û

### 1. `min_holding_minutes` ‚Äî ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ê–î–ê–ü–¢–ò–í–ù–û
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è:**
1. ‚úÖ `exit_params.{regime}.min_holding_minutes` (—á–µ—Ä–µ–∑ ParameterProvider)
2. ‚úÖ `adaptive_regime.{regime}.min_holding_minutes`
3. ‚úÖ `by_symbol.{symbol}.{regime}.min_holding_minutes` (per-symbol –ø–æ —Ä–µ–∂–∏–º—É)
4. ‚úÖ `by_symbol.{symbol}.min_holding_minutes` (per-symbol –æ–±—â–∏–π)

**–ö–æ–¥:** `exit_analyzer.py:1425-1520`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞

**–ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:**
- `exit_params.ranging.min_holding_minutes: 1.5` (90 —Å–µ–∫)
- `exit_params.trending.min_holding_minutes: 0.8` (48 —Å–µ–∫)
- `exit_params.choppy.min_holding_minutes: 2.5` (150 —Å–µ–∫)
- `by_symbol.ETH-USDT.min_holding_minutes.ranging: 2.0` (2 –º–∏–Ω –¥–ª—è ETH –≤ RANGING)

---

### 2. Smart Close –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ê–î–ê–ü–¢–ò–í–ù–û
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–ª—É—á–µ–Ω–∏—è:**
1. ‚úÖ `by_symbol.{symbol}.smart_close.{regime}.reversal_score_threshold`
2. ‚úÖ `by_symbol.{symbol}.smart_close.{regime}.trend_against_threshold`
3. ‚úÖ `exit_params.smart_close.{regime}.reversal_score_threshold`
4. ‚úÖ `exit_params.smart_close.{regime}.trend_against_threshold`
5. ‚úÖ Default –∑–Ω–∞—á–µ–Ω–∏—è (reversal_score=2.0, trend_against=0.7)

**–ö–æ–¥:** `parameter_provider.py:209-310`, `exit_analyzer.py:4764-4768`  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—Å–µ —É—Ä–æ–≤–Ω–∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞

**–ü—Ä–∏–º–µ—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:**
- `exit_params.smart_close.ranging.reversal_score_threshold: 3`
- `exit_params.smart_close.trending.reversal_score_threshold: 1`
- `exit_params.smart_close.choppy.reversal_score_threshold: 4`
- `by_symbol.ETH-USDT.smart_close.reversal_score_threshold.ranging: 4`

---

### 3. TP –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û –ê–î–ê–ü–¢–ò–í–ù–û
**–ö–∞–∫ –ø–æ–ª—É—á–∞–µ—Ç—Å—è:**
1. ‚úÖ `exit_params.{regime}.tp_percent` (—á–µ—Ä–µ–∑ ParameterProvider)
2. ‚úÖ `exit_params.{regime}.tp_atr_multiplier` (—á–µ—Ä–µ–∑ ParameterProvider)
3. ‚ö†Ô∏è Fallback –Ω–∞ `symbol_profiles.{symbol}.{regime}.tp_percent`
4. ‚ùå **–ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ `by_symbol.{symbol}.tp_percent`**

**–ö–æ–¥:** `exit_analyzer.py:768-850`  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ ParameterProvider, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `by_symbol` –Ω–∞–ø—Ä—è–º—É—é

---

### 4. SL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî ‚ö†Ô∏è –ß–ê–°–¢–ò–ß–ù–û –ê–î–ê–ü–¢–ò–í–ù–û
**–ö–∞–∫ –ø–æ–ª—É—á–∞–µ—Ç—Å—è:**
1. ‚úÖ `exit_params.{regime}.sl_percent` (—á–µ—Ä–µ–∑ ParameterProvider)
2. ‚úÖ `exit_params.{regime}.sl_atr_multiplier` (—á–µ—Ä–µ–∑ ParameterProvider)
3. ‚ö†Ô∏è Fallback –Ω–∞ `symbol_profiles.{symbol}.{regime}.sl_percent`
4. ‚ö†Ô∏è Fallback –Ω–∞ `adaptive_regime.{regime}.sl_percent`
5. ‚ùå **–ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ `by_symbol.{symbol}.sl_atr_multiplier`**

**–ö–æ–¥:** `exit_analyzer.py:986-1120`  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ ParameterProvider, –Ω–æ `get_exit_params` –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `by_symbol`

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –∫–æ–Ω—Ñ–∏–≥–µ –µ—Å—Ç—å `by_symbol.ETH-USDT.sl_atr_multiplier: 3.0`, –Ω–æ `get_exit_params` –µ–≥–æ –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç!

---

## ‚ùå –ß–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢ –ê–î–ê–ü–¢–ò–í–ù–û

### 1. `sl_atr_multiplier` –∏–∑ `by_symbol` ‚Äî ‚ùå –ù–ï –£–ß–ò–¢–´–í–ê–ï–¢–°–Ø
**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í –∫–æ–Ω—Ñ–∏–≥–µ: `by_symbol.ETH-USDT.sl_atr_multiplier: 3.0`
- –ù–æ `get_exit_params()` –≤ ParameterProvider –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `by_symbol`
- –û–Ω –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ `exit_params.{regime}.sl_atr_multiplier`

**–ö–æ–¥:** `parameter_provider.py:105-207`  
**–°—Ç–∞—Ç—É—Å:** ‚ùå –ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `by_symbol` –≤ `get_exit_params()`

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
```python
# –¢–æ–ª—å–∫–æ exit_params.{regime}
exit_params = all_exit_params.get(regime_lower, {})
# –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ by_symbol.{symbol}.sl_atr_multiplier
```

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
```python
# –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è exit_params.{regime}, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å by_symbol
if symbol:
    by_symbol = config_dict.get("by_symbol", {})
    symbol_config = by_symbol.get(symbol, {})
    if "sl_atr_multiplier" in symbol_config:
        exit_params["sl_atr_multiplier"] = symbol_config["sl_atr_multiplier"]
```

---

### 2. `tp_atr_multiplier` –∏–∑ `by_symbol` ‚Äî ‚ùå –ù–ï –£–ß–ò–¢–´–í–ê–ï–¢–°–Ø
**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `sl_atr_multiplier`, –Ω–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `by_symbol`

---

### 3. `max_holding_minutes` –∏–∑ `by_symbol` ‚Äî ‚ùå –ù–ï –£–ß–ò–¢–´–í–ê–ï–¢–°–Ø
**–ü—Ä–æ–±–ª–µ–º–∞:** `get_exit_params()` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `by_symbol.{symbol}.max_holding_minutes`

---

## üìä –¢–ê–ë–õ–ò–¶–ê –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–ò –ü–ê–†–ê–ú–ï–¢–†–û–í

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–æ —Ä–µ–∂–∏–º—É | Per-symbol | –°—Ç–∞—Ç—É—Å |
|----------|-----------|------------|--------|
| `min_holding_minutes` | ‚úÖ | ‚úÖ | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω–æ |
| `smart_close.reversal_score_threshold` | ‚úÖ | ‚úÖ | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω–æ |
| `smart_close.trend_against_threshold` | ‚úÖ | ‚úÖ | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω–æ |
| `sl_percent` | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ (—á–µ—Ä–µ–∑ symbol_profiles) |
| `sl_atr_multiplier` | ‚úÖ | ‚ùå | ‚ùå **–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç per-symbol** |
| `tp_percent` | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ (—á–µ—Ä–µ–∑ symbol_profiles) |
| `tp_atr_multiplier` | ‚úÖ | ‚ùå | ‚ùå **–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç per-symbol** |
| `max_holding_minutes` | ‚úÖ | ‚ùå | ‚ùå **–ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç per-symbol** |

---

## üîß –ß–¢–û –ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨

### 1. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `by_symbol` –≤ `get_exit_params()`
**–§–∞–π–ª:** `src/strategies/scalping/futures/config/parameter_provider.py`  
**–ú–µ—Ç–æ–¥:** `get_exit_params()` (—Å—Ç—Ä–æ–∫–∏ 105-207)

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
```python
# –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è exit_params.{regime}, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å by_symbol
if symbol and hasattr(self.config_manager, "_raw_config_dict"):
    config_dict = self.config_manager._raw_config_dict
    by_symbol = config_dict.get("by_symbol", {})
    symbol_config = by_symbol.get(symbol, {})
    if isinstance(symbol_config, dict):
        # –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ by_symbol (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –≤—ã—à–µ)
        if "sl_atr_multiplier" in symbol_config:
            exit_params["sl_atr_multiplier"] = _to_float(
                symbol_config["sl_atr_multiplier"], "sl_atr_multiplier", 
                exit_params.get("sl_atr_multiplier", 2.0)
            )
        if "tp_atr_multiplier" in symbol_config:
            exit_params["tp_atr_multiplier"] = _to_float(
                symbol_config["tp_atr_multiplier"], "tp_atr_multiplier",
                exit_params.get("tp_atr_multiplier", 1.0)
            )
        if "max_holding_minutes" in symbol_config:
            exit_params["max_holding_minutes"] = _to_float(
                symbol_config["max_holding_minutes"], "max_holding_minutes",
                exit_params.get("max_holding_minutes", 25.0)
            )
```

---

## ‚úÖ –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ:
1. ‚úÖ `min_holding_minutes` ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω–æ (—Ä–µ–∂–∏–º + per-symbol)
2. ‚úÖ Smart Close –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–Ω–æ (—Ä–µ–∂–∏–º + per-symbol)

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–∞—Å—Ç–∏—á–Ω–æ:
1. ‚ö†Ô∏è `sl_percent` / `tp_percent` ‚Äî —á–µ—Ä–µ–∑ `symbol_profiles`, –Ω–æ –Ω–µ —á–µ—Ä–µ–∑ `by_symbol`
2. ‚ö†Ô∏è `sl_atr_multiplier` / `tp_atr_multiplier` ‚Äî –ø–æ —Ä–µ–∂–∏–º—É, –Ω–æ –ù–ï per-symbol

### –ß—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. ‚ùå `sl_atr_multiplier` –∏–∑ `by_symbol` ‚Äî –ù–ï —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
2. ‚ùå `tp_atr_multiplier` –∏–∑ `by_symbol` ‚Äî –ù–ï —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
3. ‚ùå `max_holding_minutes` –∏–∑ `by_symbol` ‚Äî –ù–ï —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

1. **–°—Ä–æ—á–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `by_symbol` –≤ `get_exit_params()` –¥–ª—è:
   - `sl_atr_multiplier`
   - `tp_atr_multiplier`
   - `max_holding_minutes`

2. **–í–∞–∂–Ω–æ:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:
   - `by_symbol.{symbol}` –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ `exit_params.{regime}`
   - `by_symbol.{symbol}.{regime}` –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ `by_symbol.{symbol}`

3. **–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ:** –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä

---

---

## üìù –ü–†–ò–ú–ï–†–´ –ò–ó –ö–û–î–ê –° –¢–û–ß–ù–´–ú–ò –°–¢–†–û–ö–ê–ú–ò

### 1. `min_holding_minutes` ‚Äî –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è:** `exit_analyzer.py:_get_min_holding_minutes()` (—Å—Ç—Ä–æ–∫–∏ 1425-1520)

**–ü–†–ò–û–†–ò–¢–ï–¢ 1: exit_params —á–µ—Ä–µ–∑ ParameterProvider**
```python
# –°—Ç—Ä–æ–∫–∞ 1444-1458
if self.parameter_provider:
    try:
        exit_params = self.parameter_provider.get_exit_params(
            symbol or "", regime
        )
        if exit_params and "min_holding_minutes" in exit_params:
            min_holding_minutes = self._to_float(
                exit_params["min_holding_minutes"], "min_holding_minutes", None
            )
            if min_holding_minutes is not None:
                logger.debug(
                    f"‚úÖ ExitAnalyzer: min_holding_minutes –¥–ª—è {symbol or 'default'} ({regime}) "
                    f"–ø–æ–ª—É—á–µ–Ω —á–µ—Ä–µ–∑ ParameterProvider: {min_holding_minutes:.1f}–º–∏–Ω"
                )
                return min_holding_minutes
```

**–ü–†–ò–û–†–ò–¢–ï–¢ 2: adaptive_regime**
```python
# –°—Ç—Ä–æ–∫–∞ 1464-1486
if self.config_manager:
    try:
        if hasattr(self.config_manager, "_raw_config_dict"):
            config_dict = self.config_manager._raw_config_dict
            adaptive_regime = config_dict.get("adaptive_regime", {})
            regime_config = adaptive_regime.get(regime, {})
            if "min_holding_minutes" in regime_config:
                min_holding_minutes = self._to_float(
                    regime_config["min_holding_minutes"],
                    "min_holding_minutes",
                    None,
                )
                if min_holding_minutes is not None:
                    logger.debug(
                        f"‚úÖ ExitAnalyzer: min_holding_minutes –¥–ª—è {regime} "
                        f"–ø–æ–ª—É—á–µ–Ω –∏–∑ adaptive_regime: {min_holding_minutes:.1f}–º–∏–Ω"
                    )
                    return min_holding_minutes
```

**–ü–†–ò–û–†–ò–¢–ï–¢ 3: by_symbol per-symbol**
```python
# –°—Ç—Ä–æ–∫–∞ 1488-1520
if symbol and self.config_manager:
    try:
        if hasattr(self.config_manager, "_raw_config_dict"):
            config_dict = self.config_manager._raw_config_dict
            by_symbol = config_dict.get("by_symbol", {})
            symbol_config = by_symbol.get(symbol, {})
            # –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∂–∏–º-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä
            regime_config = symbol_config.get(regime, {})
            if (
                isinstance(regime_config, dict)
                and "min_holding_minutes" in regime_config
            ):
                min_holding_minutes = self._to_float(
                    regime_config["min_holding_minutes"],
                    "min_holding_minutes",
                    None,
                )
                if min_holding_minutes is not None:
                    logger.debug(
                        f"‚úÖ ExitAnalyzer: min_holding_minutes –¥–ª—è {symbol} ({regime}) "
                        f"–ø–æ–ª—É—á–µ–Ω –∏–∑ by_symbol: {min_holding_minutes:.1f}–º–∏–Ω"
                    )
                    return min_holding_minutes
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:**
- `exit_analyzer.py:2296` ‚Äî TRENDING —Ä–µ–∂–∏–º: `min_holding_minutes = self._get_min_holding_minutes("trending", symbol)`
- `exit_analyzer.py:2890` ‚Äî RANGING —Ä–µ–∂–∏–º: `min_holding_minutes = self._get_min_holding_minutes("ranging", symbol)`
- `exit_analyzer.py:3938` ‚Äî CHOPPY —Ä–µ–∂–∏–º: `min_holding_minutes = self._get_min_holding_minutes("choppy", symbol)`

---

### 2. Smart Close –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è:** `parameter_provider.py:get_smart_close_params()` (—Å—Ç—Ä–æ–∫–∏ 209-310)

**–ü–†–ò–û–†–ò–¢–ï–¢ 1: by_symbol.{symbol}.smart_close.{regime}**
```python
# –°—Ç—Ä–æ–∫–∞ 233-267
if symbol and hasattr(self.config_manager, "_raw_config_dict"):
    config_dict = self.config_manager._raw_config_dict
    by_symbol = config_dict.get("by_symbol", {})
    symbol_config = by_symbol.get(symbol, {})
    if isinstance(symbol_config, dict):
        smart_close_config = symbol_config.get("smart_close", {})
        if isinstance(smart_close_config, dict):
            regime_config = smart_close_config.get(regime, {})
            if isinstance(regime_config, dict):
                reversal_threshold = regime_config.get("reversal_score_threshold")
                trend_threshold = regime_config.get("trend_against_threshold")
                if (
                    reversal_threshold is not None
                    or trend_threshold is not None
                ):
                    params = defaults.copy()
                    if reversal_threshold is not None:
                        params["reversal_score_threshold"] = float(reversal_threshold)
                    if trend_threshold is not None:
                        params["trend_against_threshold"] = float(trend_threshold)
                    logger.debug(
                        f"‚úÖ ParameterProvider: Smart Close –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è {symbol} ({regime}) "
                        f"–ø–æ–ª—É—á–µ–Ω—ã –∏–∑ by_symbol: reversal={params['reversal_score_threshold']}, "
                        f"trend={params['trend_against_threshold']}"
                    )
                    return params
```

**–ü–†–ò–û–†–ò–¢–ï–¢ 2: exit_params.smart_close.{regime}**
```python
# –°—Ç—Ä–æ–∫–∞ 269-310
if hasattr(self.config_manager, "_raw_config_dict"):
    config_dict = self.config_manager._raw_config_dict
    exit_params = config_dict.get("exit_params", {})
    if isinstance(exit_params, dict):
        smart_close_config = exit_params.get("smart_close", {})
        if isinstance(smart_close_config, dict):
            regime_config = smart_close_config.get(regime, {})
            if isinstance(regime_config, dict):
                reversal_threshold = regime_config.get("reversal_score_threshold")
                trend_threshold = regime_config.get("trend_against_threshold")
                if (
                    reversal_threshold is not None
                    or trend_threshold is not None
                ):
                    params = defaults.copy()
                    if reversal_threshold is not None:
                        params["reversal_score_threshold"] = float(reversal_threshold)
                    if trend_threshold is not None:
                        params["trend_against_threshold"] = float(trend_threshold)
                    logger.debug(
                        f"‚úÖ ParameterProvider: Smart Close –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è {regime} "
                        f"–ø–æ–ª—É—á–µ–Ω—ã –∏–∑ exit_params: reversal={params['reversal_score_threshold']}, "
                        f"trend={params['trend_against_threshold']}"
                    )
                    return params
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ:**
```python
# exit_analyzer.py:4764-4774
smart_close_params = self.parameter_provider.get_smart_close_params(
    regime, symbol
)
score_threshold = smart_close_params["reversal_score_threshold"]
trend_threshold = smart_close_params["trend_against_threshold"]

should_close = (
    reversal_score <= score_threshold and trend_against >= trend_threshold
)
```

---

### 3. SL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã ‚Äî –ß–∞—Å—Ç–∏—á–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

**–ú–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è:** `exit_analyzer.py:_get_sl_percent()` (—Å—Ç—Ä–æ–∫–∏ 986-1120)

**–ü–†–ò–û–†–ò–¢–ï–¢ 1: exit_params —á–µ—Ä–µ–∑ ParameterProvider**
```python
# –°—Ç—Ä–æ–∫–∞ 986-1005
if self.parameter_provider:
    try:
        exit_params = self.parameter_provider.get_exit_params(symbol, regime)
        if exit_params:
            if "sl_percent" in exit_params:
                sl_percent = self._to_float(
                    exit_params["sl_percent"], "sl_percent", 2.0
                )
            if "sl_atr_multiplier" in exit_params:
                sl_atr_multiplier = self._to_float(
                    exit_params["sl_atr_multiplier"], "sl_atr_multiplier", 1.0
                )
            if "sl_min_percent" in exit_params:
                sl_min_percent = self._to_float(
                    exit_params["sl_min_percent"], "sl_min_percent", 0.6
                )
            logger.debug(
                f"‚úÖ ExitAnalyzer: SL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è {symbol} ({regime}) "
                f"–ø–æ–ª—É—á–µ–Ω—ã —á–µ—Ä–µ–∑ ParameterProvider: sl_percent={sl_percent:.2f}%, "
                f"sl_atr_multiplier={sl_atr_multiplier:.2f}, sl_min_percent={sl_min_percent:.2f}%"
            )
```

**–ü–†–û–ë–õ–ï–ú–ê: get_exit_params() –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç by_symbol**
```python
# parameter_provider.py:137-146
all_exit_params = self.config_manager._raw_config_dict.get("exit_params", {})
if isinstance(all_exit_params, dict) and regime:
    regime_lower = regime.lower() if isinstance(regime, str) else str(regime).lower()
    exit_params = all_exit_params.get(regime_lower, {})
    # ‚ùå –ù–ï–¢ –ü–†–û–í–ï–†–ö–ò by_symbol.{symbol}.sl_atr_multiplier
```

**–†–∞—Å—á–µ—Ç ATR-based SL:**
```python
# exit_analyzer.py:1166-1169
if atr_1m and atr_1m > 0:
    # ATR-based SL: max(min_percent, ATR% * multiplier)
    atr_sl_percent = (atr_1m / current_price) * 100 * sl_atr_multiplier
    sl_percent = max(sl_min_percent, atr_sl_percent)
```

---

## üßÆ –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê –ò –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –†–ê–°–ß–ï–¢–û–í

### 1. –†–∞—Å—á–µ—Ç `min_holding_minutes` (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ SL/Smart Close)

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è:**

```
–®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ ParameterProvider.get_exit_params()
  ‚îú‚îÄ –ï—Å–ª–∏ exit_params.{regime}.min_holding_minutes —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  ‚îÇ  ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
  ‚îÇ
–®–ê–ì 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ adaptive_regime.{regime}.min_holding_minutes
  ‚îú‚îÄ –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  ‚îÇ  ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
  ‚îÇ
–®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ by_symbol.{symbol}.{regime}.min_holding_minutes
  ‚îú‚îÄ –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (per-symbol –ø–æ —Ä–µ–∂–∏–º—É)
  ‚îÇ  ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
  ‚îÇ
–®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ by_symbol.{symbol}.min_holding_minutes
  ‚îú‚îÄ –ï—Å–ª–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (per-symbol –æ–±—â–∏–π)
  ‚îÇ  ‚îî‚îÄ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
  ‚îÇ
–®–ê–ì 5: –í–æ–∑–≤—Ä–∞—â–∞–µ–º None (–Ω–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
```

**–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```python
# exit_analyzer.py:2298-2305 (TRENDING)
minutes_in_position = (current_time - open_time).total_seconds() / 60
min_holding = self._get_min_holding_minutes("trending", symbol)

if minutes_in_position < min_holding:
    logger.debug(
        f"‚è≥ ExitAnalyzer TRENDING: SL –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è {symbol} - "
        f"–≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è {minutes_in_position:.1f} –º–∏–Ω < –º–∏–Ω–∏–º—É–º {min_holding:.1f} –º–∏–Ω"
    )
    return {"action": "hold", "reason": "min_holding_protection"}
```

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:**
- –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞: `2025-12-29 01:14:32`
- –¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: `2025-12-29 01:15:00`
- `minutes_in_position = (01:15:00 - 01:14:32) / 60 = 0.47 –º–∏–Ω`
- `min_holding = 0.8 –º–∏–Ω` (TRENDING —Ä–µ–∂–∏–º)
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `0.47 < 0.8` ‚Üí SL –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

---

### 2. –†–∞—Å—á–µ—Ç Smart Close (–∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–æ—Ä–æ–≥–∏)

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ—Ä–æ–≥–æ–≤:**

```
–®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ by_symbol.{symbol}.smart_close.{regime}
  ‚îú‚îÄ reversal_score_threshold
  ‚îú‚îÄ trend_against_threshold
  ‚îî‚îÄ –ï—Å–ª–∏ –æ–±–∞ –Ω–∞–π–¥–µ–Ω—ã ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
  ‚îÇ
–®–ê–ì 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ exit_params.smart_close.{regime}
  ‚îú‚îÄ reversal_score_threshold
  ‚îú‚îÄ trend_against_threshold
  ‚îî‚îÄ –ï—Å–ª–∏ –æ–±–∞ –Ω–∞–π–¥–µ–Ω—ã ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
  ‚îÇ
–®–ê–ì 3: Default –∑–Ω–∞—á–µ–Ω–∏—è
  ‚îú‚îÄ reversal_score_threshold = 2.0
  ‚îî‚îÄ trend_against_threshold = 0.7
```

**–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ Smart Close:**
```python
# exit_analyzer.py:4764-4774
smart_close_params = self.parameter_provider.get_smart_close_params(regime, symbol)
score_threshold = smart_close_params["reversal_score_threshold"]  # –ù–∞–ø—Ä–∏–º–µ—Ä: 3 –¥–ª—è RANGING
trend_threshold = smart_close_params["trend_against_threshold"]  # –ù–∞–ø—Ä–∏–º–µ—Ä: 0.8 –¥–ª—è RANGING

# –£—Å–ª–æ–≤–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è:
should_close = (
    reversal_score <= score_threshold and  # –ù–∞–ø—Ä–∏–º–µ—Ä: 2 <= 3 ‚Üí True
    trend_against >= trend_threshold      # –ù–∞–ø—Ä–∏–º–µ—Ä: 0.75 >= 0.8 ‚Üí False
)
```

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è ETH-USDT –≤ RANGING:**
- `reversal_score = 2` (–∏–∑ –∞–Ω–∞–ª–∏–∑–∞ —Å–≤–µ—á–µ–π, –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–π)
- `trend_against = 0.75` (–∏–∑ DirectionAnalyzer)
- –ü–æ—Ä–æ–≥–∏ –¥–ª—è ETH –≤ RANGING: `score_threshold = 4`, `trend_threshold = 0.8`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `2 <= 4` (True) AND `0.75 >= 0.8` (False) ‚Üí `should_close = False`
- **–í—ã–≤–æ–¥:** –ü–æ–∑–∏—Ü–∏—è –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è (–Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞)

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è –æ–±—ã—á–Ω–æ–π –ø–∞—Ä—ã –≤ RANGING:**
- `reversal_score = 2`
- `trend_against = 0.75`
- –ü–æ—Ä–æ–≥–∏ –¥–ª—è RANGING: `score_threshold = 3`, `trend_threshold = 0.8`
- –†–µ–∑—É–ª—å—Ç–∞—Ç: `2 <= 3` (True) AND `0.75 >= 0.8` (False) ‚Üí `should_close = False`
- **–í—ã–≤–æ–¥:** –ü–æ–∑–∏—Ü–∏—è –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è

---

### 3. –†–∞—Å—á–µ—Ç ATR-based SL

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**

```
–®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ ParameterProvider.get_exit_params()
  ‚îú‚îÄ exit_params.{regime}.sl_atr_multiplier
  ‚îú‚îÄ exit_params.{regime}.sl_min_percent
  ‚îî‚îÄ ‚ùå –ù–ï–¢ –ø—Ä–æ–≤–µ—Ä–∫–∏ by_symbol.{symbol}.sl_atr_multiplier
  ‚îÇ
–®–ê–ì 2: Fallback –Ω–∞ symbol_profiles
  ‚îú‚îÄ symbol_profiles.{symbol}.{regime}.sl_atr_multiplier
  ‚îî‚îÄ symbol_profiles.{symbol}.{regime}.sl_min_percent
```

**–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞:**
```python
# exit_analyzer.py:1166-1169
# –§–æ—Ä–º—É–ª–∞: SL% = max(sl_min_percent, (ATR / current_price) * 100 * sl_atr_multiplier)

atr_sl_percent = (atr_1m / current_price) * 100 * sl_atr_multiplier
sl_percent = max(sl_min_percent, atr_sl_percent)
```

**–ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞ –¥–ª—è ETH-USDT:**
- `current_price = 2965.00`
- `atr_1m = 20.61` (–∏–∑ DataRegistry –∏–ª–∏ fallback=5.0)
- `sl_atr_multiplier = 2.0` (–∏–∑ exit_params.ranging, –ù–ï –∏–∑ by_symbol.ETH-USDT.sl_atr_multiplier=3.0!)
- `sl_min_percent = 0.6`

**–†–∞—Å—á–µ—Ç:**
```
atr_sl_percent = (20.61 / 2965.00) * 100 * 2.0
               = 0.00695 * 100 * 2.0
               = 0.695 * 2.0
               = 1.39%

sl_percent = max(0.6, 1.39) = 1.39%
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `by_symbol.ETH-USDT.sl_atr_multiplier=3.0`:
```
atr_sl_percent = (20.61 / 2965.00) * 100 * 3.0
               = 0.00695 * 100 * 3.0
               = 0.695 * 3.0
               = 2.085%

sl_percent = max(0.6, 2.085) = 2.085%
```

**–†–∞–∑–Ω–∏—Ü–∞:** SL –±—ã–ª –±—ã `2.085%` –≤–º–µ—Å—Ç–æ `1.39%` ‚Äî –Ω–∞ 50% —à–∏—Ä–µ!

---

### 4. –ü–æ—Ä—è–¥–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤—ã—Ö–æ–¥–∞ (Exit Order)

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ RANGING —Ä–µ–∂–∏–º–µ:**

```
1. Peak Profit (exit_analyzer.py:2800-2820)
   ‚îî‚îÄ –ï—Å–ª–∏ PnL >= peak_profit_threshold ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ

2. Stop Loss —Å min_holding_minutes (exit_analyzer.py:2889-2920)
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞: minutes_in_position >= min_holding_minutes?
   ‚îÇ  ‚îú‚îÄ –ù–ï–¢ ‚Üí return {"action": "hold"}
   ‚îÇ  ‚îî‚îÄ –î–ê ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞: current_price <= sl_price?
   ‚îÇ     ‚îî‚îÄ –î–ê ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ SL
   ‚îÇ
3. Smart Close —Å min_holding_minutes (exit_analyzer.py:2955-3000)
   ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞: minutes_in_position >= min_holding_minutes?
   ‚îÇ  ‚îú‚îÄ –ù–ï–¢ ‚Üí return {"action": "hold"}
   ‚îÇ  ‚îî‚îÄ –î–ê ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞: loss >= 1.5 * SL?
   ‚îÇ     ‚îú‚îÄ –î–ê ‚Üí Smart Close Analysis
   ‚îÇ     ‚îÇ  ‚îú‚îÄ reversal_score <= threshold?
   ‚îÇ     ‚îÇ  ‚îî‚îÄ trend_against >= threshold?
   ‚îÇ     ‚îî‚îÄ –ù–ï–¢ ‚Üí –ø—Ä–æ–ø—É—Å–∫
   ‚îÇ
4. Take Profit (exit_analyzer.py:3005-3050)
   ‚îî‚îÄ –ï—Å–ª–∏ current_price >= tp_price ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TP

5. Big Profit Exit (exit_analyzer.py:3055-3100)
   ‚îî‚îÄ –ï—Å–ª–∏ PnL >= big_profit_threshold ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ

6. Partial TP (exit_analyzer.py:3105-3150)
   ‚îî‚îÄ –ï—Å–ª–∏ PnL >= partial_tp_threshold ‚Üí —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ

7. Reversal Detected (exit_analyzer.py:3155-3200)
   ‚îî‚îÄ –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Ä–∞–∑–≤–æ—Ä–æ—Ç ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ

8. Max Holding Time (exit_analyzer.py:3502-3520)
   ‚îî‚îÄ –ï—Å–ª–∏ minutes_in_position >= max_holding_minutes ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ

9. Emergency Loss Protection (exit_analyzer.py:3525-3580)
   ‚îî‚îÄ –ï—Å–ª–∏ loss >= emergency_loss_threshold ‚Üí —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
```

**–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ min_holding_minutes:**
```python
# –î–ª—è SL (exit_analyzer.py:2298-2305)
minutes_in_position = (datetime.now(timezone.utc) - position['open_time']).total_seconds() / 60
min_holding = self._get_min_holding_minutes(regime, symbol)

if minutes_in_position < min_holding:
    # –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ SL
    return {"action": "hold", "reason": "min_holding_protection"}

# –î–ª—è Smart Close (exit_analyzer.py:4684-4695)
minutes_in_position = self._get_time_in_position_minutes(metadata, position)
min_holding = self._get_min_holding_minutes(regime, symbol)

if minutes_in_position < min_holding:
    logger.debug(
        f"‚è≥ ExitAnalyzer {regime}: Smart Close –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è {symbol} - "
        f"–≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è {minutes_in_position:.1f} –º–∏–Ω < –º–∏–Ω–∏–º—É–º {min_holding:.1f} –º–∏–Ω"
    )
    return False  # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º
```

---

## üìã –ü–†–ò–ú–ï–†–´ –ò–ó –õ–û–ì–û–í

### –ü—Ä–∏–º–µ—Ä 1: min_holding_minutes –¥–ª—è ETH-USDT –≤ RANGING

**–û–∂–∏–¥–∞–µ–º–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–∑–∏—Ü–∏—è):**
```
‚úÖ ExitAnalyzer: min_holding_minutes –¥–ª—è ETH-USDT (ranging) –ø–æ–ª—É—á–µ–Ω –∏–∑ by_symbol: 2.0–º–∏–Ω
‚è≥ ExitAnalyzer RANGING: SL –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–ª—è ETH-USDT - –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è 1.2 –º–∏–Ω < –º–∏–Ω–∏–º—É–º 2.0 –º–∏–Ω
```

**–ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —ç—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç:**
- `exit_analyzer.py:1509-1512` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ by_symbol
- `exit_analyzer.py:2895-2900` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ SL

---

### –ü—Ä–∏–º–µ—Ä 2: Smart Close —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ –ø–æ—Ä–æ–≥–∞–º–∏

**–û–∂–∏–¥–∞–µ–º–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–∫–æ–≥–¥–∞ –±—É–¥–µ—Ç –ø–æ–∑–∏—Ü–∏—è):**
```
‚úÖ ParameterProvider: Smart Close –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è ETH-USDT (ranging) –ø–æ–ª—É—á–µ–Ω—ã –∏–∑ by_symbol: reversal=4, trend=0.8
Smart Close Analysis ETH-USDT (LONG, —Ä–µ–∂–∏–º=ranging): reversal_score=2/7 (–ø–æ—Ä–æ–≥=4), trend_against=0.75 (–ø–æ—Ä–æ–≥=0.80), should_close=False, pnl=-0.12%
```

**–ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —ç—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç:**
- `parameter_provider.py:262-266` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ by_symbol
- `exit_analyzer.py:4777-4782` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ Smart Close

---

### –ü—Ä–∏–º–µ—Ä 3: ATR-based SL —Ä–∞—Å—á–µ—Ç

**–û–∂–∏–¥–∞–µ–º–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```
‚úÖ ExitAnalyzer: SL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è ETH-USDT (ranging) –ø–æ–ª—É—á–µ–Ω—ã —á–µ—Ä–µ–∑ ParameterProvider: sl_percent=0.80%, sl_atr_multiplier=2.00, sl_min_percent=0.60%
‚úÖ [ATR_SL] ETH-USDT: ATR-based SL | ATR_1m=20.607857, ATR%=0.695%, multiplier=2.00, min=0.60%, final SL=1.39%
```

**–ö–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —ç—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç:**
- `exit_analyzer.py:1001-1004` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- `exit_analyzer.py:1170-1175` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–∞ ATR-based SL

**–ü—Ä–æ–±–ª–µ–º–∞:** –í –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç `multiplier=2.00`, —Ö–æ—Ç—è –≤ –∫–æ–Ω—Ñ–∏–≥–µ `by_symbol.ETH-USDT.sl_atr_multiplier=3.0`!

---

## üî¢ –ú–ê–¢–ï–ú–ê–¢–ò–ß–ï–°–ö–ò–ï –§–û–†–ú–£–õ–´

### 1. –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è –ø–æ–∑–∏—Ü–∏–∏
```
minutes_in_position = (current_time - open_time) / 60 —Å–µ–∫—É–Ω–¥
```

**–ü—Ä–∏–º–µ—Ä:**
- `open_time = 2025-12-29 01:14:32`
- `current_time = 2025-12-29 01:15:45`
- `minutes_in_position = (01:15:45 - 01:14:32) / 60 = 73 —Å–µ–∫—É–Ω–¥—ã / 60 = 1.22 –º–∏–Ω—É—Ç—ã`

---

### 2. –†–∞—Å—á–µ—Ç ATR-based SL –ø—Ä–æ—Ü–µ–Ω—Ç–∞
```
ATR% = (ATR_1m / current_price) * 100
atr_sl_percent = ATR% * sl_atr_multiplier
sl_percent = max(sl_min_percent, atr_sl_percent)
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è ETH-USDT:**
```
ATR_1m = 20.61
current_price = 2965.00
sl_atr_multiplier = 2.0 (–∏–∑ exit_params.ranging)
sl_min_percent = 0.6

ATR% = (20.61 / 2965.00) * 100 = 0.695%
atr_sl_percent = 0.695% * 2.0 = 1.39%
sl_percent = max(0.6%, 1.39%) = 1.39%
```

**–ï—Å–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è by_symbol.ETH-USDT.sl_atr_multiplier=3.0:**
```
atr_sl_percent = 0.695% * 3.0 = 2.085%
sl_percent = max(0.6%, 2.085%) = 2.085%
```

---

### 3. –†–∞—Å—á–µ—Ç Smart Close —É—Å–ª–æ–≤–∏—è
```
should_close = (reversal_score <= score_threshold) AND (trend_against >= trend_threshold)
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è ETH-USDT –≤ RANGING:**
```
reversal_score = 2 (–∏–∑ –∞–Ω–∞–ª–∏–∑–∞ —Å–≤–µ—á–µ–π, –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–π)
trend_against = 0.75 (–∏–∑ DirectionAnalyzer)
score_threshold = 4 (–∏–∑ by_symbol.ETH-USDT.smart_close.reversal_score_threshold.ranging)
trend_threshold = 0.8 (–∏–∑ exit_params.smart_close.ranging.trend_against_threshold)

should_close = (2 <= 4) AND (0.75 >= 0.8)
            = True AND False
            = False
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–∑–∏—Ü–∏—è –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è (–Ω—É–∂–Ω–æ –±–æ–ª—å—à–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞)

---

### 4. –†–∞—Å—á–µ—Ç SL —Ü–µ–Ω—ã
```
sl_price = entry_price * (1 - sl_percent / 100)  # –î–ª—è LONG
sl_price = entry_price * (1 + sl_percent / 100)  # –î–ª—è SHORT
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è ETH-USDT LONG:**
```
entry_price = 2965.00
sl_percent = 1.39% (–µ—Å–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è by_symbol.sl_atr_multiplier=3.0, –±—ã–ª–æ –±—ã 2.085%)

sl_price = 2965.00 * (1 - 1.39 / 100)
         = 2965.00 * 0.9861
         = 2923.79
```

---

## üéØ –ü–û–õ–ù–ê–Ø –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –†–ê–°–ß–ï–¢–û–í –ü–†–ò –ê–ù–ê–õ–ò–ó–ï –í–´–•–û–î–ê

### –ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è RANGING —Ä–µ–∂–∏–º–∞:

```
1. –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ü–ê–†–ê–ú–ï–¢–†–û–í
   ‚îú‚îÄ –†–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è: RANGING
   ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ exit_params —á–µ—Ä–µ–∑ ParameterProvider.get_exit_params(symbol, "ranging")
   ‚îÇ  ‚îú‚îÄ exit_params.ranging.sl_percent = 0.8%
   ‚îÇ  ‚îú‚îÄ exit_params.ranging.sl_atr_multiplier = 2.0 (‚ùå –ù–ï –∏–∑ by_symbol!)
   ‚îÇ  ‚îú‚îÄ exit_params.ranging.tp_percent = 2.5%
   ‚îÇ  ‚îú‚îÄ exit_params.ranging.max_holding_minutes = 15.0
   ‚îÇ  ‚îî‚îÄ exit_params.ranging.min_holding_minutes = 1.5
   ‚îÇ
   ‚îî‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ min_holding_minutes —á–µ—Ä–µ–∑ _get_min_holding_minutes("ranging", symbol)
      ‚îú‚îÄ –ü–†–ò–û–†–ò–¢–ï–¢ 1: exit_params.ranging.min_holding_minutes = 1.5
      ‚îú‚îÄ –ü–†–ò–û–†–ò–¢–ï–¢ 2: adaptive_regime.ranging.min_holding_minutes (–µ—Å–ª–∏ –µ—Å—Ç—å)
      ‚îú‚îÄ –ü–†–ò–û–†–ò–¢–ï–¢ 3: by_symbol.{symbol}.ranging.min_holding_minutes (–µ—Å–ª–∏ –µ—Å—Ç—å)
      ‚îî‚îÄ –ü–†–ò–û–†–ò–¢–ï–¢ 4: by_symbol.{symbol}.min_holding_minutes (–µ—Å–ª–∏ –µ—Å—Ç—å)
      ‚Üí –î–ª—è ETH-USDT: by_symbol.ETH-USDT.min_holding_minutes.ranging = 2.0 ‚úÖ

2. –†–ê–°–ß–ï–¢ SL
   ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ ATR —á–µ—Ä–µ–∑ ATRProvider.get_atr(symbol, fallback=5.0)
   ‚îú‚îÄ –†–∞—Å—á–µ—Ç ATR-based SL:
   ‚îÇ  ‚îî‚îÄ atr_sl_percent = (ATR / current_price) * 100 * sl_atr_multiplier
   ‚îÇ     ‚îî‚îÄ sl_percent = max(sl_min_percent, atr_sl_percent)
   ‚îî‚îÄ –†–∞—Å—á–µ—Ç SL —Ü–µ–Ω—ã:
      ‚îî‚îÄ sl_price = entry_price * (1 - sl_percent / 100)

3. –ü–†–û–í–ï–†–ö–ê –í–´–•–û–î–ê (–≤ –ø–æ—Ä—è–¥–∫–µ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞)
   ‚îú‚îÄ 1. Peak Profit
   ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ PnL >= peak_profit_threshold ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ
   ‚îÇ
   ‚îú‚îÄ 2. Stop Loss (—Å min_holding_minutes)
   ‚îÇ  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞: minutes_in_position >= min_holding_minutes?
   ‚îÇ  ‚îÇ  ‚îú‚îÄ –ù–ï–¢ ‚Üí return {"action": "hold"}
   ‚îÇ  ‚îÇ  ‚îî‚îÄ –î–ê ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞: current_price <= sl_price?
   ‚îÇ  ‚îÇ     ‚îî‚îÄ –î–ê ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ SL
   ‚îÇ  ‚îÇ
   ‚îú‚îÄ 3. Smart Close (—Å min_holding_minutes)
   ‚îÇ  ‚îú‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞: minutes_in_position >= min_holding_minutes?
   ‚îÇ  ‚îÇ  ‚îú‚îÄ –ù–ï–¢ ‚Üí return False
   ‚îÇ  ‚îÇ  ‚îî‚îÄ –î–ê ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞: loss >= 1.5 * SL?
   ‚îÇ  ‚îÇ     ‚îú‚îÄ –î–ê ‚Üí Smart Close Analysis
   ‚îÇ  ‚îÇ     ‚îÇ  ‚îú‚îÄ –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ—Ä–æ–≥–æ–≤ —á–µ—Ä–µ–∑ get_smart_close_params(regime, symbol)
   ‚îÇ  ‚îÇ     ‚îÇ  ‚îÇ  ‚îú‚îÄ –ü–†–ò–û–†–ò–¢–ï–¢ 1: by_symbol.{symbol}.smart_close.{regime}
   ‚îÇ  ‚îÇ     ‚îÇ  ‚îÇ  ‚îî‚îÄ –ü–†–ò–û–†–ò–¢–ï–¢ 2: exit_params.smart_close.{regime}
   ‚îÇ  ‚îÇ     ‚îÇ  ‚îú‚îÄ –†–∞—Å—á–µ—Ç reversal_score (0-7)
   ‚îÇ  ‚îÇ     ‚îÇ  ‚îú‚îÄ –†–∞—Å—á–µ—Ç trend_against (0-1)
   ‚îÇ  ‚îÇ     ‚îÇ  ‚îî‚îÄ –ü—Ä–æ–≤–µ—Ä–∫–∞: reversal_score <= threshold AND trend_against >= threshold?
   ‚îÇ  ‚îÇ     ‚îÇ     ‚îî‚îÄ –î–ê ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Smart Close
   ‚îÇ  ‚îÇ     ‚îî‚îÄ –ù–ï–¢ ‚Üí –ø—Ä–æ–ø—É—Å–∫
   ‚îÇ  ‚îÇ
   ‚îú‚îÄ 4. Take Profit
   ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ current_price >= tp_price ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TP
   ‚îÇ
   ‚îú‚îÄ 5. Big Profit Exit
   ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ PnL >= big_profit_threshold ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ
   ‚îÇ
   ‚îú‚îÄ 6. Partial TP
   ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ PnL >= partial_tp_threshold ‚Üí —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
   ‚îÇ
   ‚îú‚îÄ 7. Reversal Detected
   ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω —Ä–∞–∑–≤–æ—Ä–æ—Ç ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ
   ‚îÇ
   ‚îú‚îÄ 8. Max Holding Time
   ‚îÇ  ‚îî‚îÄ –ï—Å–ª–∏ minutes_in_position >= max_holding_minutes ‚Üí –∑–∞–∫—Ä—ã—Ç–∏–µ
   ‚îÇ
   ‚îî‚îÄ 9. Emergency Loss Protection
      ‚îî‚îÄ –ï—Å–ª–∏ loss >= emergency_loss_threshold ‚Üí —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
```

---

## üìä –ü–†–ò–û–†–ò–¢–ï–¢–´ –ü–û–õ–£–ß–ï–ù–ò–Ø –ü–ê–†–ê–ú–ï–¢–†–û–í (–û–ë–©–ê–Ø –¢–ê–ë–õ–ò–¶–ê)

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4 | –°—Ç–∞—Ç—É—Å |
|----------|-------------|-------------|-------------|-------------|--------|
| `min_holding_minutes` | `exit_params.{regime}` | `adaptive_regime.{regime}` | `by_symbol.{symbol}.{regime}` | `by_symbol.{symbol}` | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é |
| `smart_close.reversal_score_threshold` | `by_symbol.{symbol}.smart_close.{regime}` | `exit_params.smart_close.{regime}` | Default (2.0) | - | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é |
| `smart_close.trend_against_threshold` | `by_symbol.{symbol}.smart_close.{regime}` | `exit_params.smart_close.{regime}` | Default (0.7) | - | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é |
| `sl_atr_multiplier` | `exit_params.{regime}` | `symbol_profiles.{symbol}.{regime}` | Default (2.0) | ‚ùå **–ù–ï–¢ by_symbol** | ‚ùå –ß–∞—Å—Ç–∏—á–Ω–æ |
| `tp_atr_multiplier` | `exit_params.{regime}` | `symbol_profiles.{symbol}.{regime}` | Default (1.0) | ‚ùå **–ù–ï–¢ by_symbol** | ‚ùå –ß–∞—Å—Ç–∏—á–Ω–æ |
| `max_holding_minutes` | `exit_params.{regime}` | Default (25.0/120.0) | - | ‚ùå **–ù–ï–¢ by_symbol** | ‚ùå –ß–∞—Å—Ç–∏—á–Ω–æ |

---

---

## üìÑ –ü–†–ò–ú–ï–†–´ –ò–ó –ö–û–ù–§–ò–ì–ê –° –¢–û–ß–ù–´–ú–ò –°–¢–†–û–ö–ê–ú–ò

### 1. `min_holding_minutes` –≤ –∫–æ–Ω—Ñ–∏–≥–µ

**–ü–æ —Ä–µ–∂–∏–º–∞–º (exit_params):**
```yaml
# config_futures.yaml:270 (TRENDING)
adaptive_regime:
  trending:
    min_holding_minutes: 0.8  # 48 —Å–µ–∫—É–Ω–¥

# config_futures.yaml:352 (RANGING)
adaptive_regime:
  ranging:
    min_holding_minutes: 1.5  # 90 —Å–µ–∫—É–Ω–¥

# config_futures.yaml: (CHOPPY - –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏)
adaptive_regime:
  choppy:
    min_holding_minutes: 2.5  # 150 —Å–µ–∫—É–Ω–¥
```

**Per-symbol (by_symbol):**
```yaml
# config_futures.yaml:44-45 (ETH-USDT)
by_symbol:
  ETH-USDT:
    min_holding_minutes:
      ranging: 2.0  # 2 –º–∏–Ω—É—Ç—ã –¥–ª—è ETH –≤ RANGING (–≤–º–µ—Å—Ç–æ 1.5)
```

---

### 2. Smart Close –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ

**–ü–æ —Ä–µ–∂–∏–º–∞–º (exit_params.smart_close):**
```yaml
# config_futures.yaml: (–Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ exit_params)
exit_params:
  smart_close:
    ranging:
      reversal_score_threshold: 3
      trend_against_threshold: 0.80
    trending:
      reversal_score_threshold: 1
      trend_against_threshold: 0.60
    choppy:
      reversal_score_threshold: 4
      trend_against_threshold: 0.90
```

**Per-symbol (by_symbol.ETH-USDT.smart_close):**
```yaml
# config_futures.yaml:46-48 (ETH-USDT)
by_symbol:
  ETH-USDT:
    smart_close:
      reversal_score_threshold:
        ranging: 4  # 4 –≤–º–µ—Å—Ç–æ 3 –¥–ª—è ETH –≤ RANGING
```

---

### 3. SL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ

**–ü–æ —Ä–µ–∂–∏–º–∞–º (exit_params / adaptive_regime):**
```yaml
# config_futures.yaml:255 (TRENDING)
adaptive_regime:
  trending:
    sl_atr_multiplier: 0.6

# config_futures.yaml:334 (RANGING)
adaptive_regime:
  ranging:
    sl_atr_multiplier: 2.0
    sl_min_percent: 0.6
    sl_max_percent: 1.5
```

**Per-symbol (by_symbol) ‚Äî ‚ùå –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø:**
```yaml
# config_futures.yaml:42 (ETH-USDT)
by_symbol:
  ETH-USDT:
    sl_atr_multiplier: 3.0  # ‚ùå –ù–ï –£–ß–ò–¢–´–í–ê–ï–¢–°–Ø –≤ get_exit_params()!
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –≠—Ç–æ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –Ω–æ `get_exit_params()` –µ–≥–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç!

---

### 4. TP –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥–µ

**–ü–æ —Ä–µ–∂–∏–º–∞–º (exit_params / adaptive_regime):**
```yaml
# config_futures.yaml:254 (TRENDING)
adaptive_regime:
  trending:
    tp_atr_multiplier: 1.2
    tp_percent: 6.0

# config_futures.yaml:324-331 (RANGING)
adaptive_regime:
  ranging:
    tp_atr_multiplier: 1.0
    tp_percent: 5.0
    tp_atr_multiplier: 2.5  # –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤–æ–∑–º–æ–∂–Ω–æ –æ—à–∏–±–∫–∞)
    tp_min_percent: 1.5
    tp_max_percent: 2.2
```

---

## üîç –ü–û–õ–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê –ö–û–ù–§–ò–ì–ê (–°–•–ï–ú–ê)

```
config_futures.yaml
‚îú‚îÄ scalping
‚îÇ  ‚îú‚îÄ by_symbol
‚îÇ  ‚îÇ  ‚îú‚îÄ ETH-USDT
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ min_signal_strength: 0.55
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ sl_atr_multiplier: 3.0  ‚ùå –ù–ï –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ min_adx: 14.0
‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ min_holding_minutes
‚îÇ  ‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ ranging: 2.0  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ smart_close
‚îÇ  ‚îÇ  ‚îÇ     ‚îî‚îÄ reversal_score_threshold
‚îÇ  ‚îÇ  ‚îÇ        ‚îî‚îÄ ranging: 4  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îú‚îÄ SOL-USDT
‚îÇ  ‚îÇ  ‚îî‚îÄ BTC-USDT
‚îÇ  ‚îÇ
‚îú‚îÄ exit_params
‚îÇ  ‚îú‚îÄ ranging
‚îÇ  ‚îÇ  ‚îú‚îÄ min_holding_minutes: 1.5  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îú‚îÄ sl_atr_multiplier: 2.0  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îú‚îÄ tp_atr_multiplier: 1.0  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îî‚îÄ max_holding_minutes: 25.0  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îú‚îÄ trending
‚îÇ  ‚îÇ  ‚îú‚îÄ min_holding_minutes: 0.8  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îú‚îÄ sl_atr_multiplier: 0.6  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ  ‚îÇ  ‚îî‚îÄ ...
‚îÇ  ‚îú‚îÄ choppy
‚îÇ  ‚îÇ  ‚îî‚îÄ ...
‚îÇ  ‚îî‚îÄ smart_close
‚îÇ     ‚îú‚îÄ ranging
‚îÇ     ‚îÇ  ‚îú‚îÄ reversal_score_threshold: 3  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ     ‚îÇ  ‚îî‚îÄ trend_against_threshold: 0.80  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ     ‚îú‚îÄ trending
‚îÇ     ‚îÇ  ‚îú‚îÄ reversal_score_threshold: 1  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ     ‚îÇ  ‚îî‚îÄ trend_against_threshold: 0.60  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ     ‚îî‚îÄ choppy
‚îÇ        ‚îú‚îÄ reversal_score_threshold: 4  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ        ‚îî‚îÄ trend_against_threshold: 0.90  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø
‚îÇ
‚îî‚îÄ adaptive_regime
   ‚îú‚îÄ ranging
   ‚îÇ  ‚îú‚îÄ min_holding_minutes: 1.5  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø (fallback)
   ‚îÇ  ‚îú‚îÄ sl_atr_multiplier: 2.0  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø (fallback)
   ‚îÇ  ‚îî‚îÄ ...
   ‚îú‚îÄ trending
   ‚îÇ  ‚îú‚îÄ min_holding_minutes: 0.8  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø (fallback)
   ‚îÇ  ‚îú‚îÄ sl_atr_multiplier: 0.6  ‚úÖ –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø (fallback)
   ‚îÇ  ‚îî‚îÄ ...
   ‚îî‚îÄ choppy
      ‚îî‚îÄ ...
```

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–ò –° –ü–†–ò–ú–ï–†–ê–ú–ò

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ö–æ–Ω—Ñ–∏–≥ (—Ä–µ–∂–∏–º) | –ö–æ–Ω—Ñ–∏–≥ (per-symbol) | –ö–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è | –°—Ç–∞—Ç—É—Å |
|----------|----------------|---------------------|---------------|--------|
| `min_holding_minutes` | `exit_params.ranging: 1.5` | `by_symbol.ETH-USDT.ranging: 2.0` | `_get_min_holding_minutes()` | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é |
| `smart_close.reversal_score_threshold` | `exit_params.smart_close.ranging: 3` | `by_symbol.ETH-USDT.smart_close.ranging: 4` | `get_smart_close_params()` | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é |
| `smart_close.trend_against_threshold` | `exit_params.smart_close.ranging: 0.80` | - | `get_smart_close_params()` | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é |
| `sl_atr_multiplier` | `exit_params.ranging: 2.0` | `by_symbol.ETH-USDT: 3.0` ‚ùå | `get_exit_params()` | ‚ùå **–ù–ï per-symbol** |
| `tp_atr_multiplier` | `exit_params.ranging: 1.0` | - | `get_exit_params()` | ‚ùå **–ù–ï per-symbol** |
| `max_holding_minutes` | `exit_params.ranging: 25.0` | - | `get_exit_params()` | ‚ùå **–ù–ï per-symbol** |

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 29.12.2025  
**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ ‚Äî –Ω—É–∂–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–Ω–æ–π –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç–∏

