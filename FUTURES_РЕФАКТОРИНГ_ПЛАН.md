# üìã –ü–õ–ê–ù –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê FUTURES ORCHESTRATOR

**–î–∞—Ç–∞:** 21 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** üöÄ –ù–ê–ß–ò–ù–ê–ï–ú

---

## üìä –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï

### Futures Orchestrator:
- **–†–∞–∑–º–µ—Ä:** 365 KB
- **–°—Ç—Ä–æ–∫:** 5552
- **–ú–µ—Ç–æ–¥–æ–≤:** 55
- **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –û–ì–†–û–ú–ù–´–ô, —Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

### –£–∂–µ —Å–¥–µ–ª–∞–Ω–æ:
- ‚úÖ **–≠–¢–ê–ü 1:** ConfigManager —Å–æ–∑–¥–∞–Ω –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (47 —Ä–∞–∑)

---

## üéØ –ü–õ–ê–ù –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê

### –≠–¢–ê–ü 2: –†–∞—Å—à–∏—Ä–∏—Ç—å FuturesPositionManager

**–ß—Ç–æ –≤—ã–Ω–µ—Å—Ç–∏ –∏–∑ orchestrator:**
1. `_load_existing_positions()` - –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–∑–∏—Ü–∏–π
2. `_sync_positions_with_exchange()` - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –±–∏—Ä–∂–µ–π
3. `_manage_positions()` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
4. `_emergency_close_all_positions()` - –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
5. `_handle_private_ws_positions()` - –û–±—Ä–∞–±–æ—Ç–∫–∞ WS –ø–æ–∑–∏—Ü–∏–π
6. `_handle_position_closed_via_ws()` - –ó–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ WS
7. `_check_position_holding_time()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è
8. `_close_position()` - –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏

**–î–æ–±–∞–≤–∏—Ç—å –≤ FuturesPositionManager:**
- `add_position()` - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- `remove_position()` - –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- `get_position()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
- `has_position()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è
- `get_all_positions()` - –í—Å–µ –ø–æ–∑–∏—Ü–∏–∏
- `load_existing_positions()` - –ó–∞–≥—Ä—É–∑–∫–∞ —Å –±–∏—Ä–∂–∏
- `sync_with_exchange()` - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- `emergency_close_all()` - –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `self.active_positions`:** 48 —Ä–∞–∑ –≤ orchestrator

---

### –≠–¢–ê–ü 3: –°–æ–∑–¥–∞—Ç—å TSLManager –¥–ª—è Futures

**–ß—Ç–æ –≤—ã–Ω–µ—Å—Ç–∏:**
- –õ–æ–≥–∏–∫–∞ Trailing Stop Loss –∏–∑ orchestrator
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å `indicators/trailing_stop_loss.py`
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ TSL –ø–æ —Å–∏–º–≤–æ–ª–∞–º
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SL —É—Ä–æ–≤–Ω–µ–π

**–°–æ–∑–¥–∞—Ç—å:** `tsl_manager.py`

---

### –≠–¢–ê–ü 4: –†–∞—Å—à–∏—Ä–∏—Ç—å FuturesOrderExecutor

**–ß—Ç–æ –≤—ã–Ω–µ—Å—Ç–∏:**
- –ú–µ—Ç–æ–¥—ã —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–æ–≤
- –õ–æ–≥–∏–∫–∞ retry
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- WebSocket –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

---

### –≠–¢–ê–ü 5: –°–æ–∑–¥–∞—Ç—å RiskManager –¥–ª—è Futures

**–ß—Ç–æ –≤—ã–Ω–µ—Å—Ç–∏:**
- `_calculate_position_size()` - –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Margin checks
- Liquidation protection

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ:**
- `risk/position_sizer.py`
- `risk/margin_monitor.py`
- `risk/liquidation_protector.py`
- `risk/max_size_limiter.py`

---

### –≠–¢–ê–ü 6: –£–ø—Ä–æ—Å—Ç–∏—Ç—å Orchestrator

**–¶–µ–ª—å:** –£–º–µ–Ω—å—à–∏—Ç—å —Å 5552 –¥–æ ~1000-1500 —Å—Ç—Ä–æ–∫

**–£–¥–∞–ª–∏—Ç—å:**
- –í—ã–Ω–µ—Å–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã
- DEPRECATED –∫–æ–¥
- –î—É–±–ª–∏—Ä—É—é—â—É—é –ª–æ–≥–∏–∫—É

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
```
orchestrator.py: 5552 —Å—Ç—Ä–æ–∫–∏, 55 –º–µ—Ç–æ–¥–æ–≤
```

### –ü–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
```
orchestrator.py: ~1500 —Å—Ç—Ä–æ–∫, ~20 –º–µ—Ç–æ–¥–æ–≤
position_manager.py: —Ä–∞—Å—à–∏—Ä–µ–Ω (+10 –º–µ—Ç–æ–¥–æ–≤)
tsl_manager.py: ~500 —Å—Ç—Ä–æ–∫ (–ù–û–í–´–ô)
risk_manager.py: ~400 —Å—Ç—Ä–æ–∫ (–ù–û–í–´–ô)
```

### –£–ª—É—á—à–µ–Ω–∏–µ:
- **–£–º–µ–Ω—å—à–µ–Ω–∏–µ orchestrator:** ~70%
- **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å:** –í—ã—Å–æ–∫–∞—è
- **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å:** –û—Ç–ª–∏—á–Ω–∞—è

---

## üöÄ –ù–ê–ß–ò–ù–ê–ï–ú –° –≠–¢–ê–ü–ê 2!

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –†–∞—Å—à–∏—Ä–∏—Ç—å FuturesPositionManager

