# üîß –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —Ç–æ—Ä–≥–æ–≤–ª–∏ (13.10.2025)

## üìã –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π
**–§–∞–π–ª:** `src/filters/time_session_manager.py`  
**–°—Ç—Ä–æ–∫–∏:** 182-187 (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)

#### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
- –í –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤–∫–ª—é—á–µ–Ω—ã –≤—Å–µ 3 —Ç–æ—Ä–≥–æ–≤—ã–µ —Å–µ—Å—Å–∏–∏:
  - **–ê–∑–∏–∞—Ç—Å–∫–∞—è**: 0-9 UTC ‚úÖ
  - **–ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è**: 7-16 UTC ‚úÖ
  - **–ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∞—è**: 13-22 UTC ‚úÖ
  
- –ù–æ –≤ –∫–æ–¥–µ –±—ã–ª–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ "–Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö —á–∞—Å–æ–≤" `[22, 23, 0, 1, 2, 3, 4, 5]`
- –≠—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å **–î–û** –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ß–∞—Å—ã 0-5 UTC (–∞–∑–∏–∞—Ç—Å–∫–∞—è —Å–µ—Å—Å–∏—è) –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∏—Å—å!

#### –ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–æ–≤:
```
2025-10-13 06:23:57 (03:00 UTC)
‚úÖ Session check - Hour: 3, In session: True, Sessions: {'asian': (0, 9), ...}
‚ùå Trading blocked: Low liquidity hour (3:00 UTC)
```

–í—Ä–µ–º—è 03:00 UTC –≤—Ö–æ–¥–∏—Ç –≤ –∞–∑–∏–∞—Ç—Å–∫—É—é —Å–µ—Å—Å–∏—é (0-9), –Ω–æ —Ç–æ—Ä–≥–æ–≤–ª—è –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞—Å—å!

---

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2: ATR = 0.000000 –¥–ª—è BTC-USDT
**–§–∞–π–ª:** `src/indicators.py`  
**–°—Ç—Ä–æ–∫–∏:** 168-203 (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è)

#### –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:
- ATR (Average True Range) –ø–æ–∫–∞–∑—ã–≤–∞–ª 0.000000 –¥–ª—è BTC
- –ü—Ä–∏—á–∏–Ω—ã –º–æ–≥–ª–∏ –±—ã—Ç—å:
  1. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö (–º–µ–Ω—å—à–µ –ø–µ—Ä–∏–æ–¥–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞)
  2. –ê–±—Å–æ–ª—é—Ç–Ω–æ —Ñ–ª—ç—Ç–æ–≤—ã–π —Ä—ã–Ω–æ–∫ (–≤—Å–µ —Å–≤–µ—á–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ)
  3. –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
  
- –ù–æ –Ω–µ –±—ã–ª–æ **–¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏!

#### –ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–æ–≤:
```
2025-10-12 21:24:49 | üö´ BTC-USDT: Low volatility: ATR=0.000000 (min=0.0004)
```

–î–ª—è BTC —ç—Ç–æ —Å—Ç—Ä–∞–Ω–Ω–æ - –Ω—É–∂–Ω–∞ –¥–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞.

---

## ‚úÖ –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –ü–µ—Ä–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤ TimeSessionManager

**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö —á–∞—Å–æ–≤ **–ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –ü–û–°–õ–ï** –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- –¢–µ–ø–µ—Ä—å –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–∞–∫:
  1. ‚è∞ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö –¥–Ω–µ–π
  2. üîÑ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π —Å–µ—Å—Å–∏–π (–µ—Å–ª–∏ `prefer_overlaps=true`)
  3. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π** (asian/european/american)
  4. üö´ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö —á–∞—Å–æ–≤ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï–¢ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π)
  5. ‚ùå –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–µ—Å–ª–∏ –Ω–µ—Ç —Å–µ—Å—Å–∏–π)

**–ö–æ–¥ (—Å—Ç—Ä–æ–∫–∏ 198-217):**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π (–µ—Å–ª–∏ –Ω–µ —Ç—Ä–µ–±—É–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è)
active_sessions = self.get_active_sessions(current_time)
if active_sessions:
    # –ï—Å–ª–∏ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ —Å–µ—Å—Å–∏–∏ - —Ä–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ—Ä–≥–æ–≤–ª—é
    session_names = [s.name for s in active_sessions]
    logger.debug(
        f"‚úÖ Trading allowed: Active sessions {session_names} ({current_hour}:00 UTC)"
    )
    return True

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã—Ö —á–∞—Å–æ–≤ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π)
if self.config.avoid_low_liquidity_hours:
    if current_hour in self.config.low_liquidity_hours:
        logger.debug(
            f"‚è∞ Trading blocked: Low liquidity hour ({current_hour}:00 UTC)"
        )
        return False
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ê–∑–∏–∞—Ç—Å–∫–∞—è —Å–µ—Å—Å–∏—è (0-9 UTC) —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
- ‚úÖ –í—Å–µ —Ç—Ä–∏ —Å–µ—Å—Å–∏–∏ —Ç–æ—Ä–≥—É—é—Ç –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- ‚úÖ –ù–∏–∑–∫–æ–ª–∏–∫–≤–∏–¥–Ω—ã–µ —á–∞—Å—ã –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏

---

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ATR = 0

**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ –≤ `src/indicators.py`:**

1. **–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö** (—Å—Ç—Ä–æ–∫–∏ 171-187):
```python
if (len(high_data) < self.period or ...):
    min_len = min(len(high_data), len(low_data), len(close_data))
    return IndicatorResult(
        self.name, 
        0.0,
        metadata={
            "period": self.period,
            "data_length": min_len,
            "error": f"Insufficient data: need {self.period}, got {min_len}"
        }
    )
```

2. **–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è ATR = 0** (—Å—Ç—Ä–æ–∫–∏ 216-224):
```python
if atr_value == 0.0 and len(true_ranges) >= self.period:
    metadata["warning"] = "ATR is zero - market might be completely flat"
    metadata["sample_true_ranges"] = true_ranges[-5:]
    metadata["sample_prices"] = {
        "high": high_data[-5:],
        "low": low_data[-5:],
        "close": close_data[-5:]
    }
```

**–ß—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–æ –≤ `src/strategies/scalping.py`:**

3. **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ ATR = 0** (—Å—Ç—Ä–æ–∫–∏ 625-639):
```python
if atr.value == 0.0:
    error_info = atr.metadata.get("error", "Unknown reason")
    warning_info = atr.metadata.get("warning", "")
    logger.warning(
        f"üö´ {symbol}: ATR is ZERO! {error_info} {warning_info}"
    )
    if "sample_prices" in atr.metadata:
        logger.debug(f"   Sample prices: {atr.metadata['sample_prices']}")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –¢–µ–ø–µ—Ä—å –º—ã —É–≤–∏–¥–∏–º **—Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É** ATR = 0
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∂—É—Ç –ø—Ä–∏–º–µ—Ä—ã —Ü–µ–Ω –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
- ‚úÖ –ú–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å: –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ —Ä—ã–Ω–æ–∫ —Ñ–ª—ç—Ç

---

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å `try-except` –±–ª–æ–∫–æ–≤ (—Å—Ç—Ä–æ–∫–∏ 438-466)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã –≤ –ª–æ–≥–∏–∫–µ —Å—Ç–∞—Ä–æ–≥–æ scoring (—Å—Ç—Ä–æ–∫–∏ 918-945)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã –≤ emergency close (—Å—Ç—Ä–æ–∫–∏ 1809-1815)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—Ç—Å—Ç—É–ø—ã –≤ get_open_orders (—Å—Ç—Ä–æ–∫–∏ 1922-1928)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ö–æ–¥ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ª–∏–Ω—Ç–µ—Ä –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ù–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ Python

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **–¢–æ—Ä–≥–æ–≤–ª—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏:**
   - ‚úÖ –ê–∑–∏–∞—Ç—Å–∫–∞—è —Å–µ—Å—Å–∏—è (0-9 UTC) —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
   - ‚úÖ –ï–≤—Ä–æ–ø–µ–π—Å–∫–∞—è —Å–µ—Å—Å–∏—è (7-16 UTC) —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
   - ‚úÖ –ê–º–µ—Ä–∏–∫–∞–Ω—Å–∫–∞—è —Å–µ—Å—Å–∏—è (13-22 UTC) —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é
   - ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ç–æ–ª—å–∫–æ –≤ —á–∞—Å—ã –±–µ–∑ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π

2. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ ATR:**
   - ‚úÖ –ü–æ–Ω—è—Ç–Ω—ã–µ WARNING –≤ –ª–æ–≥–∞—Ö –ø—Ä–∏ ATR = 0
   - ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏—á–∏–Ω—ã (–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö / —Ñ–ª—ç—Ç)
   - ‚úÖ –ü—Ä–∏–º–µ—Ä—ã —Ü–µ–Ω –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

3. **–ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞:**
   - ‚úÖ –ù–µ—Ç —Å–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
   - ‚úÖ –ö–æ–¥ –ø—Ä–æ—Ö–æ–¥–∏—Ç –ª–∏–Ω—Ç–µ—Ä
   - ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ try-except

---

## üìù –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
```bash
python run_bot.py
```

### 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è —Ç–æ—Ä–≥–æ–≤–ª–∏ (03:00-05:00 UTC):
–¢–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:
```
‚úÖ Trading allowed: Active sessions ['Asian'] (3:00 UTC)
```
–í–º–µ—Å—Ç–æ:
```
‚ùå Trading blocked: Low liquidity hour (3:00 UTC)
```

### 3. –ï—Å–ª–∏ —É–≤–∏–¥–∏—Ç–µ ATR = 0, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ WARNING:
```
üö´ BTC-USDT: ATR is ZERO! Insufficient data: need 14, got 10
```
–∏–ª–∏
```
üö´ BTC-USDT: ATR is ZERO! ATR is zero - market might be completely flat
   Sample prices: {'high': [...], 'low': [...], 'close': [...]}
```

---

## üîç –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π

1. ‚úÖ `src/filters/time_session_manager.py` - –ª–æ–≥–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
2. ‚úÖ `src/indicators.py` - —Ä–∞—Å—á–µ—Ç ATR —Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π
3. ‚úÖ `src/strategies/scalping.py` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ATR + –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞

---

## ‚ú® –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (config.yaml):
```yaml
time_filter:
  trade_asian_session: true       # 00:00-09:00 UTC ‚úÖ
  trade_european_session: true    # 07:00-16:00 UTC ‚úÖ
  trade_american_session: true    # 13:00-22:00 UTC ‚úÖ
  prefer_overlaps: false          # –¢–æ—Ä–≥–æ–≤–∞—Ç—å –≤—Å–µ —Å–µ—Å—Å–∏–∏, –Ω–µ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è
  avoid_low_liquidity_hours: true # –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
  avoid_weekends: true            # –ù–µ —Ç–æ—Ä–≥–æ–≤–∞—Ç—å –≤ –≤—ã—Ö–æ–¥–Ω—ã–µ
```

### –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è —Å–µ—Å—Å–∏–π (–≤—ã—Å–æ–∫–∞—è –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å):
- **Asian-European**: 7-9 UTC üåèüá™üá∫
- **European-American**: 13-16 UTC üá™üá∫üá∫üá∏

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã


