# üìä –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –†–ê–ë–û–¢–´ –ë–û–¢–ê –° –ü–û–ó–ò–¶–ò–Ø–ú–ò

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-28  
**–í–µ—Ä—Å–∏—è –±–æ—Ç–∞:** Futures Scalping Bot  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç–∏–≤–Ω–∞—è —Å–µ—Å—Å–∏—è

---

## üéØ –û–ì–õ–ê–í–õ–ï–ù–ò–ï

1. [–ö–∞–∫ –±–æ—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏](#1-–∫–∞–∫-–±–æ—Ç-–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç-–ø–æ–∑–∏—Ü–∏–∏)
2. [–ö–∞–∫ –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏](#2-–∫–∞–∫-–±–æ—Ç-–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç-–ø–æ–∑–∏—Ü–∏–∏)
3. [–ö–∞–∫ –±–æ—Ç –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏](#3-–∫–∞–∫-–±–æ—Ç-–∑–∞–∫—Ä—ã–≤–∞–µ—Ç-–ø–æ–∑–∏—Ü–∏–∏)
4. [–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π](#4-—Ç–µ–∫—É—â–µ–µ-—Å–æ—Å—Ç–æ—è–Ω–∏–µ-–ø–æ–∑–∏—Ü–∏–π)
5. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#5-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## 1. –ö–ê–ö –ë–û–¢ –û–¢–ö–†–´–í–ê–ï–¢ –ü–û–ó–ò–¶–ò–ò

### 1.1. –ü—Ä–æ—Ü–µ—Å—Å –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏

**–û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫:**

```
SignalGenerator ‚Üí SignalCoordinator ‚Üí EntryManager ‚Üí OrderExecutor ‚Üí PositionRegistry
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:**

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞** (`SignalGenerator`)
   - –ê–Ω–∞–ª–∏–∑ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (RSI, MACD, BB, EMA, ATR)
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ (TRENDING, RANGING, CHOPPY)
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `FilterManager` (ADX, MTF, Correlation, Slippage)
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞ —Å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º (LONG/SHORT)

2. **–ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–∞** (`SignalCoordinator`)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –æ—Ç–∫—Ä—ã—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø–æ —Å–∏–º–≤–æ–ª—É
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ (`MaxSizeLimiter`)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∏—Å–∫–æ–≤ (`RiskManager`)
   - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ —á–µ—Ä–µ–∑ `EntryManager`

3. **–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏** (`EntryManager`)
   - –†–∞—Å—á–µ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ø–æ–∑–∏—Ü–∏–∏ (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ –±–∞–ª–∞–Ω—Å—É)
   - –†–∞–∑–º–µ—â–µ–Ω–∏–µ –ª–∏–º–∏—Ç–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞ (POST-ONLY –¥–ª—è –ª—É—á—à–µ–π —Ü–µ–Ω—ã)
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–∏ –≤ `PositionRegistry`

4. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∑–∞—â–∏—Ç—ã** (`TrailingSLCoordinator`)
   - –°–æ–∑–¥–∞–Ω–∏–µ `TrailingStopLoss` –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏
   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —Ä–µ–∂–∏–º—É —Ä—ã–Ω–∫–∞:
     - **TRENDING**: trail=2.0%, loss_cut=4.0%, min_holding=35 –º–∏–Ω, timeout=120 –º–∏–Ω
     - **RANGING**: trail=2.0%, loss_cut=4.0%, min_holding=35 –º–∏–Ω, timeout=120 –º–∏–Ω
     - **CHOPPY**: trail=1.5%, loss_cut=3.0%, min_holding=30 –º–∏–Ω, timeout=90 –º–∏–Ω

### 1.2. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ—Ç–∫—Ä—ã—Ç–∏—è

**–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏:**
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –±–∞–ª–∞–Ω—Å–∞
- –î–ª—è –±–∞–ª–∞–Ω—Å–∞ $886.57 ‚Üí —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ ~$107.98
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–¥–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏: $150
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π: $600
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ü–∏–π: 5

**–ü–ª–µ—á–æ:**
- –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ: **5x** –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∞—Ä–∂–∞ (isolated margin)

**–¢–∏–ø –æ—Ä–¥–µ—Ä–∞:**
- **–õ–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä (POST-ONLY)** –¥–ª—è –ª—É—á—à–µ–π —Ü–µ–Ω—ã
- –¢–∞–π–º–∞—É—Ç: 30 —Å–µ–∫—É–Ω–¥ ‚Üí –∑–∞–º–µ–Ω–∞ –Ω–∞ —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä

---

## 2. –ö–ê–ö –ë–û–¢ –û–ë–†–ê–ë–ê–¢–´–í–ê–ï–¢ –ü–û–ó–ò–¶–ò–ò

### 2.1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

**1. PositionMonitor** (–∏–Ω—Ç–µ—Ä–≤–∞–ª: 5 —Å–µ–∫—É–Ω–¥)
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –í—ã–∑–æ–≤ `ExitAnalyzer` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –≤ `DataRegistry`

**2. TrailingSLCoordinator** (–∏–Ω—Ç–µ—Ä–≤–∞–ª: 1.5 —Å–µ–∫—É–Ω–¥—ã)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Trailing Stop Loss –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ü–µ–Ω—ã
- –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ (ADX + Order Flow)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL

**3. PositionManager** (–∏–Ω—Ç–µ—Ä–≤–∞–ª: 5 —Å–µ–∫—É–Ω–¥)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ (`margin_ratio`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Take Profit
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Stop Loss
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Profit Harvesting
- –ü—Ä–æ–≤–µ—Ä–∫–∞ loss_cut

**4. LiquidationGuard** (–∏–Ω—Ç–µ—Ä–≤–∞–ª: 5 —Å–µ–∫—É–Ω–¥)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–∞—Ä–∂–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ä–∏—Å–∫–∞—Ö:
  - **Warning**: margin_ratio < 1.8
  - **Danger**: margin_ratio < 1.3
  - **Critical**: margin_ratio < 1.1
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º —Ä–∏—Å–∫–µ

**5. ExitAnalyzer** (–≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ PositionMonitor)
- –ê–Ω–∞–ª–∏–∑ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ —Ä–µ–∂–∏–º—É —Ä—ã–Ω–∫–∞
- –ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π: `close`, `extend_tp`, `partial_close`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ADX, Order Flow, MTF –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### 2.2. –ú–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã

**MIN_HOLDING (–∑–∞—â–∏—Ç–∞ –æ—Ç —à—É–º–∞):**
- **TRENDING/RANGING**: 35 –º–∏–Ω—É—Ç
- **CHOPPY**: 30 –º–∏–Ω—É—Ç
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TP/SL –≤ –ø–µ—Ä–≤—ã–µ 35 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
- –¶–µ–ª—å: –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ —à—É–º–∞ —Ä—ã–Ω–∫–∞

**Trailing Stop Loss:**
- –ù–∞—á–∞–ª—å–Ω—ã–π trail: 2.0% (–¥–ª—è TRENDING/RANGING)
- –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∑–∞—Ç—è–≥–∏–≤–∞–Ω–∏–µ –ø—Ä–∏ –±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª–∏
- –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ —Å–∏–ª–µ —Ç—Ä–µ–Ω–¥–∞ (ADX)

**Margin Ratio –∑–∞—â–∏—Ç–∞:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ `margin_ratio = equity / margin_used`
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π (< 30 —Å–µ–∫)
- –ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω–æ–º —Ä–∏—Å–∫–µ

---

## 3. –ö–ê–ö –ë–û–¢ –ó–ê–ö–†–´–í–ê–ï–¢ –ü–û–ó–ò–¶–ò–ò

### 3.1. –í—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞–∫—Ä—ã—Ç–∏—è

**1. Take Profit (TP)**
- **–£—Å–ª–æ–≤–∏–µ:** `profit_pct >= tp_percent` (–æ–±—ã—á–Ω–æ 2.4%)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `_check_tp_only()` –≤ `PositionManager`
- **–ó–∞—â–∏—Ç–∞:** MIN_HOLDING –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ–π–¥–µ–Ω (35 –º–∏–Ω—É—Ç)
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å—Ä–∞–∑—É –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏)

**2. Trailing Stop Loss (TSL)**
- **–£—Å–ª–æ–≤–∏–µ:** –¶–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `TrailingSLCoordinator.check_tsl()`
- **–õ–æ–≥–∏–∫–∞:**
  - –î–ª—è LONG: —Å—Ç–æ–ø –¥–≤–∏–∂–µ—Ç—Å—è –≤–≤–µ—Ä—Ö —Å —Ü–µ–Ω–æ–π
  - –î–ª—è SHORT: —Å—Ç–æ–ø –¥–≤–∏–∂–µ—Ç—Å—è –≤–Ω–∏–∑ —Å —Ü–µ–Ω–æ–π
  - –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∑–∞—Ç—è–≥–∏–≤–∞–Ω–∏–µ –ø—Ä–∏ –±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª–∏
- **–ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞:** Order Flow –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–∑–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏)

**3. Stop Loss (SL)**
- **–£—Å–ª–æ–≤–∏–µ:** `PnL% –æ—Ç –º–∞—Ä–∂–∏ <= -sl_percent` (–æ–±—ã—á–Ω–æ -2.0%)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `_check_sl()` –≤ `PositionManager`
- **–ó–∞—â–∏—Ç–∞:** MIN_HOLDING –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø—Ä–æ–π–¥–µ–Ω
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–∑–∞—â–∏—Ç–∞ –æ—Ç –±–æ–ª—å—à–∏—Ö —É–±—ã—Ç–∫–æ–≤)

**4. Loss Cut**
- **–£—Å–ª–æ–≤–∏–µ:** `PnL% –æ—Ç –º–∞—Ä–∂–∏ <= -loss_cut_percent` (–æ–±—ã—á–Ω–æ -4.0%)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `_check_tp_only()` ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut
- **–ó–∞—â–∏—Ç–∞:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 5 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (–∂–µ—Å—Ç–∫–∏–π —Å—Ç–æ–ø)

**5. Profit Harvesting (PH)**
- **–£—Å–ª–æ–≤–∏–µ:** –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∏–±—ã–ª—å –∑–∞ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É):**
  - **TRENDING**: $0.20 –∑–∞ 180 —Å–µ–∫ (3 –º–∏–Ω)
  - **RANGING**: $0.15 –∑–∞ 120 —Å–µ–∫ (2 –º–∏–Ω)
  - **CHOPPY**: $0.10 –∑–∞ 60 —Å–µ–∫ (1 –º–∏–Ω)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `_check_profit_harvesting()` –≤ `PositionManager`
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π (–¥–æ—Å—Ä–æ—á–Ω—ã–π –≤—ã—Ö–æ–¥ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∏–±—ã–ª–∏)

**6. Timeout**
- **–£—Å–ª–æ–≤–∏–µ:** –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ –¥–æ–ª—å—à–µ `timeout_minutes` (–æ–±—ã—á–Ω–æ 120 –º–∏–Ω—É—Ç)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `TrailingSLCoordinator` ‚Üí `should_close_position()`
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏)

**7. Emergency Close**
- **–£—Å–ª–æ–≤–∏–µ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π `margin_ratio < 1.1` (LiquidationGuard)
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `LiquidationGuard._handle_risk_level()`
- **–ó–∞—â–∏—Ç–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π (–∑–∞—â–∏—Ç–∞ –æ—Ç –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏)

**8. ExitAnalyzer —Ä–µ—à–µ–Ω–∏–µ**
- **–£—Å–ª–æ–≤–∏–µ:** ExitAnalyzer –ø—Ä–∏–Ω—è–ª —Ä–µ—à–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç—å
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** `ExitAnalyzer.analyze_position()`
- **–õ–æ–≥–∏–∫–∞:**
  - –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ (ADX)
  - –ê–Ω–∞–ª–∏–∑ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ (Order Flow, MTF)
  - –†–µ—à–µ–Ω–∏–µ: `close`, `extend_tp`, `partial_close`
- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)

### 3.2. –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–∫—Ä—ã—Ç–∏—è

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):**
1. Emergency Close (margin_ratio < 1.1)
2. Loss Cut (PnL <= -4% –æ—Ç –º–∞—Ä–∂–∏)

**–í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏):**
3. Take Profit (profit >= 2.4%)
4. Trailing Stop Loss (—Ü–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞)
5. Stop Loss (PnL <= -2% –æ—Ç –º–∞—Ä–∂–∏)
6. ExitAnalyzer —Ä–µ—à–µ–Ω–∏–µ (–∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)

**–°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–¥–æ—Å—Ä–æ—á–Ω—ã–π –≤—ã—Ö–æ–¥):**
7. Profit Harvesting (–±—ã—Å—Ç—Ä–∞—è –ø—Ä–∏–±—ã–ª—å)

**–ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏):**
8. Timeout (–ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ > 120 –º–∏–Ω—É—Ç)

### 3.3. –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–∫—Ä—ã—Ç–∏—è

**–®–∞–≥–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏:**

1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –∑–∞–∫—Ä—ã—Ç–∏—è**
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –≤ `close_reason`
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

2. **–û—Ç–º–µ–Ω–∞ TSL**
   - –û—á–∏—Å—Ç–∫–∞ `TrailingStopLoss` –∏–∑ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä–∞
   - –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ `trailing_sl_by_symbol`

3. **–†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞ –∑–∞–∫—Ä—ã—Ç–∏—è**
   - –¢–∏–ø: **MARKET** (–±—ã—Å—Ç—Ä–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ)
   - –°—Ç–æ—Ä–æ–Ω–∞: –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∞—è –ø–æ–∑–∏—Ü–∏–∏
   - –†–∞–∑–º–µ—Ä: –ø–æ–ª–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏

4. **–†–∞—Å—á–µ—Ç PnL**
   - Gross PnL (–±–µ–∑ –∫–æ–º–∏—Å—Å–∏–π)
   - –ö–æ–º–∏—Å—Å–∏–∏ (0.1% –Ω–∞ –≤—Ö–æ–¥ + 0.1% –Ω–∞ –≤—ã—Ö–æ–¥)
   - Net PnL (—Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π)

5. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è**
   - –ó–∞–ø–∏—Å—å –≤ `trades_*.csv`
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `PerformanceTracker`
   - –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ `PositionRegistry`
   - –û—á–∏—Å—Ç–∫–∞ –∏–∑ `active_positions`

---

## 4. –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –ü–û–ó–ò–¶–ò–ô

### 4.1. –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏

**SOL-USDT SHORT:**
- **–†–∞–∑–º–µ—Ä:** 1.56 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ (~$219.55)
- **Entry Price:** 140.69 USDT
- **Current Price:** ~140.75 USDT (–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤)
- **PnL:** -0.10 USDT (–Ω–µ–±–æ–ª—å—à–æ–π —É–±—ã—Ç–æ–∫)
- **Margin Used:** 43.89 USDT
- **Equity:** 43.79 USDT
- **Margin Ratio:** ~1.00 (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞—Å—á–µ—Ç–∞)
- **–†–µ–∂–∏–º:** RANGING
- **TSL:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (trail=2.0%, loss_cut=4.0%)
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 2025-11-28 23:09:48
- **–í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏:** ~20 —Å–µ–∫—É–Ω–¥ (–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤)

**–°—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü–æ–∑–∏—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–∞ (margin_ratio > 1.0)
- ‚ö†Ô∏è MIN_HOLDING –∞–∫—Ç–∏–≤–Ω–∞ (TP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –¥–æ 35 –º–∏–Ω—É—Ç)
- ‚úÖ TSL –∞–∫—Ç–∏–≤–µ–Ω –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- ‚úÖ LiquidationGuard –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç –ø–æ–∑–∏—Ü–∏—é

### 4.2. –õ–æ–≥–∏ —Ä–∞–±–æ—Ç—ã

**–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è:**
- `23:09:49` - –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ –∏ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∞
- `23:09:49` - TSL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- `23:09:51` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (margin_ratio=1.00)
- `23:09:51` - TP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω MIN_HOLDING (2.8 —Å–µ–∫ < 2100 —Å–µ–∫)
- `23:09:54` - TSL –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ entry_time)
- `23:09:57` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (margin_ratio=0.50, –Ω–æ –∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)
- `23:09:59` - TP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω MIN_HOLDING (10.9 —Å–µ–∫ < 2100 —Å–µ–∫)
- `23:10:03` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (margin_ratio=0.50, –∑–∞—â–∏—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞)
- `23:10:08` - TP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω MIN_HOLDING (19.8 —Å–µ–∫ < 2100 —Å–µ–∫)

**–ù–∞–±–ª—é–¥–µ–Ω–∏—è:**
- ‚úÖ –í—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ MIN_HOLDING –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
- ‚úÖ Margin Calculator –∏—Å–ø—Ä–∞–≤–ª–µ–Ω (–Ω–µ –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è)
- ‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è –≤ –Ω–µ–±–æ–ª—å—à–æ–º —É–±—ã—Ç–∫–µ (-0.10 USDT), –Ω–æ —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞

---

## 5. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 5.1. –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º!** –í—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

**–ú–µ–ª–∫–∏–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è:**
1. –ü–æ–∑–∏—Ü–∏—è SOL-USDT –≤ –Ω–µ–±–æ–ª—å—à–æ–º —É–±—ã—Ç–∫–µ (-0.10 USDT) - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞
2. MIN_HOLDING –∞–∫—Ç–∏–≤–Ω–∞ –∏ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
3. Margin Calculator –∏—Å–ø—Ä–∞–≤–ª–µ–Ω –∏ –Ω–µ –¥–∞–µ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π

### 5.2. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

**1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π:**
- ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã (5 —Å–µ–∫ –¥–ª—è PositionMonitor, 1.5 —Å–µ–∫ –¥–ª—è TSL)

**2. –ó–∞—â–∏—Ç–∞ –æ—Ç —É–±—ã—Ç–∫–æ–≤:**
- ‚úÖ Loss Cut –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ (4% –æ—Ç –º–∞—Ä–∂–∏)
- ‚úÖ Stop Loss –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ (2% –æ—Ç –º–∞—Ä–∂–∏)
- ‚úÖ MIN_HOLDING –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç —à—É–º–∞ (35 –º–∏–Ω—É—Ç)

**3. –ó–∞—â–∏—Ç–∞ –ø—Ä–∏–±—ã–ª–∏:**
- ‚úÖ Trailing Stop Loss —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Take Profit –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ (2.4%)
- ‚úÖ Profit Harvesting –∞–∫—Ç–∏–≤–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–∏–±—ã–ª–∏

**4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏:**
- ‚úÖ LiquidationGuard –º–æ–Ω–∏—Ç–æ—Ä–∏—Ç –º–∞—Ä–∂—É
- ‚úÖ Margin Calculator –∏—Å–ø—Ä–∞–≤–ª–µ–Ω
- ‚úÖ Emergency Close –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ

### 5.3. –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–ª—å—à–µ

1. **–ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è MIN_HOLDING (35 –º–∏–Ω—É—Ç):**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Take Profit
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Trailing Stop Loss
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Profit Harvesting

2. **–ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ø—Ä–∏–±—ã–ª–∏:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ –∑–∞—Ç—è–≥–∏–≤–∞–Ω–∏–µ TSL
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É ExitAnalyzer
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ)

3. **–ü—Ä–∏ —É–±—ã—Ç–∫–µ:**
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Stop Loss
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Loss Cut
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Emergency Close

---

## üìù –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

**–ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** –í—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –æ—Ç–∫—Ä—ã—Ç–∏—è, –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ.

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ª–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ (POST-ONLY)
- ‚úÖ TSL –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–æ–∑–∏—Ü–∏–∏
- ‚úÖ –í—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã –∞–∫—Ç–∏–≤–Ω—ã (MIN_HOLDING, Loss Cut, Stop Loss)
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ–∑–∏—Ü–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º —É—Å–ª–æ–≤–∏—è–º

**–¢–µ–∫—É—â–∞—è –ø–æ–∑–∏—Ü–∏—è SOL-USDT:**
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞ (margin_ratio > 1.0)
- –ó–∞—â–∏—â–µ–Ω–∞ MIN_HOLDING (35 –º–∏–Ω—É—Ç)
- TSL –∞–∫—Ç–∏–≤–µ–Ω –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –í—Å–µ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ä–∞–±–æ—Ç–∞—é—Ç

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
- –î–æ–∂–¥–∞—Ç—å—Å—è –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è MIN_HOLDING (35 –º–∏–Ω—É—Ç)
- –ù–∞–±–ª—é–¥–∞—Ç—å –∑–∞ —Ä–∞–±–æ—Ç–æ–π Take Profit –∏ Trailing Stop Loss
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É Profit Harvesting –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –±—ã—Å—Ç—Ä–æ–π –ø—Ä–∏–±—ã–ª–∏

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-28  
**–ê–≤—Ç–æ—Ä –∞–Ω–∞–ª–∏–∑–∞:** AI Assistant  
**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 1.0


