# ОТСУТСТВИЕ НАСТРОЕК ДЛЯ КАЖДОЙ ПАРЫ

**Дата:** 23 ноября 2025  
**Проблема:** Нет специфических настроек limit_offset для каждой пары

---

## ✅ ПРОВЕРКА ЛОГИКИ ДЛЯ SHORT/LONG

### Логика для всех пар:

**Для BUY (LONG):**
- ✅ Используется `best_ask` (лучшая цена продажи)
- ✅ Добавляется offset из конфига (по режиму)
- ✅ Работает одинаково для всех пар

**Для SELL (SHORT):**
- ✅ Используется `best_bid` (лучшая цена покупки)
- ✅ Вычитается offset из конфига (по режиму)
- ✅ Работает одинаково для всех пар

**Вывод:** ✅ Логика для SHORT/LONG правильная для всех пар

---

## ⚠️ ПРОБЛЕМА: ОТСУТСТВИЕ НАСТРОЕК ДЛЯ КАЖДОЙ ПАРЫ

### Текущая ситуация:

**Конфигурация `order_executor.limit_order`:**
- ✅ Есть базовый `limit_offset_percent: 0.05%`
- ✅ Есть настройки по режимам (`by_regime`):
  - `trending: 0.08%`
  - `ranging: 0.12%`
  - `choppy: 0.10%`
- ❌ НЕТ настроек для каждой пары (`by_symbol`)

### Почему это проблема:

1. **Разная ликвидность:**
   - BTC-USDT: высокая ликвидность, маленький спред → можно использовать меньший offset
   - XRP-USDT: низкая ликвидность, большой спред → нужен больший offset

2. **Разная волатильность:**
   - BTC-USDT: более стабильная цена → можно использовать меньший offset
   - DOGE-USDT: высокая волатильность → нужен больший offset для гарантии исполнения

3. **Разные спреды:**
   - BTC-USDT: спред ~0.01-0.02% → offset 0.05% достаточен
   - XRP-USDT: спред ~0.05-0.10% → offset 0.12% может быть недостаточен

---

## ✅ РЕШЕНИЕ: ДОБАВИТЬ НАСТРОЙКИ ДЛЯ КАЖДОЙ ПАРЫ

### Предлагаемая структура конфига:

```yaml
order_executor:
  limit_order:
    limit_offset_percent: 0.05  # Базовый offset
    by_regime:
      trending:
        limit_offset_percent: 0.08
      ranging:
        limit_offset_percent: 0.12
      choppy:
        limit_offset_percent: 0.10
    
    # ✅ НОВОЕ: Настройки для каждой пары
    by_symbol:
      "BTC-USDT":
        limit_offset_percent: 0.03  # Маленький offset для высокой ликвидности
        by_regime:
          trending: 0.05
          ranging: 0.08
          choppy: 0.06
      "ETH-USDT":
        limit_offset_percent: 0.04
        by_regime:
          trending: 0.06
          ranging: 0.10
          choppy: 0.08
      "SOL-USDT":
        limit_offset_percent: 0.05
        by_regime:
          trending: 0.08
          ranging: 0.12
          choppy: 0.10
      "DOGE-USDT":
        limit_offset_percent: 0.08  # Больший offset для высокой волатильности
        by_regime:
          trending: 0.10
          ranging: 0.15
          choppy: 0.12
      "XRP-USDT":
        limit_offset_percent: 0.10  # Больший offset для низкой ликвидности
        by_regime:
          trending: 0.12
          ranging: 0.18
          choppy: 0.15
```

### Приоритет настроек:

1. **Per-symbol + Per-regime** (если есть)
2. **Per-symbol** (если есть)
3. **Per-regime** (если есть)
4. **Глобальный** (fallback)

---

## ✅ ПРЕИМУЩЕСТВА

1. **Оптимизация исполнения:**
   - BTC-USDT: меньший offset → быстрее исполнение
   - XRP-USDT: больший offset → гарантия исполнения

2. **Экономия комиссий:**
   - BTC-USDT: меньший offset → больше шансов на maker fee
   - XRP-USDT: больший offset → гарантия исполнения, но taker fee

3. **Адаптивность:**
   - Учитывает специфику каждой пары
   - Улучшает общую производительность системы

---

**Статус:** ⚠️ ТРЕБУЕТСЯ РЕАЛИЗАЦИЯ

