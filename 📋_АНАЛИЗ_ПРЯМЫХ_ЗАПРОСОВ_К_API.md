# üìã –ê–ù–ê–õ–ò–ó –ü–†–Ø–ú–´–• –ó–ê–ü–†–û–°–û–í –ö API

**–î–∞—Ç–∞:** 25.11.2025  
**–¶–µ–ª—å:** –ù–∞–π—Ç–∏ –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API –∏ –∑–∞–º–µ–Ω–∏—Ç—å –∏—Ö –Ω–∞ —á—Ç–µ–Ω–∏–µ –∏–∑ DataRegistry/PositionRegistry

---

## üîç –ù–ê–ô–î–ï–ù–ù–´–ï –ü–†–Ø–ú–´–ï –ó–ê–ü–†–û–°–´

### ‚úÖ –£–ñ–ï –ò–°–ü–û–õ–¨–ó–£–Æ–¢ DataRegistry (–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å):

1. **SignalCoordinator:**
   - ‚úÖ `get_balance()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DataRegistry —Å fallback
   - ‚ö†Ô∏è `get_positions()` - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π (–º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å)

2. **RiskManager:**
   - ‚úÖ `calculate_position_size()` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç DataRegistry —Å fallback

### ‚ö†Ô∏è –ú–û–ñ–ù–û –ó–ê–ú–ï–ù–ò–¢–¨ –Ω–∞ DataRegistry:

1. **Orchestrator:**
   - `await self.client.get_balance()` –≤ `_initialize_client()` (—Å—Ç—Ä–æ–∫–∞ 736)
     - **–î–µ–π—Å—Ç–≤–∏–µ:** –£–∂–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ DataRegistry –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è
     - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Å—Ç–∞–≤–∏—Ç—å, –Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —á—Ç–µ–Ω–∏–µ –∏–∑ DataRegistry –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
   
   - `await self.client.get_balance()` –≤ `_check_drawdown_protection()` (—Å—Ç—Ä–æ–∫–∞ 2397)
     - **–î–µ–π—Å—Ç–≤–∏–µ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ drawdown
     - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ DataRegistry —Å fallback –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

   - `await self.client.get_balance()` –≤ emergency stop (—Å—Ç—Ä–æ–∫–∏ 2468, 2480, 2598, 2727)
     - **–î–µ–π—Å—Ç–≤–∏–µ:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ emergency stop
     - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û—Å—Ç–∞–≤–∏—Ç—å –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

   - `await self.client.get_balance()` –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö (—Å—Ç—Ä–æ–∫–∞ 1255, 3206)
     - **–î–µ–π—Å—Ç–≤–∏–µ:** –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç
     - **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ DataRegistry —Å fallback

### ‚úÖ –û–°–¢–ê–í–ò–¢–¨ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏–ª–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏):

1. **–ü–æ–∑–∏—Ü–∏–∏ (`get_positions()`):**
   - `_load_existing_positions()` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
   - `_sync_positions_with_exchange()` - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
   - `_check_drawdown_protection()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–π –¥–ª—è drawdown
   - **–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–∑–∏—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞

2. **Emergency Stop:**
   - –ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
   - **–ü—Ä–∏—á–∏–Ω–∞:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –ø—Ä–∏ emergency stop

---

## üìä –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### ‚úÖ –ó–ê–ú–ï–ù–ò–¢–¨:

1. **–ë–∞–ª–∞–Ω—Å –≤ –æ–±—ã—á–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö:**
   - `_check_drawdown_protection()` - —á–∏—Ç–∞—Ç—å –∏–∑ DataRegistry
   - –û—Å—Ç–∞–ª—å–Ω—ã–µ –Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ - —á–∏—Ç–∞—Ç—å –∏–∑ DataRegistry

### ‚ö†Ô∏è –û–°–¢–ê–í–ò–¢–¨:

1. **–ü–æ–∑–∏—Ü–∏–∏:**
   - –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–∑–∏—Ü–∏–π –æ—Å—Ç–∞–≤–∏—Ç—å (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞)

2. **Emergency Stop:**
   - –ü—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

3. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:**
   - –ú–µ—Ç–æ–¥—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã

---

## ‚úÖ –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

1. ‚úÖ –ó–∞–º–µ–Ω–∏—Ç—å `get_balance()` –≤ –Ω–µ–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö –Ω–∞ DataRegistry
2. ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Å—Ç–∞—Ö (emergency stop)
3. ‚úÖ –û—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–∑–∏—Ü–∏–π (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)

