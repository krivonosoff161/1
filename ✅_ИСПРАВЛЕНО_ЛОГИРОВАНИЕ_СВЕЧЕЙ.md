# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û –õ–û–ì–ò–†–û–í–ê–ù–ò–ï –°–í–ï–ß–ï–ô

**–î–∞—Ç–∞:** 26.11.2025 23:25  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**

---

## ‚ö†Ô∏è –ù–ê–ô–î–ï–ù–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/websocket_coordinator.py`  
**–°—Ç—Ä–æ–∫–∞:** ~431

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–æ–≤–æ–π —Å–≤–µ—á–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–∞–Ω–Ω—ã–µ –∏–∑ `last_candle_after`, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ DataRegistry –ü–û–°–õ–ï –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π —Å–≤–µ—á–∏
- –≠—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞—Ä–æ–π —Å–≤–µ—á–∏ –≤–º–µ—Å—Ç–æ –Ω–æ–≤–æ–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- ‚úÖ –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –Ω–∞–ø—Ä—è–º—É—é –∏–∑ `new_candle`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤—ã—à–µ
- ‚úÖ –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ–π —Å–≤–µ—á–∏

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î

**–ë—ã–ª–æ:**
```python
# –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–≤–µ—á—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è OHLCV –¥–∞–Ω–Ω—ã—Ö
last_candle_after = await self.data_registry.get_last_candle(symbol, timeframe)
if last_candle_after:
    self.structured_logger.log_candle_new(
        ...
        open=last_candle_after.open,  # ‚ö†Ô∏è –ú–æ–≥–ª–∏ –±—ã—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä–æ–π —Å–≤–µ—á–∏
        high=last_candle_after.high,
        low=last_candle_after.low,
        close=last_candle_after.close,
    )
```

**–°—Ç–∞–ª–æ:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ new_candle –≤–º–µ—Å—Ç–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ DataRegistry
self.structured_logger.log_candle_new(
    ...
    open=new_candle.open,  # ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–æ–≤–æ–π —Å–≤–µ—á–∏
    high=new_candle.high,
    low=new_candle.low,
    close=new_candle.close,
)
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ò

### **1. –í—Å–µ –º–µ—Ç–æ–¥—ã StructuredLogger** ‚úÖ
- ‚úÖ `log_candle_init` - —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ `log_candle_new` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ `log_candle_usage` - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ `log_candle_stats` - –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### **2. –í—Å–µ –≤—ã–∑–æ–≤—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è** ‚úÖ
- ‚úÖ `orchestrator.py` - `log_candle_init` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ `websocket_coordinator.py` - `log_candle_new` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ
- ‚úÖ `multi_timeframe.py` - `log_candle_usage` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### **3. –ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ None** ‚úÖ
- ‚úÖ –í—Å–µ –≤—ã–∑–æ–≤—ã –æ–±–µ—Ä–Ω—É—Ç—ã –≤ `if self.structured_logger:`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `hasattr()` –≥–¥–µ –Ω—É–∂–Ω–æ
- ‚úÖ –í—Å–µ –æ–±–µ—Ä–Ω—É—Ç–æ –≤ `try/except`

### **4. –õ–∏–Ω—Ç–µ—Ä** ‚úÖ
- ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –°–í–û–î–ö–ê

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–≤–µ—á–∏ –≤ `log_candle_new`
2. ‚úÖ –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ `new_candle` –≤–º–µ—Å—Ç–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑ DataRegistry

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ:**
1. ‚úÖ –í—Å–µ –º–µ—Ç–æ–¥—ã StructuredLogger —Å—É—â–µ—Å—Ç–≤—É—é—Ç
2. ‚úÖ –í—Å–µ –≤—ã–∑–æ–≤—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
3. ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞ None –Ω–∞ –º–µ—Å—Ç–µ
4. ‚úÖ –ù–µ—Ç –æ—à–∏–±–æ–∫ –ª–∏–Ω—Ç–µ—Ä–∞

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ü–†–û–í–ï–†–ï–ù–û**

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–µ—á–µ–π —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!






