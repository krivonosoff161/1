# –§–ò–ù–ê–õ–¨–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø - 23 –Ø–ù–í–ê–†–Ø 2026
## –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

---

## –î–û –ò –ü–û–°–õ–ï: –¢–∞–±–ª–∏—Ü–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

| # | –ü—Ä–æ–±–ª–µ–º–∞ | –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–æ—Ç–∫–∞—á–µ–Ω–æ) | –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–ø—Ä–∏–º–µ–Ω–µ–Ω–æ) |
|---|----------|--------------------------------|-------------------------------|
| 1 | side=unknown, size=0.0 | Fallback –∫ API (—Ç–µ—Ä—è–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã) | –§–ª–∞–≥ exchange_closed + –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ _close_position |
| 2 | margin=0.00 –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ | - | Fallback —Ä–∞—Å—á–µ—Ç: margin = (size * price) / leverage |
| 3 | TP –Ω–∞ —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö | - | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∞–ª—å–Ω–æ–≥–æ PnL –æ—Ç —Ü–µ–Ω—ã –ø–µ—Ä–µ–¥ tp_reached |
| 4 | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ long/short | - | –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ - –ª–æ–≥–∏–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è ‚úÖ |

---

## –ü–†–û–ë–õ–ï–ú–ê #1: Race Condition (side=unknown, size=0.0, entry=0.0)

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ –ª–æ–≥–æ–≤
- **–ù–∞–π–¥–µ–Ω–æ**: 1,263 instances –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π
- **–°–∏–º–ø—Ç–æ–º**: –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –ø—É—Å—Ç—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

```
üõë –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ XRP-USDT: sl_reached (side=unknown, size=0.0, entry=0.0, time=0.00 –º—ñ–Ω)
üîÑ –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ XRP-USDT long —Ä–∞–∑–º–µ—Ä=250 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤, PnL=-1.75 USDT
```

### ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï (–æ—Ç–∫–∞—á–µ–Ω–æ)

**–ö–æ–¥**: [orchestrator.py:4604-4673](orchestrator.py:4604) - fallback –∑–∞–ø—Ä–æ—Å –∫ OKX API

**–ü—Ä–æ–±–ª–µ–º–∞**:
```python
# –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç –≤ active_positions, –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Å –±–∏—Ä–∂–∏
if needs_api_fallback:
    positions_from_api = await self.position_manager.client.get_positions(symbol)
    # –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –±–∞–∑–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    position = {
        "position_side": api_side,
        "size": abs(api_size),
        "entry_price": api_entry_price,
        "entry_time": api_entry_time,
    }
    # ‚ùå –ù–û! –¢–µ—Ä—è–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: regime, signal_strength, adaptive TP/SL
```

**–ü–æ—á–µ–º—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ**:
- –î–∞–Ω–Ω—ã–µ —Å API –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç `regime`, `signal_strength`, adaptive –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –≠—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫—Ä–∏—Ç–∏—á–Ω—ã –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏
- –ù–∞—Ä—É—à–∞–µ—Ç—Å—è –ª–æ–≥–∏–∫–∞ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏—è–º–∏

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï

**–ü–µ—Ä–≤–æ–ø—Ä–∏—á–∏–Ω–∞**: Sync –∫–æ–¥ —É–¥–∞–ª—è–ª –ø–æ–∑–∏—Ü–∏—é –∏–∑ `active_positions` —Ä–∞–Ω—å—à–µ —á–µ–º PositionMonitor —É—Å–ø–µ–≤–∞–ª –µ—ë –∑–∞–∫—Ä—ã—Ç—å.

#### –†–µ—à–µ–Ω–∏–µ 1: –ü–æ–º–µ—Ç–∫–∞ –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è

**–§–∞–π–ª**: [orchestrator.py:2738-2757](orchestrator.py:2738)

```python
# –î–û:
self.active_positions.pop(symbol, None)  # ‚ùå –£–¥–∞–ª—è–µ—Ç —Å—Ä–∞–∑—É

# –ü–û–°–õ–ï:
if symbol in self.active_positions:
    self.active_positions[symbol]["exchange_closed"] = True  # ‚úÖ –¢–æ–ª—å–∫–æ –ø–æ–º–µ—á–∞–µ–º
    logger.debug(f"‚úÖ –ü–æ–∑–∏—Ü–∏—è {symbol} –ø–æ–º–µ—á–µ–Ω–∞ –∫–∞–∫ exchange_closed=True")

# ‚ùå –ù–ï —É–¥–∞–ª—è–µ–º —Å—Ä–∞–∑—É –∏–∑ active_positions - –ø—É—Å—Ç—å _close_position —ç—Ç–æ —Å–¥–µ–ª–∞–µ—Ç
# self.active_positions.pop(symbol, None)
```

#### –†–µ—à–µ–Ω–∏–µ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞ –≤ _close_position

**–§–∞–π–ª**: [orchestrator.py:4604-4632](orchestrator.py:4604)

```python
# –î–û:
position = self.active_positions.get(symbol, {})
if not position:
    return
# ... –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –ø—É—Å—Ç—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

# –ü–û–°–õ–ï:
position = self.active_positions.get(symbol, {})

if not position:
    logger.debug(f"‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è {symbol} —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º")
    return

# ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥ exchange_closed
if position.get("exchange_closed"):
    logger.info(
        f"‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è {symbol} —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ (exchange_closed=True), "
        f"–ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ"
    )
    # –û—á–∏—â–∞–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
    self.active_positions.pop(symbol, None)
    # ... cleanup TSL, MaxSizeLimiter, etc.
    return

# ‚úÖ –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤–∫–ª—é—á–∞—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –°–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤—Å–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- ‚úÖ –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

---

## –ü–†–û–ë–õ–ï–ú–ê #2: margin=0.00 –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ –ª–æ–≥–æ–≤
- **–í—Å–µ** –ø–æ–∑–∏—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ `margin=0.00 USD`
- –ü—Ä–æ–±–ª–µ–º–∞: OKX API –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `"margin"` —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï

**–§–∞–π–ª**: [entry_manager.py:370-395, 446-475](entry_manager.py:370)

```python
# –î–û:
margin_from_api = float(pos.get("margin", "0")) if pos.get("margin") else 0.0
position_data = {
    "margin_used": margin_from_api,  # ‚ùå –í—Å–µ–≥–¥–∞ 0
}

# –ü–û–°–õ–ï:
margin_from_api = float(pos.get("margin", "0")) if pos.get("margin") else 0.0

# ‚úÖ –ï—Å–ª–∏ margin=0, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Ä—É—á–Ω—É—é: margin = (size * price) / leverage
if margin_from_api == 0.0 and entry_price > 0:
    leverage_from_api = float(pos.get("lever", "1") or "1")
    if leverage_from_api > 0:
        calculated_margin = (pos_size * entry_price) / leverage_from_api
        logger.debug(
            f"üìä –†–∞—Å—Å—á–∏—Ç–∞–Ω–∞ –º–∞—Ä–∂–∞ –¥–ª—è {symbol}: "
            f"size={pos_size:.6f} * price={entry_price:.2f} / leverage={leverage_from_api:.0f}x = "
            f"${calculated_margin:.2f}"
        )
        margin_from_api = calculated_margin

position_data = {
    "margin_used": margin_from_api,  # ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –º–∞—Ä–∂–∞
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ –õ–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é –º–∞—Ä–∂—É
- ‚úÖ –ù–µ –∑–∞–≤–∏—Å–∏–º –æ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API

---

## –ü–†–û–ë–õ–ï–ú–ê #3: TP —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑ –ª–æ–≥–æ–≤ (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê)

**SOL-USDT**: –ó–∞–∫—Ä—ã–ª–∞—Å—å –∑–∞ **5.4 —Å–µ–∫—É–Ω–¥—ã** –ø–æ `tp_reached`, –Ω–æ —Å **–£–ë–´–¢–ö–û–ú -1.15 USDT**!

```
Entry: 128.4459
Exit: 128.4100  (—Ü–µ–Ω–∞ —Å–Ω–∏–∑–∏–ª–∞—Å—å!)
Gross PnL: -0.25 USDT
Commission: 0.90 USDT
Net PnL: -1.15 USDT  ‚ùå –£–ë–´–¢–û–ö
Duration: 5.4 seconds
Reason: tp_reached  ‚ùå –≠–¢–û –û–®–ò–ë–ö–ê!
```

**–õ–æ–≥ ExitAnalyzer**:
```
ExitAnalyzer CHOPPY: TP –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –¥–ª—è SOL-USDT: 3.07% >= 2.26%
ExitAnalyzer: –†–µ—à–µ–Ω–∏–µ –¥–ª—è SOL-USDT | PnL=3.07% | TP=2.26%
```

**–î–∏–∞–≥–Ω–æ–∑**: ExitAnalyzer –ø–æ–ª—É—á–∏–ª `current_pnl=3.1%` –∏–∑ **–ø—Ä–µ–¥—ã–¥—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏** –∏–ª–∏ **–æ–±—â–µ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Å–µ—Å—Å–∏–∏**, –∞ –Ω–µ –∏–∑ —Ç–µ–∫—É—â–µ–π –ø–æ–∑–∏—Ü–∏–∏!

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –†–ï–®–ï–ù–ò–ï

**–§–∞–π–ª**: [exit_analyzer.py:2970, 4451, 5666](exit_analyzer.py:2970) - 3 –º–µ—Å—Ç–∞ (trending, ranging, choppy)

```python
# –î–û:
if pnl_percent >= tp_percent:
    # –°—Ä–∞–∑—É –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ TP
    return {"action": "close", "reason": "tp_reached"}

# –ü–û–°–õ–ï:
if pnl_percent >= tp_percent:
    # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (23.01.2026): –ó–∞—â–∏—Ç–∞ –æ—Ç TP –Ω–∞ —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –†–ï–ê–õ–¨–ù–´–ô PnL –æ—Ç entry_price –∫ current_price
    real_price_pnl_pct = (
        ((current_price - entry_price) / entry_price * 100)
        if position_side == "long"
        else ((entry_price - current_price) / entry_price * 100)
    )

    if real_price_pnl_pct < 0:
        logger.warning(
            f"‚ö†Ô∏è TP –ó–ê–©–ò–¢–ê: {symbol} TP —Ö–æ—á–µ—Ç —Å—Ä–∞–±–æ—Ç–∞—Ç—å (pnl_percent={pnl_percent:.2f}%), "
            f"–Ω–æ –†–ï–ê–õ–¨–ù–´–ô PnL –æ—Ç —Ü–µ–Ω—ã = {real_price_pnl_pct:.2f}% (–£–ë–´–¢–û–ö)! "
            f"entry={entry_price:.6f}, current={current_price:.6f}, side={position_side}. "
            f"–ë–õ–û–ö–ò–†–£–ï–ú –∑–∞–∫—Ä—ã—Ç–∏–µ - –≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ current_pnl –∏–∑ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤."
        )
        return {"action": "hold", "reason": "tp_rejected_negative_real_pnl"}

    # ‚úÖ –¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ TP
    return {"action": "close", "reason": "tp_reached"}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–æ –≤ 3 –º–µ—Å—Ç–∞—Ö**:
1. **Trending** —Ä–µ–∂–∏–º: [exit_analyzer.py:2970](exit_analyzer.py:2970)
2. **Ranging** —Ä–µ–∂–∏–º: [exit_analyzer.py:4451](exit_analyzer.py:4451)
3. **Choppy** —Ä–µ–∂–∏–º: [exit_analyzer.py:5666](exit_analyzer.py:5666)

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:
- ‚úÖ TP –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É–±—ã—Ç–æ—á–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ `current_pnl` –∏–∑ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## –ü–†–û–ë–õ–ï–ú–ê #4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è long/short

### ‚úÖ –ü–†–û–í–ï–†–ï–ù–û - –ü–†–û–ë–õ–ï–ú –ù–ï–¢

–ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤—Å–µ –∫–ª—é—á–µ–≤—ã–µ –º–µ—Å—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è direction:

1. **orchestrator.py:2224-2236**:
   ```python
   pos_side_raw = pos.get("posSide", "").lower()
   if pos_side_raw in ["long", "short"]:
       position_side = pos_side_raw  # ‚úÖ –ò–∑ API
   else:
       # Fallback: –æ–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ –∑–Ω–∞–∫—É pos
       position_side = "long" if pos_size > 0 else "short"  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
   ```

2. **signal_coordinator.py:328**:
   ```python
   signal_position_side = "long" if signal_side == "buy" else "short"  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
   ```

3. **entry_manager.py:524, 529, 551, 556**:
   ```python
   "posSide": "long" if side == "buy" else "short"  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
   "position_side": "long" if side == "buy" else "short"  # ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
   ```

**–í—ã–≤–æ–¥**: –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–æ –≤—Å–µ—Ö –º–µ—Å—Ç–∞—Ö. –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

---

## –°–í–û–î–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∏ | –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ |
|------|--------|----------------|
| [orchestrator.py](orchestrator.py) | 2738-2757 | –ü–æ–º–µ—Ç–∫–∞ exchange_closed –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è |
| [orchestrator.py](orchestrator.py) | 4604-4632 | –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞ exchange_closed |
| [entry_manager.py](entry_manager.py) | 370-395 | Fallback —Ä–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏ (–æ—Å–Ω–æ–≤–Ω–æ–π –ø—É—Ç—å) |
| [entry_manager.py](entry_manager.py) | 446-475 | Fallback —Ä–∞—Å—á–µ—Ç –º–∞—Ä–∂–∏ (retry –ø—É—Ç—å) |
| [exit_analyzer.py](exit_analyzer.py) | 2970+ | –ó–∞—â–∏—Ç–∞ TP trending —Ä–µ–∂–∏–º |
| [exit_analyzer.py](exit_analyzer.py) | 4451+ | –ó–∞—â–∏—Ç–∞ TP ranging —Ä–µ–∂–∏–º |
| [exit_analyzer.py](exit_analyzer.py) | 5666+ | –ó–∞—â–∏—Ç–∞ TP choppy —Ä–µ–∂–∏–º |

### –§–∞–π–ª—ã –æ—Ç–∫–∞—á–µ–Ω—ã (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è):

| –§–∞–π–ª | –ß—Ç–æ –æ—Ç–∫–∞—á–µ–Ω–æ | –ü–æ—á–µ–º—É –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |
|------|--------------|-------------------|
| [orchestrator.py](orchestrator.py) | Fallback –∫ API –≤ _close_position | –¢–µ—Ä—è–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã |

---

## –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü—Ä–æ–±–ª–µ–º–∞ #1 (Race Condition)
- **–ë—ã–ª–æ**: 1,263 instances —Å `side=unknown, size=0.0, entry=0.0`
- **–ë—É–¥–µ—Ç**: 0 instances - –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

### –ü—Ä–æ–±–ª–µ–º–∞ #2 (Margin)
- **–ë—ã–ª–æ**: `margin=0.00 USD` –≤–æ –≤—Å–µ—Ö –ª–æ–≥–∞—Ö –æ—Ç–∫—Ä—ã—Ç–∏—è
- **–ë—É–¥–µ—Ç**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –º–∞—Ä–∂–∞ –≤ –ª–æ–≥–∞—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `margin=68.95 USD`)

### –ü—Ä–æ–±–ª–µ–º–∞ #3 (TP –Ω–∞ —É–±—ã—Ç–∫–∞—Ö)
- **–ë—ã–ª–æ**: 1 —Å–¥–µ–ª–∫–∞ –∏–∑ 9 –∑–∞–∫—Ä—ã–ª–∞—Å—å –ø–æ `tp_reached` —Å —É–±—ã—Ç–∫–æ–º -1.15 USDT
- **–ë—É–¥–µ—Ç**: 0 —Å–¥–µ–ª–æ–∫ - TP –ù–ò–ö–û–ì–î–ê –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É–±—ã—Ç–æ—á–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞ #4 (–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ)
- **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ**: –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º, –ª–æ–≥–∏–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è ‚úÖ

---

## –ü–†–ò–ù–¶–ò–ü–´ –ü–†–ê–í–ò–õ–¨–ù–´–• –†–ï–®–ï–ù–ò–ô

### 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚ùå –ù–ï –∑–∞–ø—Ä–∞—à–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å API –µ—Å–ª–∏ –æ–Ω–∏ —Ç–µ—Ä—è—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–ª–∞–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤–º–µ—Å—Ç–æ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### 2. Fallback —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- ‚ùå –ù–ï –∑–∞–º–µ–Ω—è—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ API fallback
- ‚úÖ –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è (margin)

### 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- ‚ùå –ù–ï –¥–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ `pnl_percent` –∏–∑ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π PnL –æ—Ç —Ü–µ–Ω—ã –ø–µ—Ä–µ–¥ TP

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏, –∞ –Ω–µ –∑–∞–º–µ–Ω–∞
- ‚ùå –ù–ï –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å —Ä–∞–±–æ—á—É—é –ª–æ–≥–∏–∫—É
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∫–æ–¥–∞

---

## –î–ê–¢–ê –ò –ö–û–ù–¢–ï–ö–°–¢

- **–î–∞—Ç–∞**: 23 —è–Ω–≤–∞—Ä—è 2026
- **–ê–≤—Ç–æ—Ä**: Claude Sonnet 4.5
- **–õ–æ–≥–∏**: staging_2026-01-23_21-27-28
- **–ë–∞–ª–∞–Ω—Å**: $913 USD
- **–ü—Ä–æ—Ñ–∏–ª—å**: small (progressive: true)
- **Leverage**: 5x-10x
- **–°–µ—Å—Å–∏—è**: 9 —Å–¥–µ–ª–æ–∫ (4 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö, 5 —É–±—ã—Ç–æ—á–Ω—ã—Ö, win rate 44.4%)

---

**–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üöÄ
