# –ê–ù–ê–õ–ò–ó –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø –°–ò–ì–ù–ê–õ–û–í –ò PNL

**–î–∞—Ç–∞:** 23 –Ω–æ—è–±—Ä—è 2025  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –∏ —Ä–∞—Å—á–µ—Ç PnL

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –û–®–ò–ë–ö–ò –û–†–î–ï–†–ê

### –ü—Ä–æ–±–ª–µ–º–∞:
- –û—à–∏–±–∫–∞ `'NoneType' object has no attribute 'get'` –ø—Ä–∏ —Ä–∞–∑–º–µ—â–µ–Ω–∏–∏ –æ—Ä–¥–µ—Ä–∞
- `order_id` –Ω–µ –±—ã–ª –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
- ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è `order_id = None` –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –∫–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ `order_id` –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º - –µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –æ—à–∏–±–∫—É

---

## üìä –ê–ù–ê–õ–ò–ó PNL

### –î–∞–Ω–Ω—ã–µ —Å –±–∏—Ä–∂–∏:
- **–°–∏–º–≤–æ–ª:** ETH-USDT
- **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** SHORT (5x)
- **–†–∞–∑–º–µ—Ä:** 0.064 ETH
- **–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞:** 2816.28 USDT
- **–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞:** 2843.81 USDT
- **–ü–ª–∞–≤–∞—é—â–∏–π PnL:** -1.76 USDT (-4.87%)

### –†–∞—Å—á–µ—Ç PnL –¥–ª—è SHORT –ø–æ–∑–∏—Ü–∏–∏:

**–§–æ—Ä–º—É–ª–∞ –¥–ª—è SHORT:**
```
PnL% –æ—Ç —Ü–µ–Ω—ã = (entry_price - current_price) / entry_price * 100
PnL% –æ—Ç –º–∞—Ä–∂–∏ = PnL% –æ—Ç —Ü–µ–Ω—ã * leverage
PnL –≤ USD = (entry_price - current_price) * size
```

**–†–∞—Å—á–µ—Ç:**
```
PnL% –æ—Ç —Ü–µ–Ω—ã = (2816.28 - 2843.81) / 2816.28 * 100 = -0.98%
PnL% –æ—Ç –º–∞—Ä–∂–∏ = -0.98% * 5 = -4.9% ‚âà -4.87% ‚úÖ
PnL –≤ USD = (2816.28 - 2843.81) * 0.064 = -1.76 USDT ‚úÖ
```

**–í—ã–≤–æ–¥:** ‚úÖ PnL —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –ü–æ–∑–∏—Ü–∏—è SHORT –æ—Ç–∫—Ä—ã—Ç–∞ –ø–æ 2816.28, —Ü–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞ –¥–æ 2843.81 ‚Üí –ø–æ–∑–∏—Ü–∏—è –≤ –º–∏–Ω—É—Å–µ. –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è SHORT –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ —Ä–æ—Å—Ç–µ —Ü–µ–Ω—ã.

---

## üîç –ê–ù–ê–õ–ò–ó –ù–ê–ü–†–ê–í–õ–ï–ù–ò–Ø –°–ò–ì–ù–ê–õ–û–í

### –î–∞–Ω–Ω—ã–µ –∏–∑ –ª–æ–≥–æ–≤:
- **–°–∏–≥–Ω–∞–ª:** ETH-USDT SHORT @ $2813.49 (—Å–∏–ª–∞=0.56)
- **–¶–µ–Ω–∞ –≤—Ö–æ–¥–∞:** 2816.28 USDT
- **–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞:** 2843.81 USDT

### –õ–æ–≥–∏–∫–∞ SHORT —Å–∏–≥–Ω–∞–ª–∞ (–∏–∑ –∫–æ–¥–∞):

**–£—Å–ª–æ–≤–∏—è –¥–ª—è SHORT —Å–∏–≥–Ω–∞–ª–∞:**
1. `ma_fast < ma_slow` (–±—ã—Å—Ç—Ä–∞—è MA –Ω–∏–∂–µ –º–µ–¥–ª–µ–Ω–Ω–æ–π) ‚úÖ
2. `current_price < ma_fast` (—Ü–µ–Ω–∞ –Ω–∏–∂–µ –±—ã—Å—Ç—Ä–æ–π MA) ‚úÖ
3. `ma_difference_pct >= min_ma_difference_pct` (—Ä–∞–∑–Ω–∏—Ü–∞ EMA –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞) ‚úÖ
4. `price_direction != "up"` (—Ü–µ–Ω–∞ –Ω–µ —Ä–∞—Å—Ç–µ—Ç) ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã:**
- –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–≤–µ—á–µ–π –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –ï—Å–ª–∏ `price_change > price_change_threshold` ‚Üí `price_direction = "up"`
- –ï—Å–ª–∏ `price_change < -price_change_threshold` ‚Üí `price_direction = "down"`
- –ò–Ω–∞—á–µ ‚Üí `price_direction = "neutral"`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°–∏–≥–Ω–∞–ª –±—ã–ª SHORT –ø—Ä–∏ —Ü–µ–Ω–µ 2813.49
- –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã–ª–∞—Å—å –ø–æ 2816.28 (—Ü–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞ –Ω–∞ +0.1%)
- –¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞ 2843.81 (—Ü–µ–Ω–∞ –≤—ã—Ä–æ—Å–ª–∞ –µ—â–µ –Ω–∞ +1.0%)

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. ‚úÖ –°–∏–≥–Ω–∞–ª –±—ã–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º (EMA –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –ø–∞–¥–µ–Ω–∏–µ), –Ω–æ —Ü–µ–Ω–∞ —Ä–∞–∑–≤–µ—Ä–Ω—É–ª–∞—Å—å –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è
2. ‚ö†Ô∏è –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∏–≥–Ω–∞–ª–∞ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏ (—Ü–µ–Ω–∞ —É—Å–ø–µ–ª–∞ –≤—ã—Ä–∞—Å—Ç–∏)
3. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ `price_direction` –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ (—Ü–µ–Ω–∞ —É–∂–µ —Ä–æ—Å–ª–∞, –Ω–æ EMA –µ—â–µ –ø–æ–∫–∞–∑—ã–≤–∞–ª–∞ –ø–∞–¥–µ–Ω–∏–µ)

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `price_direction`?
- –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ª–∏ —Ç–µ–∫—É—â–µ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ü–µ–Ω—ã –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–∞?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ `price_direction != "up"` –¥–ª—è SHORT?

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- –°—Ä–∞–≤–Ω–∏—Ç—å —Å–∏–≥–Ω–∞–ª—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º –¥–≤–∏–∂–µ–Ω–∏–µ–º —Ü–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–æ –≤—Å–µ—Ö —Ä–µ–∂–∏–º–∞—Ö –∏ –ø–∞—Ä–∞—Ö

---

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç PnL ‚úÖ

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è PnL –¥–ª—è SHORT –ø–æ–∑–∏—Ü–∏–π?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ª–µ–≤–µ—Ä–∏–¥–∂?
- –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è PnL –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –æ—Ç –º–∞—Ä–∂–∏?

**–§–æ—Ä–º—É–ª–∞ –¥–ª—è SHORT:**
```
PnL% –æ—Ç —Ü–µ–Ω—ã = (entry_price - current_price) / entry_price * 100
PnL% –æ—Ç –º–∞—Ä–∂–∏ = PnL% –æ—Ç —Ü–µ–Ω—ã * leverage
PnL –≤ USD = (entry_price - current_price) * size
```

**–í—ã–≤–æ–¥:** ‚úÖ –†–∞—Å—á–µ—Ç PnL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π. –ü–æ–∑–∏—Ü–∏—è –≤ –º–∏–Ω—É—Å–µ –∏–∑-–∑–∞ —Ä–æ—Å—Ç–∞ —Ü–µ–Ω—ã –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è SHORT –ø–æ–∑–∏—Ü–∏–∏.

---

### 3. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ ‚úÖ

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Ç–µ–∫—É—â–µ–≥–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ü–µ–Ω—ã –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∏–≥–Ω–∞–ª–∞
- –£—á–∏—Ç—ã–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ EMA, –Ω–æ –∏ —Ç–µ–∫—É—â–µ–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã
- –î–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∏–≥–Ω–∞–ª–∞ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## ‚úÖ –í–´–í–û–î–´

### PnL:
- ‚úÖ –†–∞—Å—á–µ—Ç PnL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- ‚úÖ –ü–æ–∑–∏—Ü–∏—è –≤ –º–∏–Ω—É—Å–µ –∏–∑-–∑–∞ —Ä–æ—Å—Ç–∞ —Ü–µ–Ω—ã –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è SHORT –ø–æ–∑–∏—Ü–∏–∏
- ‚úÖ –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è SHORT –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ —Ä–æ—Å—Ç–µ —Ü–µ–Ω—ã

### –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–æ–≤:
- ‚úÖ –õ–æ–≥–∏–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è
- ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω–∞ –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∏–≥–Ω–∞–ª–∞ –∏ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –ø–æ–∑–∏—Ü–∏–∏
- ‚ö†Ô∏è –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è `price_direction`

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞, PnL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π, —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤

