# üéØ –ü–õ–ê–ù –ê–î–ê–ü–¢–ò–í–ù–û–ì–û ATR –° –ü–†–û–ì–ù–û–ó–û–ú –í–û–õ–ê–¢–ò–õ–¨–ù–û–°–¢–ò

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 29.12.2025  
**–°—Ç–∞—Ç—É—Å:** –ò–¥–µ—è –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π (–ø–æ—Å–ª–µ —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ —Ç–µ–∫—É—â–µ–π —Å–∏—Å—Ç–µ–º—ã)

---

## üìã –û–ë–©–ï–ï –û–ü–ò–°–ê–ù–ò–ï

### –¢–µ–∫—É—â–∞—è —Å–∏—Å—Ç–µ–º–∞
- **ATR:** –ü–æ–ª—É—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ `ATRProvider` (—Å fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–π —Ä–∞—Å—á—ë—Ç)
- **–ú–Ω–æ–∂–∏—Ç–µ–ª–∏:** –°—Ç–∞—Ç–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥–µ –ø–æ —Ä–µ–∂–∏–º–∞–º:
  - `trending`: `sl_atr_multiplier: 0.6`, `tp_atr_multiplier: 1.2`
  - `ranging`: `sl_atr_multiplier: 2.0`, `tp_atr_multiplier: 2.5`
  - `choppy`: (–Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥–µ)
- **Per-symbol:** –ï—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ETH-USDT: sl_atr_multiplier: 3.0`)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –∫ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —Ä—ã–Ω–∫–∞

### –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ Grok
–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π ATR multiplier, –∫–æ—Ç–æ—Ä—ã–π —É—á–∏—Ç—ã–≤–∞–µ—Ç:
1. **–†–µ–∂–∏–º —Ä—ã–Ω–∫–∞** (trending/ranging/choppy) ‚Äî –±–∞–∑–æ–≤—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏
2. **–°–∏–ª—É —Ç—Ä–µ–Ω–¥–∞** (ADX > 30) ‚Äî –±–æ–Ω—É—Å –∫ multiplier
3. **–†–æ—Å—Ç –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏** (ADX —Ä–∞—Å—Ç—ë—Ç >10%) ‚Äî –ø—Ä–æ–≥–Ω–æ–∑ –±—É–¥—É—â–µ–≥–æ
4. **Volume spike** (volume > avg*1.5) ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ breakout
5. **–ù–∏–∑–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å** (volatility < 1%) ‚Äî —à—Ç—Ä–∞—Ñ –∫ multiplier

---

## ‚úÖ –ü–õ–Æ–°–´ –ü–†–ï–î–õ–û–ñ–ï–ù–ò–Ø

### 1. –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ú–Ω–æ–∂–∏—Ç–µ–ª—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ —Ç–µ–∫—É—â—É—é —Å–∏—Ç—É–∞—Ü–∏—é
- –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—Ä—É—á–Ω—É—é –º–µ–Ω—è—Ç—å –∫–æ–Ω—Ñ–∏–≥ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä—ã–Ω–∫–∞

### 2. –ü—Ä–æ–≥–Ω–æ–∑ –±—É–¥—É—â–µ–≥–æ
- –£—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–æ—Å—Ç ADX/volume –¥–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–≤–µ–ª–∏—á–µ–Ω–∏—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞–µ—Ç –æ –≤–æ–∑–º–æ–∂–Ω–æ–º breakout –∑–∞—Ä–∞–Ω–µ–µ

### 3. –ú–µ–Ω—å—à–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö SL
- –ü—Ä–∏ —Ä–æ—Å—Ç–µ —Ç—Ä–µ–Ω–¥–∞ –º–Ω–æ–∂–∏—Ç–µ–ª—å —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è ‚Üí –ø–æ–∑–∏—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞
- –û—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –≤ –Ω–∞—á–∞–ª–µ breakout, –∫–æ–≥–¥–∞ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –µ—â—ë –Ω–µ –≤—ã—Ä–æ—Å–ª–∞

### 4. –ë–æ–ª—å—à–µ –ø—Ä–æ—Ñ–∏—Ç–∞ –≤ ranging
- –ü—Ä–∏ –Ω–∏–∑–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ –º–Ω–æ–∂–∏—Ç–µ–ª—å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è ‚Üí tighter TP
- –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–µ —Ü–µ–ª–∏ –≤ —Å–ø–æ–∫–æ–π–Ω–æ–º —Ä—ã–Ω–∫–µ

### 5. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø—Ä–∞–∫—Ç–∏–∫–∞–º –ø—Ä–æ–ø-—Ç—Ä–µ–π–¥–∏–Ω–≥–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å–∫–∞–ª—å–ø–∏–Ω–≥-—Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö

---

## ‚ö†Ô∏è –ú–ò–ù–£–°–´ –ò –†–ò–°–ö–ò

### 1. –°–ª–æ–∂–Ω–æ—Å—Ç—å
- –ë–æ–ª—å—à–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –ë–æ–ª—å—à–µ –ª–æ–≥–∏–∫–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ù—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å, –ø–æ—á–µ–º—É multiplier –∏–∑–º–µ–Ω–∏–ª—Å—è

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –¢—Ä–µ–±—É–µ—Ç—Å—è `adx_prev` (–ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ADX)
- –¢—Ä–µ–±—É–µ—Ç—Å—è `volume_ratio` (—Ç–µ–∫—É—â–∏–π –æ–±—ä—ë–º / —Å—Ä–µ–¥–Ω–∏–π –æ–±—ä—ë–º)
- –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### 3. –†–∏—Å–∫ –ø–µ—Ä–µ–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ú–Ω–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ ‚Üí —Ä–∏—Å–∫ –ø–æ–¥–≥–æ–Ω–∫–∏ –ø–æ–¥ –∏—Å—Ç–æ—Ä–∏—é
- –ù—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —Ä—ã–Ω–∫–∞—Ö

### 4. –û—Ç–ª–∞–¥–∫–∞
- –°–ª–æ–∂–Ω–µ–µ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É multiplier –∏–∑–º–µ–Ω–∏–ª—Å—è
- –ù—É–∂–Ω—ã –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

---

## üîß –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø

### –≠—Ç–∞–ø 1: –ü—Ä–æ—Å—Ç—ã–µ –±–æ–Ω—É—Å—ã (–±—ã—Å—Ç—Ä—ã–π, –Ω–∏–∑–∫–∏–π —Ä–∏—Å–∫)

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
1. **Strong trend bonus:** –ï—Å–ª–∏ `ADX > 30` ‚Üí `+0.5` –∫ multiplier
2. **Low volatility penalty:** –ï—Å–ª–∏ `volatility < 1%` ‚Üí `-0.3` –∫ multiplier

**–ì–¥–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:**
- –§–∞–π–ª: `src/strategies/scalping/futures/positions/exit_analyzer.py`
- –ú–µ—Ç–æ–¥: `_get_sl_percent()` –∏–ª–∏ –Ω–æ–≤—ã–π –º–µ—Ç–æ–¥ `_get_adaptive_atr_multiplier()`

**–ö–æ–Ω—Ñ–∏–≥:**
```yaml
atr:
  multipliers:
    trending:
      base: 0.6
      strong_trend_bonus: 0.5  # –ï—Å–ª–∏ ADX > 30
    ranging:
      base: 2.0
      low_vol_penalty: -0.3   # –ï—Å–ª–∏ volatility < 1%
    choppy:
      base: 3.5
      high_vol_bonus: 0.5     # –ï—Å–ª–∏ volatility > 3%
```

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 1-2 —á–∞—Å–∞  
**–†–∏—Å–∫:** –ù–∏–∑–∫–∏–π (–ø—Ä–æ—Å—Ç–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—Å–ª–æ–≤–∏–π)

---

### –≠—Ç–∞–ø 2: Volume spike factor (—Å—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫)

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- –ï—Å–ª–∏ `volume > avg*1.5` ‚Üí `+40%` –∫ multiplier

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ù—É–∂–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å `volume_ratio` (–º–æ–∂–Ω–æ –≤–∑—è—Ç—å –∏–∑ `regime_manager`)
- –ù—É–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å —Å—Ä–µ–¥–Ω–∏–π –æ–±—ä—ë–º (–∏–∑ `regime_manager` –∏–ª–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ)

**–ö–æ–Ω—Ñ–∏–≥:**
```yaml
atr:
  forecast_adjust:
    enabled: true
    volume_spike_factor: 0.4  # –ï—Å–ª–∏ volume > avg*1.5 ‚Äî +40%
```

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 2-3 —á–∞—Å–∞  
**–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π (–Ω—É–∂–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)

---

### –≠—Ç–∞–ø 3: ADX growth factor (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π, –≤—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫)

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å:**
- –ï—Å–ª–∏ `ADX —Ä–∞—Å—Ç—ë—Ç >10%` ‚Üí `+30%` –∫ multiplier

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ù—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å `adx_prev` (–ø—Ä–µ–¥—ã–¥—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ADX)
- –ù—É–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–π ADX —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º
- –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å: `DataRegistry` –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫—ç—à

**–ö–æ–Ω—Ñ–∏–≥:**
```yaml
atr:
  forecast_adjust:
    enabled: true
    adx_growth_factor: 0.3    # –ï—Å–ª–∏ ADX —Ä–∞—Å—Ç—ë—Ç >10% ‚Äî +30%
```

**–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 3-4 —á–∞—Å–∞  
**–†–∏—Å–∫:** –í—ã—Å–æ–∫–∏–π (–Ω—É–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é, —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞)

---

## üìù –ü–†–ò–ú–ï–† –†–ï–ê–õ–ò–ó–ê–¶–ò–ò (–≠—Ç–∞–ø 1)

### –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ `exit_analyzer.py`:

```python
def _get_adaptive_atr_multiplier(
    self, 
    symbol: str, 
    regime: str, 
    adx: float, 
    volatility: float,
    base_multiplier: float
) -> float:
    """
    –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π ATR multiplier –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏ —Ä—ã–Ω–∫–∞.
    
    Args:
        symbol: –¢–æ—Ä–≥–æ–≤–∞—è –ø–∞—Ä–∞
        regime: –†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (trending/ranging/choppy)
        adx: –¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ ADX
        volatility: –¢–µ–∫—É—â–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å (%)
        base_multiplier: –ë–∞–∑–æ–≤—ã–π multiplier –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
        
    Returns:
        –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π multiplier —Å —É—á—ë—Ç–æ–º –±–æ–Ω—É—Å–æ–≤/—à—Ç—Ä–∞—Ñ–æ–≤
    """
    multiplier = base_multiplier
    
    # –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
    try:
        atr_params = self.parameter_provider.get_atr_params(regime)
        multipliers_config = atr_params.get('multipliers', {}).get(regime, {})
    except Exception:
        multipliers_config = {}
    
    # Strong trend bonus (trending —Ä–µ–∂–∏–º)
    if regime == "trending" and adx > 30:
        bonus = multipliers_config.get('strong_trend_bonus', 0.5)
        multiplier += bonus
        logger.debug(
            f"‚úÖ [AdaptiveATR] {symbol}: Strong trend bonus +{bonus:.2f} "
            f"(ADX={adx:.1f} > 30), multiplier: {base_multiplier:.2f} ‚Üí {multiplier:.2f}"
        )
    
    # Low volatility penalty (ranging —Ä–µ–∂–∏–º)
    if regime == "ranging" and volatility < 1.0:
        penalty = multipliers_config.get('low_vol_penalty', -0.3)
        multiplier += penalty
        logger.debug(
            f"‚úÖ [AdaptiveATR] {symbol}: Low volatility penalty {penalty:.2f} "
            f"(volatility={volatility:.2f}% < 1%), multiplier: {base_multiplier:.2f} ‚Üí {multiplier:.2f}"
        )
    
    # High volatility bonus (choppy —Ä–µ–∂–∏–º)
    if regime == "choppy" and volatility > 3.0:
        bonus = multipliers_config.get('high_vol_bonus', 0.5)
        multiplier += bonus
        logger.debug(
            f"‚úÖ [AdaptiveATR] {symbol}: High volatility bonus +{bonus:.2f} "
            f"(volatility={volatility:.2f}% > 3%), multiplier: {base_multiplier:.2f} ‚Üí {multiplier:.2f}"
        )
    
    # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω (–Ω–µ –Ω–∏–∂–µ 1.0, –Ω–µ –≤—ã—à–µ 5.0)
    multiplier = max(1.0, min(multiplier, 5.0))
    
    return multiplier
```

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ `_get_sl_percent()`:

```python
# –ü–æ–ª—É—á–∞–µ–º –±–∞–∑–æ–≤—ã–π multiplier –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
sl_atr_multiplier = exit_params.get('sl_atr_multiplier', 2.0)

# –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏
adx = indicators.get('adx', 0)
volatility = indicators.get('volatility_percent', 0)

# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π multiplier
adaptive_multiplier = self._get_adaptive_atr_multiplier(
    symbol=symbol,
    regime=regime,
    adx=adx,
    volatility=volatility,
    base_multiplier=sl_atr_multiplier
)

# –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π multiplier –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ SL
atr_sl_percent = (atr_1m / current_price) * 100 * adaptive_multiplier
```

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –í–ù–ï–î–†–ï–ù–ò–Æ

### –ü–æ—ç—Ç–∞–ø–Ω—ã–π –ø–æ–¥—Ö–æ–¥

1. **–≠—Ç–∞–ø 1 (—Å–µ–π—á–∞—Å):** –ü—Ä–æ—Å—Ç—ã–µ –±–æ–Ω—É—Å—ã (strong trend, low vol penalty)
   - –ë—ã—Å—Ç—Ä–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å
   - –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫
   - –î–∞—Å—Ç —á–∞—Å—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤

2. **–≠—Ç–∞–ø 2 (–ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≠—Ç–∞–ø–∞ 1):** Volume spike factor
   - –°—Ä–µ–¥–Ω–∏–π —Ä–∏—Å–∫
   - –¢—Ä–µ–±—É–µ—Ç —Ä–∞—Å—á—ë—Ç volume_ratio

3. **–≠—Ç–∞–ø 3 (–ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≠—Ç–∞–ø–∞ 2):** ADX growth factor
   - –í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫
   - –¢—Ä–µ–±—É–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ ADX

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –Ω–∞ sandbox
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: multiplier –¥–æ–ª–∂–µ–Ω –º–µ–Ω—è—Ç—å—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã: –º–µ–Ω—å—à–µ –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö SL, –±–æ–ª—å—à–µ –ø—Ä–æ—Ñ–∏—Ç–∞
4. –°—Ä–∞–≤–Ω–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏: winrate, —Å—Ä–µ–¥–Ω–∏–π PnL, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ SL

### –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- **Winrate:** –î–æ–ª–∂–µ–Ω –≤—ã—Ä–∞—Å—Ç–∏ –Ω–∞ 5-15% –≤ trending —Ñ–∞–∑—ã
- **–ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ SL:** –î–æ–ª–∂–Ω—ã —É–º–µ–Ω—å—à–∏—Ç—å—Å—è –Ω–∞ 20-30%
- **–°—Ä–µ–¥–Ω–∏–π PnL:** –î–æ–ª–∂–µ–Ω –≤—ã—Ä–∞—Å—Ç–∏ –Ω–∞ 10-20% –≤ ranging —Ä–µ–∂–∏–º–µ

---

## ‚ùì –í–û–ü–†–û–°–´ –î–õ–Ø –£–¢–û–ß–ù–ï–ù–ò–Ø

### 1. –û—Ç–∫—É–¥–∞ –±—Ä–∞—Ç—å `adx_prev`?
- **–í–∞—Ä–∏–∞–Ω—Ç A:** –•—Ä–∞–Ω–∏—Ç—å –≤ `DataRegistry` (–∫–∞–∫ —Ç–µ–∫—É—â–∏–π ADX)
- **–í–∞—Ä–∏–∞–Ω—Ç B:** –û—Ç–¥–µ–ª—å–Ω—ã–π –∫—ç—à –≤ `exit_analyzer`
- **–í–∞—Ä–∏–∞–Ω—Ç C:** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ —Å–≤–µ—á–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç A (DataRegistry) ‚Äî —É–∂–µ –µ—Å—Ç—å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 2. –ö–∞–∫ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å `volume_ratio`?
- **–í–∞—Ä–∏–∞–Ω—Ç A:** –ò–∑ `regime_manager` (—É–∂–µ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è)
- **–í–∞—Ä–∏–∞–Ω—Ç B:** –†–∞—Å—Å—á–∏—Ç—ã–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ –≤ `exit_analyzer`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç A (regime_manager) ‚Äî –Ω–µ –¥—É–±–ª–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É

### 3. –ö–∞–∫ —á–∞—Å—Ç–æ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å multiplier?
- **–í–∞—Ä–∏–∞–Ω—Ç A:** –¢–æ–ª—å–∫–æ –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ –ø–æ–∑–∏—Ü–∏—é (—Å—Ç–∞—Ç–∏—á–Ω—ã–π)
- **–í–∞—Ä–∏–∞–Ω—Ç B:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Ü–µ–Ω—ã (–¥–∏–Ω–∞–º–∏—á–Ω—ã–π)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç A (–ø—Ä–∏ –≤—Ö–æ–¥–µ) ‚Äî –ø—Ä–æ—â–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –Ω–∞—á–∞–ª–∞

### 4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è multiplier
- Grok –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç: `max(1.0, min(multiplier, 5.0))`
- –ü–æ–¥—Ö–æ–¥—è—Ç –ª–∏ —ç—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ã?

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–∞—Ç—å —Å —ç—Ç–∏—Ö –≥—Ä–∞–Ω–∏—Ü, –ø–æ—Ç–æ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º

### 5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ç–µ–∫—É—â–∏–º –∫–æ–¥–æ–º
- **–í–∞—Ä–∏–∞–Ω—Ç A:** –ù–æ–≤—ã–π –º–µ—Ç–æ–¥ –≤ `exit_analyzer.py`
- **–í–∞—Ä–∏–∞–Ω—Ç B:** –û—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å `AdaptiveATRManager`

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∞—Ä–∏–∞–Ω—Ç A (–º–µ—Ç–æ–¥ –≤ exit_analyzer) ‚Äî –ø—Ä–æ—â–µ, –º–µ–Ω—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –¢—Ä–µ–π–¥–µ—Ä—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞ (Grok)
- **–ù–∞ –∫—Ä–∏–ø—Ç–µ (ETH, SOL):** +15-30% –∫ winrate –≤ trending —Ñ–∞–∑—ã
- **–°–Ω–∏–∂–µ–Ω–∏–µ drawdown:** -20-30% –≤ choppy —Ä–µ–∂–∏–º–µ
- **–£–ª—É—á—à–µ–Ω–∏–µ –∫–æ–Ω–≤–µ—Ä—Å–∏–∏:** +10-20% –≤ ranging —Ä–µ–∂–∏–º–µ

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –æ—Ü–µ–Ω–∫–∞
- **–°–ª–æ–∂–Ω–æ—Å—Ç—å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:** –°—Ä–µ–¥–Ω—è—è (–ø–æ—ç—Ç–∞–ø–Ω–æ)
- **–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 6-10 —á–∞—Å–æ–≤ (–≤—Å–µ —ç—Ç–∞–ø—ã)
- **–†–∏—Å–∫:** –°—Ä–µ–¥–Ω–∏–π (–Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## ‚úÖ –ò–¢–û–ì–û–í–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

**–ù–∞—á–∞—Ç—å —Å –≠—Ç–∞–ø–∞ 1** (–ø—Ä–æ—Å—Ç—ã–µ –±–æ–Ω—É—Å—ã):
- –ë—ã—Å—Ç—Ä–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å (1-2 —á–∞—Å–∞)
- –ù–∏–∑–∫–∏–π —Ä–∏—Å–∫
- –î–∞—Å—Ç —á–∞—Å—Ç—å –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤
- –ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Ä–µ—à–∏—Ç—å, –Ω—É–∂–Ω—ã –ª–∏ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —ç—Ç–∞–ø—ã

**–ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≠—Ç–∞–ø–∞ 1:**
- –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ö–æ—Ä–æ—à–∏–µ ‚Üí –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –≠—Ç–∞–ø—É 2
- –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω—ã–µ ‚Üí –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–∞ –≠—Ç–∞–ø–µ 1
- –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã ‚Üí –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è

---

## üìö –°–°–´–õ–ö–ò

- **–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è ATR:** `src/strategies/scalping/futures/positions/exit_analyzer.py` (—Å—Ç—Ä–æ–∫–∏ 1127-1196)
- **ATRProvider:** `src/strategies/scalping/futures/indicators/atr_provider.py`
- **ParameterProvider:** `src/strategies/scalping/futures/config/parameter_provider.py`
- **–ö–æ–Ω—Ñ–∏–≥:** `config/config_futures.yaml` (—Å—Ç—Ä–æ–∫–∏ 240-330)

---

**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–≠—Ç–∞–ø 1)  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 29.12.2025



