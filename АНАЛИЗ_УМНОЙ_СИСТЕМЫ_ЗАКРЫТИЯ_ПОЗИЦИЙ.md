# üß† –ê–ù–ê–õ–ò–ó –£–ú–ù–û–ô –°–ò–°–¢–ï–ú–´ –ó–ê–ö–†–´–¢–ò–Ø –ü–û–ó–ò–¶–ò–ô

**–î–∞—Ç–∞:** 2025-12-07  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ª–∏ "—É–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π" –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

---

## üìÇ –§–ê–ô–õ–´ –° –õ–û–ì–ò–ö–û–ô –ó–ê–ö–†–´–¢–ò–Ø –ü–û–ó–ò–¶–ò–ô

### 1. `exit_analyzer.py` ‚úÖ
**–ü—É—Ç—å:** `src/strategies/scalping/futures/positions/exit_analyzer.py`

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `_analyze_position_impl()` - –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–∑–∏—Ü–∏–∏
- `_generate_exit_for_trending()` - –ª–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–ª—è trending —Ä–µ–∂–∏–º–∞
- `_generate_exit_for_ranging()` - –ª–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
- `_generate_exit_for_choppy()` - –ª–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –¥–ª—è choppy —Ä–µ–∂–∏–º–∞
- `_check_reversal_signals()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ (Order Flow, MTF)
- `_analyze_trend_strength()` - –∞–Ω–∞–ª–∏–∑ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ —á–µ—Ä–µ–∑ ADX

### 2. `smart_exit_coordinator.py` ‚úÖ
**–ü—É—Ç—å:** `src/strategies/scalping/futures/coordinators/smart_exit_coordinator.py`

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `check_position()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∑–∏—Ü–∏–∏ —Å "—É–º–Ω—ã–º" –∞–Ω–∞–ª–∏–∑–æ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- `_apply_smart_filter()` - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —É–º–Ω–æ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (RSI, MACD)

### 3. `trailing_sl_coordinator.py` ‚úÖ
**–ü—É—Ç—å:** `src/strategies/scalping/futures/coordinators/trailing_sl_coordinator.py`

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `update_trailing_stop_loss()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ trailing stop loss —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π –∑–∞–∫—Ä—ã—Ç–∏—è
- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–µ –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É (RSI, MACD, Bollinger Bands)

### 4. `position_manager.py` ‚úÖ
**–ü—É—Ç—å:** `src/strategies/scalping/futures/position_manager.py`

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `_check_tp_only()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ Take Profit
- `_check_sl()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ Stop Loss
- `_check_max_holding()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —É–¥–µ—Ä–∂–∞–Ω–∏—è

---

## üîç –õ–û–ì–ò–ö–ê –ó–ê–ö–†–´–¢–ò–Ø (–ù–ï –°–í–Ø–ó–ê–ù–ù–ê–Ø –° –§–ò–ö–°–ò–†–û–í–ê–ù–ù–´–ú SL/TP)

### 1Ô∏è‚É£ EXIT_ANALYZER.PY

#### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:

**A. –†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (ranging/trending/choppy):**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ª–æ–≥–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è
- –†–∞–∑–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ (TP, SL, max_holding)

**B. Order Flow (–¥–µ–ª—å—Ç–∞):**
```python
# –°—Ç—Ä–æ–∫–∏ 773-831
async def _check_reversal_signals(self, symbol: str, position_side: str) -> bool:
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ Order Flow —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞
    if self.order_flow:
        current_delta = self.order_flow.get_delta()
        avg_delta = self.order_flow.get_avg_delta(periods=10)
        reversal_threshold = 0.15  # 15% –∏–∑–º–µ–Ω–µ–Ω–∏–µ delta
        
        if position_side.lower() == "long":
            # –î–ª—è LONG: —Ä–∞–∑–≤–æ—Ä–æ—Ç = delta –±—ã–ª –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º –∏ —Å—Ç–∞–ª –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º
            if (current_delta < -reversal_threshold and avg_delta > reversal_threshold):
                reversal_detected = True
```

**C. MTF (Multi-Timeframe):**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞ –Ω–∞ –±–æ–ª–µ–µ –≤—ã—Å–æ–∫–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ (TODO: —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–æ—â–µ–Ω–Ω–æ)

**D. ADX (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞):**
```python
# –°—Ç—Ä–æ–∫–∏ 729-771
async def _analyze_trend_strength(self, symbol: str) -> Optional[Dict[str, Any]]:
    # –ê–Ω–∞–ª–∏–∑ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ —á–µ—Ä–µ–∑ ADX
    adx_value = adx_data.get("adx", 0)
    plus_di = adx_data.get("plus_di", 0)
    minus_di = adx_data.get("minus_di", 0)
    
    # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∏–ª—É —Ç—Ä–µ–Ω–¥–∞ (0-1)
    if adx_value >= 25:
        trend_strength = 1.0
    elif adx_value >= 20:
        trend_strength = 0.7
    else:
        trend_strength = 0.3
```

#### ‚úÖ –£—Å–ª–æ–≤–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è (–Ω–µ SL/TP):

**1. –†–∞–∑–≤–æ—Ä–æ—Ç Order Flow/MTF:**
```python
# –°—Ç—Ä–æ–∫–∏ 1235-1249 (TRENDING)
reversal_detected = await self._check_reversal_signals(symbol, position_side)
if reversal_detected:
    return {
        "action": "close",
        "reason": "reversal_detected",
        "reversal_signal": "order_flow_or_mtf",
    }
```

**2. –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ:**
```python
# –°—Ç—Ä–æ–∫–∏ 1251-1264 (TRENDING)
if pnl_percent > 0.5:
    trend_data = await self._analyze_trend_strength(symbol)
    if trend_data and trend_data.get("trend_strength", 0) >= 0.8:
        return {
            "action": "extend_tp",
            "reason": "strong_trend_profit",
            "trend_strength": trend_data.get("trend_strength", 0),
        }
```

**3. –î–µ—Ä–∂–∞–Ω–∏–µ —É–±—ã—Ç–æ—á–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ max_holding:**
```python
# –°—Ç—Ä–æ–∫–∏ 1294-1307 (TRENDING)
if pnl_percent < 0:
    logger.info(
        f"‚è∞ ExitAnalyzer TRENDING: –í—Ä–µ–º—è {minutes_in_position:.1f} –º–∏–Ω >= {max_holding_minutes:.1f} –º–∏–Ω, "
        f"–Ω–æ –ø–æ–∑–∏—Ü–∏—è –≤ —É–±—ã—Ç–∫–µ ({pnl_percent:.2f}%) - –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º, –∂–¥–µ–º SL –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"
    )
    return {
        "action": "hold",
        "reason": "max_holding_exceeded_but_loss_trending",
    }
```

**4. –ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (Partial TP):**
```python
# –°—Ç—Ä–æ–∫–∏ 1207-1221 (TRENDING)
if can_partial_close:
    fraction = partial_tp_params.get("fraction", 0.6)
    return {
        "action": "partial_close",
        "reason": "partial_tp",
        "fraction": fraction,
    }
```

#### ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
- Volume Profile (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ exit_analyzer.py)
- –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å (liquidity) - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
- –†–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã–µ —Å–≤–µ—á–∏ (reversal candles) - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
- –§–∞–Ω–¥–∏–Ω–≥ (funding rate) - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è (correlation) - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
- –ü–∏–≤–æ—Ç—ã (pivot points) - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è

---

### 2Ô∏è‚É£ SMART_EXIT_COORDINATOR.PY

#### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:

**A. RSI (–ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å):**
```python
# –°—Ç—Ä–æ–∫–∏ 123-155
if side == "long":
    if rsi > 70:
        # LONG –ø–æ–∑–∏—Ü–∏—è, RSI –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω - —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
        return True
    elif rsi < 50:
        # LONG –ø–æ–∑–∏—Ü–∏—è, RSI –Ω–µ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω - –±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
        return False  # –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
```

**B. MACD (—Ä–∞–∑–≤–æ—Ä–æ—Ç —Å–∏–≥–Ω–∞–ª–∞):**
```python
# –°—Ç—Ä–æ–∫–∏ 157-202
if side == "long":
    if macd_line < signal_line:
        # LONG –ø–æ–∑–∏—Ü–∏—è, MACD –º–µ–¥–≤–µ–∂–∏–π - —Ä–∞–∑—Ä–µ—à–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
        return True
    else:
        # LONG –ø–æ–∑–∏—Ü–∏—è, MACD –±—ã—á–∏–π - –±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
        return False
```

#### ‚úÖ –£—Å–ª–æ–≤–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è:

**1. RSI –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω:**
- LONG + RSI > 70 ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º
- SHORT + RSI < 30 ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º
- LONG + RSI < 50 ‚Üí –±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ (—Ç—Ä–µ–Ω–¥ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å—Å—è)
- SHORT + RSI > 50 ‚Üí –±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ (—Ç—Ä–µ–Ω–¥ –º–æ–∂–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å—Å—è)

**2. MACD —Ä–∞–∑–≤–æ—Ä–æ—Ç:**
- LONG + MACD –º–µ–¥–≤–µ–∂–∏–π (macd < signal) ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º
- SHORT + MACD –±—ã—á–∏–π (macd > signal) ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º
- LONG + MACD –±—ã—á–∏–π (macd > signal) ‚Üí –±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ
- SHORT + MACD –º–µ–¥–≤–µ–∂–∏–π (macd < signal) ‚Üí –±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ

#### ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
- Bollinger Bands (–Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ smart_exit_coordinator.py)
- Volume Profile
- –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å
- Order Flow
- –§–∞–Ω–¥–∏–Ω–≥
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è
- –ü–∏–≤–æ—Ç—ã

---

### 3Ô∏è‚É£ TRAILING_SL_COORDINATOR.PY

#### ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:

**A. Order Flow (–¥–µ–ª—å—Ç–∞):**
```python
# –°—Ç—Ä–æ–∫–∏ 898-1013
order_flow_reversal_detected = False
if self.order_flow:
    current_delta = self.order_flow.get_delta()
    avg_delta = self.order_flow.get_avg_delta(periods=10)
    
    if position_side.lower() == "long":
        if (prev_delta > reversal_threshold and current_delta < -reversal_threshold):
            order_flow_reversal_detected = True
            # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ
```

**B. RSI (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è):**
```python
# –°—Ç—Ä–æ–∫–∏ 1036-1057
if pos_side == "long" and rsi_value < 30:
    logger.debug(
        f"üìä RSI –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω ({rsi_value:.1f}) –¥–ª—è {symbol} LONG - "
        f"–±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop (–ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏)"
    )
    should_block_close = True
```

**C. MACD (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è):**
```python
# –°—Ç—Ä–æ–∫–∏ 1059-1085
if pos_side == "long" and histogram > 0:
    logger.debug(
        f"üìä MACD –±—ã—á—å—è –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—è –¥–ª—è {symbol} LONG - "
        f"–±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop (–ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏)"
    )
    should_block_close = True
```

**D. Bollinger Bands (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è):**
```python
# –°—Ç—Ä–æ–∫–∏ 1087-1125
if pos_side == "long" and current_price <= lower * 1.001:
    logger.debug(
        f"üìä –¶–µ–Ω–∞ —É –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã Bollinger –¥–ª—è {symbol} LONG - "
        f"–±–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop (–ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏)"
    )
    should_block_close = True
```

#### ‚úÖ –£—Å–ª–æ–≤–∏—è –∑–∞–∫—Ä—ã—Ç–∏—è:

**1. Order Flow —Ä–∞–∑–≤–æ—Ä–æ—Ç (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1):**
```python
# –°—Ç—Ä–æ–∫–∏ 976-1013
if order_flow_reversal_detected:
    logger.info(f"üîÑ –ó–∞–∫—Ä—ã–≤–∞–µ–º {symbol} –ø–æ Order Flow —Ä–∞–∑–≤–æ—Ä–æ—Ç—É")
    await self.close_position_callback(symbol, "order_flow_reversal")
    return  # –ó–∞–∫—Ä—ã–≤–∞–µ–º –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ!
```

**2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2):**
```python
# –°—Ç—Ä–æ–∫–∏ 1131-1137
if should_close_by_sl:
    if should_block_close:
        logger.debug(
            f"üîí –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ trailing stop –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ –¥–ª—è {symbol} "
            f"(–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –≤–æ–∑–º–æ–∂–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É, –ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏)"
        )
        return  # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º
```

#### ‚ùå –ù–ï –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è:
- Volume Profile
- –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å
- –†–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã–µ —Å–≤–µ—á–∏
- –§–∞–Ω–¥–∏–Ω–≥
- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è
- –ü–∏–≤–æ—Ç—ã

---

## üìã –ö–†–ê–¢–ö–û–ï –û–ü–ò–°–ê–ù–ò–ï –õ–û–ì–ò–ö–ò –ó–ê–ö–†–´–¢–ò–Ø

### ‚úÖ –ö–∞–∫–∞—è –ª–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è?

**1. ExitAnalyzer (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3):**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞, Order Flow, ADX
- –ú–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å, —á–∞—Å—Ç–∏—á–Ω–æ –∑–∞–∫—Ä—ã—Ç—å, –ø—Ä–æ–¥–ª–∏—Ç—å TP, –∏–ª–∏ –¥–µ—Ä–∂–∞—Ç—å
- **–î–µ—Ä–∂–∏—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏** –ø—Ä–∏ `max_holding_exceeded_but_loss`

**2. SmartExitCoordinator (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1):**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç RSI, MACD –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- –ú–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ

**3. TrailingSLCoordinator (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2):**
- –ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç Order Flow, RSI, MACD, Bollinger Bands
- –ú–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –ø–æ Order Flow —Ä–∞–∑–≤–æ—Ä–æ—Ç—É –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TSL

### ‚úÖ –ö–∞–∫–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —É—á–∞—Å—Ç–≤—É—é—Ç?

**–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:**
- ‚úÖ –†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (ranging/trending/choppy)
- ‚úÖ Order Flow (–¥–µ–ª—å—Ç–∞)
- ‚úÖ ADX (—Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞)
- ‚úÖ RSI (–ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω–Ω–æ—Å—Ç—å/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å)
- ‚úÖ MACD (—Ä–∞–∑–≤–æ—Ä–æ—Ç —Å–∏–≥–Ω–∞–ª–∞)
- ‚úÖ Bollinger Bands (—Ü–µ–Ω–∞ —É –≥—Ä–∞–Ω–∏—Ü)

**–ù–ï –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:**
- ‚ùå Volume Profile
- ‚ùå –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å (liquidity)
- ‚ùå –†–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã–µ —Å–≤–µ—á–∏ (reversal candles)
- ‚ùå –§–∞–Ω–¥–∏–Ω–≥ (funding rate)
- ‚ùå –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è (correlation)
- ‚ùå –ü–∏–≤–æ—Ç—ã (pivot points)
- ‚ùå MTF (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–æ—â–µ–Ω–Ω–æ, TODO)

---

## üß† –ú–û–ñ–ï–¢ –õ–ò –ë–û–¢ –î–ï–†–ñ–ê–¢–¨ –ü–û–ó–ò–¶–ò–Æ –í –ú–ò–ù–£–°–ï, –ï–°–õ–ò –í–ò–î–ò–¢ –ü–û–¢–ï–ù–¶–ò–ê–õ –†–ê–ó–í–û–†–û–¢–ê?

### ‚úÖ –î–ê, –ú–û–ñ–ï–¢!

**1. –ü—Ä–∏ max_holding_exceeded_but_loss:**
```python
# exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 1294-1307 (TRENDING)
if pnl_percent < 0:
    logger.info(
        f"‚è∞ ExitAnalyzer TRENDING: –í—Ä–µ–º—è {minutes_in_position:.1f} –º–∏–Ω >= {max_holding_minutes:.1f} –º–∏–Ω, "
        f"–Ω–æ –ø–æ–∑–∏—Ü–∏—è –≤ —É–±—ã—Ç–∫–µ ({pnl_percent:.2f}%) - –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º, –∂–¥–µ–º SL –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"
    )
    return {
        "action": "hold",
        "reason": "max_holding_exceeded_but_loss_trending",
    }
```

**2. –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL:**
```python
# trailing_sl_coordinator.py, —Å—Ç—Ä–æ–∫–∏ 1131-1137
if should_close_by_sl:
    if should_block_close:
        # –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ, –µ—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É
        return  # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º
```

**–ù–û:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL —Ä–∞–±–æ—Ç–∞–µ—Ç **–¢–û–õ–¨–ö–û –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π** (`profit_pct > 0`, —Å—Ç—Ä–æ–∫–∞ 897).

### ‚ùå –ù–ï–¢, –ù–ï –ú–û–ñ–ï–¢ (–¥–ª—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π):

**SmartExitCoordinator:**
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

**TrailingSLCoordinator:**
- –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π (`profit_pct > 0`)

---

## üß± –ï–°–¢–¨ –õ–ò –£–°–õ–û–í–ò–ï "–î–ï–†–ñ–ê–¢–¨, –ï–°–õ–ò –ï–°–¢–¨ –®–ê–ù–° –ù–ê –û–¢–ö–ê–¢"?

### ‚úÖ –î–ê, –ï–°–¢–¨!

**1. –ü—Ä–∏ max_holding_exceeded_but_loss:**
- –ë–æ—Ç **–¥–µ—Ä–∂–∏—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏** –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ max_holding
- –õ–æ–≥–∏–∫–∞: "–∂–¥–µ–º SL –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"

**2. –ü—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL:**
- –ë–æ—Ç **–±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π**, –µ—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É
- –£—Å–ª–æ–≤–∏—è:
  - RSI –ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω (< 30) –¥–ª—è LONG
  - RSI –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω (> 70) –¥–ª—è SHORT
  - MACD –±—ã—á–∏–π –¥–ª—è LONG
  - MACD –º–µ–¥–≤–µ–∂–∏–π –¥–ª—è SHORT
  - –¶–µ–Ω–∞ —É –≥—Ä–∞–Ω–∏—Ü Bollinger Bands

---

## üß† –ü–†–ò–ú–ï–†–´

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–∑–∏—Ü–∏—è –≤ –º–∏–Ω—É—Å–µ, –Ω–æ –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
- –ü–æ–∑–∏—Ü–∏—è: SOL-USDT LONG, PnL = -6.82%
- –†–µ–∂–∏–º: ranging
- RSI = 25 (–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω)
- MACD = –±—ã—á–∏–π (macd > signal)
- –¶–µ–Ω–∞ —É –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã Bollinger
- –û–±—ä–µ–º —Ä–∞—Å—Ç–µ—Ç
- Order Flow delta = –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è

**–î–µ–π—Å—Ç–≤–∏–µ –±–æ—Ç–∞:**
- ‚ùå **–ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç** –ø–æ max_holding (–µ—Å–ª–∏ –≤—Ä–µ–º—è –ø—Ä–µ–≤—ã—à–µ–Ω–æ)
- ‚úÖ **–î–µ—Ä–∂–∏—Ç –ø–æ–∑–∏—Ü–∏—é** (`action=hold, reason=max_holding_exceeded_but_loss`)
- ‚ö†Ô∏è **–ù–û:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

**–í—ã–≤–æ–¥:** –ë–æ—Ç –¥–µ—Ä–∂–∏—Ç —É–±—ã—Ç–æ—á–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –ø—Ä–∏ max_holding, –Ω–æ **–ù–ï –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TSL** –¥–ª—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π.

---

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–∑–∏—Ü–∏—è –≤ –ø–ª—é—Å–µ, –Ω–æ –µ—Å—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞

**–°—Ü–µ–Ω–∞—Ä–∏–π:**
- –ü–æ–∑–∏—Ü–∏—è: BTC-USDT LONG, PnL = +2.0%
- –†–µ–∂–∏–º: ranging
- RSI = 25 (–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω)
- MACD = –±—ã—á–∏–π (macd > signal)
- –¶–µ–Ω–∞ —É –Ω–∏–∂–Ω–µ–π –ø–æ–ª–æ—Å—ã Bollinger
- Order Flow delta = –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è

**–î–µ–π—Å—Ç–≤–∏–µ –±–æ—Ç–∞:**
- ‚úÖ **–ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ** –ø–æ TSL (`should_block_close = True`)
- ‚úÖ **–î–µ—Ä–∂–∏—Ç –ø–æ–∑–∏—Ü–∏—é** –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —Ä–æ—Å—Ç–∞
- ‚úÖ **–ú–æ–∂–µ—Ç –ø—Ä–æ–¥–ª–∏—Ç—å TP** –µ—Å–ª–∏ —Ç—Ä–µ–Ω–¥ —Å–∏–ª—å–Ω—ã–π

**–í—ã–≤–æ–¥:** –ë–æ—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π, –µ—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É.

---

## ‚ö†Ô∏è –ï–°–¢–¨ –õ–ò –§–õ–ê–ì –ò–õ–ò –ü–ê–†–ê–ú–ï–¢–†, –ö–û–¢–û–†–´–ô –ó–ê–ü–†–ï–©–ê–ï–¢ –ó–ê–ö–†–´–í–ê–¢–¨ –£–ë–´–¢–û–ß–ù–£–Æ –ü–û–ó–ò–¶–ò–Æ?

### ‚úÖ –î–ê, –ï–°–¢–¨ (–Ω–µ—è–≤–Ω–æ):

**1. `max_holding_exceeded_but_loss`:**
```python
# exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 1294-1307, 1592-1605, 1821-1834
if pnl_percent < 0:
    return {
        "action": "hold",
        "reason": "max_holding_exceeded_but_loss",
    }
```

**2. `reversal_detection.enabled`:**
```python
# trailing_sl_coordinator.py, —Å—Ç—Ä–æ–∫–∏ 1019-1137
if reversal_config.get("enabled", False):
    # –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TSL, –µ—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É
    should_block_close = True
```

**–ù–û:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π (`profit_pct > 0`).

---

## üìå –ï–°–¢–¨ –õ–ò –ü–ï–†–ï–û–ü–†–ï–î–ï–õ–ï–ù–ò–ï SL, –ï–°–õ–ò –†–´–ù–û–ö "–í–ò–î–ò–¢" –ü–û–¢–ï–ù–¶–ò–ê–õ?

### ‚ùå –ù–ï–¢, –ù–ï–¢ –ü–†–Ø–ú–û–ì–û –ü–ï–†–ï–û–ü–†–ï–î–ï–õ–ï–ù–ò–Ø SL

**–ß—Ç–æ –µ—Å—Ç—å:**
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TSL (–¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π)
- ‚úÖ –î–µ—Ä–∂–∞–Ω–∏–µ —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ max_holding
- ‚úÖ –ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ

**–ß–µ–≥–æ –Ω–µ—Ç:**
- ‚ùå `ignore_sl_if_reversal_detected = true` - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
- ‚ùå `smart_exit_override_sl = true` - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ
- ‚ùå –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ SL –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ - –Ω–µ –Ω–∞–π–¥–µ–Ω–æ

---

## üìä –ö–ê–ö PnL% –û–¢–û–ë–†–ê–ñ–ê–ï–¢–°–Ø –í –õ–û–ì–ê–•?

### ‚úÖ –û—Ç –º–∞—Ä–∂–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1):

```python
# exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 343-397
if margin_used and margin_used > 0 and unrealized_pnl is not None:
    gross_pnl_pct = (unrealized_pnl / margin_used) * 100  # –í –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
    
    # –£—á–∏—Ç—ã–≤–∞–µ–º –∫–æ–º–∏—Å—Å–∏—é –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    if include_fees and seconds_since_open >= 10.0:
        commission_pct = trading_fee_rate * 100  # 0.1% = 0.1
        net_pnl_pct = gross_pnl_pct - commission_pct
        return net_pnl_pct
```

### ‚úÖ –° —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–∏:

- –ö–æ–º–∏—Å—Å–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ 10 —Å–µ–∫—É–Ω–¥** —Å –º–æ–º–µ–Ω—Ç–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è
- –ö–æ–º–∏—Å—Å–∏—è = `trading_fee_rate * 100` (–æ–±—ã—á–Ω–æ 0.1%)
- Net PnL% = Gross PnL% - Commission%

### ‚ùå –ù–ï —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è:

- ‚ùå –§–∞–Ω–¥–∏–Ω–≥ (funding rate) - –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –≤ —Ä–∞—Å—á–µ—Ç–µ PnL%
- ‚ùå Fallback –Ω–∞ —Ä–∞—Å—á–µ—Ç –æ—Ç —Ü–µ–Ω—ã (–µ—Å–ª–∏ –º–∞—Ä–∂–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞)

---

## üéØ –ò–¢–û–ì–û–í–´–ï –í–´–í–û–î–´

### ‚úÖ –ß—Ç–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–£–º–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:**
   - RSI, MACD, Bollinger Bands, ADX, Order Flow

2. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–µ –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É:**
   - –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
   - –ë–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TSL

3. **–î–µ—Ä–∂–∞–Ω–∏–µ —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π:**
   - –ü—Ä–∏ max_holding_exceeded_but_loss
   - –õ–æ–≥–∏–∫–∞: "–∂–¥–µ–º SL –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è"

4. **–ü—Ä–æ–¥–ª–µ–Ω–∏–µ TP –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ:**
   - –ï—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > 0.5% –∏ trend_strength >= 0.8

5. **–ß–∞—Å—Ç–∏—á–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (Partial TP):**
   - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —á–∞—Å—Ç—å –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ trigger_percent

6. **Order Flow —Ä–∞–∑–≤–æ—Ä–æ—Ç:**
   - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–∏ —Ä–∞–∑–≤–æ—Ä–æ—Ç–µ Order Flow

### ‚ùå –ß—Ç–æ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

1. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π:**
   - –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π
   - –£–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø–æ TSL

2. **–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ SL:**
   - –ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è SL –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
   - –ù–µ—Ç `ignore_sl_if_reversal_detected`

3. **–ù–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:**
   - Volume Profile
   - –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å
   - –†–∞–∑–≤–æ—Ä–æ—Ç–Ω—ã–µ —Å–≤–µ—á–∏
   - –§–∞–Ω–¥–∏–Ω–≥
   - –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è
   - –ü–∏–≤–æ—Ç—ã
   - MTF (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–ø—Ä–æ—â–µ–Ω–Ω–æ)

### üîß –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è —É–±—ã—Ç–æ—á–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π:**
   - –ï—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π

2. **–î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ SL:**
   - –ï—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Å–∏–ª—å–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤ –Ω–∞—à—É –ø–æ–ª—å–∑—É
   - –í—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å SL –∏–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –µ–≥–æ

3. **–†–∞—Å—à–∏—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:**
   - Volume Profile –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∫–∏/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è
   - –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ—á–µ–∫ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞
   - –§–∞–Ω–¥–∏–Ω–≥ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞

---

**–°–æ–∑–¥–∞–Ω–æ:** 2025-12-07  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω



