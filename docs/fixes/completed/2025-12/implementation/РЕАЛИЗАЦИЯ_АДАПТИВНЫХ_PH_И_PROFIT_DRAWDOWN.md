# ‚úÖ –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ê–î–ê–ü–¢–ò–í–ù–´–• PH –ò PROFIT DRAWDOWN

**–î–∞—Ç–∞:** 2025-12-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

---

## üéØ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### üî¥ –ü–†–ò–û–†–ò–¢–ï–¢ 1.1: Adaptive Profit Harvesting (PH)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- PH threshold –±—ã–ª —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º ($0.10-$0.12 USD)
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1000: PH = 0.013% –æ—Ç notional ‚Üí –ø–æ—Ç–µ—Ä—è 99% –ø—Ä–∏–±—ã–ª–∏!
- –° –¥–æ–ª–∏–≤–∫–∞–º–∏ (3x): PH = 0.0048% –æ—Ç notional ‚Üí –ö–ê–¢–ê–°–¢–†–û–§–ê!

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ PH threshold —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –º–∞—Ä–∂–∏
- ‚úÖ –î–ª—è trending: 2.5% –æ—Ç –º–∞—Ä–∂–∏
- ‚úÖ –î–ª—è ranging: 1.5% –æ—Ç –º–∞—Ä–∂–∏
- ‚úÖ –î–ª—è choppy: 1.0% –æ—Ç –º–∞—Ä–∂–∏

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
1. `src/strategies/scalping/futures/position_manager.py` (—Å—Ç—Ä–æ–∫–∏ 1594-1635)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è `ph_threshold_type` –∏ `ph_threshold_percent`
   - –ï—Å–ª–∏ `ph_threshold_type = "margin_percent"`, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è `ph_threshold` –æ—Ç –º–∞—Ä–∂–∏
   - –ü–æ–ª—É—á–µ–Ω–∏–µ `margin_used` –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ –∏–ª–∏ metadata

2. `config/config_futures.yaml`:
   - **Trending** (—Å—Ç—Ä–æ–∫–∞ 243-245):
     ```yaml
     ph_threshold_type: "margin_percent"
     ph_threshold_percent: 2.5  # 2.5% –æ—Ç –º–∞—Ä–∂–∏
     ph_threshold: 0.12  # Fallback
     ```
   - **Ranging** (—Å—Ç—Ä–æ–∫–∞ 306-309):
     ```yaml
     ph_threshold_type: "margin_percent"
     ph_threshold_percent: 1.5  # 1.5% –æ—Ç –º–∞—Ä–∂–∏
     ph_threshold: 0.10  # Fallback
     ```
   - **Choppy** (—Å—Ç—Ä–æ–∫–∞ 368-370):
     ```yaml
     ph_threshold_type: "margin_percent"
     ph_threshold_percent: 1.0  # 1.0% –æ—Ç –º–∞—Ä–∂–∏
     ph_threshold: 0.1  # Fallback
     ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- PH —Ç–µ–ø–µ—Ä—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–∑–∏—Ü–∏–∏! ‚úÖ
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1000 (margin $133, notional $665):
  - Ranging: PH = $133 * 1.5% = $2.00 (0.3% –æ—Ç notional) ‚úÖ
  - –í–º–µ—Å—Ç–æ $0.10 (0.015% –æ—Ç notional) ‚ùå

---

### üî¥ –ü–†–ò–û–†–ò–¢–ï–¢ 1.2: Adaptive Profit Drawdown

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `min_profit_to_activate_usd` –±—ã–ª —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º ($0.5 USD)
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1000: –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ 0.067% –æ—Ç notional ‚Üí —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ!
- Profit Drawdown —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª –Ω–∞ –º–∏–∫—Ä–æ–ø—Ä–∏–±—ã–ª—è—Ö

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ `min_profit_to_activate` —Ç–µ–ø–µ—Ä—å —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –º–∞—Ä–∂–∏
- ‚úÖ 3.0% –æ—Ç –º–∞—Ä–∂–∏ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
1. `src/strategies/scalping/futures/position_manager.py` (—Å—Ç—Ä–æ–∫–∏ 5155-5190)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `min_profit_to_activate` –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π drawdown
   - –ï—Å–ª–∏ `min_profit_to_activate_type = "margin_percent"`, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –æ—Ç –º–∞—Ä–∂–∏
   - Profit Drawdown –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `peak_profit >= min_profit_to_activate`

2. `config/config_futures.yaml` (—Å—Ç—Ä–æ–∫–∏ 125-129):
   ```yaml
   profit_drawdown:
     enabled: true
     drawdown_percent: 0.75
     min_profit_to_activate_type: "margin_percent"  # ‚úÖ –ù–û–í–û–ï
     min_profit_to_activate_percent: 3.0  # ‚úÖ –ù–û–í–û–ï: 3.0% –æ—Ç –º–∞—Ä–∂–∏
     min_profit_to_activate_usd: 0.5  # Fallback
   ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Profit Drawdown —Ç–µ–ø–µ—Ä—å –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è —Å —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–∑–∏—Ü–∏–∏! ‚úÖ
- –ü—Ä–∏ –±–∞–ª–∞–Ω—Å–µ $1000 (margin $133):
  - –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–∏ $133 * 3.0% = $4.00 (0.6% –æ—Ç notional) ‚úÖ
  - –í–º–µ—Å—Ç–æ $0.5 (0.075% –æ—Ç notional) ‚ùå

---

### üü† –ü–†–ò–û–†–ò–¢–ï–¢ 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ min_profit_after_commission –≤ Partial TP

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Partial TP –∑–∞–∫—Ä—ã–≤–∞–ª –ø–æ–∑–∏—Ü–∏–∏ –î–û —Ç–æ–≥–æ, –∫–∞–∫ –ø—Ä–∏–±—ã–ª—å –ø–æ–∫—Ä–æ–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏
- –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –ª–æ–≥–æ–≤:
  - DOGE-USDT: gross_pnl=+$0.0524, commission=-$0.0640, net_pnl=-$0.0116 ‚ùå
  - ETH-USDT: gross_pnl=+$0.0350, commission=-$0.0755, net_pnl=-$0.0405 ‚ùå

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `min_profit_after_commission` –≤ `close_partial_position`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–µ—Ä–µ–¥ —á–∞—Å—Ç–∏—á–Ω—ã–º –∑–∞–∫—Ä—ã—Ç–∏–µ–º
- ‚úÖ –ï—Å–ª–∏ `net_partial_pnl < min_profit_after_commission`, Partial TP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:**
1. `src/strategies/scalping/futures/position_manager.py` (—Å—Ç—Ä–æ–∫–∏ 6176-6225)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `min_profit_after_commission` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
   - –†–∞—Å—á–µ—Ç `net_partial_pnl = partial_pnl - partial_commission`
   - –ï—Å–ª–∏ `net_partial_pnl < min_profit_after_commission`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞
   - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞: `position_side` ‚Üí `side`

2. `config/config_futures.yaml` (—Å—Ç—Ä–æ–∫–∞ 75):
   ```yaml
   partial_tp:
     min_profit_after_commission: 0.5  # ‚úÖ –£–∂–µ –±—ã–ª–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ
   ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Partial TP —Ç–µ–ø–µ—Ä—å –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏, –µ—Å–ª–∏ —á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å < $0.50 ‚úÖ
- –ü—Ä–æ–±–ª–µ–º–∞ "–ö–æ–º–∏—Å—Å–∏—è > –ü—Ä–∏–±—ã–ª—å" —Ä–µ—à–µ–Ω–∞! ‚úÖ

---

## üìä –°–†–ê–í–ù–ò–¢–ï–õ–¨–ù–ê–Ø –¢–ê–ë–õ–ò–¶–ê: –î–û vs –ü–û–°–õ–ï

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π | –£–ª—É—á—à–µ–Ω–∏–µ |
|----------|----------------|-------------------|-----------|
| **PH Threshold (Ranging, –±–∞–ª–∞–Ω—Å $1000)** | $0.10 (0.015% –æ—Ç notional) | $2.00 (0.3% –æ—Ç notional) | **x20** ‚úÖ |
| **PH Threshold (Trending, –±–∞–ª–∞–Ω—Å $1000)** | $0.12 (0.018% –æ—Ç notional) | $3.33 (0.5% –æ—Ç notional) | **x28** ‚úÖ |
| **Profit Drawdown Activation (–±–∞–ª–∞–Ω—Å $1000)** | $0.50 (0.075% –æ—Ç notional) | $4.00 (0.6% –æ—Ç notional) | **x8** ‚úÖ |
| **Partial TP: –ö–æ–º–∏—Å—Å–∏—è > –ü—Ä–∏–±—ã–ª—å** | ‚ùå –ù–µ –ø—Ä–æ–≤–µ—Ä—è–ª–æ—Å—å | ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è | **–†–ï–®–ï–ù–û** ‚úÖ |

---

## üéØ –ú–ê–¢–ï–ú–ê–¢–ò–ö–ê –ú–ê–°–®–¢–ê–ë–ò–†–û–í–ê–ù–ò–Ø

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–ª–∞–Ω—Å $50 (MICRO Profile)
- Margin: $11 (22% –æ—Ç –±–∞–ª–∞–Ω—Å–∞)
- Notional: $55 (5x leverage)

**PH (Ranging):**
- –î–æ: $0.10 (0.18% –æ—Ç notional)
- –ü–æ—Å–ª–µ: $11 * 1.5% = $0.165 (0.3% –æ—Ç notional) ‚úÖ

**Profit Drawdown:**
- –î–æ: $0.50 (0.91% –æ—Ç notional)
- –ü–æ—Å–ª–µ: $11 * 3.0% = $0.33 (0.6% –æ—Ç notional) ‚úÖ

### –ü—Ä–∏–º–µ—Ä 2: –ë–∞–ª–∞–Ω—Å $1000 (SMALL Profile)
- Margin: $133 (–∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É $100-$200)
- Notional: $665 (5x leverage)

**PH (Ranging):**
- –î–æ: $0.10 (0.015% –æ—Ç notional) ‚ùå
- –ü–æ—Å–ª–µ: $133 * 1.5% = $2.00 (0.3% –æ—Ç notional) ‚úÖ

**Profit Drawdown:**
- –î–æ: $0.50 (0.075% –æ—Ç notional) ‚ùå
- –ü–æ—Å–ª–µ: $133 * 3.0% = $4.00 (0.6% –æ—Ç notional) ‚úÖ

### –ü—Ä–∏–º–µ—Ä 3: –ë–∞–ª–∞–Ω—Å $5000 (LARGE Profile)
- Margin: $500 (10% –æ—Ç –±–∞–ª–∞–Ω—Å–∞, –∫–∞–ø)
- Notional: $2500 (5x leverage)

**PH (Ranging):**
- –î–æ: $0.10 (0.004% –æ—Ç notional) ‚ùå
- –ü–æ—Å–ª–µ: $500 * 1.5% = $7.50 (0.3% –æ—Ç notional) ‚úÖ

**Profit Drawdown:**
- –î–æ: $0.50 (0.02% –æ—Ç notional) ‚ùå
- –ü–æ—Å–ª–µ: $500 * 3.0% = $15.00 (0.6% –æ—Ç notional) ‚úÖ

---

## ‚úÖ –ò–¢–û–ì–û–í–´–ô –°–¢–ê–¢–£–°

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ (100%):
- ‚úÖ Adaptive PH (2.5%/1.5%/1.0% –æ—Ç –º–∞—Ä–∂–∏)
- ‚úÖ Adaptive Profit Drawdown (3.0% –æ—Ç –º–∞—Ä–∂–∏)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ min_profit_after_commission –≤ Partial TP
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ —Å `position_side` –≤ `close_partial_position`

### –û—Å—Ç–∞–ª–æ—Å—å (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- ‚è≥ –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ PH/Profit Drawdown –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ (–Ω–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

---

## üöÄ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- PH –∑–∞–∫—Ä—ã–≤–∞–ª –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –º–∏–∫—Ä–æ–ø—Ä–∏–±—ã–ª—è—Ö (0.015% –æ—Ç notional)
- Profit Drawdown –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (0.075% –æ—Ç notional)
- Partial TP –∑–∞–∫—Ä—ã–≤–∞–ª –ø–æ–∑–∏—Ü–∏–∏ —Å —É–±—ã—Ç–∫–æ–º –ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- PH –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ —Ä–∞–∑—É–º–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ (0.3% –æ—Ç notional) ‚úÖ
- Profit Drawdown –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ (0.6% –æ—Ç notional) ‚úÖ
- Partial TP –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏, –µ—Å–ª–∏ —á–∏—Å—Ç–∞—è –ø—Ä–∏–±—ã–ª—å < $0.50 ‚úÖ
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Å—à—Ç–∞–±–∏—Ä—É—é—Ç—Å—è —Å —Ä–∞–∑–º–µ—Ä–æ–º –ø–æ–∑–∏—Ü–∏–∏ ‚úÖ

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-12-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –≥–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é








