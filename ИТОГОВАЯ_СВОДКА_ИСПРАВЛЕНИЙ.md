# ‚úÖ –ò–¢–û–ì–û–í–ê–Ø –°–í–û–î–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

**–î–∞—Ç–∞:** 2025-11-15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–í–°–ï –ö–†–ò–¢–ò–ß–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò–°–ü–†–ê–í–õ–ï–ù–´**

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### **1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω—ã –¥–ª—è SELL** ‚úÖ

**–§–∞–π–ª:** `src/strategies/scalping/futures/order_executor.py` (—Å—Ç—Ä–æ–∫–∏ 345-357)

**–ü—Ä–æ–±–ª–µ–º–∞:** –î–ª—è SELL –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `best_ask * 0.999`, —á—Ç–æ —Å—Ç–∞–≤–∏–ª–æ –æ—Ä–¥–µ—Ä –¥–∞–ª–µ–∫–æ –æ—Ç —Ä—ã–Ω–∫–∞ (–æ–∫–æ–ª–æ best_ask –≤–º–µ—Å—Ç–æ best_bid).

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –£–±—Ä–∞–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `best_ask * 0.999`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `best_bid` –∏ `min_sell_price`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ –õ–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –¥–ª—è SELL —Ç–µ–ø–µ—Ä—å —Å—Ç–∞–≤—è—Ç—Å—è –±–ª–∏–∑–∫–æ –∫ `best_bid` (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏).

---

### **2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `post_only` –¥–ª—è —Ä–µ–∂–∏–º–æ–≤** ‚úÖ

**–§–∞–π–ª:** `src/strategies/scalping/futures/order_executor.py` (—Å—Ç—Ä–æ–∫–∏ 415-431)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –±–∞–∑–æ–≤—ã–π `post_only=false` –≤–º–µ—Å—Ç–æ —Ä–µ–∂–∏–º–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (`true` –¥–ª—è ranging).

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `regime` –≤ `_place_limit_order`
- `post_only` —Ç–µ–ø–µ—Ä—å –±–µ—Ä–µ—Ç—Å—è –∏–∑ `by_regime[regime].post_only`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚úÖ
- –î–ª—è `ranging`: `post_only=true` (maker fee 0.02% –≤–º–µ—Å—Ç–æ taker 0.05%)
- –î–ª—è `trending`: `post_only=false`
- –î–ª—è `choppy`: `post_only=false`

---

### **3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `max_wait_seconds` –¥–ª—è —Ä–µ–∂–∏–º–æ–≤** ‚ö†Ô∏è

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py` (—Å—Ç—Ä–æ–∫–∞ 1968)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –±–∞–∑–æ–≤—ã–π 60 —Å–µ–∫ –≤–º–µ—Å—Ç–æ —Ä–µ–∂–∏–º–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (120 —Å–µ–∫ –¥–ª—è ranging).

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢–†–ï–ë–£–ï–¢–°–Ø –†–£–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï**

**–ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**

–ó–∞–º–µ–Ω–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 1967-1968:
```python
limit_order_config = order_executor_config.get("limit_order", {})
max_wait = limit_order_config.get("max_wait_seconds", 60)
```

–ù–∞:
```python
limit_order_config = order_executor_config.get("limit_order", {})

# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü–æ–ª—É—á–∞–µ–º max_wait_seconds –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ —Å —É—á–µ—Ç–æ–º —Ä–µ–∂–∏–º–∞
current_regime = "ranging"  # Fallback
try:
    if hasattr(self, "signal_generator") and self.signal_generator:
        regime_obj = self.signal_generator.regime_manager.get_current_regime()
        if regime_obj:
            current_regime = regime_obj.lower() if isinstance(regime_obj, str) else str(regime_obj).lower()
except:
    pass

# –ü–æ–ª—É—á–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —Ä–µ–∂–∏–º—É
regime_limit_config = limit_order_config.get("by_regime", {}).get(current_regime, {})
max_wait = regime_limit_config.get("max_wait_seconds", limit_order_config.get("max_wait_seconds", 60))
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** ‚úÖ
- –î–ª—è `ranging`: 120 —Å–µ–∫ (–≤–º–µ—Å—Ç–æ 60)
- –î–ª—è `trending`: 45 —Å–µ–∫
- –î–ª—è `choppy`: 30 —Å–µ–∫

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### ‚úÖ –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **–õ–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –±—É–¥—É—Ç –±—ã—Å—Ç—Ä–µ–µ –∏—Å–ø–æ–ª–Ω—è—Ç—å—Å—è** ‚úÖ
   - –î–ª—è SELL: –æ—Ä–¥–µ—Ä —Å—Ç–∞–≤–∏—Ç—Å—è –±–ª–∏–∑–∫–æ –∫ `best_bid` (–ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏)
   - –ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `best_ask * 0.999` (—ç—Ç–æ –¥–∞–ª–µ–∫–æ –æ—Ç —Ü–µ–Ω—ã)

2. **–ú–µ–Ω—å—à–µ –æ—Ç–º–µ–Ω –ª–∏–º–∏—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤** ‚ö†Ô∏è
   - –û—Ä–¥–µ—Ä–∞ —Å—Ç–∞–≤—è—Ç—Å—è –±–ª–∏–∂–µ –∫ —Ä—ã–Ω–∫—É ‚Üí –±—ã—Å—Ç—Ä–µ–µ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è
   - **–¢–†–ï–ë–£–ï–¢–°–Ø:** –∏—Å–ø—Ä–∞–≤–∏—Ç—å `max_wait_seconds` –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è 120 —Å–µ–∫ –¥–ª—è ranging
   - `post_only=true` –¥–ª—è ranging ‚Üí —ç–∫–æ–Ω–æ–º–∏—è –∫–æ–º–∏—Å—Å–∏–π (0.02% –≤–º–µ—Å—Ç–æ 0.05%)

3. **–ú–µ–Ω—å—à–µ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è** ‚úÖ
   - –ú–µ–Ω—å—à–µ –∑–∞–º–µ–Ω –Ω–∞ —Ä—ã–Ω–æ—á–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞
   - –û—Ä–¥–µ—Ä–∞ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è –ø–æ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω–µ (–±–µ–∑ –ø—Ä–æ—Å–∫–∞–ª—å–∑—ã–≤–∞–Ω–∏—è)

4. **–≠–∫–æ–Ω–æ–º–∏—è –∫–æ–º–∏—Å—Å–∏–π** ‚úÖ
   - –î–ª—è ranging —Ä–µ–∂–∏–º–∞: `post_only=true` ‚Üí maker fee 0.02% –≤–º–µ—Å—Ç–æ taker 0.05%
   - –≠–∫–æ–Ω–æ–º–∏—è: 0.06% –∑–∞ —Å–¥–µ–ª–∫—É (0.03% √ó 2)

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å `max_wait_seconds` –≤ `orchestrator.py` (—Å—Ç—Ä–æ–∫–∞ 1968) - **–¢–†–ï–ë–£–ï–¢–°–Ø –†–£–ß–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï**
2. ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –¥–ª—è —Å–±–æ—Ä–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
3. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –æ—Ç–º–µ–Ω –æ—Ä–¥–µ—Ä–æ–≤ –∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ** (–ø–æ—Å–ª–µ —Ä—É—á–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è `max_wait_seconds`)



