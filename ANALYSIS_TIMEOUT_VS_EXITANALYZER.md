# –ê–ù–ê–õ–ò–ó: –ù–£–ñ–ï–ù –õ–ò TIMEOUT –ï–°–õ–ò –ï–°–¢–¨ EXITANALYZER?

**–î–∞—Ç–∞:** 2025-12-18  
**–°—Ç–∞—Ç—É—Å:** üîç –ê–ù–ê–õ–ò–ó –ó–ê–í–ï–†–®–ï–ù

---

## ü§î –í–û–ü–†–û–°

**–ï—Å–ª–∏ ExitAnalyzer –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è –æ –∑–∞–∫—Ä—ã—Ç–∏–∏, –∑–∞—á–µ–º –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π timeout/max_holding?**

---

## üìä –¢–ï–ö–£–©–ê–Ø –õ–û–ì–ò–ö–ê

### 1. ExitAnalyzer (–ü–†–ò–û–†–ò–¢–ï–¢ #0)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç max_holding –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
- ‚úÖ –ú–æ–∂–µ—Ç –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å –≤—Ä–µ–º—è –µ—Å–ª–∏ —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥ + –ø—Ä–∏–±—ã–ª—å
- ‚úÖ –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ max_holding (–∂–¥–µ—Ç SL)
- ‚úÖ –£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∞–Ω–∞–ª–∏–∑–∞ —Ä—ã–Ω–∫–∞

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∏–∫–∏ (trending):**
```python
if minutes_in_position >= max_holding_minutes:
    if trend_strength >= 0.7 and pnl_percent > 0.3:
        # –ü—Ä–æ–¥–ª–µ–≤–∞–µ–º - —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥
        return {"action": "extend_tp"}
    elif pnl_percent < 0:
        # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º —É–±—ã—Ç–æ—á–Ω—ã–µ - –∂–¥–µ–º SL
        return {"action": "hold"}
    else:
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø—Ä–∏–±—ã–ª—å–Ω—ã–µ –±–µ–∑ —Å–∏–≥–Ω–∞–ª–æ–≤
        return {"action": "close", "reason": "max_holding_no_signals"}
```

### 2. Timeout –≤ Orchestrator (–ü–†–ò–û–†–ò–¢–ï–¢ #1)
**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- ‚úÖ –ñ–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ (–Ω–µ –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç—Å—è)
- ‚úÖ –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –í–°–ï –ø–æ–∑–∏—Ü–∏–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ "–ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞—â–∏—Ç–∞"

**–ö–æ–¥:**
```python
if timeout_minutes is not None and time_held >= timeout_minutes:
    await self._close_position(symbol, "timeout")  # –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –í–°–ï!
```

---

## üîç –ê–ù–ê–õ–ò–ó: –ù–£–ñ–ï–ù –õ–ò TIMEOUT?

### ‚úÖ –ê–†–ì–£–ú–ï–ù–¢–´ –ó–ê TIMEOUT:

1. **–ó–∞—â–∏—Ç–∞ –æ—Ç –±–∞–≥–æ–≤ ExitAnalyzer**
   - –ï—Å–ª–∏ ExitAnalyzer –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (–±–∞–≥, –æ—à–∏–±–∫–∞)
   - –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è "–∑–∞–≤–∏—Å–ª–∞" –≤ —Å–∏—Å—Ç–µ–º–µ
   - –ü–æ—Å–ª–µ–¥–Ω—è—è –ª–∏–Ω–∏—è –∑–∞—â–∏—Ç—ã

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∏—Å–∫–∞**
   - –ù–µ –¥–µ—Ä–∂–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —É–ø—É—â–µ–Ω–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏ (opportunity cost)
   - –ó–∞—â–∏—Ç–∞ –æ—Ç "–∑–∞–±—ã—Ç—ã—Ö" –ø–æ–∑–∏—Ü–∏–π

3. **–ê–±—Å–æ–ª—é—Ç–Ω—ã–π –ª–∏–º–∏—Ç**
   - –ù–µ –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç—Å—è (–≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç max_holding –≤ ExitAnalyzer)
   - –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è

### ‚ùå –ê–†–ì–£–ú–ï–ù–¢–´ –ü–†–û–¢–ò–í TIMEOUT:

1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏**
   - ExitAnalyzer —É–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç max_holding
   - Timeout –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ "—Ç—É–ø–æ"

2. **–ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ**
   - –ú–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –ø—Ä–∏–±—ã–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ
   - ExitAnalyzer –º–æ–≥ –±—ã –ø—Ä–æ–¥–ª–∏—Ç—å, –Ω–æ timeout –∑–∞–∫—Ä—ã–≤–∞–µ—Ç

3. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤**
   - ExitAnalyzer: "–ø—Ä–æ–¥–ª–µ–≤–∞–µ–º, —Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥"
   - Timeout: "–∑–∞–∫—Ä—ã–≤–∞–µ–º, –≤—Ä–µ–º—è –≤—ã—à–ª–æ"
   - –ö—Ç–æ –ø–æ–±–µ–∂–¥–∞–µ—Ç? (–°–µ–π—á–∞—Å timeout –ø–æ–±–µ–∂–¥–∞–µ—Ç, —Ç.–∫. –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º)

---

## üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –í–∞—Ä–∏–∞–Ω—Ç 1: –£–ë–†–ê–¢–¨ TIMEOUT (–µ—Å–ª–∏ ExitAnalyzer —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ)
**–õ–æ–≥–∏–∫–∞:**
- ExitAnalyzer —É–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç max_holding
- ExitAnalyzer —É–º–Ω—ã–π - –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
- Timeout —Ç–æ–ª—å–∫–æ –º–µ—à–∞–µ—Ç

**–†–∏—Å–∫:** –ï—Å–ª–∏ ExitAnalyzer —Å–ª–æ–º–∞–µ—Ç—Å—è, –ø–æ–∑–∏—Ü–∏–∏ –º–æ–≥—É—Ç –≤–∏—Å–µ—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç—ã ExitAnalyzer + –∞–≤–∞—Ä–∏–π–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –°–î–ï–õ–ê–¢–¨ TIMEOUT –û–ß–ï–ù–¨ –ë–û–õ–¨–®–ò–ú (–∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞—â–∏—Ç–∞)
**–õ–æ–≥–∏–∫–∞:**
- Timeout = 2-3 —á–∞—Å–∞ (–≤–º–µ—Å—Ç–æ 7 –º–∏–Ω—É—Ç)
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –±–∞–≥–æ–≤
- ExitAnalyzer —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ–º –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö

**–ü—Ä–∏–º–µ—Ä:**
```yaml
trailing_sl:
  timeout_minutes: 180  # 3 —á–∞—Å–∞ –≤–º–µ—Å—Ç–æ 7 –º–∏–Ω—É—Ç
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–ú–ù–´–ô TIMEOUT (–ø—Ä–æ–≤–µ—Ä—è–µ—Ç ExitAnalyzer –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º)
**–õ–æ–≥–∏–∫–∞:**
- –ü–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ timeout –ø—Ä–æ–≤–µ—Ä—è–µ–º ExitAnalyzer
- –ï—Å–ª–∏ ExitAnalyzer –≥–æ–≤–æ—Ä–∏—Ç "–ø—Ä–æ–¥–ª–µ–≤–∞–µ–º" ‚Üí –ø—Ä–æ–¥–ª–µ–≤–∞–µ–º timeout
- –ï—Å–ª–∏ ExitAnalyzer –≥–æ–≤–æ—Ä–∏—Ç "hold" (—É–±—ã—Ç–æ–∫) ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ timeout
- –ï—Å–ª–∏ ExitAnalyzer –≥–æ–≤–æ—Ä–∏—Ç "close" ‚Üí –∑–∞–∫—Ä—ã–≤–∞–µ–º

**–ö–æ–¥:**
```python
if time_held >= timeout_minutes:
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º ExitAnalyzer –ø–µ—Ä–µ–¥ –∂–µ—Å—Ç–∫–∏–º –∑–∞–∫—Ä—ã—Ç–∏–µ–º
    exit_decision = await exit_analyzer.analyze_position(symbol)
    if exit_decision and exit_decision.get("action") == "extend_tp":
        # –ü—Ä–æ–¥–ª–µ–≤–∞–µ–º timeout –µ—â–µ –Ω–∞ 30 –º–∏–Ω—É—Ç
        timeout_minutes += 30
    else:
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º
        await self._close_position(symbol, "timeout")
```

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô –ü–û–î–•–û–î

### ‚úÖ –í–∞—Ä–∏–∞–Ω—Ç 2: –ë–æ–ª—å—à–æ–π timeout –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞—â–∏—Ç–∞

**–ü—Ä–∏—á–∏–Ω—ã:**
1. ExitAnalyzer —É–∂–µ —É–º–Ω—ã–π –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç max_holding
2. Timeout –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –±–∞–≥–æ–≤
3. –ù–µ –º–µ—à–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ ExitAnalyzer

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
```yaml
trailing_sl:
  timeout_minutes: 180  # 3 —á–∞—Å–∞ –≤–º–µ—Å—Ç–æ 7 –º–∏–Ω—É—Ç
  timeout_loss_percent: 2.0  # –ú–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –¥–ª—è –±–æ–ª—å—à–µ–π —Ç–µ—Ä–ø–∏–º–æ—Å—Ç–∏
```

**–õ–æ–≥–∏–∫–∞:**
- ExitAnalyzer —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ–º –≤ –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏—è—Ö (–¥–æ 2 —á–∞—Å–æ–≤)
- Timeout —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ ExitAnalyzer –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª (–ø–æ—Å–ª–µ 3 —á–∞—Å–æ–≤)

---

## üìã –ü–õ–ê–ù –î–ï–ô–°–¢–í–ò–ô

1. ‚úÖ **–£–≤–µ–ª–∏—á–∏—Ç—å timeout_minutes** –¥–æ 180 –º–∏–Ω—É—Ç (3 —á–∞—Å–∞)
2. ‚úÖ **–£–±—Ä–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É timeout –ü–ï–†–ï–î ExitAnalyzer** (—Å–µ–π—á–∞—Å timeout –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º)
3. ‚úÖ **–û—Å—Ç–∞–≤–∏—Ç—å timeout –∫–∞–∫ –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞—â–∏—Ç—É** (–ø–æ—Å–ª–µ –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫)

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** Timeout –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–ï–†–ï–î ExitAnalyzer, —á—Ç–æ –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ!

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É timeout –ü–û–°–õ–ï ExitAnalyzer, –∏–ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å timeout –¥–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è.

---

**–í—ã–≤–æ–¥:** ExitAnalyzer —É–∂–µ —É–º–Ω—ã–π –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç max_holding. Timeout –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ –∫–∞–∫ –∑–∞—â–∏—Ç–∞ –æ—Ç –±–∞–≥–æ–≤, –ø–æ—ç—Ç–æ–º—É –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –±–æ–ª—å—à–∏–º (3 —á–∞—Å–∞) –∏ –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è –ü–û–°–õ–ï ExitAnalyzer.
