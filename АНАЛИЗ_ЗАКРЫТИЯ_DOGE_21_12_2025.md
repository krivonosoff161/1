# ‚úÖ –ê–ù–ê–õ–ò–ó –ó–ê–ö–†–´–¢–ò–Ø DOGE-USDT (21.12.2025)

## üìã –û–°–ù–û–í–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

**–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 2025-12-21 13:51:29  
**–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è:** 2025-12-21 13:57:18  
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 5.98 –º–∏–Ω—É—Ç (351 —Å–µ–∫—É–Ω–¥)  
**–ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è:** `tp_reached` (Take Profit –¥–æ—Å—Ç–∏–≥–Ω—É—Ç)  
**–°—Ç–æ—Ä–æ–Ω–∞:** SHORT  
**–†–∞–∑–º–µ—Ä:** 1890 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤  
**Entry price:** $0.131950  
**Exit price:** $0.1317  
**Net PnL:** $0.1477 USDT (2.84% –æ—Ç –º–∞—Ä–∂–∏)

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ù–û–í–´–• –õ–û–ì–û–í

### 1. ‚úÖ Pre-close state logging - –†–ê–ë–û–¢–ê–ï–¢!

**–ù–∞–π–¥–µ–Ω–æ –≤ –ª–æ–≥–∞—Ö (—Å—Ç—Ä–æ–∫–∏ 11697-11710):**

```
2025-12-21 13:57:26.526 | INFO | ================================================================================
2025-12-21 13:57:26.527 | INFO | üìä [PRE_CLOSE] DOGE-USDT: –ü—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç—å
2025-12-21 13:57:26.528 | INFO | ================================================================================
2025-12-21 13:57:26.528 | INFO |    –ü—Ä–∏—á–∏–Ω–∞: tp_reached
2025-12-21 13:57:26.529 | INFO |    Side: SHORT
2025-12-21 13:57:26.530 | INFO |    Size: 1.89 –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤
2025-12-21 13:57:26.531 | INFO |    Entry price: $0.131950
2025-12-21 13:57:26.531 | INFO |    –í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏: 5.98 –º–∏–Ω
2025-12-21 13:57:26.531 | INFO |    Unrealized PnL: $0.0000 USDT
2025-12-21 13:57:26.532 | INFO |    Margin used: $0.0000 USDT
2025-12-21 13:57:26.533 | INFO |    Regime: unknown
2025-12-21 13:57:26.533 | INFO |    Leverage: unknown
2025-12-21 13:57:26.534 | INFO |    Signal strength: 0.00
2025-12-21 13:57:26.534 | INFO | ================================================================================
```

**–û—Ü–µ–Ω–∫–∞:** ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û –†–ê–ë–û–¢–ê–ï–¢** (7/10)
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏—á–∏–Ω–∞, side, size, entry price, –≤—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏
- ‚ö†Ô∏è **–ü–†–û–ë–õ–ï–ú–ê:** `Unrealized PnL`, `Margin used`, `Regime`, `Leverage`, `Signal strength` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç `0.0000` –∏–ª–∏ `unknown`
- **–ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:** –ü–æ–ª—É—á–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–µ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

---

### 2. ‚úÖ Race condition –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ - –†–ê–ë–û–¢–ê–ï–¢ –û–¢–õ–ò–ß–ù–û!

**–ù–∞–π–¥–µ–Ω–æ –≤ –ª–æ–≥–∞—Ö (—Å—Ç—Ä–æ–∫–∏ 11713-11718):**

```
2025-12-21 13:57:26.924 | WARNING | ================================================================================
2025-12-21 13:57:26.925 | WARNING | ‚ö†Ô∏è [RACE_CONDITION] DOGE-USDT: –ü–æ–ø—ã—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é —Å size=0!
2025-12-21 13:57:26.925 | WARNING |    –ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è: tp_reached
2025-12-21 13:57:26.926 | WARNING |    –°—Ç–∞—Ç—É—Å: –ü–æ–∑–∏—Ü–∏—è —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ
2025-12-21 13:57:26.926 | WARNING |    –î–µ–π—Å—Ç–≤–∏–µ: –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–∫—Ä—ã—Ç–∏–µ, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ
2025-12-21 13:57:26.928 | WARNING | ================================================================================
```

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ **–û–¢–õ–ò–ß–ù–û!** (10/10)
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ race condition (–ø–æ–∑–∏—Ü–∏—è —É–∂–µ –∑–∞–∫—Ä—ã—Ç–∞ –Ω–∞ –±–∏—Ä–∂–µ)
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏—á–∏–Ω–∞, —Å—Ç–∞—Ç—É—Å –∏ –¥–µ–π—Å—Ç–≤–∏–µ
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–ª–∞ —Å–∏—Ç—É–∞—Ü–∏—é (–ø—Ä–æ–ø—É—Å—Ç–∏–ª–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è —Å–∏—Ç—É–∞—Ü–∏—è - –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–ª–∞—Å—å –Ω–∞ –±–∏—Ä–∂–µ –ø–æ TP (Trailing Stop Loss –∏–ª–∏ –ø—Ä—è–º–æ–π TP), –∞ –±–æ—Ç –ø–æ–ø—ã—Ç–∞–ª—Å—è –∑–∞–∫—Ä—ã—Ç—å –µ—ë –ø–æ–≤—Ç–æ—Ä–Ω–æ. –ó–∞—â–∏—Ç–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ!

---

### 3. ‚úÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è - –†–ê–ë–û–¢–ê–ï–¢!

**–ù–∞–π–¥–µ–Ω–æ –≤ –ª–æ–≥–∞—Ö (—Å—Ç—Ä–æ–∫–∞ 11483):**

```
2025-12-21 13:57:18.648 | INFO | üí∞ –ü–û–ó–ò–¶–ò–Ø –ó–ê–ö–†–´–¢–ê: DOGE-USDT SHORT
```

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢** (8/10)
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
- ‚ö†Ô∏è **–ù–ï –ù–ê–ô–î–ï–ù–û:** –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å PnL, –∫–æ–º–∏—Å—Å–∏—è–º–∏, funding fee (–≤–æ–∑–º–æ–∂–Ω–æ, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–Ω—å—à–µ –≤ –ª–æ–≥–µ)

---

### 4. ‚úÖ CSV –∑–∞–ø–∏—Å—å - –†–ê–ë–û–¢–ê–ï–¢!

**–ù–∞–π–¥–µ–Ω–æ –≤ `trades_2025-12-21.csv`:**

```
timestamp,symbol,side,entry_price,exit_price,size,gross_pnl,commission,net_pnl,duration_sec,reason,win_rate
2025-12-21T13:57:18.658339,DOGE-USDT,short,0.1320,0.1317,1890.00000000,0.3969,0.2492,0.1477,351.020336,tp_reached,100.00
```

**–û—Ü–µ–Ω–∫–∞:** ‚úÖ **–û–¢–õ–ò–ß–ù–û!** (10/10)
- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Net PnL: $0.1477 USDT
- ‚úÖ –ü—Ä–∏—á–∏–Ω–∞: `tp_reached`

---

## ‚ö†Ô∏è –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ü—Ä–æ–±–ª–µ–º–∞ #1: Pre-close state logging –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "unknown" –∏ "0.0000"

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í Pre-close state logging –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ª—è (`Unrealized PnL`, `Margin used`, `Regime`, `Leverage`, `Signal strength`) –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –î–∞–Ω–Ω—ã–µ –Ω–µ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ –ø–µ—Ä–µ–¥ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

**–†–µ—à–µ–Ω–∏–µ:** –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å `orchestrator._close_position` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —ç—Ç–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑:
- `position` dict (–¥–ª—è `margin_used`, `unrealized_pnl`)
- `position_registry.metadata` (–¥–ª—è `regime`, `leverage`, `signal_strength`)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü† **–í–ê–ñ–ù–û** (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ —É–ª—É—á—à–∏—Ç –∞–Ω–∞–ª–∏–∑)

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –û–¶–ï–ù–ö–ê

| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-------------|--------|--------|-------------|
| Pre-close state logging | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 7/10 | –ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| Race condition –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 10/10 | –û—Ç–ª–∏—á–Ω–æ! |
| –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 8/10 | –û—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –µ—Å—Ç—å |
| CSV –∑–∞–ø–∏—Å—å | ‚úÖ –†–ê–ë–û–¢–ê–ï–¢ | 10/10 | –û—Ç–ª–∏—á–Ω–æ! |
| Exchange-side closure detection | ‚è≥ –ù–ï –ü–†–û–í–ï–†–ï–ù–û | - | –ù–µ –±—ã–ª–æ exchange-side closure |
| Partial TP logging | ‚è≥ –ù–ï –ü–†–û–í–ï–†–ï–ù–û | - | –ù–µ –±—ã–ª–æ Partial TP |

---

## üéØ –í–´–í–û–î–´

1. ‚úÖ **Pre-close state logging** - —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
2. ‚úÖ **Race condition –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ!
3. ‚úÖ **CSV –∑–∞–ø–∏—Å—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ!
4. ‚ö†Ô∏è **–ù—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:** Pre-close state logging –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ì–æ—Ç–æ–≤–æ –∫ –¥–∞–ª—å–Ω–µ–π—à–µ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:** –î–∞, –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞—é—Ç!

---

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-12-21 14:00:00  
**–õ–æ–≥ —Ñ–∞–π–ª:** `logs/futures/futures_main_2025-12-21.log`  
**CSV —Ñ–∞–π–ª:** `logs/trades_2025-12-21.csv`

