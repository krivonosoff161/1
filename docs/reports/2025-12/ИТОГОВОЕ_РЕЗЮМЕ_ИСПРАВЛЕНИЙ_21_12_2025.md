# ‚úÖ –ò–¢–û–ì–û–í–û–ï –†–ï–ó–Æ–ú–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô (21.12.2025)

**–î–∞—Ç–∞:** 2025-12-21  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –ê–Ω–∞–ª–∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –ª–æ–≥–æ–≤ –æ—Ç Grok 4.1  
**–°—Ç–∞—Ç—É—Å:** –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

---

## üéØ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### üî¥ –ü–†–ò–û–†–ò–¢–ï–¢ 1A: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω TP/SL –¥–ª—è DOGE-USDT –≤ ranging —Ä–µ–∂–∏–º–µ

**–§–∞–π–ª:** `config/config_futures.yaml`  
**–°—Ç—Ä–æ–∫–∞:** 807-808

**–ë—ã–ª–æ:**
```yaml
ranging:
  tp_percent: 4.0  # ‚ùå –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ (Risk:Reward = 1.33:1)
  sl_percent: 2.0  # ‚ùå –°–ª–∏—à–∫–æ–º –≤—ã—Å–æ–∫–æ (Risk:Reward = 1.33:1)
```

**–°—Ç–∞–ª–æ:**
```yaml
ranging:
  tp_percent: 2.0  # ‚úÖ –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ R:R = 2.0:1
  sl_percent: 1.0  # ‚úÖ –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ R:R = 2.0:1
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Risk:Reward —É–ª—É—á—à–µ–Ω —Å 1.33:1 –¥–æ 2.0:1
- Break-even Win Rate —Å–Ω–∏–∂–µ–Ω —Å 42.9% –¥–æ 33.3%
- –ü–æ—Å–ª–µ partial TP SL –±—É–¥–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è –¥–æ 1.5% (1.0 * 1.5 = 1.5), —á—Ç–æ –±–æ–ª–µ–µ —Ä–∞–∑—É–º–Ω–æ

---

### üü† –ü–†–ò–û–†–ò–¢–ï–¢ 2A: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Partial TP

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`  
**–°—Ç—Ä–æ–∫–∏:** 1791-1798, 1842-1853, 2077-2089

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í –ª–æ–≥–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `trigger_percent` (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è fallback 0.6 –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è)
- –ù–µ –±—ã–ª–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –ø–æ—á–µ–º—É Partial TP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ `trigger_percent` –¥–æ –±–ª–æ–∫–∞ if** (—Å—Ç—Ä–æ–∫–∞ 1792):
   ```python
   trigger_percent = partial_tp_params.get("trigger_percent", 0.6) if partial_tp_params.get("enabled", False) else None
   ```

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ Partial TP** (—Å—Ç—Ä–æ–∫–∏ 1842-1853):
   ```python
   else:
       logger.warning(
           f"‚ö†Ô∏è ExitAnalyzer RANGING: Partial TP —Ç—Ä–∏–≥–≥–µ—Ä –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –¥–ª—è {symbol} "
           f"({pnl_percent:.2f}% >= {trigger_percent:.2f}%), –Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è: {min_holding_info}"
       )
   ```

3. **–£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏** (—Å—Ç—Ä–æ–∫–∏ 2077-2089):
   ```python
   partial_tp_status = (
       f"partial_tp={trigger_percent:.2f}% (–Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç)" 
       if trigger_percent is not None and pnl_percent < trigger_percent
       else f"partial_tp={trigger_percent:.2f}% (–¥–æ—Å—Ç–∏–≥–Ω—É—Ç, –Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è)" 
       if trigger_percent is not None
       else "partial_tp=disabled"
   )
   ```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ `trigger_percent`
- –í–∏–¥–Ω–æ, –ø–æ—á–µ–º—É Partial TP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è (min_holding, partial_tp_executed, –∏ —Ç.–¥.)

---

### üü† –ü–†–ò–û–†–ò–¢–ï–¢ 2B: –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ min_holding –¥–ª—è Partial TP

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`  
**–ú–µ—Ç–æ–¥:** `_check_adaptive_min_holding_for_partial_tp` (—Å—Ç—Ä–æ–∫–∞ 1117)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–í—ã–≤–æ–¥:**
- –ú–µ—Ç–æ–¥ `_check_adaptive_min_holding_for_partial_tp` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç `duration_minutes >= actual_min_holding`
- –ï—Å–ª–∏ min_holding –Ω–µ –ø—Ä–æ–π–¥–µ–Ω ‚Üí `can_partial_close = False` ‚Üí Partial TP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
- –≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è

---

### üü† –ü–†–ò–û–†–ò–¢–ï–¢ 2C: –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è SL=3.0%

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py`  
**–ú–µ—Ç–æ–¥:** `_get_sl_percent` (—Å—Ç—Ä–æ–∫–∞ 616), –ª–æ–≥–∏–∫–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏—è SL (—Å—Ç—Ä–æ–∫–∞ 1712)

**–ê–Ω–∞–ª–∏–∑:**
- –ú–µ—Ç–æ–¥ `_get_sl_percent` –ø–æ–ª—É—á–∞–µ—Ç SL –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:
  1. Per-symbol per-regime (DOGE-USDT ‚Üí ranging ‚Üí sl_percent)
  2. By-regime (ranging ‚Üí sl_percent)
  3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π SL
- –ü–æ—Å–ª–µ partial TP SL —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –≤ 1.5 —Ä–∞–∑–∞ (—Å—Ç—Ä–æ–∫–∞ 1712)

**–í—ã–≤–æ–¥:**
- –ï—Å–ª–∏ –≤ –ª–æ–≥–∞—Ö –ø–æ–∫–∞–∑–∞–Ω–æ SL=3.0% —Å —Å–∞–º–æ–≥–æ –Ω–∞—á–∞–ª–∞, —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø–æ–∑–∏—Ü–∏—è —É–∂–µ –±—ã–ª–∞ —Å `partial_tp_executed=True`
- –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è TP/SL (2.0%/1.0%), –ø–æ—Å–ª–µ partial TP SL –±—É–¥–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è –¥–æ 1.5% (1.0 * 1.5 = 1.5), —á—Ç–æ –±–æ–ª–µ–µ —Ä–∞–∑—É–º–Ω–æ

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ó–∞–¥–∞—á–∞ | –§–∞–π–ª | –°—Ç–∞—Ç—É—Å | –í—Ä–µ–º—è |
|-----------|--------|------|--------|-------|
| üî¥ 1A | –ò—Å–ø—Ä–∞–≤–∏—Ç—å TP/SL –¥–ª—è DOGE-USDT ranging (4.0%/2.0% ‚Üí 2.0%/1.0%) | config_futures.yaml | ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ | 2 –º–∏–Ω |
| üî¥ 1B | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥—Ä—É–≥–∏–µ per-symbol TP/SL –¥–ª—è ranging | config_futures.yaml | ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ | 5 –º–∏–Ω |
| üü† 2A | –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ Partial TP | exit_analyzer.py | ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ | 15 –º–∏–Ω |
| üü† 2B | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É min_holding –¥–ª—è Partial TP | exit_analyzer.py | ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ | 15 –º–∏–Ω |
| üü† 2C | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–∫—É–¥–∞ –±–µ—Ä–µ—Ç—Å—è SL=3.0% | exit_analyzer.py | ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ | 10 –º–∏–Ω |

**–ò–¢–û–ì–û:** ~47 –º–∏–Ω—É—Ç

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- Risk:Reward = 1.33:1 (TP 4.0%, SL 3.0%)
- Break-even Win Rate = 42.9%
- –¢–µ–∫—É—â–∏–π Win Rate = 50% ‚Üí –µ–ª–µ-–µ–ª–µ –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å
- Partial TP –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –ø—Ä–∏—á–∏–Ω

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- Risk:Reward = 2.0:1 (TP 2.0%, SL 1.0%)
- Break-even Win Rate = 33.3%
- –¢–µ–∫—É—â–∏–π Win Rate = 50% ‚Üí —Å—Ç–∞–±–∏–ª—å–Ω–∞—è –ø—Ä–∏–±—ã–ª—å–Ω–æ—Å—Ç—å ‚úÖ
- Partial TP –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤–∏–¥–Ω–æ –ø—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ ‚úÖ

---

## üìù –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

### 1. –ö–æ–º–∏—Å—Å–∏—è > –ü—Ä–∏–±—ã–ª—å
**–ü—Ä–æ–±–ª–µ–º–∞:** Partial TP –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –î–û —Ç–æ–≥–æ, –∫–∞–∫ –ø—Ä–∏–±—ã–ª—å –ø–æ–∫—Ä–æ–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏  
**–°—Ç–∞—Ç—É—Å:** –£–∂–µ –≤ –ø–ª–∞–Ω–µ (Priority 1.1 - Adaptive PH –∏ Profit Drawdown)  
**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É `min_profit_after_commission` –≤ `close_partial_position`

### 2. 48.8% —Å–¥–µ–ª–æ–∫ –ø–æ SL
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—ã—Å–æ–∫–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–∫—Ä—ã—Ç–∏–π –ø–æ SL  
**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ —Ä–µ—à–µ–Ω–æ (—É–ª—É—á—à–µ–Ω Risk:Reward —Å 1.33:1 –¥–æ 2.0:1)  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### 3. Partial TP –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç
**–ü—Ä–æ–±–ª–µ–º–∞:** Partial TP —Ç—Ä–∏–≥–≥–µ—Ä –¥–æ—Å—Ç–∏–≥–Ω—É—Ç, –Ω–æ –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ—à–µ–Ω–æ (—É–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –≤–∏–¥–Ω–æ –ø—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)  
**–ü—Ä–∏—á–∏–Ω–∞:** min_holding –±–ª–æ–∫–∏—Ä—É–µ—Ç Partial TP (–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)

---

## üöÄ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è** –Ω–∞ demo/sandbox –∞–∫–∫–∞—É–Ω—Ç–µ
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏** –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ TP/SL —Ç–µ–ø–µ—Ä—å 2.0%/1.0% –¥–ª—è DOGE-USDT –≤ ranging
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Partial TP –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤–∏–¥–Ω–æ –ø—Ä–∏—á–∏–Ω—ã –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ Partial TP
3. **–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** —á–µ—Ä–µ–∑ 24-48 —á–∞—Å–æ–≤:
   - –°—Ä–∞–≤–Ω–∏—Ç—å Win Rate –¥–æ –∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —É–ª—É—á—à–∏–ª—Å—è –ª–∏ Risk:Reward
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ Partial TP —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

**–î–∞—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:** 2025-12-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã








