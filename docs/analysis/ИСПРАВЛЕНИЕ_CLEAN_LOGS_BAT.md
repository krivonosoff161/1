# üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï clean_logs.bat

**–î–∞—Ç–∞:** 2025-11-16  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê

`clean_logs.bat` **–ù–ï** –ø–µ—Ä–µ–º–µ—â–∞–ª JSON —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫ (`trades_*.json`), —Ç–æ–ª—å–∫–æ CSV —Ñ–∞–π–ª—ã (`trades_*.csv`).

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –õ–æ–≥–∏ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤
- ‚úÖ CSV —Ñ–∞–π–ª—ã –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤
- ‚ùå JSON —Ñ–∞–π–ª—ã **–ù–ï** –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï

### **1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ JSON —Ñ–∞–π–ª–æ–≤**

**–§–∞–π–ª:** `clean_logs.bat:88-93`

```batch
if exist "logs\trades_*.json" (
    echo   –ù–∞–π–¥–µ–Ω—ã —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫: logs\trades_*.json
    set filefound=1
) else (
    echo   –§–∞–π–ª—ã —Å–¥–µ–ª–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã: logs\trades_*.json
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–∞—Ç–Ω–∏–∫ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ JSON —Ñ–∞–π–ª–æ–≤ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–∞–±–æ—Ç—ã.

---

### **2. –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ JSON —Ñ–∞–π–ª–æ–≤**

**–§–∞–π–ª:** `clean_logs.bat:470-567`

```batch
REM ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ü–µ—Ä–µ–º–µ—â–∞–µ–º —Ç–∞–∫–∂–µ JSON —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫
echo.
echo ====================================
echo –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Å–¥–µ–ª–æ–∫ (trades.json) –≤ –∞—Ä—Ö–∏–≤...
echo ====================================
set jsoncount=0
set failedjson=0
set json_processed=0

REM –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ JSON —Ñ–∞–π–ª–æ–≤
dir /b "logs\trades_*.json" >nul 2>&1
if errorlevel 1 (
    echo   ‚ö†Ô∏è JSON —Ñ–∞–π–ª—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
    goto :skip_json
)

echo   ‚úÖ JSON —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã!
echo   –ù–∞—á–∏–Ω–∞—é –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–∞–∂–¥–æ–≥–æ JSON —Ñ–∞–π–ª–∞...
echo.

REM –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–∞–∂–¥—ã–π JSON —Ñ–∞–π–ª
for %%f in ("logs\trades_*.json") do (
    set /a json_processed+=1
    echo.
    echo   ========================================
    echo   ‚úÖ –§–ê–ô–õ #!json_processed!: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é JSON —Ñ–∞–π–ª: %%f
    echo   ========================================
    
    if exist "%%f" (
        echo   ‚úÖ –§–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: %%f
        
        REM –ü–æ–ª—É—á–∞–µ–º –∏–º—è —Ñ–∞–π–ª–∞
        for %%g in ("%%f") do (
            set "jsonname=%%~nxg"
            set "jsonfullpath=%%~f"
            echo   –ò–º—è —Ñ–∞–π–ª–∞: !jsonname!
            echo   –ü–æ–ª–Ω—ã–π –ø—É—Ç—å: !jsonfullpath!
        )
        
        echo   –ü–µ—Ä–µ–º–µ—â–∞—é —Ñ–∞–π–ª –≤ –∞—Ä—Ö–∏–≤: !archivefolder!
        echo   –í—ã–ø–æ–ª–Ω—è—é –∫–æ–º–∞–Ω–¥—É: move /Y "%%f" "!archivefolder!\"
        
        REM –ü—Ä–æ–±—É–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π move
        move /Y "%%f" "!archivefolder!\" 2>&1
        set moveerror=!errorlevel!
        echo   –ö–æ–¥ –æ—à–∏–±–∫–∏ move: !moveerror!
        
        if !moveerror! equ 0 (
            if exist "!archivefolder!\!jsonname!" (
                set /a jsoncount+=1
                echo   ‚úÖ –£–°–ü–ï–•: –§–∞–π–ª –ø–µ—Ä–µ–º–µ—â–µ–Ω: !jsonname!
            ) else (
                echo   ‚ö†Ô∏è –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∞—Ä—Ö–∏–≤–µ –ø–æ—Å–ª–µ move
                set /a failedjson+=1
            )
        ) else (
            echo   ‚ö†Ô∏è Move –Ω–µ —É–¥–∞–ª—Å—è, –ø—Ä–æ–±—É—é –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ...
            copy /Y "%%f" "!archivefolder!\" 2>&1
            set copyerror=!errorlevel!
            
            if !copyerror! equ 0 (
                if exist "!archivefolder!\!jsonname!" (
                    echo   ‚úÖ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ, —É–¥–∞–ª—è—é –æ—Ä–∏–≥–∏–Ω–∞–ª...
                    timeout /t 2 /nobreak >nul 2>&1
                    del /F /Q "%%f" 2>&1
                    set delerror=!errorlevel!
                    
                    if !delerror! equ 0 (
                        set /a jsoncount+=1
                        echo   ‚úÖ –£–°–ü–ï–•: –§–∞–π–ª —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏ –æ—Ä–∏–≥–∏–Ω–∞–ª —É–¥–∞–ª–µ–Ω: !jsonname!
                    ) else (
                        echo   ‚ö†Ô∏è –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ, –Ω–æ –Ω–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –æ—Ä–∏–≥–∏–Ω–∞–ª
                        set /a jsoncount+=1
                    )
                ) else (
                    echo   ‚ùå –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å - —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∞—Ä—Ö–∏–≤–µ
                    set /a failedjson+=1
                )
            ) else (
                echo   ‚ùå –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å (–∫–æ–¥: !copyerror!)
                echo   –§–∞–π–ª –æ—Ç–∫—Ä—ã—Ç –≤ –¥—Ä—É–≥–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ
                set /a failedjson+=1
            )
        )
    ) else (
        echo   ‚ùå –§–∞–π–ª –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: %%f
        set /a failedjson+=1
    )
)

:skip_json
echo.
echo ====================================
echo –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ JSON —Ñ–∞–π–ª–æ–≤
echo ====================================
echo –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ JSON —Ñ–∞–π–ª–æ–≤: !json_processed!
echo –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ JSON —Ñ–∞–π–ª–æ–≤: !jsoncount!
echo –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å JSON: !failedjson!
echo.
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ë–∞—Ç–Ω–∏–∫ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç JSON —Ñ–∞–π–ª—ã –≤ –∞—Ä—Ö–∏–≤, –∏—Å–ø–æ–ª—å–∑—É—è —Ç—É –∂–µ –ª–æ–≥–∏–∫—É, —á—Ç–æ –∏ –¥–ª—è CSV —Ñ–∞–π–ª–æ–≤ (move ‚Üí copy + del).

---

### **3. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**

**–§–∞–π–ª:** `clean_logs.bat:642-647`

```batch
echo –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
echo   - –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ LOG —Ñ–∞–π–ª–æ–≤: !logcount!
echo   - –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ ZIP –∞—Ä—Ö–∏–≤–æ–≤: !zipcount!
echo   - –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ CSV —Ñ–∞–π–ª–æ–≤: !tradescount!
echo   - –ü–µ—Ä–µ–º–µ—â–µ–Ω–æ JSON —Ñ–∞–π–ª–æ–≤: !jsoncount!
echo   - –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å: !failedcount! LOG, !failedzip! ZIP, !failedtrades! CSV, !failedjson! JSON
echo.
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–Ω—ã—Ö JSON —Ñ–∞–π–ª–æ–≤.

---

### **4. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏**

**–§–∞–π–ª:** `clean_logs.bat:650-682`

```batch
REM –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å–¥–µ–ª–æ–∫
echo ====================================
echo –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤ —Å–¥–µ–ª–æ–∫:
echo ====================================
if exist "logs\trades_*.csv" (
    echo   ‚ö†Ô∏è –û–°–¢–ê–õ–ò–°–¨ CSV —Ñ–∞–π–ª—ã –≤ logs\:
    for %%f in ("logs\trades_*.csv") do (
        echo     - %%f
    )
    echo.
)

if exist "logs\trades_*.json" (
    echo   ‚ö†Ô∏è –û–°–¢–ê–õ–ò–°–¨ JSON —Ñ–∞–π–ª—ã –≤ logs\:
    for %%f in ("logs\trades_*.json") do (
        echo     - %%f
    )
    echo.
)

if exist "logs\trades_*.csv" (
    echo   üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: 
    echo     1. –ó–∞–∫—Ä–æ–π—Ç–µ CSV/JSON —Ñ–∞–π–ª—ã –≤ Excel, –±–ª–æ–∫–Ω–æ—Ç–µ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
    echo     2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –Ω–µ –ø–∏—à–µ—Ç –≤ —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫
    echo     3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–∞—Ç–Ω–∏–∫ —Å–Ω–æ–≤–∞
) else if exist "logs\trades_*.json" (
    echo   üí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø: 
    echo     1. –ó–∞–∫—Ä–æ–π—Ç–µ JSON —Ñ–∞–π–ª—ã –≤ –±–ª–æ–∫–Ω–æ—Ç–µ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
    echo     2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –Ω–µ –ø–∏—à–µ—Ç –≤ —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫
    echo     3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –±–∞—Ç–Ω–∏–∫ —Å–Ω–æ–≤–∞
) else (
    echo   ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫ (CSV + JSON) —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã!
)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∫ CSV, —Ç–∞–∫ –∏ JSON —Ñ–∞–π–ª—ã.

---

### **5. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è**

**–§–∞–π–ª:** `clean_logs.bat:692-703`

```batch
echo –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ CSV —Ñ–∞–π–ª–æ–≤: !csv_processed!
echo –£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–æ CSV: !tradescount!
echo –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å CSV: !failedtrades!
echo.
echo –û–±—Ä–∞–±–æ—Ç–∞–Ω–æ JSON —Ñ–∞–π–ª–æ–≤: !json_processed!
echo –£—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–º–µ—â–µ–Ω–æ JSON: !jsoncount!
echo –ù–µ —É–¥–∞–ª–æ—Å—å –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å JSON: !failedjson!
echo.
echo –ï—Å–ª–∏ —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫ (CSV/JSON) –Ω–µ –ø–µ—Ä–µ–º–µ—Å—Ç–∏–ª–∏—Å—å:
echo   1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª –∑–∞–∫—Ä—ã—Ç –≤ Excel, –±–ª–æ–∫–Ω–æ—Ç–µ –∏–ª–∏ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–≥—Ä–∞–º–º–∞—Ö
echo   2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –Ω–µ –∑–∞–ø—É—â–µ–Ω (–æ–Ω –º–æ–∂–µ—Ç –ø–∏—Å–∞—Ç—å –≤ —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫)
echo   3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª –≤—Ä—É—á–Ω—É—é –≤ –ø–∞–ø–∫—É –∞—Ä—Ö–∏–≤–∞
echo.
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –§–∏–Ω–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Ç–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç JSON —Ñ–∞–π–ª—ã.

---

## ‚úÖ –ò–¢–û–ì–û

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –±–∞—Ç–Ω–∏–∫ —Å–µ–π—á–∞—Å:**

1. ‚úÖ –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç –ª–æ–≥–∏ (`logs/futures/*.log`) –≤ –∞—Ä—Ö–∏–≤
2. ‚úÖ –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç ZIP –∞—Ä—Ö–∏–≤—ã (`logs/futures/*.zip`) –≤ –∞—Ä—Ö–∏–≤
3. ‚úÖ –ü–µ—Ä–µ–º–µ—â–∞–µ—Ç CSV —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫ (`logs/trades_*.csv`) –≤ –∞—Ä—Ö–∏–≤
4. ‚úÖ **–ü–µ—Ä–µ–º–µ—â–∞–µ—Ç JSON —Ñ–∞–π–ª—ã —Å–¥–µ–ª–æ–∫ (`logs/trades_*.json`) –≤ –∞—Ä—Ö–∏–≤** ‚Üê –ò–°–ü–†–ê–í–õ–ï–ù–û

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞—Ä—Ö–∏–≤–∞:**
```
logs/futures/archived/logs_YYYY-MM-DD_HH-MM-SS/
  ‚îú‚îÄ‚îÄ futures_main_YYYY-MM-DD.log
  ‚îú‚îÄ‚îÄ futures_main_YYYY-MM-DD.log.zip
  ‚îú‚îÄ‚îÄ trades_YYYY-MM-DD.csv      ‚Üê CSV —Ñ–∞–π–ª—ã
  ‚îî‚îÄ‚îÄ trades_YYYY-MM-DD.json     ‚Üê JSON —Ñ–∞–π–ª—ã ‚Üê –î–û–ë–ê–í–õ–ï–ù–û
```

---

## üß™ –ü–†–û–í–ï–†–ö–ê

**–¢–µ–∫—É—â–∏–µ —Ñ–∞–π–ª—ã:**
```
CSV —Ñ–∞–π–ª—ã: 1 - ['trades_2025-11-16.csv']
JSON —Ñ–∞–π–ª—ã: 1 - ['trades_2025-11-16.json']
```

**–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `clean_logs.bat`:**
- ‚úÖ –û–±–∞ —Ñ–∞–π–ª–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ –∞—Ä—Ö–∏–≤
- ‚úÖ –í –ø–∞–ø–∫–µ `logs/` –Ω–µ –¥–æ–ª–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è –Ω–∏ CSV, –Ω–∏ JSON —Ñ–∞–π–ª–æ–≤

---

**–î–∞—Ç–∞:** 2025-11-16  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

