# üîç –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú –î–û–õ–ì–û–ì–û –£–î–ï–†–ñ–ê–ù–ò–Ø –ü–û–ó–ò–¶–ò–ô

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-28  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ—á—Ç–∏ —Å—Ä–∞–∑—É, –¥—Ä—É–≥–∏–µ –≤–∏—Å—è—Ç –ø–æ 3+ —á–∞—Å–∞ –ø—Ä–∏ MIN_HOLDING=35 –º–∏–Ω—É—Ç

---

## üìä –ê–ù–ê–õ–ò–ó –ó–ê–ö–†–´–¢–´–• –ü–û–ó–ò–¶–ò–ô

### –ó–∞–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞ –Ω–æ—á—å:

1. **BTC-USDT SHORT**
   - **–û—Ç–∫—Ä—ã—Ç–∞:** 27.11.2025 22:53:40
   - **–ó–∞–∫—Ä—ã—Ç–∞:** 28.11.2025 05:13:38
   - **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 379.96 –º–∏–Ω—É—Ç (6.3 —á–∞—Å–∞!) ‚ö†Ô∏è
   - **Net PnL:** +$1.94
   - **–ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è:** tp (take profit)
   - **MIN_HOLDING:** 35 –º–∏–Ω—É—Ç
   - **TIMEOUT:** 120 –º–∏–Ω—É—Ç (2 —á–∞—Å–∞)

2. **DOGE-USDT SHORT**
   - **–û—Ç–∫—Ä—ã—Ç–∞:** 00:35:52 (28.11)
   - **–ó–∞–∫—Ä—ã—Ç–∞:** 05:21:48 (28.11)
   - **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 70.40 –º–∏–Ω—É—Ç ‚úÖ
   - **Net PnL:** +$1.25
   - **–ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è:** tp
   - **MIN_HOLDING:** 35 –º–∏–Ω—É—Ç

3. **DOGE-USDT SHORT**
   - **–û—Ç–∫—Ä—ã—Ç–∞:** 05:23:27 (28.11)
   - **–ó–∞–∫—Ä—ã—Ç–∞:** 05:55:29 (28.11)
   - **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 32.27 –º–∏–Ω—É—Ç ‚úÖ
   - **Net PnL:** +$2.48
   - **–ü—Ä–∏—á–∏–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è:** tp
   - **MIN_HOLDING:** 35 –º–∏–Ω—É—Ç

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê #1: BTC-USDT –¥–µ—Ä–∂–∞–ª–∞—Å—å 6.3 —á–∞—Å–∞ –≤–º–µ—Å—Ç–æ 2 —á–∞—Å–æ–≤ –º–∞–∫—Å–∏–º—É–º

### –î–µ—Ç–∞–ª–∏:
- **TIMEOUT = 120 –º–∏–Ω—É—Ç (2 —á–∞—Å–∞)** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
- **–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è = 379.96 –º–∏–Ω—É—Ç (6.3 —á–∞—Å–∞)**
- **–ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –≤ 3.2 —Ä–∞–∑–∞!** ‚ùå

### –ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ:

–õ–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –≤ `orchestrator.py` (—Å—Ç—Ä–æ–∫–∏ 3371-3389):

```python
# ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï #6: –ü—Ä–æ–≤–µ—Ä—è–µ–º min_profit_to_close –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
# –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –µ—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏ > min_profit_to_close
min_profit_to_close = None
tsl = self.trailing_sl_coordinator.get_tsl(symbol)
if tsl:
    min_profit_to_close = getattr(tsl, "min_profit_to_close", None)

if (
    min_profit_to_close is not None
    and profit_pct > min_profit_to_close
):
    # –ü–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏ –ø—Ä–µ–≤—ã—à–∞–µ—Ç min_profit_to_close - –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏
    logger.info(
        f"‚è∞ –ü–æ–∑–∏—Ü–∏—è {symbol} —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è {time_held:.1f} –º–∏–Ω—É—Ç "
        f"(–ª–∏–º–∏—Ç: {actual_max_holding:.1f} –º–∏–Ω—É—Ç), "
        f"–Ω–æ –ø—Ä–∏–±—ã–ª—å {profit_pct:.2%} > min_profit_to_close {min_profit_to_close:.2%}, "
        f"–ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–¥–∞–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–ª—è —Ä–æ—Å—Ç–∞ –ø—Ä–∏–±—ã–ª–∏)"
    )
    return  # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º, –¥–∞–µ–º –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ `min_profit_to_close` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.1%), –∏ –ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏ –¥–∞–∂–µ 0.5%, –æ–Ω–∞ **–ù–ò–ö–û–ì–î–ê –Ω–µ –∑–∞–∫—Ä–æ–µ—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏**
- TIMEOUT=120 –º–∏–Ω—É—Ç **–ò–ì–ù–û–†–ò–†–£–ï–¢–°–Ø**, –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > min_profit_to_close
- –≠—Ç–æ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç —Å–∫–∞–ª—å–ø–∏–Ω–≥ –≤ —Å–≤–∏–Ω–≥-—Ç–æ—Ä–≥–æ–≤–ª—é!

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê #2: –ü–æ–∑–∏—Ü–∏–∏ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –ø—Ä–∏–±—ã–ª—å—é –¥–µ—Ä–∂–∞—Ç—Å—è —Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ

### –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ (—Å—Ç—Ä–æ–∫–∏ 3348-3369):

```python
# –ï—Å–ª–∏ –≤—Ä–µ–º—è –º–æ–∂–Ω–æ –ø—Ä–æ–¥–ª–∏—Ç—å –∏ –ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏
if (
    extend_time_if_profitable
    and not time_extended
    and profit_pct > min_profit_for_extension  # 0.1% –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
):
    # –ü—Ä–æ–¥–ª–µ–≤–∞–µ–º –≤—Ä–µ–º—è –Ω–∞ 50% –æ—Ç –∏—Å—Ö–æ–¥–Ω–æ–≥–æ
    extension_minutes = original_max_holding * (extension_percent / 100.0)
    new_max_holding = original_max_holding + extension_minutes
    # 35 –º–∏–Ω—É—Ç + 17.5 –º–∏–Ω—É—Ç = 52.5 –º–∏–Ω—É—Ç
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∏–±—ã–ª–∏ > 0.1%, –≤—Ä–µ–º—è –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç—Å—è —Å 35 –¥–æ 52.5 –º–∏–Ω—É—Ç
- –ù–æ –ø–æ—Å–ª–µ –ø—Ä–æ–¥–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > min_profit_to_close, –ø–æ–∑–∏—Ü–∏—è –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ –∑–∞–∫—Ä–æ–µ—Ç—Å—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏
- –ü–æ–∑–∏—Ü–∏–∏ —Å –ø—Ä–∏–±—ã–ª—å—é 0.2-0.5% –º–æ–≥—É—Ç –≤–∏—Å–µ—Ç—å —á–∞—Å–∞–º–∏, –æ–∂–∏–¥–∞—è TP

---

## üî¥ –ü–†–û–ë–õ–ï–ú–ê #3: –ù–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ—Å–ª–µ TIMEOUT

### –¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:
1. ‚ùå –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —É–±—ã—Ç–æ—á–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (—Å—Ç—Ä–æ–∫–∞ 3393-3400)
2. ‚ùå –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å –ø—Ä–∏–±—ã–ª—å—é > min_profit_to_close –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (—Å—Ç—Ä–æ–∫–∞ 3378-3389)
3. ‚úÖ –ó–∞–∫—Ä—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–æ–∑–∏—Ü–∏–∏ —Å –ø—Ä–∏–±—ã–ª—å—é 0 < profit < min_profit_to_close (—Å—Ç—Ä–æ–∫–∞ 3402-3408)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–∑–∏—Ü–∏–∏ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –ø—Ä–∏–±—ã–ª—å—é (0.1-0.5%) –¥–µ—Ä–∂–∞—Ç—Å—è –¥–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è TP –∏–ª–∏ trailing stop
- TIMEOUT –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏
- –≠—Ç–æ –Ω–µ —Å–∫–∞–ª—å–ø–∏–Ω–≥!

---

## üí° –†–ï–®–ï–ù–ò–ï

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏:

1. **TIMEOUT –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∂–µ—Å—Ç–∫–∏–º –ª–∏–º–∏—Ç–æ–º:**
   - –ü–æ—Å–ª–µ TIMEOUT –ø–æ–∑–∏—Ü–∏—è –î–û–õ–ñ–ù–ê –∑–∞–∫—Ä—ã—Ç—å—Å—è, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–∏–±—ã–ª–∏ (–∫—Ä–æ–º–µ —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤)
   - min_profit_to_close –¥–æ–ª–∂–µ–Ω –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –¥–æ TIMEOUT

2. **MIN_HOLDING vs TIMEOUT:**
   - **MIN_HOLDING (35 –º–∏–Ω):** –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è (–∑–∞—â–∏—Ç–∞ –æ—Ç —à—É–º–∞)
   - **TIMEOUT (120 –º–∏–Ω):** –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è (–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ)
   - –ü–æ—Å–ª–µ TIMEOUT –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è **–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ**, –¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > min_profit_to_close

3. **–õ–æ–≥–∏–∫–∞ –ø—Ä–æ–¥–ª–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏:**
   - –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ –¥–æ TIMEOUT
   - –ü–æ—Å–ª–µ TIMEOUT –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –ù–ï –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è

### –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞:

```python
# –ü–æ—Å–ª–µ TIMEOUT - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ
if time_held >= timeout_minutes:
    logger.info(
        f"‚è∞ TIMEOUT –¥–ª—è {symbol}: {time_held:.1f} –º–∏–Ω—É—Ç >= {timeout_minutes:.1f} –º–∏–Ω—É—Ç, "
        f"–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º (–ø—Ä–∏–±—ã–ª—å: {profit_pct:.2%})"
    )
    await self._close_position(symbol, "timeout")
    return

# –ü—Ä–æ–≤–µ—Ä–∫–∞ MIN_HOLDING (—Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TP/SL)
if time_held < min_holding_minutes:
    # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω—å—à–µ MIN_HOLDING (–∫—Ä–æ–º–µ emergency)
    return

# –ü—Ä–æ–≤–µ—Ä–∫–∞ max_holding —Å –ø—Ä–æ–¥–ª–µ–Ω–∏–µ–º (—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ TIMEOUT)
if time_held >= actual_max_holding:
    # –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—â–µ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç TIMEOUT)
    if extend_time_if_profitable and profit_pct > min_profit_for_extension:
        # –ü—Ä–æ–¥–ª–µ–≤–∞–µ–º...
        pass
    else:
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ max_holding (–Ω–æ –Ω–µ –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > min_profit_to_close –∏ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç TIMEOUT)
        if profit_pct > min_profit_to_close:
            # –î–∞–µ–º –µ—â–µ –≤—Ä–µ–º—è –¥–æ TIMEOUT
            pass
        else:
            # –ó–∞–∫—Ä—ã–≤–∞–µ–º
            await self._close_position(symbol, "max_holding_time")
```

---

## üìã –°–¢–ê–¢–ò–°–¢–ò–ö–ê

- **–í—Å–µ–≥–æ –∑–∞–∫—Ä—ã—Ç–æ –ø–æ–∑–∏—Ü–∏–π:** 3
- **–° –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –≤—Ä–µ–º–µ–Ω–µ–º (30-70 –º–∏–Ω):** 2 ‚úÖ
- **–° –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ–º TIMEOUT:** 1 ‚ùå (BTC-USDT, 6.3 —á–∞—Å–∞ –≤–º–µ—Å—Ç–æ 2 —á–∞—Å–æ–≤)

---

## ‚úÖ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ TIMEOUT:**
   - TIMEOUT –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–∞–±—Å–æ–ª—é—Ç–Ω—ã–º** –ª–∏–º–∏—Ç–æ–º
   - –ü–æ—Å–ª–µ TIMEOUT –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ

2. **–£—Ç–æ—á–Ω–∏—Ç—å min_profit_to_close:**
   - –ï—Å–ª–∏ —ç—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ trailing stop, –æ–Ω –Ω–µ –¥–æ–ª–∂–µ–Ω –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TIMEOUT
   - –ü–æ—Å–ª–µ TIMEOUT –ø–æ–∑–∏—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∑–∞–∫—Ä—ã—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç min_profit_to_close

3. **–†–∞–∑–¥–µ–ª–∏—Ç—å –ª–æ–≥–∏–∫—É:**
   - MIN_HOLDING - –∑–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
   - TIMEOUT - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
   - max_holding - –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–π –ª–∏–º–∏—Ç —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –ø—Ä–æ–¥–ª–µ–Ω–∏—è

---

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–ò–ú–ï–ù–ï–ù–û

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2025-11-28

### –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:

1. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ TIMEOUT –ü–ï–†–ï–î –≤—Å–µ–º–∏ –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏**

   **–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`
   
   **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** TIMEOUT —Ç–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–ï–†–í–´–ú –¥–µ–ª–æ–º, –¥–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –≤—Ä–µ–º–µ–Ω–∏. –ü–æ—Å–ª–µ TIMEOUT –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–∏–±—ã–ª–∏ –∏–ª–∏ min_profit_to_close.

   **–ö–æ–¥:**
   ```python
   # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: TIMEOUT - –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏
   # –ü–æ–ª—É—á–∞–µ–º timeout_minutes –∏–∑ TSL (–∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏) –ü–ï–†–ï–î –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
   timeout_minutes = None
   tsl = self.trailing_sl_coordinator.get_tsl(symbol)
   if tsl and hasattr(tsl, "timeout_minutes"):
       timeout_minutes = tsl.timeout_minutes

   # ‚úÖ –ü–ï–†–í–ê–Ø –ü–†–û–í–ï–†–ö–ê: TIMEOUT - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Å–ª–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
   if timeout_minutes is not None and time_held >= timeout_minutes:
       logger.info(
           f"‚è∞ TIMEOUT –¥–ª—è {symbol}: {time_held:.1f} –º–∏–Ω—É—Ç >= {timeout_minutes:.1f} –º–∏–Ω—É—Ç, "
           f"–ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ–º (–ø—Ä–∏–±—ã–ª—å: {profit_pct:.2%})"
       )
       await self._close_position(symbol, "timeout")
       return
   ```

2. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ TIMEOUT'–æ–º**

   **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ (extend_time_if_profitable) —Ç–µ–ø–µ—Ä—å –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—Å–∏—Ç—å TIMEOUT.

   **–ö–æ–¥:**
   ```python
   new_max_holding = original_max_holding + extension_minutes
   
   # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–µ–≤—ã—à–∞—Ç—å TIMEOUT
   if timeout_minutes is not None and new_max_holding > timeout_minutes:
       new_max_holding = timeout_minutes
   ```

3. **–£—Ç–æ—á–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ min_profit_to_close**

   **–ò–∑–º–µ–Ω–µ–Ω–∏–µ:** min_profit_to_close –±–æ–ª—å—à–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TIMEOUT. –ü–æ–∑–∏—Ü–∏—è —Å –ø—Ä–∏–±—ã–ª—å—é > min_profit_to_close –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ max_holding, –Ω–æ TIMEOUT –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞–∫—Ä–æ–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ.

   **–ö–æ–¥:**
   ```python
   # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ max_holding –µ—Å–ª–∏ –ø—Ä–∏–±—ã–ª—å > min_profit_to_close,
   # –ù–û —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—â–µ –Ω–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç TIMEOUT (TIMEOUT –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤—ã—à–µ –∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç)
   logger.info(
       f"‚è∞ –ü–æ–∑–∏—Ü–∏—è {symbol} —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è {time_held:.1f} –º–∏–Ω—É—Ç "
       f"(–ª–∏–º–∏—Ç: {actual_max_holding:.1f} –º–∏–Ω—É—Ç), "
       f"–ø—Ä–∏–±—ã–ª—å {profit_pct:.2%} > min_profit_to_close {min_profit_to_close:.2%}, "
       f"–Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ max_holding (–∂–¥–µ–º TIMEOUT={timeout_minutes:.1f} –º–∏–Ω –∏–ª–∏ TP/SL)"
   )
   ```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

- **TIMEOUT = 120 –º–∏–Ω—É—Ç** —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ **–∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç**
- –ü–æ–∑–∏—Ü–∏–∏ –±–æ–ª—å—à–µ –Ω–µ –±—É–¥—É—Ç –¥–µ—Ä–∂–∞—Ç—å—Å—è –¥–æ–ª—å—à–µ TIMEOUT
- –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ TIMEOUT'–æ–º
- min_profit_to_close –±–æ–ª—å—à–µ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ TIMEOUT

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞:

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞:
1. –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ 120 –º–∏–Ω—É—Ç (TIMEOUT)
2. –ù–µ –±—É–¥–µ—Ç –ø—Ä–µ–≤—ã—à–µ–Ω–∏–π TIMEOUT –≤ 3+ —Ä–∞–∑–∞
3. –ü–æ–∑–∏—Ü–∏–∏ —Å –º–∞–ª–µ–Ω—å–∫–æ–π –ø—Ä–∏–±—ã–ª—å—é –Ω–µ –±—É–¥—É—Ç –≤–∏—Å–µ—Ç—å —á–∞—Å–∞–º–∏

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é.**

---

## ‚ö†Ô∏è –í–ê–ñ–ù–û: –£—Ç–æ—á–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∫–∞–∑–∞–ª:
1. **MIN_HOLDING = 35 –º–∏–Ω—É—Ç** - —ç—Ç–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è (–∑–∞—â–∏—Ç–∞ –æ—Ç —à—É–º–∞), –ù–ï TIMEOUT!
2. **TIMEOUT = 120 –º–∏–Ω—É—Ç** - —ç—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è
3. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è **–±—ã—Å—Ç—Ä–æ** (–ø–æ—á—Ç–∏ —Å—Ä–∞–∑—É) - —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ (TP, profit harvest)
4. –ü—Ä–æ–±–ª–µ–º–∞ —Ç–æ–ª—å–∫–æ —Å –ø–æ–∑–∏—Ü–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ—Ä–∂–∞—Ç—Å—è **—Å–ª–∏—à–∫–æ–º –¥–æ–ª–≥–æ** (>120 –º–∏–Ω—É—Ç)

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
- MIN_HOLDING –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è (—à—É–º —Ä—ã–Ω–∫–∞) - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ 35 –º–∏–Ω—É—Ç
- TIMEOUT –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ—Å–ª–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ - —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ—Å–ª–µ 120 –º–∏–Ω—É—Ç
- –ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ (TP, profit harvest, trailing stop) –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤—Ä–µ–º–µ–Ω–∏

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- TIMEOUT –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ü–ï–†–í–´–ú –¥–µ–ª–æ–º, –¥–æ –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
- TIMEOUT –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø–æ—Å–ª–µ 120 –º–∏–Ω—É—Ç, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –ø—Ä–∏–±—ã–ª–∏
- –≠—Ç–æ –ù–ï –º–µ—à–∞–µ—Ç –±—ã—Å—Ç—Ä–æ–º—É –∑–∞–∫—Ä—ã—Ç–∏—é, —Ç–∞–∫ –∫–∞–∫ TP/profit harvest –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è —Ä–∞–Ω—å—à–µ
- –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ TIMEOUT'–æ–º (–Ω–µ –º–æ–∂–µ—Ç –ø—Ä–µ–≤—ã—Å–∏—Ç—å 120 –º–∏–Ω—É—Ç)

