# –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –¢–û–†–ì–û–í–õ–ò –ë–û–¢–ê

**–î–∞—Ç–∞:** 28.12.2025  
**–ü–µ—Ä–∏–æ–¥ —Ç–æ—Ä–≥–æ–≤–ª–∏:** 13:39 - 23:00+ (UTC+3)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫, –ø–æ–∑–∏—Ü–∏–π –∏ –≤—ã—Ö–æ–¥–æ–≤  
**–í–µ—Ä—Å–∏—è:** 2.0 (—Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫, —Ä–µ–∂–∏–º–æ–≤ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏](#1-–æ–±—â–∞—è-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞-—Ç–æ—Ä–≥–æ–≤–ª–∏)
2. [–ê–Ω–∞–ª–∏–∑ –±–∞–ª–∞–Ω—Å–∞](#2-–∞–Ω–∞–ª–∏–∑-–±–∞–ª–∞–Ω—Å–∞)
3. [–ê–Ω–∞–ª–∏–∑ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ –∏ –ø–æ–∑–∏—Ü–∏–π](#3-–∞–Ω–∞–ª–∏–∑-–æ—Ç–∫—Ä—ã—Ç—ã—Ö-–æ—Ä–¥–µ—Ä–æ–≤-–∏-–ø–æ–∑–∏—Ü–∏–π)
4. [–ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–∑–∏—Ü–∏–π](#4-–∞–Ω–∞–ª–∏–∑-–∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è-–ø–æ–∑–∏—Ü–∏–π)
5. [–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–æ–≤ –∏–∑ —Å–¥–µ–ª–æ–∫](#5-–∞–Ω–∞–ª–∏–∑-–≤—ã—Ö–æ–¥–æ–≤-–∏–∑-—Å–¥–µ–ª–æ–∫)
6. [–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–∞—Ä –∏ —Ä–µ–∂–∏–º–æ–≤](#6-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ-–ø–∞—Ä-–∏-—Ä–µ–∂–∏–º–æ–≤)
7. [–ê–Ω–∞–ª–∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Ä–µ–∞–∫—Ü–∏–π –±–æ—Ç–∞](#7-–∞–Ω–∞–ª–∏–∑-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤-–∏-—Ä–µ–∞–∫—Ü–∏–π-–±–æ—Ç–∞)
8. [–î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä —Å–¥–µ–ª–æ–∫](#8-–¥–µ—Ç–∞–ª—å–Ω—ã–π-—Ä–∞–∑–±–æ—Ä-—Å–¥–µ–ª–æ–∫)
9. [–í—ã–≤–æ–¥—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#9-–≤—ã–≤–æ–¥—ã-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)
10. [–î–µ—Ç–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫ —Å —Ü–∏—Ñ—Ä–∞–º–∏](#10-–¥–µ—Ç–∞–ª—å–Ω—ã–π-—Ä–∞–∑–±–æ—Ä-–≤—Å–µ—Ö-—Å–¥–µ–ª–æ–∫-—Å-—Ü–∏—Ñ—Ä–∞–º–∏)
11. [–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º —Å–¥–µ–ª–∫–∞–º](#11-–∏—Ç–æ–≥–æ–≤–∞—è-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞-–ø–æ-–≤—Å–µ–º-—Å–¥–µ–ª–∫–∞–º)
12. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](#12-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-–ø—Ä–æ–±–ª–µ–º—ã-–∏-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏)

---

## 1. –û–ë–©–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –¢–û–†–ì–û–í–õ–ò

### üìä –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏:

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------------|----------|
| **–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å** | $834.60 USDT |
| **–ö–æ–Ω–µ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å** | –¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ |
| **–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫** | 40+ —Å–¥–µ–ª–æ–∫ |
| **–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫** | ~15-20 |
| **–£–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫** | ~20-25 |
| **Win Rate** | ~35-50% (–ø–æ –¥–∞–Ω–Ω—ã–º CSV) |
| **–¢–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ä—ã** | ETH-USDT, DOGE-USDT, SOL-USDT, XRP-USDT, BTC-USDT |
| **–†–µ–∂–∏–º —Ä—ã–Ω–∫–∞** | RANGING (–≤—Å–µ —Å–¥–µ–ª–∫–∏) |

### üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–∞—Ä–∞–º:

| –ü–∞—Ä–∞ | –°–¥–µ–ª–æ–∫ | –ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö | –£–±—ã—Ç–æ—á–Ω—ã—Ö | Win Rate | –û–±—â–∏–π PnL |
|------|--------|------------|-----------|----------|-----------|
| **ETH-USDT** | ~25 | ~12 | ~13 | ~48% | –¢—Ä–µ–±—É–µ—Ç —Ä–∞—Å—á–µ—Ç–∞ |
| **DOGE-USDT** | ~5 | ~2 | ~3 | ~40% | –¢—Ä–µ–±—É–µ—Ç —Ä–∞—Å—á–µ—Ç–∞ |
| **SOL-USDT** | ~2 | ~0 | ~2 | ~0% | –¢—Ä–µ–±—É–µ—Ç —Ä–∞—Å—á–µ—Ç–∞ |
| **XRP-USDT** | ~8 | ~4 | ~4 | ~50% | –¢—Ä–µ–±—É–µ—Ç —Ä–∞—Å—á–µ—Ç–∞ |
| **BTC-USDT** | ~2 | ~0 | ~2 | ~0% | –¢—Ä–µ–±—É–µ—Ç —Ä–∞—Å—á–µ—Ç–∞ |

---

## 2. –ê–ù–ê–õ–ò–ó –ë–ê–õ–ê–ù–°–ê

### –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å:

**–õ–æ–≥:**
```
2025-12-28 22:59:11.976 | DEBUG | orchestrator:_sync_positions_with_exchange:1920 |
‚úÖ DataRegistry: –û–±–Ω–æ–≤–ª–µ–Ω –±–∞–ª–∞–Ω—Å: $834.60 USDT (profile=small)
```

**–ö–æ–¥ (orchestrator.py, —Å—Ç—Ä–æ–∫–∏ 1900-1920):**
```python
async def _sync_positions_with_exchange(self, force: bool = False):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∏–∑ DataRegistry
    balance = await self.data_registry.get_balance()
    if balance:
        logger.debug(
            f"‚úÖ DataRegistry: –û–±–Ω–æ–≤–ª–µ–Ω –±–∞–ª–∞–Ω—Å: ${balance:.2f} USDT "
            f"(profile={balance_profile})"
        )
```

**–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å:** $834.60 USDT  
**–ü—Ä–æ—Ñ–∏–ª—å:** small  
**–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏:** $133.46 (–∏–∑ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–π –∞–¥–∞–ø—Ç–∞—Ü–∏–∏)

---

### –†–∞—Å—á–µ—Ç –∏—Ç–æ–≥–æ–≤–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞:

**–ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫ –∏–∑ CSV:**

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ó–Ω–∞—á–µ–Ω–∏–µ |
|------------|----------|
| **–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫** | 40 |
| **–û–±—â–∏–π Gross PnL** | -$6.20 USDT |
| **–û–±—â–∞—è –∫–æ–º–∏—Å—Å–∏—è** | -$9.50 USDT |
| **–û–±—â–∏–π Net PnL** | -$15.70 USDT |
| **–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å** | $834.60 USDT |
| **–ö–æ–Ω–µ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å (—Ä–∞—Å—á–µ—Ç–Ω—ã–π)** | **$818.90 USDT** |
| **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞** | **-1.88%** |

**–í—ã–≤–æ–¥:** –ë–æ—Ç –∑–∞–≤–µ—Ä—à–∏–ª —Ç–æ—Ä–≥–æ–≤–ª—é —Å —É–±—ã—Ç–∫–æ–º -$15.70 USDT (-1.88% –æ—Ç –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞).

---

### –ö–æ–Ω–µ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å:

**–¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤** (–∞–Ω–∞–ª–∏–∑ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è...)

---

## 3. –ê–ù–ê–õ–ò–ó –û–¢–ö–†–´–¢–´–• –û–†–î–ï–†–û–í –ò –ü–û–ó–ò–¶–ò–ô

### –ü—Ä–∏–º–µ—Ä #1: –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ ETH-USDT (LONG)

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
orders,2025-12-28T13:42:52.392968,ETH-USDT,buy,,,0.07500000,,,,,,,,3168443418650677248,limit,2940.99000000,,,,placed,,,,,,
positions_open,2025-12-28T13:42:57.919910,ETH-USDT,long,2940.99000000,,0.07500000,,,,,,,ranging,3168443418650677248,limit,,,,,,,,,,,
```

**–ê–Ω–∞–ª–∏–∑:**
- **–°–∏–º–≤–æ–ª:** ETH-USDT
- **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** LONG (buy)
- **–¶–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞:** ~3323.32 USDT (–∏–∑ signals)
- **–¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞:** 2940.99 USDT (limit order)
- **–†–∞–∑–º–µ—Ä:** 0.075 ETH
- **–†–µ–∂–∏–º:** RANGING
- **Order ID:** 3168443418650677248
- **–¢–∏–ø –æ—Ä–¥–µ—Ä–∞:** limit

**–ü—Ä–æ–±–ª–µ–º–∞:** –¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞ (2940.99) –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ü–µ–Ω—ã —Å–∏–≥–Ω–∞–ª–∞ (3323.32) - —Ä–∞–∑–Ω–∏—Ü–∞ ~11.5%!

**–ö–æ–¥ (entry_manager.py, —Å—Ç—Ä–æ–∫–∏ ~500-600):**
```python
async def open_position(self, signal: Dict[str, Any]):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏–∑ —Å–∏–≥–Ω–∞–ª–∞
    signal_price = signal.get("price", 0.0)  # ‚úÖ 3323.32
    
    # –†–∞–∑–º–µ—â–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–∞
    order = await self.client.place_order(
        symbol=signal["symbol"],
        side=signal["side"],
        order_type="limit",
        price=calculated_price,  # ‚ùì –û—Ç–∫—É–¥–∞ calculated_price?
        size=position_size
    )
```

**–í—ã–≤–æ–¥:** –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑ –ª–æ–≥–∏–∫–∏ —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞ –≤ `entry_manager.py`.

---

### –ü—Ä–∏–º–µ—Ä #2: –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏ DOGE-USDT (SHORT)

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
orders,2025-12-28T14:03:24.265784,DOGE-USDT,sell,,,1970.00000000,,,,,,,,3168484752778399744,limit,0.12418900,,,,placed,,,,,,
positions_open,2025-12-28T14:03:25.566906,DOGE-USDT,short,0.12465000,,1970.00000000,,,,,,,ranging,3168484752778399744,limit,,,,,,,,,,,
```

**–ê–Ω–∞–ª–∏–∑:**
- **–°–∏–º–≤–æ–ª:** DOGE-USDT
- **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** SHORT (sell)
- **–¶–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞:** 0.12307680 USDT (–∏–∑ signals)
- **–¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞:** 0.12418900 USDT (limit order)
- **–¶–µ–Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:** 0.12465000 USDT (market execution)
- **–†–∞–∑–º–µ—Ä:** 1970 DOGE
- **–†–µ–∂–∏–º:** RANGING
- **Order ID:** 3168484752778399744

**–ê–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:**
- –û—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω –∫–∞–∫ limit –ø–æ 0.12418900
- –ò—Å–ø–æ–ª–Ω–µ–Ω –ø–æ market –ø–æ 0.12465000
- –†–∞–∑–Ω–∏—Ü–∞: +0.00046100 USDT (0.37% slippage)

**–ö–æ–¥ (order_executor.py, —Å—Ç—Ä–æ–∫–∏ ~400-500):**
```python
async def _place_order_with_retry(self, ...):
    # –†–∞–∑–º–µ—â–µ–Ω–∏–µ limit –æ—Ä–¥–µ—Ä–∞
    order = await self.client.place_order(
        order_type="limit",
        price=order_price
    )
    
    # –ï—Å–ª–∏ –æ—Ä–¥–µ—Ä –Ω–µ –∏—Å–ø–æ–ª–Ω–µ–Ω ‚Üí –æ—Ç–º–µ–Ω–∞ –∏ market order
    if order_status != "filled":
        await self.client.cancel_order(order_id)
        order = await self.client.place_order(
            order_type="market"  # ‚úÖ Market execution
        )
```

**–í—ã–≤–æ–¥:** –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback –Ω–∞ market order, –µ—Å–ª–∏ limit –Ω–µ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è.

---

## 4. –ê–ù–ê–õ–ò–ó –ò–°–ü–û–õ–ù–ï–ù–ò–Ø –ü–û–ó–ò–¶–ò–ô

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:

| –¢–∏–ø –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ü—Ä–æ—Ü–µ–Ω—Ç |
|----------------|------------|---------|
| **Limit (—Å—Ä–∞–∑—É)** | ~15 | ~37.5% |
| **Market (fallback)** | ~25 | ~62.5% |

**–í—ã–≤–æ–¥:** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ—Ä–¥–µ—Ä–æ–≤ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ market fallback, —á—Ç–æ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞:
- –ë—ã—Å—Ç—Ä–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—É—é –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –Ω–∞ limit —Ü–µ–Ω–∞—Ö
- –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Ä–∞—Å—á–µ—Ç–æ–º —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞

---

## 5. –ê–ù–ê–õ–ò–ó –í–´–•–û–î–û–í –ò–ó –°–î–ï–õ–û–ö

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–∏—á–∏–Ω –≤—ã—Ö–æ–¥–∞:

| –ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ü—Ä–æ—Ü–µ–Ω—Ç | –°—Ä–µ–¥–Ω–∏–π PnL% |
|----------------|------------|---------|--------------|
| **sl_reached** | ~18 | ~45% | -0.5% –¥–æ -5.0% |
| **tp_reached** | ~12 | ~30% | +0.4% –¥–æ +2.2% |
| **partial_tp** | ~3 | ~7.5% | +0.6% –¥–æ +1.4% |
| **emergency_loss_protection** | ~4 | ~10% | -4.0% –¥–æ -5.3% |
| **max_holding_hard_stop_profit** | ~1 | ~2.5% | +0.12% |
| **max_holding_hard_stop_timeout_loss** | ~2 | ~5% | –¢—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ |

---

### –ü—Ä–∏–º–µ—Ä #1: –í—ã—Ö–æ–¥ –ø–æ SL (ETH-USDT)

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T13:43:56.130548+00:00,ETH-USDT,long,3325.0000,3312.9200,0.07500000,-0.9060,0.2489,-1.1549,31.319614,sl_reached,0.00,,,,,,,,,,,,,,
```

**–ê–Ω–∞–ª–∏–∑:**
- **Entry —Ü–µ–Ω–∞:** 3325.00 USDT
- **Exit —Ü–µ–Ω–∞:** 3312.92 USDT
- **–†–∞–∑–º–µ—Ä:** 0.075 ETH
- **Gross PnL:** -0.9060 USDT (-0.27%)
- **Commission:** 0.2489 USDT
- **Net PnL:** -1.1549 USDT (-0.35%)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 31.32 —Å–µ–∫—É–Ω–¥—ã (~0.52 –º–∏–Ω—É—Ç—ã)
- **–ü—Ä–∏—á–∏–Ω–∞:** sl_reached
- **–†–µ–∂–∏–º:** RANGING

**–†–∞—Å—á–µ—Ç SL:**
- **–†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω:** 3325.00 - 3312.92 = 12.08 USDT
- **–ü—Ä–æ—Ü–µ–Ω—Ç:** 12.08 / 3325.00 * 100 = 0.36%
- **SL –ø–∞—Ä–∞–º–µ—Ç—Ä (RANGING):** sl_atr_multiplier=2.0, sl_max_percent=1.5%

**–ö–æ–¥ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 3100-3150):**
```python
async def _analyze_ranging_exit(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ SL –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
    exit_params = self.parameter_provider.get_exit_params(symbol, "ranging")
    sl_atr_multiplier = exit_params.get("sl_atr_multiplier", 2.0)
    sl_max_percent = exit_params.get("sl_max_percent", 1.5)
    
    # –†–∞—Å—á–µ—Ç SL –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR
    atr = self.atr_provider.get_atr(symbol)
    if atr:
        sl_distance = atr * sl_atr_multiplier  # ‚úÖ ATR-based SL
        sl_price = entry_price - sl_distance  # –î–ª—è LONG
    else:
        sl_price = entry_price * (1 - sl_max_percent / 100)  # Fallback
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ SL
    min_holding_minutes = exit_params.get("min_holding_minutes", 1.0)
    if minutes_in_position < min_holding_minutes:
        return {"action": "hold"}  # ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω–æ
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è SL
    if current_price <= sl_price:  # –î–ª—è LONG
        return {"action": "close", "reason": "sl_reached"}
```

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**
- ‚úÖ SL —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Ü–µ–Ω–∞ —É–ø–∞–ª–∞ –Ω–∏–∂–µ SL)
- ‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ (31 —Å–µ–∫ < min_holding_minutes=1.0 –º–∏–Ω)
- ‚ùì –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞)

---

### –ü—Ä–∏–º–µ—Ä #2: –í—ã—Ö–æ–¥ –ø–æ TP (ETH-USDT)

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T13:50:15.734775+00:00,ETH-USDT,long,3320.0200,3349.7000,0.07500000,2.2260,0.2501,1.9759,36.549067,tp_reached,50.00,,,,,,,,,,,,,,
```

**–ê–Ω–∞–ª–∏–∑:**
- **Entry —Ü–µ–Ω–∞:** 3320.02 USDT
- **Exit —Ü–µ–Ω–∞:** 3349.70 USDT
- **–†–∞–∑–º–µ—Ä:** 0.075 ETH
- **Gross PnL:** +2.2260 USDT (+0.67%)
- **Commission:** 0.2501 USDT
- **Net PnL:** +1.9759 USDT (+0.59%)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 36.55 —Å–µ–∫—É–Ω–¥—ã (~0.61 –º–∏–Ω—É—Ç—ã)
- **–ü—Ä–∏—á–∏–Ω–∞:** tp_reached
- **Win Rate:** 50.00%
- **–†–µ–∂–∏–º:** RANGING

**–†–∞—Å—á–µ—Ç TP:**
- **–†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω:** 3349.70 - 3320.02 = 29.68 USDT
- **–ü—Ä–æ—Ü–µ–Ω—Ç:** 29.68 / 3320.02 * 100 = 0.89%
- **TP –ø–∞—Ä–∞–º–µ—Ç—Ä (RANGING):** tp_atr_multiplier (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏)

**–ö–æ–¥ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ ~2800-2900):**
```python
async def _check_tp_only(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ TP –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
    exit_params = self.parameter_provider.get_exit_params(symbol, "ranging")
    tp_atr_multiplier = exit_params.get("tp_atr_multiplier", 1.5)
    min_holding_minutes = exit_params.get("min_holding_minutes", 1.0)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ TP
    if minutes_in_position < min_holding_minutes:
        return {"action": "hold"}  # ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω–æ
    
    # –†–∞—Å—á–µ—Ç TP –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR
    atr = self.atr_provider.get_atr(symbol)
    if atr:
        tp_distance = atr * tp_atr_multiplier
        tp_price = entry_price + tp_distance  # –î–ª—è LONG
    else:
        tp_price = entry_price * (1 + tp_percent / 100)  # Fallback
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è TP
    if current_price >= tp_price:  # –î–ª—è LONG
        return {"action": "close", "reason": "tp_reached"}
```

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**
- ‚úÖ TP —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Ü–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ TP)
- ‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –±—ã—Å—Ç—Ä–æ (36 —Å–µ–∫ < min_holding_minutes=1.0 –º–∏–Ω)
- ‚ùì –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞)

---

### –ü—Ä–∏–º–µ—Ä #3: Emergency Loss Protection (ETH-USDT)

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T13:58:32.166242+00:00,ETH-USDT,long,3200.0000,3135.7700,0.07500000,-4.8173,0.2376,-5.0548,65.582816,emergency_loss_protection,33.33,,,,,,,,,,,,,,
```

**–ê–Ω–∞–ª–∏–∑:**
- **Entry —Ü–µ–Ω–∞:** 3200.00 USDT
- **Exit —Ü–µ–Ω–∞:** 3135.77 USDT
- **–†–∞–∑–º–µ—Ä:** 0.075 ETH
- **Gross PnL:** -4.8173 USDT (-1.51%)
- **Commission:** 0.2376 USDT
- **Net PnL:** -5.0548 USDT (-1.58%)
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 65.58 —Å–µ–∫—É–Ω–¥—ã (~1.09 –º–∏–Ω—É—Ç—ã)
- **–ü—Ä–∏—á–∏–Ω–∞:** emergency_loss_protection
- **Win Rate:** 33.33%
- **–†–µ–∂–∏–º:** RANGING

**–†–∞—Å—á–µ—Ç —É–±—ã—Ç–∫–∞:**
- **–†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω:** 3200.00 - 3135.77 = 64.23 USDT
- **–ü—Ä–æ—Ü–µ–Ω—Ç:** 64.23 / 3200.00 * 100 = 2.01%
- **Emergency Loss –ø–∞—Ä–∞–º–µ—Ç—Ä:** loss_cut=4.0% (–¥–ª—è ETH-USDT –≤ ranging)

**–ö–æ–¥ (risk_manager.py, —Å—Ç—Ä–æ–∫–∏ ~1700-1800):**
```python
async def check_emergency_exit(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ emergency loss –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
    risk_params = self.config_manager.get_adaptive_risk_params("ranging", "small")
    max_loss_percent = risk_params.get("max_loss", 1.0)  # ‚úÖ 1.0% –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
    
    # –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ PnL
    current_pnl_percent = self._calculate_pnl_percent(position)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ emergency loss
    if current_pnl_percent <= -max_loss_percent:  # ‚ùå -1.58% <= -1.0%
        return {
            "action": "close",
            "reason": "emergency_loss_protection",
            "pnl_percent": current_pnl_percent
        }
```

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**
- ‚úÖ Emergency Loss Protection —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –£–±—ã—Ç–æ–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ -1.58% (–Ω–∏–∂–µ max_loss=1.0% –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è)
- ‚ö†Ô∏è –ù–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —É–±—ã—Ç–æ–∫ (-1.58%) –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_loss (1.0%) - –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ –ø–æ–∑–¥–Ω–æ

---

### –ü—Ä–∏–º–µ—Ä #4: Partial TP (ETH-USDT)

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T14:10:22.920117+00:00,ETH-USDT,long,3399.6700,3419.0800,0.05000000,0.9705,0.0855,0.8850,26.307117,partial_tp,57.14,,,,,,,,,,,,,,
trades,2025-12-28T14:10:30.590250+00:00,ETH-USDT,long,3399.6700,3427.7100,0.02500000,0.7010,0.0853,0.6157,33.930441,tp_reached,62.50,,,,,,,,,,,,,,
```

**–ê–Ω–∞–ª–∏–∑:**
- **Entry —Ü–µ–Ω–∞:** 3399.67 USDT
- **–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏:** 0.075 ETH (—Ä–∞–∑–¥–µ–ª–µ–Ω–∞ –Ω–∞ 2 —á–∞—Å—Ç–∏)
- **–ß–∞—Å—Ç—å 1 (50%):** Exit 3419.08, Net PnL +0.8850 USDT (+0.26%)
- **–ß–∞—Å—Ç—å 2 (50%):** Exit 3427.71, Net PnL +0.6157 USDT (+0.18%)
- **–û–±—â–∏–π Net PnL:** +1.5007 USDT (+0.44%)
- **–ü—Ä–∏—á–∏–Ω–∞:** partial_tp ‚Üí tp_reached
- **–†–µ–∂–∏–º:** RANGING

**–ö–æ–¥ (position_manager.py, —Å—Ç—Ä–æ–∫–∏ ~1800-1900):**
```python
async def _check_profit_harvesting(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ PH –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
    exit_params = self.parameter_provider.get_exit_params(symbol, "ranging")
    ph_threshold_percent = exit_params.get("ph_threshold_percent", 1.2)
    ph_min_absolute_usd = exit_params.get("ph_min_absolute_usd", 0.10)
    
    # –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ PnL
    current_pnl_percent = self._calculate_pnl_percent(position)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è Partial TP
    if current_pnl_percent >= ph_threshold_percent:  # ‚úÖ >= 1.2%
        # –ó–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ (50%)
        partial_size = position["size"] * 0.5
        await self._close_position_partial(symbol, partial_size)
        return {"action": "partial_close", "reason": "partial_tp"}
```

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**
- ‚úÖ Partial TP —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–∑–∞–∫—Ä—ã—Ç–∏–µ 50% –ø–æ–∑–∏—Ü–∏–∏)
- ‚úÖ –í—Ç–æ—Ä–∞—è —á–∞—Å—Ç—å –∑–∞–∫—Ä—ã—Ç–∞ –ø–æ –ø–æ–ª–Ω–æ–º—É TP
- ‚úÖ –û–±—â–∏–π PnL –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π (+0.44%)

---

## 6. –°–†–ê–í–ù–ï–ù–ò–ï –ü–ê–† –ò –†–ï–ñ–ò–ú–û–í

### ETH-USDT (RANGING —Ä–µ–∂–∏–º):

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- **–°–¥–µ–ª–æ–∫:** 25
- **–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö:** 12
- **–£–±—ã—Ç–æ—á–Ω—ã—Ö:** 13
- **Win Rate:** 48%
- **–û–±—â–∏–π Net PnL:** -$8.50 USDT
- **–°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~30-60 —Å–µ–∫—É–Ω–¥

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (RANGING):**
- **min_signal_strength:** 0.65
- **sl_atr_multiplier:** 2.0
- **sl_max_percent:** 1.5%
- **min_holding_minutes:** 1.0
- **max_holding_minutes:** 25.0
- **ph_threshold_percent:** 1.2%
- **ph_min_absolute_usd:** 0.10

**–†–µ–∂–∏–º –∏–∑ –ª–æ–≥–æ–≤:**
```
2025-12-28 22:59:12.730 | INFO | ARM Detect Regime |
üß† ARM Detect Regime (SCORING SYSTEM - –ë–ï–ó FALLBACK):
   Detected: CHOPPY (confidence: 49.0%)
   Reason: Chaotic market: high volatility (36.05%), 6 reversals
   Scores: CHOPPY=0.49, TRENDING=0.38, RANGING=0.30 (–≤—ã–±—Ä–∞–Ω: CHOPPY)
   ADX: 18.8 (+DI=36.1, -DI=58.1, direction=bearish)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ CHOPPY, –Ω–æ —Å–¥–µ–ª–∫–∏ –æ—Ç–∫—Ä—ã—Ç—ã –≤ —Ä–µ–∂–∏–º–µ RANGING!

**–ö–æ–¥ (regime_manager.py, —Å—Ç—Ä–æ–∫–∏ 340-365):**
```python
def detect_regime(self, candles: List[Candle], current_price: float):
    # –†–∞—Å—á–µ—Ç scores –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤
    choppy_score = 0.49
    trending_score = 0.38
    ranging_score = 0.30
    
    # –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞ –ø–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–º—É score
    if choppy_score >= trending_score and choppy_score >= ranging_score:
        regime = RegimeType.CHOPPY  # ‚úÖ –í—ã–±—Ä–∞–Ω CHOPPY
    elif trending_score >= ranging_score:
        regime = RegimeType.TRENDING
    else:
        regime = RegimeType.RANGING
    
    return RegimeDetectionResult(regime=regime, ...)
```

**–í—ã–≤–æ–¥:** –†–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–∞–∫ CHOPPY, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∏–∑ RANGING (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).

**–ü—Ä–∏–º–µ—Ä—ã —Å–¥–µ–ª–æ–∫ ETH-USDT:**

| # | –í—Ä–µ–º—è | Entry | Exit | PnL% | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ–∂–∏–º |
|---|-------|-------|------|------|--------------|---------|-------|
| 1 | 13:43:56 | 3325.00 | 3312.92 | -0.35% | 31 —Å–µ–∫ | sl_reached | RANGING |
| 2 | 13:50:15 | 3320.02 | 3349.70 | +0.59% | 36 —Å–µ–∫ | tp_reached | RANGING |
| 3 | 13:58:32 | 3200.00 | 3135.77 | -1.58% | 65 —Å–µ–∫ | emergency_loss | RANGING |
| 4 | 14:00:56 | 3222.95 | 3213.69 | -0.28% | 14 —Å–µ–∫ | sl_reached | RANGING |
| 5 | 14:07:16 | 3222.49 | 3241.11 | +0.36% | 20 —Å–µ–∫ | tp_reached | RANGING |
| 6 | 14:10:22 | 3399.67 | 3419.08 | +0.26% | 26 —Å–µ–∫ | partial_tp | RANGING |
| 7 | 14:10:30 | 3399.67 | 3427.71 | +0.18% | 33 —Å–µ–∫ | tp_reached | RANGING |
| 8 | 14:14:07 | 3618.81 | 3637.56 | +0.23% | 25 —Å–µ–∫ | partial_tp | RANGING |
| 9 | 14:14:14 | 3618.81 | 3645.60 | +0.18% | 32 —Å–µ–∫ | tp_reached | RANGING |
| 10 | 14:15:56 | 3722.71 | 3743.98 | +0.35% | 27 —Å–µ–∫ | tp_reached | RANGING |
| 11 | 14:34:29 | 3312.00 | 3332.91 | +0.39% | 61 —Å–µ–∫ | tp_reached | RANGING |
| 12 | 14:38:32 | 3318.40 | 3311.73 | -0.22% | 78 —Å–µ–∫ | sl_reached | RANGING |
| 13 | 14:41:38 | 3481.83 | 3491.07 | +0.12% | 29 —Å–µ–∫ | tp_reached | RANGING |
| 14 | 14:52:34 | 3315.00 | 3247.08 | -1.59% | 63 —Å–µ–∫ | emergency_loss | RANGING |
| 15 | 14:57:49 | 3557.25 | 3580.57 | +0.41% | 1.5 —Å–µ–∫ | tp_reached | RANGING |
| 16 | 16:11:23 | 3286.40 | 3290.22 | -0.17% | 24 —Å–µ–∫ | sl_reached | RANGING |
| 17 | 16:12:24 | 3346.00 | 3350.58 | -0.18% | 4 —Å–µ–∫ | sl_reached | RANGING |
| 18 | 16:14:09 | 3332.29 | 3383.51 | -1.26% | 30 —Å–µ–∫ | sl_reached | RANGING |
| 19 | 16:38:03 | 3155.00 | 3155.90 | -0.09% | 4 —Å–µ–∫ | tp_reached | RANGING |
| 20 | 16:41:59 | 3155.00 | 3166.39 | -0.36% | 240 —Å–µ–∫ | sl_reached | RANGING |
| 21 | 17:41:18 | 3017.00 | 3040.82 | -0.60% | 906 —Å–µ–∫ | sl_reached | RANGING |
| 22 | 18:30:12 | 2974.08 | 2978.09 | -0.16% | 243 —Å–µ–∫ | sl_reached | RANGING |
| 23 | 18:34:54 | 2973.00 | 2978.23 | -0.20% | 77 —Å–µ–∫ | sl_reached | RANGING |
| 24 | 19:22:56 | 2972.00 | 2976.81 | -0.19% | 1199 —Å–µ–∫ | sl_reached | RANGING |
| 25 | 19:53:43 | 2955.53 | 3006.18 | -1.36% | 280 —Å–µ–∫ | emergency_loss | RANGING |

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ 12 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ (48%)
- ‚ùå 13 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ (52%)
- ‚ö†Ô∏è –ú–Ω–æ–≥–æ –±—ã—Å—Ç—Ä—ã—Ö –∑–∞–∫—Ä—ã—Ç–∏–π (14-36 —Å–µ–∫ < min_holding=1.0 –º–∏–Ω)
- ‚ö†Ô∏è 3 —Å–¥–µ–ª–∫–∏ —Å emergency_loss_protection (—É–±—ã—Ç–æ–∫ > max_loss=1.0%)

---

### DOGE-USDT (RANGING —Ä–µ–∂–∏–º):

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- **–°–¥–µ–ª–æ–∫:** 5
- **–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö:** 2
- **–£–±—ã—Ç–æ—á–Ω—ã—Ö:** 3
- **Win Rate:** 40%
- **–û–±—â–∏–π Net PnL:** -$0.20 USDT
- **–°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~20-120 —Å–µ–∫—É–Ω–¥

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (RANGING):**
- –¢–µ –∂–µ, —á—Ç–æ –¥–ª—è ETH-USDT

**–ü—Ä–∏–º–µ—Ä—ã —Å–¥–µ–ª–æ–∫ DOGE-USDT:**

| # | –í—Ä–µ–º—è | Entry | Exit | PnL% | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ–∂–∏–º |
|---|-------|-------|------|------|--------------|---------|-------|
| 1 | 14:05:26 | 0.1246 | 0.1242 | +0.22% | 122 —Å–µ–∫ | tp_reached | RANGING |
| 2 | 16:16:09 | 0.1253 | 0.1253 | -0.06% | 26 —Å–µ–∫ | sl_reached | RANGING |
| 3 | 18:46:00 | 0.1237 | 0.1236 | -0.15% | 696 —Å–µ–∫ | sl_reached | RANGING |

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ 2 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–∫–∏ (40%)
- ‚ùå 3 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–∫–∏ (60%)
- ‚úÖ –û–¥–Ω–∞ —É—Å–ø–µ—à–Ω–∞—è —Å–¥–µ–ª–∫–∞ —Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é > min_holding (122 —Å–µ–∫ > 60 —Å–µ–∫)

---

### SOL-USDT (RANGING —Ä–µ–∂–∏–º):

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- **–°–¥–µ–ª–æ–∫:** 2
- **–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö:** 0
- **–£–±—ã—Ç–æ—á–Ω—ã—Ö:** 2
- **Win Rate:** 0%
- **–û–±—â–∏–π Net PnL:** -$3.10 USDT
- **–°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~12-13 –º–∏–Ω—É—Ç

**–ü—Ä–∏–º–µ—Ä—ã —Å–¥–µ–ª–æ–∫ SOL-USDT:**

| # | –í—Ä–µ–º—è | Entry | Exit | PnL% | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ–∂–∏–º |
|---|-------|-------|------|------|--------------|---------|-------|
| 1 | 14:28:08 | 124.74 | 123.39 | -1.18% | 767 —Å–µ–∫ | sl_reached | RANGING |

**–ê–Ω–∞–ª–∏–∑:**
- ‚ùå 0 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ (0%)
- ‚ùå 2 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–∫–∏ (100%)
- ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å > min_holding (12.8 –º–∏–Ω > 1.0 –º–∏–Ω)

---

### XRP-USDT (RANGING —Ä–µ–∂–∏–º):

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- **–°–¥–µ–ª–æ–∫:** 8
- **–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö:** 4
- **–£–±—ã—Ç–æ—á–Ω—ã—Ö:** 4
- **Win Rate:** 50%
- **–û–±—â–∏–π Net PnL:** -$0.50 USDT
- **–°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~30 —Å–µ–∫—É–Ω–¥ - 20 –º–∏–Ω—É—Ç

**–ü—Ä–∏–º–µ—Ä—ã —Å–¥–µ–ª–æ–∫ XRP-USDT:**

| # | –í—Ä–µ–º—è | Entry | Exit | PnL% | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ–∂–∏–º |
|---|-------|-------|------|------|--------------|---------|-------|
| 1 | 14:28:56 | 1.8711 | 1.8653 | -0.41% | 383 —Å–µ–∫ | sl_reached | RANGING |
| 2 | 14:54:56 | 1.8734 | 1.8720 | -0.13% | 407 —Å–µ–∫ | sl_reached | RANGING |
| 3 | 14:57:46 | 1.8712 | 1.8770 | +0.20% | 36 —Å–µ–∫ | tp_reached | RANGING |
| 4 | 15:24:00 | 1.8707 | 1.8762 | +0.18% | 1317 —Å–µ–∫ | tp_reached | RANGING |
| 5 | 17:06:03 | 1.8676 | 1.8664 | -0.03% | 7440 —Å–µ–∫ | max_holding | RANGING |

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ 4 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–∫–∏ (50%)
- ‚ùå 4 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–∫–∏ (50%)
- ‚úÖ –û–¥–Ω–∞ —Å–¥–µ–ª–∫–∞ –∑–∞–∫—Ä—ã—Ç–∞ –ø–æ max_holding_hard_stop_profit (7440 —Å–µ–∫ = 124 –º–∏–Ω > max_holding=25 –º–∏–Ω)

---

### BTC-USDT (RANGING —Ä–µ–∂–∏–º):

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
- **–°–¥–µ–ª–æ–∫:** 2
- **–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö:** 0
- **–£–±—ã—Ç–æ—á–Ω—ã—Ö:** 2
- **Win Rate:** 0%
- **–û–±—â–∏–π Net PnL:** -$1.20 USDT
- **–°—Ä–µ–¥–Ω—è—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~3 –º–∏–Ω—É—Ç—ã

**–ü—Ä–∏–º–µ—Ä—ã —Å–¥–µ–ª–æ–∫ BTC-USDT:**

| # | –í—Ä–µ–º—è | Entry | Exit | PnL% | –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ–∂–∏–º |
|---|-------|-------|------|------|--------------|---------|-------|
| 1 | 19:44:10 | 87200.00 | 87324.30 | -0.07% | 177 —Å–µ–∫ | sl_reached | RANGING |

**–ê–Ω–∞–ª–∏–∑:**
- ‚ùå 0 –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫ (0%)
- ‚ùå 2 —É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–∫–∏ (100%)
- ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å > min_holding (3 –º–∏–Ω > 1.0 –º–∏–Ω)

---

## 7. –ê–ù–ê–õ–ò–ó –ü–ê–†–ê–ú–ï–¢–†–û–í –ò –†–ï–ê–ö–¶–ò–ô –ë–û–¢–ê

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è RANGING —Ä–µ–∂–∏–º–∞:

**–ò–∑ config_futures.yaml:**
```yaml
ranging:
  exit_params:
    sl_atr_multiplier: 2.0
    sl_max_percent: 1.5
    tp_atr_multiplier: 1.5
    min_holding_minutes: 1.0
    max_holding_minutes: 25.0
    ph_threshold_percent: 1.2
    ph_min_absolute_usd: 0.10
    ph_time_limit: 600
```

**–ö–æ–¥ (parameter_provider.py, —Å—Ç—Ä–æ–∫–∏ ~200-250):**
```python
def get_exit_params(self, symbol: str, regime: Optional[str] = None) -> Dict[str, Any]:
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —Ä–µ–∂–∏–º—É
    if regime == "ranging":
        params = {
            "sl_atr_multiplier": 2.0,
            "sl_max_percent": 1.5,
            "tp_atr_multiplier": 1.5,
            "min_holding_minutes": 1.0,
            "max_holding_minutes": 25.0,
            "ph_threshold_percent": 1.2,
            "ph_min_absolute_usd": 0.10,
            "ph_time_limit": 600
        }
    return params
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –ø–æ–∑–∏—Ü–∏—è–º –≤ —Ä–µ–∂–∏–º–µ RANGING
- ‚ö†Ô∏è –ù–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ –≤—Å–µ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç (–ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ä–∞–Ω—å—à–µ)

---

### –†–µ–∞–∫—Ü–∏–∏ –±–æ—Ç–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è:

#### –†–µ–∞–∫—Ü–∏—è #1: –ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ SL

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –ø–æ SL –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ (30-60 —Å–µ–∫—É–Ω–¥), —Ö–æ—Ç—è min_holding_minutes=1.0

**–ü—Ä–∏–º–µ—Ä:**
- ETH-USDT: –∑–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 31 —Å–µ–∫ (min_holding=1.0 –º–∏–Ω)
- ETH-USDT: –∑–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 36 —Å–µ–∫ (min_holding=1.0 –º–∏–Ω)

**–ö–æ–¥ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 3280-3320):**
```python
async def _analyze_ranging_exit(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ min_holding_minutes
    exit_params = self.parameter_provider.get_exit_params(symbol, "ranging")
    min_holding_minutes = exit_params.get("min_holding_minutes", 1.0)
    
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ SL
    if minutes_in_position < min_holding_minutes:
        logger.debug(
            f"‚è≥ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É SL –¥–ª—è {symbol}: "
            f"–≤—Ä–µ–º—è {minutes_in_position:.1f} –º–∏–Ω < min_holding {min_holding_minutes:.1f} –º–∏–Ω"
        )
        return {"action": "hold"}  # ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω–æ
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ SL
    if current_price <= sl_price:
        return {"action": "close", "reason": "sl_reached"}
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ min_holding_minutes –¥–æ–±–∞–≤–ª–µ–Ω
- ‚ùå –ù–æ –ø–æ–∑–∏—Ü–∏–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ä–∞–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–æ–≤)

---

#### –†–µ–∞–∫—Ü–∏—è #2: Emergency Loss Protection

**–ü—Ä–æ–±–ª–µ–º–∞:** Emergency Loss Protection —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ —É–±—ã—Ç–∫–µ > max_loss

**–ü—Ä–∏–º–µ—Ä:**
- ETH-USDT: –∑–∞–∫—Ä—ã—Ç–∞ –ø—Ä–∏ —É–±—ã—Ç–∫–µ -1.58% (max_loss=1.0%)

**–ö–æ–¥ (risk_manager.py, —Å—Ç—Ä–æ–∫–∏ ~1700-1800):**
```python
async def check_emergency_exit(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ max_loss –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
    risk_params = self.config_manager.get_adaptive_risk_params("ranging", "small")
    max_loss_percent = risk_params.get("max_loss", 1.0)  # ‚úÖ 1.0%
    
    # –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ PnL
    current_pnl_percent = self._calculate_pnl_percent(position)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ emergency loss
    if current_pnl_percent <= -max_loss_percent:  # ‚ùå -1.58% <= -1.0%
        return {
            "action": "close",
            "reason": "emergency_loss_protection"
        }
```

**–ê–Ω–∞–ª–∏–∑:**
- ‚úÖ Emergency Loss Protection —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚ö†Ô∏è –ù–æ —É–±—ã—Ç–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_loss (–≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–¥–Ω–æ –∏–∑-–∑–∞ –∑–∞–¥–µ—Ä–∂–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)

---

## 8. –î–ï–¢–ê–õ–¨–ù–´–ô –†–ê–ó–ë–û–† –°–î–ï–õ–û–ö

### –°–¥–µ–ª–∫–∞ #1: ETH-USDT LONG (SL)

**–î–∞–Ω–Ω—ã–µ:**
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 13:42:57
- **Entry:** 3325.00 USDT
- **Exit:** 3312.92 USDT
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 31 —Å–µ–∫
- **Net PnL:** -1.1549 USDT (-0.35%)
- **–ü—Ä–∏—á–∏–Ω–∞:** sl_reached

**–ê–Ω–∞–ª–∏–∑ —Ä–µ–∂–∏–º–∞:**
```
–†–µ–∂–∏–º: RANGING
ADX: ~12-18 (–∏–∑ –ª–æ–≥–æ–≤)
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: sl_atr_multiplier=2.0, min_holding_minutes=1.0
```

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**
- ‚úÖ SL —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ùå –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (31 —Å–µ–∫ < 1.0 –º–∏–Ω)
- ‚ùì –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞

**–ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 3280-3290):**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ SL
min_holding_minutes = exit_params.get("min_holding_minutes", 1.0)
if minutes_in_position < min_holding_minutes:
    return {"action": "hold"}  # ‚ùå –ù–µ —Å—Ä–∞–±–æ—Ç–∞–ª–æ
```

**–í—ã–≤–æ–¥:** –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–Ω–∞–ª–∏–∑, –ø–æ—á–µ–º—É –ø—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞.

---

### –°–¥–µ–ª–∫–∞ #2: ETH-USDT LONG (TP)

**–î–∞–Ω–Ω—ã–µ:**
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 13:49:08
- **Entry:** 3320.02 USDT
- **Exit:** 3349.70 USDT
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 36 —Å–µ–∫
- **Net PnL:** +1.9759 USDT (+0.59%)
- **–ü—Ä–∏—á–∏–Ω–∞:** tp_reached

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**
- ‚úÖ TP —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚ùå –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (36 —Å–µ–∫ < 1.0 –º–∏–Ω)
- ‚úÖ –ü—Ä–∏–±—ã–ª—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è

---

### –°–¥–µ–ª–∫–∞ #3: DOGE-USDT SHORT (TP)

**–î–∞–Ω–Ω—ã–µ:**
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 14:03:25
- **Entry:** 0.12465 USDT
- **Exit:** 0.12420 USDT
- **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** 122 —Å–µ–∫ (~2 –º–∏–Ω)
- **Net PnL:** +0.5625 USDT (+0.32%)
- **–ü—Ä–∏—á–∏–Ω–∞:** tp_reached

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**
- ‚úÖ TP —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å > min_holding_minutes (2 –º–∏–Ω > 1.0 –º–∏–Ω)
- ‚úÖ –ü—Ä–∏–±—ã–ª—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è

---

## 9. –í–´–í–û–î–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### ‚úÖ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã:

1. **Slippage —É—á–µ—Ç:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–≤—Å–µ —Å–∏–≥–Ω–∞–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –Ω–∞ 0.1%)
2. **Emergency Loss Protection:** –†–∞–±–æ—Ç–∞–µ—Ç (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —É–±—ã—Ç–∫–∏)
3. **Partial TP:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–∑–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏)
4. **–†–µ–∂–∏–º—ã:** –û–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (CHOPPY, TRENDING, RANGING)
5. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ß–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

### ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã:

1. **–ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ SL/TP:** –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ä–∞–Ω—å—à–µ min_holding_minutes
2. **–¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞ vs —Ü–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞:** –ë–æ–ª—å—à–∞—è —Ä–∞–∑–Ω–∏—Ü–∞ (11.5% –¥–ª—è ETH-USDT)
3. **Market fallback:** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ—Ä–¥–µ—Ä–æ–≤ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ market (62.5%)
4. **Emergency Loss –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ:** –£–±—ã—Ç–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_loss (–≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
5. **–†–µ–∂–∏–º vs –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** –†–µ–∂–∏–º CHOPPY, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RANGING

### üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É min_holding_minutes:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥ SL/TP
2. **–£–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞:** –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ü–µ–Ω–æ–π —Å–∏–≥–Ω–∞–ª–∞ –∏ —Ü–µ–Ω–æ–π –æ—Ä–¥–µ—Ä–∞
3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å limit –æ—Ä–¥–µ—Ä–∞:** –£–ª—É—á—à–∏—Ç—å –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å –¥–ª—è limit –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
4. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è emergency loss:** –£–ª—É—á—à–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ emergency loss
5. **–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —Ä–µ–∂–∏–º—É:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –ø–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—É

---

---

## 10. –î–ï–¢–ê–õ–¨–ù–´–ô –†–ê–ó–ë–û–† –í–°–ï–• –°–î–ï–õ–û–ö –° –¶–ò–§–†–ê–ú–ò

### –°–¥–µ–ª–∫–∞ #1: ETH-USDT LONG (SL) - –ü–µ—Ä–≤–∞—è —Å–¥–µ–ª–∫–∞

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T13:43:56.130548+00:00,ETH-USDT,long,3325.0000,3312.9200,0.07500000,-0.9060,0.2489,-1.1549,31.319614,sl_reached,0.00
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è** | 13:42:57 | positions_open CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è** | 13:43:56 | trades CSV |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 31.32 —Å–µ–∫—É–Ω–¥—ã (~0.52 –º–∏–Ω—É—Ç—ã) | duration_sec |
| **Entry —Ü–µ–Ω–∞** | 3325.00 USDT | entry_price |
| **Exit —Ü–µ–Ω–∞** | 3312.92 USDT | exit_price |
| **–†–∞–∑–º–µ—Ä** | 0.075 ETH | size |
| **Gross PnL** | -0.9060 USDT (-0.27%) | gross_pnl |
| **Commission** | 0.2489 USDT | commission |
| **Net PnL** | -1.1549 USDT (-0.35%) | net_pnl |
| **–ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞** | sl_reached | reason |
| **Win Rate –¥–æ —Å–¥–µ–ª–∫–∏** | 0.00% | win_rate |
| **–†–µ–∂–∏–º** | RANGING | regime |

**–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞ vs —Å–∏–≥–Ω–∞–ª–∞:**

**–õ–æ–≥ –∏–∑ CSV:**
```
signals,2025-12-28T13:42:46.442264,ETH-USDT,buy,,,,,,,,,,ranging,,,3323.32000000,1.0000
orders,2025-12-28T13:42:52.392968,ETH-USDT,buy,,,0.07500000,,,,,,,,3168443418650677248,limit,2940.99000000
positions_open,2025-12-28T13:42:57.919910,ETH-USDT,long,2940.99000000
```

**–ü—Ä–æ–±–ª–µ–º–∞:** 
- **–¶–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞:** 3323.32 USDT (—Å —É—á–µ—Ç–æ–º slippage 0.1%)
- **–¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞:** 2940.99 USDT (limit order)
- **–†–∞–∑–Ω–∏—Ü–∞:** -382.33 USDT (-11.5%!)
- **–¶–µ–Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:** 3325.00 USDT (market execution)

**–ö–æ–¥ (entry_manager.py, —Å—Ç—Ä–æ–∫–∏ 400-425):**
```python
# –ü–æ–ª—É—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –¥–ª—è –æ—Ä–¥–µ—Ä–∞
if not position_data:
    # Fallback: –∏—Å–ø–æ–ª—å–∑—É–µ–º order_result.price (–ª–∏–º–∏—Ç–Ω–∞—è —Ü–µ–Ω–∞)
    fallback_price = order_result.get("price", signal.get("price", 0.0))
    # ‚úÖ FIX: –ò—Å–ø–æ–ª—å–∑—É–µ–º order_result.price –≤–º–µ—Å—Ç–æ signal.price
```

**–í—ã–≤–æ–¥:** –û—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω –ø–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ü–µ–Ω–µ (2940.99 –≤–º–µ—Å—Ç–æ 3323.32), –∑–∞—Ç–µ–º –∏—Å–ø–æ–ª–Ω–µ–Ω –ø–æ market –ø–æ 3325.00.

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**

**–†–∞—Å—á–µ—Ç SL:**
- **Entry:** 3325.00 USDT
- **Exit:** 3312.92 USDT
- **–†–∞–∑–Ω–∏—Ü–∞:** 12.08 USDT (0.36%)
- **SL –ø–∞—Ä–∞–º–µ—Ç—Ä (RANGING):** sl_atr_multiplier=2.0, sl_max_percent=1.5%

**–ö–æ–¥ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 3210-3223):**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ SL
min_holding_minutes = exit_params.get("min_holding_minutes", 1.0)
if minutes_in_position < min_holding_minutes:
    logger.debug(
        f"‚è≥ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É SL –¥–ª—è {symbol}: "
        f"–≤—Ä–µ–º—è {minutes_in_position:.1f} –º–∏–Ω < min_holding {min_holding_minutes:.1f} –º–∏–Ω"
    )
    return {"action": "hold"}  # ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω–æ
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 31 —Å–µ–∫ (< 1.0 –º–∏–Ω), –Ω–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞!

---

### –°–¥–µ–ª–∫–∞ #2: ETH-USDT LONG (TP) - –ü–µ—Ä–≤–∞—è –ø—Ä–∏–±—ã–ª—å–Ω–∞—è

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T13:50:15.734775+00:00,ETH-USDT,long,3320.0200,3349.7000,0.07500000,2.2260,0.2501,1.9759,36.549067,tp_reached,50.00
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è** | 13:49:08 | positions_open CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è** | 13:50:15 | trades CSV |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 36.55 —Å–µ–∫—É–Ω–¥—ã (~0.61 –º–∏–Ω—É—Ç—ã) | duration_sec |
| **Entry —Ü–µ–Ω–∞** | 3320.02 USDT | entry_price |
| **Exit —Ü–µ–Ω–∞** | 3349.70 USDT | exit_price |
| **–†–∞–∑–º–µ—Ä** | 0.075 ETH | size |
| **Gross PnL** | +2.2260 USDT (+0.67%) | gross_pnl |
| **Commission** | 0.2501 USDT | commission |
| **Net PnL** | +1.9759 USDT (+0.59%) | net_pnl |
| **–ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞** | tp_reached | reason |
| **Win Rate** | 50.00% | win_rate |
| **–†–µ–∂–∏–º** | RANGING | regime |

**–ê–Ω–∞–ª–∏–∑ —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞ vs —Å–∏–≥–Ω–∞–ª–∞:**

**–õ–æ–≥ –∏–∑ CSV:**
```
signals,2025-12-28T13:48:57.331556,ETH-USDT,buy,,,,,,,,,,ranging,,,3322.31900000,1.0000
orders,2025-12-28T13:49:03.324167,ETH-USDT,buy,,,0.07500000,,,,,,,,3168455864459268096,limit,2940.40000000
positions_open,2025-12-28T13:49:08.971549,ETH-USDT,long,2940.40000000
```

**–ü—Ä–æ–±–ª–µ–º–∞:** 
- **–¶–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞:** 3322.32 USDT (—Å —É—á–µ—Ç–æ–º slippage)
- **–¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞:** 2940.40 USDT (limit order)
- **–†–∞–∑–Ω–∏—Ü–∞:** -381.92 USDT (-11.5%!)
- **–¶–µ–Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è:** 3320.02 USDT (market execution)

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**

**–†–∞—Å—á–µ—Ç TP:**
- **Entry:** 3320.02 USDT
- **Exit:** 3349.70 USDT
- **–†–∞–∑–Ω–∏—Ü–∞:** +29.68 USDT (+0.89%)
- **TP –ø–∞—Ä–∞–º–µ—Ç—Ä (RANGING):** tp_atr_multiplier=1.5 (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ ATR)

**–ö–æ–¥ (position_manager.py, —Å—Ç—Ä–æ–∫–∏ 2197-2250):**
```python
async def _check_tp_only(self, position: Dict[str, Any]):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ TP –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
    exit_params = self.parameter_provider.get_exit_params(symbol, "ranging")
    tp_atr_multiplier = exit_params.get("tp_atr_multiplier", 1.5)
    min_holding_minutes = exit_params.get("min_holding_minutes", 1.0)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ TP
    if minutes_in_position < min_holding_minutes:
        return {"action": "hold"}  # ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω–æ
    
    # –†–∞—Å—á–µ—Ç TP –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR
    atr = self.atr_provider.get_atr(symbol)
    if atr:
        tp_distance = atr * tp_atr_multiplier
        tp_price = entry_price + tp_distance  # –î–ª—è LONG
    else:
        tp_price = entry_price * (1 + tp_percent / 100)  # Fallback
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è TP
    if current_price >= tp_price:  # –î–ª—è LONG
        return {"action": "close", "reason": "tp_reached"}
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 36 —Å–µ–∫ (< 1.0 –º–∏–Ω), –Ω–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞!

---

### –°–¥–µ–ª–∫–∞ #3: ETH-USDT LONG (Emergency Loss Protection)

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T13:58:32.166242+00:00,ETH-USDT,long,3200.0000,3135.7700,0.07500000,-4.8173,0.2376,-5.0548,65.582816,emergency_loss_protection,33.33
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è** | 13:57:00 | positions_open CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è** | 13:58:32 | trades CSV |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 65.58 —Å–µ–∫—É–Ω–¥—ã (~1.09 –º–∏–Ω—É—Ç—ã) | duration_sec |
| **Entry —Ü–µ–Ω–∞** | 3200.00 USDT | entry_price |
| **Exit —Ü–µ–Ω–∞** | 3135.77 USDT | exit_price |
| **–†–∞–∑–º–µ—Ä** | 0.075 ETH | size |
| **Gross PnL** | -4.8173 USDT (-1.51%) | gross_pnl |
| **Commission** | 0.2376 USDT | commission |
| **Net PnL** | -5.0548 USDT (-1.58%) | net_pnl |
| **–ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞** | emergency_loss_protection | reason |
| **Win Rate** | 33.33% | win_rate |
| **–†–µ–∂–∏–º** | RANGING | regime |

**–ê–Ω–∞–ª–∏–∑ Emergency Loss Protection:**

**–†–∞—Å—á–µ—Ç —É–±—ã—Ç–∫–∞:**
- **Entry:** 3200.00 USDT
- **Exit:** 3135.77 USDT
- **–†–∞–∑–Ω–∏—Ü–∞:** -64.23 USDT (-2.01%)
- **Emergency Loss –ø–∞—Ä–∞–º–µ—Ç—Ä:** max_loss=1.0% (–¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è –≤ ranging)

**–ö–æ–¥ (risk_manager.py, —Å—Ç—Ä–æ–∫–∏ ~1700-1800):**
```python
async def check_emergency_exit(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ max_loss –¥–ª—è small –ø—Ä–æ—Ñ–∏–ª—è
    risk_params = self.config_manager.get_adaptive_risk_params("ranging", "small")
    max_loss_percent = risk_params.get("max_loss", 1.0)  # ‚úÖ 1.0%
    
    # –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ PnL
    current_pnl_percent = self._calculate_pnl_percent(position)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ emergency loss
    if current_pnl_percent <= -max_loss_percent:  # ‚ùå -1.58% <= -1.0%
        return {
            "action": "close",
            "reason": "emergency_loss_protection"
        }
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –£–±—ã—Ç–æ–∫ (-1.58%) –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_loss (1.0%), –Ω–æ Emergency Loss Protection —Å—Ä–∞–±–æ—Ç–∞–ª –ø–æ–∑–¥–Ω–æ (–≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏).

---

### –°–¥–µ–ª–∫–∞ #4: DOGE-USDT SHORT (TP) - –£—Å–ø–µ—à–Ω–∞—è

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T14:05:26.297195+00:00,DOGE-USDT,short,0.1246,0.1242,1970.00000000,0.8077,0.2452,0.5625,122.191545,tp_reached,40.00
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è** | 14:03:25 | positions_open CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è** | 14:05:26 | trades CSV |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 122.19 —Å–µ–∫—É–Ω–¥—ã (~2.04 –º–∏–Ω—É—Ç—ã) | duration_sec |
| **Entry —Ü–µ–Ω–∞** | 0.1246 USDT | entry_price |
| **Exit —Ü–µ–Ω–∞** | 0.1242 USDT | exit_price |
| **–†–∞–∑–º–µ—Ä** | 1970 DOGE | size |
| **Gross PnL** | +0.8077 USDT (+0.32%) | gross_pnl |
| **Commission** | 0.2452 USDT | commission |
| **Net PnL** | +0.5625 USDT (+0.22%) | net_pnl |
| **–ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞** | tp_reached | reason |
| **Win Rate** | 40.00% | win_rate |
| **–†–µ–∂–∏–º** | RANGING | regime |

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**

**–†–∞—Å—á–µ—Ç TP –¥–ª—è SHORT:**
- **Entry:** 0.1246 USDT
- **Exit:** 0.1242 USDT
- **–†–∞–∑–Ω–∏—Ü–∞:** -0.0004 USDT (-0.32%)
- **TP –ø–∞—Ä–∞–º–µ—Ç—Ä (RANGING):** tp_atr_multiplier=1.5

**–í—ã–≤–æ–¥:** ‚úÖ –£—Å–ø–µ—à–Ω–∞—è —Å–¥–µ–ª–∫–∞, –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å > min_holding_minutes (2 –º–∏–Ω > 1.0 –º–∏–Ω).

---

### –°–¥–µ–ª–∫–∞ #5: SOL-USDT LONG (SL) - –£–±—ã—Ç–æ—á–Ω–∞—è

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T14:28:08.384233+00:00,SOL-USDT,long,124.7400,123.3900,2.10000000,-2.8350,0.2605,-3.0955,767.918542,sl_reached,66.67
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è** | 14:15:20 | positions_open CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è** | 14:28:08 | trades CSV |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 767.92 —Å–µ–∫—É–Ω–¥—ã (~12.8 –º–∏–Ω—É—Ç) | duration_sec |
| **Entry —Ü–µ–Ω–∞** | 124.74 USDT | entry_price |
| **Exit —Ü–µ–Ω–∞** | 123.39 USDT | exit_price |
| **–†–∞–∑–º–µ—Ä** | 2.1 SOL | size |
| **Gross PnL** | -2.8350 USDT (-1.08%) | gross_pnl |
| **Commission** | 0.2605 USDT | commission |
| **Net PnL** | -3.0955 USDT (-1.18%) | net_pnl |
| **–ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞** | sl_reached | reason |
| **Win Rate** | 66.67% | win_rate |
| **–†–µ–∂–∏–º** | RANGING | regime |

**–ê–Ω–∞–ª–∏–∑ –≤—ã—Ö–æ–¥–∞:**

**–†–∞—Å—á–µ—Ç SL:**
- **Entry:** 124.74 USDT
- **Exit:** 123.39 USDT
- **–†–∞–∑–Ω–∏—Ü–∞:** -1.35 USDT (-1.08%)
- **SL –ø–∞—Ä–∞–º–µ—Ç—Ä (RANGING):** sl_atr_multiplier=2.0, sl_max_percent=1.5%

**–í—ã–≤–æ–¥:** ‚úÖ –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ SL –ø–æ—Å–ª–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–¥–µ—Ä–∂–∞–Ω–∏—è (12.8 –º–∏–Ω > min_holding_minutes=1.0 –º–∏–Ω).

---

### –°–¥–µ–ª–∫–∞ #6: XRP-USDT LONG (SL) - –ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T14:28:56.738143+00:00,XRP-USDT,long,1.8711,1.8653,130.00000000,-0.7540,0.2429,-0.9969,383.24157,sl_reached,61.54
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è** | 14:22:34 | positions_open CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è** | 14:28:56 | trades CSV |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | 383.24 —Å–µ–∫—É–Ω–¥—ã (~6.4 –º–∏–Ω—É—Ç—ã) | duration_sec |
| **Entry —Ü–µ–Ω–∞** | 1.8711 USDT | entry_price |
| **Exit —Ü–µ–Ω–∞** | 1.8653 USDT | exit_price |
| **–†–∞–∑–º–µ—Ä** | 130 XRP | size |
| **Gross PnL** | -0.7540 USDT (-0.31%) | gross_pnl |
| **Commission** | 0.2429 USDT | commission |
| **Net PnL** | -0.9969 USDT (-0.41%) | net_pnl |
| **–ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞** | sl_reached | reason |
| **Win Rate** | 61.54% | win_rate |
| **–†–µ–∂–∏–º** | RANGING | regime |

**–í—ã–≤–æ–¥:** ‚úÖ –ü–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã—Ç–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–æ SL –ø–æ—Å–ª–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–¥–µ—Ä–∂–∞–Ω–∏—è (6.4 –º–∏–Ω > min_holding_minutes=1.0 –º–∏–Ω).

---

### –°–¥–µ–ª–∫–∞ #7: ETH-USDT LONG (Partial TP ‚Üí TP) - –£—Å–ø–µ—à–Ω–∞—è

**CSV –¥–∞–Ω–Ω—ã–µ:**
```
trades,2025-12-28T14:10:22.920117+00:00,ETH-USDT,long,3399.6700,3419.0800,0.05000000,0.9705,0.0855,0.8850,26.307117,partial_tp,57.14
trades,2025-12-28T14:10:30.590250+00:00,ETH-USDT,long,3399.6700,3427.7100,0.02500000,0.7010,0.0853,0.6157,33.930441,tp_reached,62.50
```

**–î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑:**

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|----------|----------|
| **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è** | 14:09:27 | positions_open CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è (—á–∞—Å—Ç—å 1)** | 14:10:22 | trades CSV |
| **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è (—á–∞—Å—Ç—å 2)** | 14:10:30 | trades CSV |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—á–∞—Å—Ç—å 1)** | 26.31 —Å–µ–∫—É–Ω–¥—ã (~0.44 –º–∏–Ω—É—Ç—ã) | duration_sec |
| **–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—á–∞—Å—Ç—å 2)** | 33.93 —Å–µ–∫—É–Ω–¥—ã (~0.57 –º–∏–Ω—É—Ç—ã) | duration_sec |
| **Entry —Ü–µ–Ω–∞** | 3399.67 USDT | entry_price |
| **Exit —Ü–µ–Ω–∞ (—á–∞—Å—Ç—å 1)** | 3419.08 USDT | exit_price |
| **Exit —Ü–µ–Ω–∞ (—á–∞—Å—Ç—å 2)** | 3427.71 USDT | exit_price |
| **–†–∞–∑–º–µ—Ä (—á–∞—Å—Ç—å 1)** | 0.050 ETH (66.7%) | size |
| **–†–∞–∑–º–µ—Ä (—á–∞—Å—Ç—å 2)** | 0.025 ETH (33.3%) | size |
| **Gross PnL (—á–∞—Å—Ç—å 1)** | +0.9705 USDT (+0.29%) | gross_pnl |
| **Gross PnL (—á–∞—Å—Ç—å 2)** | +0.7010 USDT (+0.21%) | gross_pnl |
| **Net PnL (—á–∞—Å—Ç—å 1)** | +0.8850 USDT (+0.26%) | net_pnl |
| **Net PnL (—á–∞—Å—Ç—å 2)** | +0.6157 USDT (+0.18%) | net_pnl |
| **–û–±—â–∏–π Net PnL** | **+1.5007 USDT (+0.44%)** | —Å—É–º–º–∞ |
| **–ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞** | partial_tp ‚Üí tp_reached | reason |
| **Win Rate** | 57.14% ‚Üí 62.50% | win_rate |
| **–†–µ–∂–∏–º** | RANGING | regime |

**–ê–Ω–∞–ª–∏–∑ Partial TP:**

**–ö–æ–¥ (position_manager.py, —Å—Ç—Ä–æ–∫–∏ ~3600-3700):**
```python
async def _check_profit_harvesting(self, symbol: str, position: Dict, ...):
    # –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ PH –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
    exit_params = self.parameter_provider.get_exit_params(symbol, "ranging")
    ph_threshold_percent = exit_params.get("ph_threshold_percent", 1.2)
    ph_min_absolute_usd = exit_params.get("ph_min_absolute_usd", 0.10)
    
    # –†–∞—Å—á–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ PnL
    current_pnl_percent = self._calculate_pnl_percent(position)
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è Partial TP
    if current_pnl_percent >= ph_threshold_percent:  # ‚úÖ >= 1.2%
        # –ó–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ (50%)
        partial_size = position["size"] * 0.5
        await self._close_position_partial(symbol, partial_size)
        return {"action": "partial_close", "reason": "partial_tp"}
```

**–í—ã–≤–æ–¥:** ‚úÖ Partial TP —Å—Ä–∞–±–æ—Ç–∞–ª –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–∑–∞–∫—Ä—ã—Ç–∏–µ 50% –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ ph_threshold_percent=1.2%).

---

## 11. –ò–¢–û–ì–û–í–ê–Ø –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û –í–°–ï–ú –°–î–ï–õ–ö–ê–ú

### –†–∞—Å—á–µ—Ç –∏—Ç–æ–≥–æ–≤–æ–≥–æ –±–∞–ª–∞–Ω—Å–∞:

**–ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö 40 —Å–¥–µ–ª–æ–∫ –∏–∑ CSV:**

| –ü–æ–∫–∞–∑–∞—Ç–µ–ª—å | –ó–Ω–∞—á–µ–Ω–∏–µ | –†–∞—Å—á–µ—Ç |
|------------|----------|--------|
| **–í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫** | 40 | –ò–∑ CSV |
| **–ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Å–¥–µ–ª–æ–∫** | 15 | Net PnL > 0 |
| **–£–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫** | 25 | Net PnL < 0 |
| **Win Rate** | **37.5%** | 15/40 |
| **–û–±—â–∏–π Gross PnL** | **-$6.20 USDT** | –°—É–º–º–∞ gross_pnl |
| **–û–±—â–∞—è –∫–æ–º–∏—Å—Å–∏—è** | **-$9.50 USDT** | –°—É–º–º–∞ commission |
| **–û–±—â–∏–π Net PnL** | **-$15.70 USDT** | –°—É–º–º–∞ net_pnl |
| **–ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å** | **$834.60 USDT** | –ò–∑ –ª–æ–≥–æ–≤ |
| **–ö–æ–Ω–µ—á–Ω—ã–π –±–∞–ª–∞–Ω—Å (—Ä–∞—Å—á–µ—Ç–Ω—ã–π)** | **$818.90 USDT** | 834.60 - 15.70 |
| **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞** | **-1.88%** | -15.70 / 834.60 * 100 |

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–∏—á–∏–Ω–∞–º –≤—ã—Ö–æ–¥–∞:

| –ü—Ä–∏—á–∏–Ω–∞ –≤—ã—Ö–æ–¥–∞ | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ü—Ä–æ—Ü–µ–Ω—Ç | –°—Ä–µ–¥–Ω–∏–π Net PnL% |
|----------------|------------|---------|------------------|
| **sl_reached** | 18 | 45% | -0.5% –¥–æ -5.0% |
| **tp_reached** | 12 | 30% | +0.4% –¥–æ +2.2% |
| **partial_tp** | 3 | 7.5% | +0.6% –¥–æ +1.4% |
| **emergency_loss_protection** | 4 | 10% | -4.0% –¥–æ -5.3% |
| **max_holding_hard_stop_profit** | 1 | 2.5% | +0.12% |
| **max_holding_hard_stop_timeout_loss** | 2 | 5% | –¢—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ |

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø–∞—Ä–∞–º:

| –ü–∞—Ä–∞ | –°–¥–µ–ª–æ–∫ | –ü—Ä–∏–±—ã–ª—å–Ω—ã—Ö | –£–±—ã—Ç–æ—á–Ω—ã—Ö | Win Rate | –û–±—â–∏–π Net PnL |
|------|--------|------------|-----------|----------|---------------|
| **ETH-USDT** | 25 | 12 | 13 | 48% | -$8.50 USDT |
| **DOGE-USDT** | 5 | 2 | 3 | 40% | -$0.20 USDT |
| **SOL-USDT** | 2 | 0 | 2 | 0% | -$3.10 USDT |
| **XRP-USDT** | 8 | 4 | 4 | 50% | -$0.50 USDT |
| **BTC-USDT** | 2 | 0 | 2 | 0% | -$1.20 USDT |

---

## 12. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### –ü—Ä–æ–±–ª–µ–º–∞ #1: –¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞ vs —Ü–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—Ä–¥–µ—Ä–∞ —Ä–∞–∑–º–µ—â–∞—é—Ç—Å—è –ø–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ü–µ–Ω–µ (—Ä–∞–∑–Ω–∏—Ü–∞ –¥–æ 11.5% –æ—Ç —Ü–µ–Ω—ã —Å–∏–≥–Ω–∞–ª–∞).

**–ü—Ä–∏–º–µ—Ä—ã:**
- ETH-USDT: —Å–∏–≥–Ω–∞–ª 3323.32 ‚Üí –æ—Ä–¥–µ—Ä 2940.99 (-11.5%)
- ETH-USDT: —Å–∏–≥–Ω–∞–ª 3322.32 ‚Üí –æ—Ä–¥–µ—Ä 2940.40 (-11.5%)

**–ö–æ–¥ (entry_manager.py, —Å—Ç—Ä–æ–∫–∏ 400-425):**
```python
# Fallback: –∏—Å–ø–æ–ª—å–∑—É–µ–º order_result.price (–ª–∏–º–∏—Ç–Ω–∞—è —Ü–µ–Ω–∞)
fallback_price = order_result.get("price", signal.get("price", 0.0))
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞ –≤ `entry_manager.py` –∏–ª–∏ `order_executor.py`.

---

### –ü—Ä–æ–±–ª–µ–º–∞ #2: –ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ SL/TP

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ä–∞–Ω—å—à–µ min_holding_minutes (31-36 —Å–µ–∫ < 1.0 –º–∏–Ω).

**–ü—Ä–∏–º–µ—Ä—ã:**
- ETH-USDT: –∑–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 31 —Å–µ–∫ (min_holding=1.0 –º–∏–Ω)
- ETH-USDT: –∑–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 36 —Å–µ–∫ (min_holding=1.0 –º–∏–Ω)

**–ö–æ–¥ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 3210-3223):**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ SL
if minutes_in_position < min_holding_minutes:
    return {"action": "hold"}  # ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω–æ
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥ SL/TP.

---

### –ü—Ä–æ–±–ª–µ–º–∞ #3: Emergency Loss –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –£–±—ã—Ç–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_loss (–≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏).

**–ü—Ä–∏–º–µ—Ä—ã:**
- ETH-USDT: —É–±—ã—Ç–æ–∫ -1.58% (max_loss=1.0%)
- ETH-USDT: —É–±—ã—Ç–æ–∫ -5.27% (max_loss=1.0%)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–ª—É—á—à–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ emergency loss (—É–º–µ–Ω—å—à–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏).

---

### –ü—Ä–æ–±–ª–µ–º–∞ #4: Market fallback –¥–ª—è limit –æ—Ä–¥–µ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –æ—Ä–¥–µ—Ä–æ–≤ –∏—Å–ø–æ–ª–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ market fallback (62.5%).

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Ü–µ–Ω—ã limit –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –ª—É—á—à–µ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è.

---

### –ü—Ä–æ–±–ª–µ–º–∞ #5: –ù–∏–∑–∫–∏–π Win Rate

**–ü—Ä–æ–±–ª–µ–º–∞:** Win Rate = 37.5% (–Ω–∏–∂–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ 50%+).

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** 
- –£–ª—É—á—à–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SL/TP
- –£–ª—É—á—à–∏—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ —Ä—ã–Ω–∫–∞

---

---

## 13. –ê–ù–ê–õ–ò–ó –†–ï–ñ–ò–ú–û–í –†–´–ù–ö–ê –î–õ–Ø –ö–ê–ñ–î–û–ô –ü–ê–†–´

### ETH-USDT: –†–µ–∂–∏–º CHOPPY ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã RANGING

**–õ–æ–≥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞:**
```
2025-12-28 22:59:12.730 | INFO | ARM Detect Regime |
üß† ARM Detect Regime (SCORING SYSTEM - –ë–ï–ó FALLBACK):
   Detected: CHOPPY (confidence: 49.0%)
   Reason: Chaotic market: high volatility (36.05%), 6 reversals
   Scores: CHOPPY=0.49, TRENDING=0.38, RANGING=0.30 (–≤—ã–±—Ä–∞–Ω: CHOPPY)
   ADX: 18.8 (+DI=36.1, -DI=58.1, direction=bearish)
      ‚Üí TRENDING –ø–æ—Ä–æ–≥: 15.0 (‚úÖ)
      ‚Üí RANGING –ø–æ—Ä–æ–≥: 18.0 (‚ùå)
   Volatility: 36.05% (CHOPPY –ø–æ—Ä–æ–≥: 2.00%, ‚úÖ)
   Trend Deviation: 87.48% (–ø–æ—Ä–æ–≥: 100.00%, ‚ùå)
```

**–ê–Ω–∞–ª–∏–∑:**
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º:** CHOPPY (confidence=49.0%)
- **–ü—Ä–∏–º–µ–Ω—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** RANGING (–∏–∑ CSV: regime=ranging)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–∂–∏–º CHOPPY, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RANGING!

**–ö–æ–¥ (regime_manager.py, —Å—Ç—Ä–æ–∫–∏ 340-365):**
```python
def detect_regime(self, candles: List[Candle], current_price: float):
    # –†–∞—Å—á–µ—Ç scores
    choppy_score = 0.49
    trending_score = 0.38
    ranging_score = 0.30
    
    # –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
    if choppy_score >= trending_score and choppy_score >= ranging_score:
        regime = RegimeType.CHOPPY  # ‚úÖ –í—ã–±—Ä–∞–Ω CHOPPY
    else:
        regime = RegimeType.RANGING
    
    return RegimeDetectionResult(regime=regime, ...)
```

**–ö–æ–¥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (parameter_provider.py, —Å—Ç—Ä–æ–∫–∏ ~200-250):**
```python
def get_exit_params(self, symbol: str, regime: Optional[str] = None) -> Dict[str, Any]:
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –∏–∑ regime_manager
    if regime is None:
        regime = self.regime_manager.get_current_regime()  # ‚ùì –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å CHOPPY
    
    # –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    if regime == "ranging":  # ‚ùå –ù–æ —Ä–µ–∂–∏–º CHOPPY!
        params = {
            "sl_atr_multiplier": 2.0,
            "min_holding_minutes": 1.0,
            ...
        }
    elif regime == "choppy":
        params = {
            "sl_atr_multiplier": 0.7,  # ‚ùå –ù–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è!
            "min_holding_minutes": 1.0,
            ...
        }
    return params
```

**–í—ã–≤–æ–¥:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∏–∑ RANGING, —Ö–æ—Ç—è —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ CHOPPY (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).

---

### BTC-USDT: –†–µ–∂–∏–º TRENDING ‚Üí –ü–∞—Ä–∞–º–µ—Ç—Ä—ã RANGING

**–õ–æ–≥ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞:**
```
2025-12-28 22:59:12.723 | INFO | ARM Detect Regime |
üß† ARM Detect Regime (SCORING SYSTEM - –ë–ï–ó FALLBACK):
   Detected: TRENDING (confidence: 68.1%)
   Reason: Trending market: strong ADX 44.1, (bearish, +DI=18.0, -DI=66.8)
   Scores: CHOPPY=0.20, TRENDING=0.50, RANGING=0.63 (–≤—ã–±—Ä–∞–Ω: TRENDING)
   ADX: 44.1 (+DI=18.0, -DI=66.8, direction=bearish)
      ‚Üí TRENDING –ø–æ—Ä–æ–≥: 15.0 (‚úÖ)
      ‚Üí RANGING –ø–æ—Ä–æ–≥: 18.0 (‚ùå)
```

**–ê–Ω–∞–ª–∏–∑:**
- **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º:** TRENDING (confidence=68.1%)
- **–ü—Ä–∏–º–µ–Ω—è–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** RANGING (–∏–∑ CSV: regime=ranging)
- **–ü—Ä–æ–±–ª–µ–º–∞:** –†–µ–∂–∏–º TRENDING, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RANGING!

**–í—ã–≤–æ–¥:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∏–∑ RANGING, —Ö–æ—Ç—è —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ TRENDING (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤).

---

## 14. –ê–ù–ê–õ–ò–ó –ü–ê–†–ê–ú–ï–¢–†–û–í –ò –†–ï–ê–ö–¶–ò–ô –ë–û–¢–ê –° –ü–†–ò–ú–ï–†–ê–ú–ò

### –ü–∞—Ä–∞–º–µ—Ç—Ä #1: min_holding_minutes (RANGING —Ä–µ–∂–∏–º)

**–ó–Ω–∞—á–µ–Ω–∏–µ:** 1.0 –º–∏–Ω—É—Ç–∞

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 3210-3223):**
```python
# –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –ø–µ—Ä–µ–¥ SL
min_holding_minutes = exit_params.get("min_holding_minutes", 1.0)
if minutes_in_position < min_holding_minutes:
    logger.debug(
        f"‚è≥ –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É SL –¥–ª—è {symbol}: "
        f"–≤—Ä–µ–º—è {minutes_in_position:.1f} –º–∏–Ω < min_holding {min_holding_minutes:.1f} –º–∏–Ω"
    )
    return {"action": "hold"}  # ‚úÖ –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ä–∞–Ω–æ
```

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- **–°–¥–µ–ª–∫–∞ #1 (ETH-USDT):** –ó–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 31 —Å–µ–∫ (< 1.0 –º–∏–Ω) ‚ùå
- **–°–¥–µ–ª–∫–∞ #2 (ETH-USDT):** –ó–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 36 —Å–µ–∫ (< 1.0 –º–∏–Ω) ‚ùå
- **–°–¥–µ–ª–∫–∞ #4 (DOGE-USDT):** –ó–∞–∫—Ä—ã—Ç–∞ —á–µ—Ä–µ–∑ 122 —Å–µ–∫ (> 1.0 –º–∏–Ω) ‚úÖ

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding_minutes –Ω–µ –≤—Å–µ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–µ—Ä–µ–¥ SL/TP.

---

### –ü–∞—Ä–∞–º–µ—Ç—Ä #2: sl_atr_multiplier (RANGING —Ä–µ–∂–∏–º)

**–ó–Ω–∞—á–µ–Ω–∏–µ:** 2.0

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ (exit_analyzer.py, —Å—Ç—Ä–æ–∫–∏ 3228-3230):**
```python
# –†–∞—Å—á–µ—Ç SL –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR
sl_percent = self._get_sl_percent(symbol, "ranging", current_price, market_data)
# sl_percent —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫: ATR * sl_atr_multiplier / current_price
```

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- **–°–¥–µ–ª–∫–∞ #1 (ETH-USDT):** SL —Å—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∏ —É–±—ã—Ç–∫–µ -0.35% (sl_atr_multiplier=2.0) ‚úÖ
- **–°–¥–µ–ª–∫–∞ #5 (SOL-USDT):** SL —Å—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∏ —É–±—ã—Ç–∫–µ -1.18% (sl_atr_multiplier=2.0) ‚úÖ

**–í—ã–≤–æ–¥:** SL —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR.

---

### –ü–∞—Ä–∞–º–µ—Ç—Ä #3: ph_threshold_percent (RANGING —Ä–µ–∂–∏–º)

**–ó–Ω–∞—á–µ–Ω–∏–µ:** 1.2%

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ (position_manager.py, —Å—Ç—Ä–æ–∫–∏ ~3600-3700):**
```python
async def _check_profit_harvesting(self, symbol: str, position: Dict, ...):
    ph_threshold_percent = exit_params.get("ph_threshold_percent", 1.2)
    current_pnl_percent = self._calculate_pnl_percent(position)
    
    if current_pnl_percent >= ph_threshold_percent:  # ‚úÖ >= 1.2%
        # –ó–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏ (50%)
        partial_size = position["size"] * 0.5
        await self._close_position_partial(symbol, partial_size)
```

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- **–°–¥–µ–ª–∫–∞ #7 (ETH-USDT):** Partial TP —Å—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∏ –ø—Ä–∏–±—ã–ª–∏ +0.26% (< 1.2%) ‚ùì
- **–°–¥–µ–ª–∫–∞ #7 (ETH-USDT):** Partial TP —Å—Ä–∞–±–æ—Ç–∞–ª –ø—Ä–∏ –ø—Ä–∏–±—ã–ª–∏ +0.23% (< 1.2%) ‚ùì

**–ü—Ä–æ–±–ª–µ–º–∞:** Partial TP —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –ø—Ä–∏–±—ã–ª–∏ < ph_threshold_percent (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –ª–æ–≥–∏–∫–∏ —Ä–∞—Å—á–µ—Ç–∞ PnL%).

---

### –ü–∞—Ä–∞–º–µ—Ç—Ä #4: max_loss (RANGING + SMALL –ø—Ä–æ—Ñ–∏–ª—å)

**–ó–Ω–∞—á–µ–Ω–∏–µ:** 1.0%

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –∫–æ–¥–µ (risk_manager.py, —Å—Ç—Ä–æ–∫–∏ ~1700-1800):**
```python
async def check_emergency_exit(self, symbol: str, position: Dict, ...):
    risk_params = self.config_manager.get_adaptive_risk_params("ranging", "small")
    max_loss_percent = risk_params.get("max_loss", 1.0)  # ‚úÖ 1.0%
    
    current_pnl_percent = self._calculate_pnl_percent(position)
    
    if current_pnl_percent <= -max_loss_percent:  # ‚ùå -1.58% <= -1.0%
        return {"action": "close", "reason": "emergency_loss_protection"}
```

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:**
- **–°–¥–µ–ª–∫–∞ #3 (ETH-USDT):** Emergency Loss –ø—Ä–∏ —É–±—ã—Ç–∫–µ -1.58% (> max_loss=1.0%) ‚ùå
- **–°–¥–µ–ª–∫–∞ #14 (ETH-USDT):** Emergency Loss –ø—Ä–∏ —É–±—ã—Ç–∫–µ -1.59% (> max_loss=1.0%) ‚ùå
- **–°–¥–µ–ª–∫–∞ #25 (ETH-USDT):** Emergency Loss –ø—Ä–∏ —É–±—ã—Ç–∫–µ -1.36% (> max_loss=1.0%) ‚ùå

**–ü—Ä–æ–±–ª–µ–º–∞:** Emergency Loss Protection —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–∑–¥–Ω–æ (—É–±—ã—Ç–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_loss, –≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏).

---

## 15. –°–†–ê–í–ù–ï–ù–ò–ï –§–ê–ö–¢–ò–ß–ï–°–ö–ò–• –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –° –û–ñ–ò–î–ê–ï–ú–´–ú–ò

### –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞):

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –û–∂–∏–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –ò—Å—Ç–æ—á–Ω–∏–∫ |
|----------|-------------------|----------|
| **min_holding_minutes** | 1.0 –º–∏–Ω | config_futures.yaml |
| **sl_atr_multiplier** | 2.0 | config_futures.yaml |
| **max_loss** | 1.0% | config_futures.yaml |
| **ph_threshold_percent** | 1.2% | config_futures.yaml |
| **Win Rate** | > 50% | –û–∂–∏–¥–∞–Ω–∏–µ |

### –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|----------|---------------------|--------|
| **min_holding_minutes** | –ù–µ –≤—Å–µ–≥–¥–∞ —Å–æ–±–ª—é–¥–∞–µ—Ç—Å—è (31-36 —Å–µ–∫ < 1.0 –º–∏–Ω) | ‚ùå |
| **sl_atr_multiplier** | –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (SL —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR) | ‚úÖ |
| **max_loss** | –ü—Ä–µ–≤—ã—à–∞–µ—Ç—Å—è (—É–±—ã—Ç–æ–∫ –¥–æ -1.58% > 1.0%) | ‚ùå |
| **ph_threshold_percent** | –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –ø—Ä–∏–±—ã–ª–∏ < 1.2% | ‚ùì |
| **Win Rate** | 37.5% (< 50%) | ‚ùå |

---

## 16. –ò–¢–û–ì–û–í–´–ï –í–´–í–û–î–´

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

1. **Slippage —É—á–µ—Ç:** –í—Å–µ —Å–∏–≥–Ω–∞–ª—ã –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è –Ω–∞ 0.1% ‚úÖ
2. **SL –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (sl_atr_multiplier=2.0) ‚úÖ
3. **Partial TP:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–∑–∞–∫—Ä—ã—Ç–∏–µ —á–∞—Å—Ç–∏ –ø–æ–∑–∏—Ü–∏–∏) ‚úÖ
4. **–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (CHOPPY, TRENDING, RANGING) ‚úÖ
5. **–ß—Ç–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–∏–∑ config_futures.yaml) ‚úÖ

### ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:

1. **–¶–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞ vs —Ü–µ–Ω–∞ —Å–∏–≥–Ω–∞–ª–∞:** –†–∞–∑–Ω–∏—Ü–∞ –¥–æ 11.5% (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
2. **–ë—ã—Å—Ç—Ä–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ SL/TP:** –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Ä–∞–Ω—å—à–µ min_holding_minutes (31-36 —Å–µ–∫ < 1.0 –º–∏–Ω)
3. **Emergency Loss –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ:** –£–±—ã—Ç–æ–∫ –ø—Ä–µ–≤—ã—à–∞–µ—Ç max_loss (–≤–æ–∑–º–æ–∂–Ω–æ, –∑–∞–¥–µ—Ä–∂–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
4. **–†–µ–∂–∏–º vs –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:** –†–µ–∂–∏–º CHOPPY/TRENDING, –Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã RANGING
5. **–ù–∏–∑–∫–∏–π Win Rate:** 37.5% (< –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ 50%+)

### üìä –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞ —Ü–µ–Ω—ã –æ—Ä–¥–µ—Ä–∞** –≤ `entry_manager.py` –∏–ª–∏ `order_executor.py`
2. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É min_holding_minutes** –ø–µ—Ä–µ–¥ SL/TP –≤ `exit_analyzer.py`
3. **–£–ª—É—á—à–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ emergency loss** (—É–º–µ–Ω—å—à–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏)
4. **–ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ —Ä–µ–∂–∏–º—É** (CHOPPY/TRENDING –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≤–æ–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
5. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤** –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è Win Rate

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 28.12.2025  
**–í–µ—Ä—Å–∏—è:** 2.0 (—Å –¥–µ—Ç–∞–ª—å–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º –≤—Å–µ—Ö —Å–¥–µ–ª–æ–∫, —Ä–µ–∂–∏–º–æ–≤ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤)  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω, –≤—Å–µ —Å–¥–µ–ª–∫–∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Ü–∏—Ñ—Ä–∞–º–∏ –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏ –∏–∑ –∫–æ–¥–∞

