# ‚ö° –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ô –ì–†–û–ö–ê (2025-12-21)

**–î–∞—Ç–∞:** 2025-12-21  
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ì—Ä–æ–∫–∞ –ø–æ –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ TCC cycle  
**–¶–µ–ª—å:** –°–Ω–∏–∑–∏—Ç—å cycle time —Å 18-19s –¥–æ <10s

---

## ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

### 1. ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—è–∂–µ–ª—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (TTL 60s)

**–ü—Ä–æ–±–ª–µ–º–∞:** VolumeProfile/OrderFlow/Liquidity –∑–∞–Ω–∏–º–∞—é—Ç 20-30% –≤—Ä–µ–º–µ–Ω–∏ signals (historical data, API calls)

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω TTL –¥–ª—è VolumeProfile/OrderFlow/Liquidity –¥–æ **60 —Å–µ–∫—É–Ω–¥** (–±—ã–ª–æ 20s)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —ç—Ç–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ –≤ `FilterManager`
- ‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω—ã TTL: –±—ã—Å—Ç—Ä—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã (ADX/MTF/Pivot) - 20s, —Ç—è–∂–µ–ª—ã–µ - 60s

**–ö–æ–¥:**
```python
# filter_manager.py
self.filter_cache_ttl_fast: float = 20.0  # ADX/MTF/Pivot
self.filter_cache_ttl_slow: float = 60.0  # VolumeProfile/OrderFlow/Liquidity

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
cached_vp_result = self._get_cached_filter_result(symbol, "volume_profile", use_slow_ttl=True)
cached_liquidity_result = self._get_cached_filter_result(symbol, "liquidity", use_slow_ttl=True)
cached_of_result = self._get_cached_filter_result(symbol, "order_flow", use_slow_ttl=True)
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** -20-30% –≤—Ä–µ–º–µ–Ω–∏ signals (—Å 15-16k ms –¥–æ 10-12k ms)

---

### 2. ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API calls (leverage/instrument info)

**–ü—Ä–æ–±–ª–µ–º–∞:** API calls –¥–ª—è leverage –∏ instrument details –∑–∞–Ω–∏–º–∞—é—Ç 1-2s –∫–∞–∂–¥—ã–π —Ü–∏–∫–ª

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω TTL 300s (5 –º–∏–Ω—É—Ç) –¥–ª—è `get_instrument_leverage_info`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ `round_leverage_to_available` (TTL 300s)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ `get_instrument_info` (TTL 300s)

**–ö–æ–¥:**
```python
# futures_client.py
self._leverage_info_cache: dict = {}  # {symbol: {'max': 125, 'avail': [...], 'ts': now}}
self._leverage_info_cache_ttl: float = 300.0  # 5 –º–∏–Ω—É—Ç

self._leverage_round_cache: dict = {}  # {(symbol, desired): {'rounded': 20, 'ts': now}}
self._leverage_round_cache_ttl: float = 300.0  # 5 –º–∏–Ω—É—Ç

self._instrument_info_cache: dict = {}  # {inst_type: {'data': [...], 'ts': now}}
self._instrument_info_cache_ttl: float = 300.0  # 5 –º–∏–Ω—É—Ç
```

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** -20% –≤—Ä–µ–º–µ–Ω–∏ monitor (—Å 1.9k ms –¥–æ 1.5k ms)

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –ì—Ä–æ–∫–∞:
- **Cycle time:** 18-19 —Å–µ–∫—É–Ω–¥
- **Signals:** 15-16k ms (86% –≤—Ä–µ–º–µ–Ω–∏)
- **Monitor:** 1.9k ms

### –ü–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π –ì—Ä–æ–∫–∞:
- **Cycle time:** 10-12 —Å–µ–∫—É–Ω–¥ (-35-45%)
- **Signals:** 10-12k ms (-25-35%)
- **Monitor:** 1.5k ms (-20%)

---

## üîß –ß–¢–û –û–°–¢–ê–õ–û–°–¨ (–∏–∑ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ì—Ä–æ–∫–∞)

### 1. ‚ö†Ô∏è Async API –¥–ª—è leverage/positions (High priority)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–î–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `aiohttp` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ leverage/positions

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** -20% –≤—Ä–µ–º–µ–Ω–∏ monitor

---

### 2. ‚ö†Ô∏è Limit symbols to 5 (Medium priority)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (—Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞)

**–î–µ–π—Å—Ç–≤–∏–µ:** –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–≤–æ–ª–æ–≤ –¥–æ 5 (BTC/SOL/ETH/DOGE/XRP)

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** -30% –≤—Ä–µ–º–µ–Ω–∏ parallel processing

---

### 3. ‚ö†Ô∏è ThreadPool –¥–ª—è filters (Low priority)

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–î–µ–π—Å—Ç–≤–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `ThreadPoolExecutor` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:** -10-15% –≤—Ä–µ–º–µ–Ω–∏ signals

---

## ‚úÖ –ò–¢–û–ì

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—è–∂–µ–ª—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ (TTL 60s)
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ API calls (leverage/instrument info, TTL 300s)

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- **Cycle time:** 18-19s ‚Üí **10-12s** (-35-45%)
- **Signals:** 15-16k ms ‚Üí **10-12k ms** (-25-35%)

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
- ‚ö†Ô∏è Async API –¥–ª—è leverage/positions (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏)
- ‚ö†Ô∏è Limit symbols (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞)

---

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 2025-12-21  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û—Å–Ω–æ–≤–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –ì—Ä–æ–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã  
**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:** –î–∞








