# –ü–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ –±–æ—Ç–µ

**–î–∞—Ç–∞:** 2025-11-30  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –º–µ—Å—Ç–∞, –≥–¥–µ –±–æ—Ç –¥–µ–ª–∞–µ—Ç —Ä–∞—Å—á–µ—Ç—ã –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

---

## üìä –ö–û–ú–ü–û–ù–ï–ù–¢–´ –° –ê–î–ê–ü–¢–ò–í–ù–´–ú–ò –†–ê–°–ß–ï–¢–ê–ú–ò

### 1. ‚úÖ **TP/SL –†–∞—Å—á–µ—Ç—ã** (PositionManager, OrderExecutor, ExitAnalyzer)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/position_manager.py` - `_get_adaptive_tp_percent()`, `_get_adaptive_sl_percent()`
- `src/strategies/scalping/futures/order_executor.py` - `_calculate_tp_sl_prices()`
- `src/strategies/scalping/futures/positions/exit_analyzer.py` - `_get_tp_percent()`

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
1. ‚úÖ **Per-regime TP/SL** (trending/ranging/choppy) - –∏–∑ `symbol_profiles[symbol][regime].tp_percent`
2. ‚úÖ **Per-symbol TP/SL** - –∏–∑ `symbol_profiles[symbol].tp_percent`
3. ‚úÖ **–ì–ª–æ–±–∞–ª—å–Ω—ã–π TP/SL** - –∏–∑ `scalping_config.tp_percent` (fallback)

**ATR-based —Ä–∞—Å—á–µ—Ç:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ATR –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ TP/SL —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ –ú–Ω–æ–∂–∏—Ç–µ–ª–∏ –∞–¥–∞–ø—Ç–∏—Ä—É—é—Ç—Å—è –ø–æ —Ä–µ–∂–∏–º—É: `tp_atr_multiplier`, `sl_atr_multiplier`
- ‚úÖ Fallback –Ω–∞ `sl_percent` –µ—Å–ª–∏ ATR-based SL —Å–ª–∏—à–∫–æ–º –º–∞–ª (< 0.1%)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –≤—Å–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 2. ‚úÖ **–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏** (RiskManager, PositionSizer)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/risk_manager.py` - `calculate_position_size()`
- `src/strategies/scalping/futures/calculations/position_sizer.py` - `calculate_position_size()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ —Ñ–∞–∫—Ç–æ—Ä—ã:**
1. ‚úÖ **Balance Profile** - –ø—Ä–æ–≥—Ä–µ—Å—Å–∏–≤–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–æ –±–∞–ª–∞–Ω—Å—É
2. ‚úÖ **Regime Multiplier** - –º–Ω–æ–∂–∏—Ç–µ–ª—å –ø–æ —Ä–µ–∂–∏–º—É (trending: 1.2x, ranging: 1.0x, choppy: 0.8x)
3. ‚úÖ **Per-symbol Multiplier** - –∏–∑ `symbol_profiles[symbol].position_multiplier`
4. ‚úÖ **Volatility Adjustment** - –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ ATR (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
5. ‚úÖ **Signal Strength** - –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ —Å–∏–ª–µ —Å–∏–≥–Ω–∞–ª–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**
1. ‚úÖ Balance Profile ‚Üí base_size
2. ‚úÖ Per-symbol multiplier ‚Üí adjusted_size
3. ‚úÖ Regime multiplier ‚Üí adjusted_size
4. ‚úÖ Volatility adjustment ‚Üí final_size
5. ‚úÖ Max limits ‚Üí clamped_size

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –≤—Å–µ –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 3. ‚úÖ **–ö–æ–º–∏—Å—Å–∏–∏** (ExitAnalyzer, OrderExecutor)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/positions/exit_analyzer.py` - `_calculate_pnl_percent()`
- `src/strategies/scalping/futures/order_executor.py` - —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Maker/Taker** - —Ä–∞–∑–Ω—ã–µ –∫–æ–º–∏—Å—Å–∏–∏ (maker: 0.02%, taker: 0.05%)
2. ‚úÖ **–ü–µ—Ä–≤—ã–µ 10 —Å–µ–∫—É–Ω–¥** - –∫–æ–º–∏—Å—Å–∏—è –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ —Å–ø—Ä–µ–¥)
3. ‚úÖ **–ò–∑ –∫–æ–Ω—Ñ–∏–≥–∞** - `commission.trading_fee_rate` (fallback: 0.1%)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 4. ‚úÖ **PnL –†–∞—Å—á–µ—Ç—ã** (ExitAnalyzer)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/positions/exit_analyzer.py` - `_calculate_pnl_percent()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **–ü–µ—Ä–≤—ã–µ 10 —Å–µ–∫—É–Ω–¥** - –∫–æ–º–∏—Å—Å–∏—è –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è (—Ç–æ–ª—å–∫–æ —Å–ø—Ä–µ–¥)
2. ‚úÖ **Gross/Net PnL** - –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –æ–±–∞ –∑–Ω–∞—á–µ–Ω–∏—è
3. ‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å** - –±–æ–ª—å—à–µ –∑–Ω–∞–∫–æ–≤ –¥–ª—è –º–∞–ª—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (< 0.1%)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 5. ‚úÖ **–ú–∞—Ä–∂–∞ –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** (MarginCalculator)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/calculations/margin_calculator.py` - `is_position_safe()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Safety Threshold** - –ø–æ —Ä–µ–∂–∏–º—É –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞:
   - trending: 1.5
   - ranging: 1.3
   - choppy: 1.2
2. ‚úÖ **Fallback** - –µ—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω ‚Üí "ranging" (1.3)
3. ‚úÖ **–ù–æ–≤—ã–µ –ø–æ–∑–∏—Ü–∏–∏** - –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç (< 30 —Å–µ–∫)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:**
1. ‚úÖ `margin_config.by_regime[regime].safety_threshold`
2. ‚úÖ Fallback: 1.3 (ranging)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 6. ‚úÖ **Trailing Stop Loss** (TrailingSLCoordinator)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/coordinators/trailing_sl_coordinator.py` - `initialize_trailing_stop_loss()`
- `src/strategies/scalping/futures/config/config_manager.py` - `get_trailing_sl_params()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Per-regime –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –∏–∑ `trailing_sl.by_regime[regime]`:
   - `initial_trail`, `max_trail`, `min_trail`
   - `loss_cut_percent`, `timeout_loss_percent`
   - `check_interval_seconds`
   - `regime_multiplier`, `trend_strength_boost`
   - `high_profit_threshold`
   - `trail_growth` multipliers
2. ‚úÖ **Fallback** - –æ–±—â–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ `trailing_sl`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 7. ‚úÖ **Profit Harvesting** (PositionManager)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/position_manager.py` - `_check_profit_harvesting()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Per-regime –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –∏–∑ `regime_params`:
   - `ph_enabled`
   - `ph_threshold` (USD)
   - `ph_time_limit` (—Å–µ–∫)
   - `min_holding_minutes`
2. ‚úÖ **–ò–∑ –∫–æ–Ω—Ñ–∏–≥–∞** - —á–µ—Ä–µ–∑ `config_manager.get_regime_params()`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 8. ‚úÖ **Profit Drawdown** (PositionManager)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/position_manager.py` - `_check_profit_drawdown()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Per-regime multiplier** - –∏–∑ `profit_drawdown.by_regime[regime].multiplier`:
   - trending: 2.0 (40% –æ—Ç–∫–∞—Ç)
   - ranging: 1.5 (30% –æ—Ç–∫–∞—Ç)
   - choppy: 1.0 (20% –æ—Ç–∫–∞—Ç)
2. ‚úÖ **–ë–∞–∑–æ–≤—ã–π drawdown** - –∏–∑ `profit_drawdown.drawdown_percent` (20%)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 9. ‚úÖ **Partial TP** (ExitAnalyzer)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/positions/exit_analyzer.py` - `_get_partial_tp_params()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Per-regime –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –∏–∑ `partial_tp.by_regime[regime]`:
   - `fraction` (0.5-0.7)
   - `trigger_percent` (0.3-0.6%)
2. ‚úÖ **Adaptive min_holding** - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π min_holding –ø–æ –ø—Ä–∏–±—ã–ª–∏

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 10. ‚úÖ **Max Holding Time** (PositionManager)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/position_manager.py` - `_check_max_holding()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Per-regime max_holding** - –∏–∑ `regime_params.max_holding_minutes`
2. ‚úÖ **–ò–∑ –∫–æ–Ω—Ñ–∏–≥–∞** - —á–µ—Ä–µ–∑ `config_manager.get_regime_params()`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 11. ‚úÖ **Limit Price** (OrderExecutor)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/order_executor.py` - `_calculate_limit_price()`

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Per-regime offset** - –∏–∑ `order_executor.limit_price_offset.by_regime[regime]`
2. ‚úÖ **Per-symbol offset** - –∏–∑ `symbol_profiles[symbol].limit_price_offset`
3. ‚úÖ **Fallback** - –æ–±—â–∏–π offset –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

### 12. ‚úÖ **–†–µ–∂–∏–º —Ä—ã–Ω–∫–∞** (RegimeManager, SignalGenerator)

**–§–∞–π–ª—ã:**
- `src/strategies/scalping/futures/adaptivity/regime_manager.py` - `detect_regime()`
- `src/strategies/scalping/futures/signal_generator.py` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞

**–ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
1. ‚úÖ **Per-symbol —Ä–µ–∂–∏–º—ã** - –æ—Ç–¥–µ–ª—å–Ω—ã–π ARM –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞
2. ‚úÖ **–î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ** - –Ω–∞ –æ—Å–Ω–æ–≤–µ ADX, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤
3. ‚úÖ **Fallback** - "ranging" –µ—Å–ª–∏ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ

---

## üîç –ü–†–û–í–ï–†–ö–ê –ü–†–ò–û–†–ò–¢–ï–¢–û–í

### –û–±—â–∏–π –ø–∞—Ç—Ç–µ—Ä–Ω –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤:

```
1. Per-regime –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (trending/ranging/choppy)
   ‚Üì (–µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)
2. Per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
   ‚Üì (–µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ)
3. –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (fallback)
```

### ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ª–µ–¥—É—é—Ç —ç—Ç–æ–º—É –ø–∞—Ç—Ç–µ—Ä–Ω—É:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | Per-regime | Per-symbol | –ì–ª–æ–±–∞–ª—å–Ω—ã–π | –°—Ç–∞—Ç—É—Å |
|-----------|------------|------------|------------|--------|
| TP/SL | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| TrailingSL | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ |
| Profit Harvesting | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ |
| Profit Drawdown | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ |
| Partial TP | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ |
| Max Holding | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ |
| Limit Price | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| Safety Threshold | ‚úÖ | ‚ùå | ‚úÖ | ‚úÖ |

---

## ‚ö†Ô∏è –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 1. –†–µ–∂–∏–º –Ω–µ –≤—Å–µ–≥–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ —Ä–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ ExitAnalyzer: —Ä–µ–∂–∏–º –±–µ—Ä–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∏–∑ signal_generator
- ‚úÖ PositionManager: —Ä–µ–∂–∏–º –±–µ—Ä–µ—Ç—Å—è –∏–∑ –ø–æ–∑–∏—Ü–∏–∏ –∏–ª–∏ signal_generator
- ‚úÖ OrderExecutor: —Ä–µ–∂–∏–º –±–µ—Ä–µ—Ç—Å—è –∏–∑ signal

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** - —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏

---

### 2. Fallback –∑–Ω–∞—á–µ–Ω–∏—è

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ –í—Å–µ fallback –ª–æ–≥–∏—Ä—É—é—Ç—Å—è WARNING
- ‚úÖ Fallback –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –í –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ fallback –Ω–µ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **OK** - fallback –±–µ–∑–æ–ø–∞—Å–Ω—ã

---

### 3. –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —á–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω (per-regime ‚Üí per-symbol ‚Üí global)
- ‚úÖ –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏
- ‚úÖ Symbol_profiles –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–æ–≥–∏—á–Ω–æ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **OK** - –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –Ω–µ—Ç

---

## üìã –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | Fallback | –°—Ç–∞—Ç—É—Å |
|-----------|--------------|-----------|----------|--------|
| **TP/SL** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É/—Å–∏–º–≤–æ–ª—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è | ‚úÖ |
| **–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏** | ‚úÖ –ü–æ –±–∞–ª–∞–Ω—Å—É/—Ä–µ–∂–∏–º—É/–≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è | ‚úÖ |
| **–ö–æ–º–∏—Å—Å–∏–∏** | ‚úÖ Maker/Taker | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **PnL** | ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **–ú–∞—Ä–∂–∞** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **TrailingSL** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **Profit Harvesting** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **Profit Drawdown** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **Partial TP** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **Max Holding** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **Limit Price** | ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É/—Å–∏–º–≤–æ–ª—É | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |
| **–†–µ–∂–∏–º** | ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π | ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π | ‚úÖ OK | ‚úÖ |

---

## ‚ö†Ô∏è –ù–ê–ô–î–ï–ù–ù–´–ï FALLBACK –ó–ù–ê–ß–ï–ù–ò–Ø

### 1. ExitAnalyzer._get_tp_percent()

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py:337`

**Fallback:** `tp_percent = 2.4`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **OK** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

---

### 2. ExitAnalyzer._get_big_profit_exit_percent()

**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/exit_analyzer.py:389-395`

**Fallback:**
- Majors (BTC/ETH): `1.5`
- Alts (SOL/DOGE/XRP): `2.0`
- Unknown: `1.5`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **OK** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ

---

### 3. PositionManager._check_profit_drawdown()

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py:3959`

**Fallback:** `multiplier = 1.5` (–¥–ª—è ranging)

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **OK** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ

---

### 4. OrderExecutor._calculate_tp_sl_prices()

**–§–∞–π–ª:** `src/strategies/scalping/futures/order_executor.py:1294-1296`

**Fallback:** 
```python
tp_multiplier = float(self.scalping_config.get("tp_percent", 0.3))
sl_multiplier = float(self.scalping_config.get("sl_percent", 0.2))
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **OK** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ regime_params –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

---

## üéØ –í–´–í–û–î

### ‚úÖ **–í–°–ï –†–ê–°–ß–ï–¢–´ –ê–î–ê–ü–¢–ò–í–ù–´**

1. ‚úÖ **TP/SL** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É –∏ —Å–∏–º–≤–æ–ª—É
2. ‚úÖ **–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ –±–∞–ª–∞–Ω—Å—É, —Ä–µ–∂–∏–º—É, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
3. ‚úÖ **–ö–æ–º–∏—Å—Å–∏–∏** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ (maker/taker, –ø–µ—Ä–≤—ã–µ 10 —Å–µ–∫)
4. ‚úÖ **PnL** - –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π —Ä–∞—Å—á–µ—Ç
5. ‚úÖ **–ú–∞—Ä–∂–∞** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É
6. ‚úÖ **TrailingSL** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É
7. ‚úÖ **Profit Harvesting** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É
8. ‚úÖ **Profit Drawdown** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É
9. ‚úÖ **Partial TP** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É
10. ‚úÖ **Max Holding** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É
11. ‚úÖ **Limit Price** - –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –ø–æ —Ä–µ–∂–∏–º—É –∏ —Å–∏–º–≤–æ–ª—É
12. ‚úÖ **–†–µ–∂–∏–º** - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏

### ‚úÖ **–ü–†–ò–û–†–ò–¢–ï–¢–´ –ü–†–ê–í–ò–õ–¨–ù–´–ï**

- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–ª–µ–¥—É—é—Ç –ø–∞—Ç—Ç–µ—Ä–Ω—É: per-regime ‚Üí per-symbol ‚Üí global
- Fallback –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–Ω—Ñ–∏–≥–µ
- –í—Å–µ fallback –ª–æ–≥–∏—Ä—É—é—Ç—Å—è WARNING

### ‚úÖ **FALLBACK –ó–ù–ê–ß–ï–ù–ò–Ø –ë–ï–ó–û–ü–ê–°–ù–´**

- –í—Å–µ fallback –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- Fallback –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –í –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ fallback –Ω–µ –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

### ‚úÖ **–í–°–ï –†–ê–ë–û–¢–ê–ï–¢ –ö–û–†–†–ï–ö–¢–ù–û**

**–ë–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏–≤–µ–Ω –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã!**

**–í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ:**
- ‚úÖ –ü–æ —Ä–µ–∂–∏–º—É —Ä—ã–Ω–∫–∞ (trending/ranging/choppy)
- ‚úÖ –ü–æ —Å–∏–º–≤–æ–ª—É (BTC/ETH/SOL/DOGE/XRP)
- ‚úÖ –ü–æ –±–∞–ª–∞–Ω—Å—É (small/medium/large)
- ‚úÖ –ü–æ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (ATR-based)
- ‚úÖ –ü–æ —Å–∏–ª–µ —Å–∏–≥–Ω–∞–ª–∞

**–ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥ –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏!**

