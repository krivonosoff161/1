# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è: adaptive_regime –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è (29.11.2025)

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. **–ü—Ä–æ–±–ª–µ–º–∞ —Å `adaptive_regime` (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞)**

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í `position_manager.py` –Ω–∞ —Å—Ç—Ä–æ–∫–µ 3816-3822 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è `hasattr()` –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ `adaptive_regime`
- `adaptive_regime` –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–∞–∫ **—Å–ª–æ–≤–∞—Ä—å**, –∞ –Ω–µ –æ–±—ä–µ–∫—Ç Pydantic
- –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏–ª–æ –∫ —Ç–æ–º—É, —á—Ç–æ `max_holding_minutes` –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –†–∞–±–æ—Ç–∞–µ–º –∫–∞–∫ —Å–æ —Å–ª–æ–≤–∞—Ä—è–º–∏, —Ç–∞–∫ –∏ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏ Pydantic
if isinstance(adaptive_regime, dict):
    # –ï—Å–ª–∏ —ç—Ç–æ —Å–ª–æ–≤–∞—Ä—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º .get()
    if regime and regime in adaptive_regime:
        regime_config = adaptive_regime.get(regime, {})
    elif "ranging" in adaptive_regime:
        regime_config = adaptive_regime.get("ranging", {})
else:
    # –ï—Å–ª–∏ —ç—Ç–æ –æ–±—ä–µ–∫—Ç Pydantic, –∏—Å–ø–æ–ª—å–∑—É–µ–º getattr/hasattr
    if regime and hasattr(adaptive_regime, regime):
        regime_config = getattr(adaptive_regime, regime)
    elif hasattr(adaptive_regime, "ranging"):
        regime_config = getattr(adaptive_regime, "ranging")

if regime_config:
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –†–∞–±–æ—Ç–∞–µ–º –∫–∞–∫ —Å–æ —Å–ª–æ–≤–∞—Ä—è–º–∏, —Ç–∞–∫ –∏ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏
    if isinstance(regime_config, dict):
        max_holding_minutes = float(regime_config.get("max_holding_minutes", 120.0))
    else:
        max_holding_minutes = float(getattr(
            regime_config, "max_holding_minutes", 120.0
        ))
```

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py` (—Å—Ç—Ä–æ–∫–∞ 3813-3832)

---

### 2. **–ü—Ä–æ–±–ª–µ–º–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π** ‚ö†Ô∏è

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–∑–∏—Ü–∏–∏ **SOL-USDT** –∏ **BTC-USDT** –∑–∞–∫—Ä—ã–ª–∏—Å—å –Ω–∞ –±–∏—Ä–∂–µ:
  - **SOL-USDT**: –∑–∞–∫—Ä—ã—Ç–∞ –≤ 18:11:20, –ø—Ä–∏–±—ã–ª—å +0.18 USDT (+0.43%)
  - **BTC-USDT**: –∑–∞–∫—Ä—ã—Ç–∞ –≤ 18:10:57, –ø—Ä–∏–±—ã–ª—å +0.25 USDT (+0.52%)
- –í –ª–æ–≥–∞—Ö **–ù–ï–¢ –∑–∞–ø–∏—Å–µ–π** –æ –∑–∞–∫—Ä—ã—Ç–∏–∏ —ç—Ç–∏—Ö –ø–æ–∑–∏—Ü–∏–π
- –ë–æ—Ç –Ω–µ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–ª —Ñ–∞–∫—Ç –∑–∞–∫—Ä—ã—Ç–∏—è

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. –ó–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, Trailing Stop Loss)
2. WebSocket –Ω–µ –ø–µ—Ä–µ–¥–∞–ª –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
3. –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
4. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `handle_position_closed_via_ws`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `_close_position_by_reason`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ –±–æ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ WebSocket

---

## üìä –î–∞–Ω–Ω—ã–µ –æ –∑–∞–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö

### SOL-USDT LONG
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 29.11.2025, 18:02:04
- **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è:** 29.11.2025, 18:11:20
- **–í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏:** ~9 –º–∏–Ω—É—Ç 16 —Å–µ–∫—É–Ω–¥
- **–í—Ö–æ–¥–Ω–∞—è —Ü–µ–Ω–∞:** 138.08 USDT
- **–¶–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞:** 138.33 USDT
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å:** +0.18 USDT (+0.43%)
- **–†–∞–∑–º–µ—Ä:** 1.55 SOL

### BTC-USDT LONG
- **–í—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è:** 29.11.2025, 18:03:07
- **–í—Ä–µ–º—è –∑–∞–∫—Ä—ã—Ç–∏—è:** 29.11.2025, 18:10:57
- **–í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏:** ~7 –º–∏–Ω—É—Ç 50 —Å–µ–∫—É–Ω–¥
- **–í—Ö–æ–¥–Ω–∞—è —Ü–µ–Ω–∞:** 90,612.4 USDT
- **–¶–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞:** 90,798.7 USDT
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–∏–±—ã–ª—å:** +0.25 USDT (+0.52%)
- **–†–∞–∑–º–µ—Ä:** 0.0027 BTC

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∑–∞–≥—Ä—É–∑–∫–∞ `max_holding_minutes` –∏–∑ `adaptive_regime` –≤ `_check_max_holding`
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–≤–∞—Ä–µ–π –∏ –æ–±—ä–µ–∫—Ç–æ–≤ Pydantic –¥–ª—è `adaptive_regime`

---

## ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–∞–ª—å–Ω–µ–π—à–∞—è —Ä–∞–±–æ—Ç–∞

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π:**
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `_close_position_by_reason` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∑–∞–∫—Ä—ã—Ç–∏—è —á–µ—Ä–µ–∑ WebSocket

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞–∫—Ä—ã—Ç–∏—è:**
   - Trailing Stop Loss
   - Take Profit
   - Profit Harvesting
   - Max Holding

3. **–î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–∫—Ç –∑–∞–∫—Ä—ã—Ç–∏—è —á–µ—Ä–µ–∑ WebSocket
   - –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É –∑–∞–∫—Ä—ã—Ç–∏—è

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –û–±–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–ª–∏—Å—å —Å **–ø—Ä–∏–±—ã–ª—å—é** (+0.18 –∏ +0.25 USDT)
- –í—Ä–µ–º—è –≤ –ø–æ–∑–∏—Ü–∏–∏ –±—ã–ª–æ **–∫–æ—Ä–æ—Ç–∫–∏–º** (7-9 –º–∏–Ω—É—Ç), —á—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–∫–∞–ª—å–ø–∏–Ω–≥—É
- –ü—Ä–æ–±–ª–µ–º–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º **–∫—Ä–∏—Ç–∏—á–Ω–∞** - –±–µ–∑ –ª–æ–≥–æ–≤ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –∏ –∫–∞–∫ –∑–∞–∫—Ä—ã–ª–∏—Å—å –ø–æ–∑–∏—Ü–∏–∏





