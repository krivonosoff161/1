# ‚úÖ –ü–†–û–í–ï–†–ö–ê –ü–ï–†–ï–î –ó–ê–ü–£–°–ö–û–ú

## üß™ –ü–†–û–í–ï–†–ö–ê –ö–û–ú–ü–ò–õ–Ø–¶–ò–ò

### ‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ:

```bash
‚úÖ exit_analyzer.py - OK
‚úÖ risk_manager.py - OK
‚úÖ orchestrator.py - OK
‚úÖ trailing_stop_loss.py - OK
‚úÖ position_registry.py - OK
‚úÖ config_manager.py - OK
```

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–°–ï –§–ê–ô–õ–´ –ö–û–ú–ü–ò–õ–ò–†–£–Æ–¢–°–Ø –ë–ï–ó –û–®–ò–ë–û–ö**

---

## üß© –ú–ò–ù–ò–ú–ê–õ–¨–ù–´–ô –ù–ê–ë–û–† –î–õ–Ø ¬´–í–°–Å –û–ö¬ª –ü–û–°–õ–ï –î–ï–ü–õ–û–Ø

### üìã –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|---------------|---------------------|
| **–ù–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ** | `grep -i error logs/futures/info_*.log \| head -5` | –ü—É—Å—Ç–æ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è |
| **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å** | `grep "‚úÖ .* –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω" logs/futures/info_*.log` | 5 —à—Ç—É–∫:<br>- CandlePatternDetector<br>- VolumeProfileCalculator<br>- PivotCalculator<br>- LiquidityLevelsDetector<br>- ExitAnalyzer |
| **Smart-close –Ω–µ –¥–µ—Ä–≥–∞–µ—Ç—Å—è** | `grep "smart_close\|Smart Close" logs/futures/info_*.log` | ‚â§ 1 —Ä–∞–∑–∞ –≤ —á–∞—Å (–∏–ª–∏ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏ —É–±—ã—Ç–∫–∏ < -3.0%) |
| **Locks –æ—á–∏—â–∞—é—Ç—Å—è** | `grep "–û—á–∏—â–µ–Ω lock" logs/futures/info_*.log` | –ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ close |
| **Partial TP 1 —Ä–∞–∑** | `grep "Partial TP —É–∂–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω" logs/futures/info_*.log` | –ü–æ—è–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏ —Ü–µ–Ω–∞ –≤–µ—Ä–Ω—É–ª–∞—Å—å –∫ +1% –ø–æ—Å–ª–µ partial_tp |

---

## üîç –ö–û–ú–ê–ù–î–´ –î–õ–Ø –ü–†–û–í–ï–†–ö–ò (PowerShell)

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:

```powershell
Get-Content "logs\futures\info_*.log" | Select-String -Pattern "ERROR|Exception|Traceback" | Select-Object -First 10
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –ü—É—Å—Ç–æ –∏–ª–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏)

---

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤:

```powershell
Get-Content "logs\futures\info_*.log" | Select-String -Pattern "‚úÖ .* –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω" | Select-Object -First 10
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
```
‚úÖ CandlePatternDetector –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ VolumeProfileCalculator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ PivotCalculator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ LiquidityLevelsDetector –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
‚úÖ ExitAnalyzer –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
```

---

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ smart-close:

```powershell
Get-Content "logs\futures\info_*.log" | Select-String -Pattern "smart_close|Smart Close|—É–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ" | Select-Object -First 10
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: 
- –ù–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏ —É–±—ã—Ç–∫–∏ < -3.0%
- –ò–ª–∏ ‚â§ 1 —Ä–∞–∑–∞ –≤ —á–∞—Å, –µ—Å–ª–∏ —É–±—ã—Ç–∫–∏ >= -3.0%

---

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—á–∏—Å—Ç–∫–∏ locks:

```powershell
Get-Content "logs\futures\info_*.log" | Select-String -Pattern "–û—á–∏—â–µ–Ω lock|–û—á–∏—â–µ–Ω drift_lock" | Select-Object -First 10
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏

---

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ partial TP:

```powershell
Get-Content "logs\futures\info_*.log" | Select-String -Pattern "Partial TP —É–∂–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω" | Select-Object -First 5
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ—è–≤–ª—è–µ—Ç—Å—è, –µ—Å–ª–∏ —Ü–µ–Ω–∞ –≤–µ—Ä–Ω—É–ª–∞—Å—å –∫ +1% –ø–æ—Å–ª–µ partial_tp

---

## ‚úÖ –ò–¢–û–ì–û–í–´–ô –ß–ï–ö–õ–ò–°–¢

### –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:
- [x] –í—Å–µ —Ñ–∞–π–ª—ã —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω—ã –±–µ–∑ –æ—à–∏–±–æ–∫
- [x] –õ–∏–Ω—Ç–µ—Ä –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—à–∏–±–æ–∫
- [x] –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–∑ –∞—É–¥–∏—Ç–∞ –ö–∏–º—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

### –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ (–ø–µ—Ä–≤—ã–µ 5 –º–∏–Ω—É—Ç):
- [ ] –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- [ ] –í—Å–µ 5 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å
- [ ] –ë–æ—Ç –æ—Ç–∫—Ä—ã–ª –ø–æ–∑–∏—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å —Å–∏–≥–Ω–∞–ª—ã)
- [ ] ExitAnalyzer –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø–æ–∑–∏—Ü–∏–∏

### –ü–æ—Å–ª–µ 1 —á–∞—Å–∞ —Ä–∞–±–æ—Ç—ã:
- [ ] Smart-close –Ω–µ –¥–µ—Ä–≥–∞–µ—Ç—Å—è (–∏–ª–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ä–µ–¥–∫–æ)
- [ ] Locks –æ—á–∏—â–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
- [ ] Partial TP —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (–Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–≤–∞–∂–¥—ã)

---

## üéØ –û–ñ–ò–î–ê–ï–ú–û–ï –ü–û–í–ï–î–ï–ù–ò–ï

### ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:

1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**: –í—Å–µ –º–æ–¥—É–ª–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è —Å –ª–æ–≥–∞–º–∏
2. **–¢–æ—Ä–≥–æ–≤–ª—è**: –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è
3. **–£–º–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ**: –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É–±—ã—Ç–∫–µ >= -3.0% (–¥–ª—è ranging —Ä–µ–∂–∏–º–∞)
4. **–û—á–∏—Å—Ç–∫–∞**: Locks –æ—á–∏—â–∞—é—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è
5. **Partial TP**: –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑, –∑–∞—Ç–µ–º –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è

### ‚ö†Ô∏è –ü—Ä–∏–∑–Ω–∞–∫–∏ –ø—Ä–æ–±–ª–µ–º:

1. **–û—à–∏–±–∫–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ**: –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–º–ø–æ—Ä—Ç—ã
2. **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å**: –ù–µ—Ç –ª–æ–≥–æ–≤ "‚úÖ ... –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω" ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å try/except
3. **Smart-close –¥–µ—Ä–≥–∞–µ—Ç—Å—è**: –ú–Ω–æ–≥–æ –ª–æ–≥–æ–≤ "Smart Close" ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å spread_buffer
4. **Locks –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è**: –ù–µ—Ç –ª–æ–≥–æ–≤ "–û—á–∏—â–µ–Ω lock" ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å _close_position
5. **Partial TP –¥–≤–∞–∂–¥—ã**: –ù–µ—Ç –ª–æ–≥–æ–≤ "Partial TP —É–∂–µ –±—ã–ª –≤—ã–ø–æ–ª–Ω–µ–Ω" ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å partial_tp_executed

---

## üìä –°–¢–ê–¢–£–° –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

| –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –§–∞–π–ª |
|-------------|--------|------|
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ | ‚úÖ | exit_analyzer.py |
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ smart_close | ‚úÖ | exit_analyzer.py |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ valid_tasks | ‚úÖ | exit_analyzer.py |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ trend_data is None | ‚úÖ | exit_analyzer.py |
| max(0.0, ...) –≤ TrailingStopLoss | ‚úÖ | trailing_stop_loss.py |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ current_price | ‚úÖ | exit_analyzer.py |
| Fallback regime=ranging | ‚úÖ | exit_analyzer.py |
| LOCK_DRIFT | ‚úÖ | orchestrator.py |
| –û—á–∏—Å—Ç–∫–∞ locks | ‚úÖ | orchestrator.py |
| –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ/–ø–æ—Å–ª–µ –æ–±—Ä–µ–∑–∫–∏ | ‚úÖ | risk_manager.py |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ partial_tp_executed | ‚úÖ | exit_analyzer.py, position_registry.py |
| –£—á–µ—Ç —Å–ø—Ä–µ–¥–∞ –≤ smart_close | ‚úÖ | exit_analyzer.py |

---

**–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏**: 2025-12-07
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ì–û–¢–û–í –ö –ó–ê–ü–£–°–ö–£**

