# –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –õ–û–ì–ò–ö–ê –î–õ–Ø SELL –û–†–î–ï–†–û–í

**–î–∞—Ç–∞:** 2025-12-18  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

---

## ‚ö†Ô∏è –û–®–ò–ë–ö–ê –í –ê–ù–ê–õ–ò–ó–ï

–í –¥–æ–∫—É–º–µ–Ω—Ç–µ `ANALYSIS_LIMIT_ORDER_PRICE_PROBLEM.md` –±—ã–ª–∞ –¥–æ–ø—É—â–µ–Ω–∞ –æ—à–∏–±–∫–∞ –≤ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è—Ö –¥–ª—è SELL –æ—Ä–¥–µ—Ä–æ–≤.

---

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê–Ø –õ–û–ì–ò–ö–ê –î–õ–Ø –ë–ò–†–ñ–ï–í–û–ô –¢–û–†–ì–û–í–õ–ò

### –î–ª—è BUY (–ø–æ–∫—É–ø–∫–∞):
- **–ù—É–∂–Ω–æ –ø–æ–∫—É–ø–∞—Ç—å –ø–æ —Ü–µ–Ω–µ –ü–†–û–î–ê–í–¶–ê** ‚Üí `best_ask` (ask = —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏)
- –õ–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä —Å—Ç–∞–≤–∏—Ç—Å—è –ø–æ `best_ask` –∏–ª–∏ –Ω–µ–º–Ω–æ–≥–æ **–≤—ã—à–µ** –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** `limit_price = best_ask * (1 + offset_percent / 100.0)`

### –î–ª—è SELL (–ø—Ä–æ–¥–∞–∂–∞):
- **–ù—É–∂–Ω–æ –ø—Ä–æ–¥–∞–≤–∞—Ç—å –ø–æ —Ü–µ–Ω–µ –ü–û–ö–£–ü–ê–¢–ï–õ–Ø** ‚Üí `best_bid` (bid = —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏)
- –õ–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä —Å—Ç–∞–≤–∏—Ç—Å—è –ø–æ `best_bid` –∏–ª–∏ –Ω–µ–º–Ω–æ–≥–æ **–Ω–∏–∂–µ** –¥–ª—è –≥–∞—Ä–∞–Ω—Ç–∏–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- **–ü—Ä–∞–≤–∏–ª—å–Ω–æ:** `limit_price = best_bid * (1 - offset_percent / 100.0)`

---

## ‚ùå –û–®–ò–ë–ö–ê –í –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø–•

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ (–∏–∑ –∞–Ω–∞–ª–∏–∑–∞):**
> "–î–ª—è SELL –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `best_ask` (–≤—ã—à–µ), –∞ –Ω–µ `best_bid`"

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ:**
> –î–ª—è SELL –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `best_bid` (–Ω–∏–∂–µ), –∞ –Ω–µ `best_ask`

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ö–û–î–ê

**–ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π:**
```python
# –î–ª—è SELL
limit_price = best_bid * (1 - offset_percent / 100.0)
```

–≠—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ! –î–ª—è –ø—Ä–æ–¥–∞–∂–∏ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ü–µ–Ω—É –ø–æ–∫—É–ø–∞—Ç–µ–ª—è (`best_bid`), –∞ –Ω–µ —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–≤—Ü–∞ (`best_ask`).

---

## üìä –û–ë–™–Ø–°–ù–ï–ù–ò–ï –î–õ–Ø –ë–ò–†–ñ–ï–í–û–ì–û –¢–†–ï–ô–î–ï–†–ê

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–∫–∞–Ω (order book):

```
ASK (–ø—Ä–æ–¥–∞–∂–∞)    |  BID (–ø–æ–∫—É–ø–∫–∞)
-----------------|-----------------
2809.91 (10 BTC) |  2809.90 (5 BTC)
2809.92 (15 BTC) |  2809.89 (8 BTC)
2809.93 (20 BTC) |  2809.88 (12 BTC)
```

- **best_ask = 2809.91** - –ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–∂–∏ (—Å–∞–º–∞—è –Ω–∏–∑–∫–∞—è —Ü–µ–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –∫—Ç–æ-—Ç–æ –≥–æ—Ç–æ–≤ –ø—Ä–æ–¥–∞—Ç—å)
- **best_bid = 2809.90** - –ª—É—á—à–∞—è —Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∫–∏ (—Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è —Ü–µ–Ω–∞, –ø–æ –∫–æ—Ç–æ—Ä–æ–π –∫—Ç–æ-—Ç–æ –≥–æ—Ç–æ–≤ –∫—É–ø–∏—Ç—å)
- **spread = 0.01** - —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É ask –∏ bid

### –î–ª—è BUY (–ø–æ–∫—É–ø–∫–∞):
- –ß—Ç–æ–±—ã –∫—É–ø–∏—Ç—å **—Å—Ä–∞–∑—É**, –Ω—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è –Ω–∞ —Ü–µ–Ω—É –ø—Ä–æ–¥–∞–≤—Ü–∞ ‚Üí `best_ask = 2809.91`
- –ß—Ç–æ–±—ã –∫—É–ø–∏—Ç—å **–¥–µ—à–µ–≤–ª–µ**, —Å—Ç–∞–≤–∏–º –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä –Ω–∏–∂–µ `best_ask` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `2809.90`)
- –ù–æ –¥–ª—è **–±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è** –≤ —Å–∫–∞–ª—å–ø–∏–Ω–≥–µ —Å—Ç–∞–≤–∏–º –ø–æ `best_ask` –∏–ª–∏ –Ω–µ–º–Ω–æ–≥–æ –≤—ã—à–µ

### –î–ª—è SELL (–ø—Ä–æ–¥–∞–∂–∞):
- –ß—Ç–æ–±—ã –ø—Ä–æ–¥–∞—Ç—å **—Å—Ä–∞–∑—É**, –Ω—É–∂–Ω–æ —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è –Ω–∞ —Ü–µ–Ω—É –ø–æ–∫—É–ø–∞—Ç–µ–ª—è ‚Üí `best_bid = 2809.90`
- –ß—Ç–æ–±—ã –ø—Ä–æ–¥–∞—Ç—å **–¥–æ—Ä–æ–∂–µ**, —Å—Ç–∞–≤–∏–º –ª–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä –≤—ã—à–µ `best_bid` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `2809.91`)
- –ù–æ –¥–ª—è **–±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è** –≤ —Å–∫–∞–ª—å–ø–∏–Ω–≥–µ —Å—Ç–∞–≤–∏–º –ø–æ `best_bid` –∏–ª–∏ –Ω–µ–º–Ω–æ–≥–æ –Ω–∏–∂–µ

---

## ‚úÖ –ò–¢–û–ì–û–í–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò (–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï)

### 1. –î–ª—è BUY:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `best_ask` (—Ü–µ–Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞)
- Offset –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π: `best_ask * (1 + offset_percent / 100.0)`
- –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è: offset = 0.01-0.05%

### 2. –î–ª—è SELL:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `best_bid` (—Ü–µ–Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª—è) ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û –í –ö–û–î–ï**
- Offset –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π: `best_bid * (1 - offset_percent / 100.0)` ‚úÖ **–ü–†–ê–í–ò–õ–¨–ù–û –í –ö–û–î–ï**
- –î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è: offset = 0.01-0.05%

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏:
- –°—Ä–∞–≤–Ω–∏–≤–∞—Ç—å `signal["price"]` —Å `current_price`
- –ï—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ > 0.5% ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å market order

### 4. Fallback:
- –î–ª—è BUY: `current_price * 1.001` (–≤—ã—à–µ)
- –î–ª—è SELL: `current_price * 0.999` (–Ω–∏–∂–µ)

---

## üéØ –í–´–í–û–î

**–ö–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!** –õ–æ–≥–∏–∫–∞ –¥–ª—è SELL –≤ –∫–æ–¥–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –±–∏—Ä–∂–µ–≤–æ–π —Ç–æ—Ä–≥–æ–≤–ª–µ.

**–û—à–∏–±–∫–∞ –±—ã–ª–∞ —Ç–æ–ª—å–∫–æ –≤ –º–æ–µ–º –∞–Ω–∞–ª–∏–∑–µ** - —è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞–ª —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é –¥–ª—è SELL.

**–†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `signal["price"]` –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –ª–∏–º–∏—Ç–Ω–æ–π —Ü–µ–Ω—ã, —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
