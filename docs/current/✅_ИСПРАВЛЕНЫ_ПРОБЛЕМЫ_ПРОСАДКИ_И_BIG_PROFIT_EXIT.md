# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ—Å–∞–¥–∫–∏ –∏ Big-profit exit

**–î–∞—Ç–∞:** 2025-11-22 13:15  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

## üîç –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. ‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ Big-profit exit
**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –æ—à–∏–±–∫–∞:
```
‚ö†Ô∏è –û—à–∏–±–∫–∞ Big-profit exit –¥–ª—è ETH-USDT: 'dict' object has no attribute '_big_profit_max'
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `hasattr(position, "_big_profit_max")`, –Ω–æ `position` - —ç—Ç–æ **—Å–ª–æ–≤–∞—Ä—å (dict)**, –∞ –Ω–µ –æ–±—ä–µ–∫—Ç. `hasattr()` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å–ª–æ–≤–∞—Ä—è–º–∏.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –ó–∞–º–µ–Ω–µ–Ω–æ `hasattr(position, "_big_profit_max")` –Ω–∞ `"_big_profit_max" not in position`
- –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ `position._big_profit_max` –Ω–∞ `position["_big_profit_max"]`
- –ó–∞–º–µ–Ω–µ–Ω—ã –≤—Å–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ `position._big_profit_history` –Ω–∞ `position["_big_profit_history"]`

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py` (—Å—Ç—Ä–æ–∫–∏ 1285-1367)

### 2. ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å entry_time –ø—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL
**–°–∏–º–ø—Ç–æ–º:** –í –ª–æ–≥–∞—Ö –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ:
```
‚ö†Ô∏è –ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏ SOL-USDT (–ø–æ–∑–∏—Ü–∏—è —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–∫—Ä—ã—Ç–∞, entry_time –±—É–¥–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL)
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è `entry_time` –≤ –ø–æ–∑–∏—Ü–∏—é.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `entry_time` –ø—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL
- –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–ª—É—á–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∏–∑ `cTime` –∏–ª–∏ `uTime` –∏–∑ –±–∏—Ä–∂–∏
- –ï—Å–ª–∏ –≤—Ä–µ–º—è –∏–∑ –±–∏—Ä–∂–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
- –¢–∞–∫–∂–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è `timestamp` –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py` (—Å—Ç—Ä–æ–∫–∏ 5001-5042)

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π

–ò–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–æ–≥–æ–≤ –≤–∏–¥–Ω–æ, —á—Ç–æ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –º–∏–Ω—É—Å–µ:
- **ETH-USDT**: PnL=-1.80% (–æ—Ç –º–∞—Ä–∂–∏), profit=-0.35%
- **BTC-USDT**: PnL=-1.21% (–æ—Ç –º–∞—Ä–∂–∏), profit=-0.00%
- **XRP-USDT**: PnL=-0.96% (–æ—Ç –º–∞—Ä–∂–∏), profit=-0.28%
- **SOL-USDT**: profit=0.21-0.26% (–≤ –ø–ª—é—Å–µ, –Ω–æ –¥–µ—Ä–∂–∏—Ç—Å—è –º–µ–Ω–µ–µ min_holding)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞. `min_holding` –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –∑–∞–∫—Ä—ã—Ç–∏—è.

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

1. ‚úÖ **Big-profit exit —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** - –æ—à–∏–±–∫–∞ `'dict' object has no attribute '_big_profit_max'` –±–æ–ª—å—à–µ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è
2. ‚úÖ **entry_time —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è** –ø—Ä–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL
3. ‚úÖ **–¢—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø –¥–ª—è big_profit_exit** —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –ø—Ä–∏–±—ã–ª—å)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞:
1. –û—à–∏–±–∫–∏ Big-profit exit –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å –∏–∑ –ª–æ–≥–æ–≤
2. –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ "–ù–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–∫—Ä—ã—Ç–∏—è" –¥–æ–ª–∂–Ω—ã –∏—Å—á–µ–∑–Ω—É—Ç—å
3. `_big_profit_max` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –ø–æ–∑–∏—Ü–∏–π

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ª–æ–≥–∏ –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—à–∏–±–æ–∫ Big-profit exit
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π `entry_time`
4. –ù–∞–±–ª—é–¥–∞—Ç—å –∑–∞ –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º –ø–æ–∑–∏—Ü–∏–π –≤ –º–∏–Ω—É—Å–µ (–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –¥–µ—Ä–∂–∞—Ç—å—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ `min_holding`)

---
**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é.**


