# ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï: –ö–æ–º–∏—Å—Å–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

**–î–∞—Ç–∞:** 26.11.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ü–†–ê–í–ò–õ–¨–ù–û –ù–ê–°–¢–†–û–ï–ù–û

---

## ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï

**–î–∞, –±–æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏—é 0.05% Taker –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∏ –∑–∞–∫—Ä—ã—Ç–∏–µ.**

---

## üìä –ö–ê–ö –£–ß–ò–¢–´–í–ê–ï–¢–°–Ø –ö–û–ú–ò–°–°–ò–Ø

### **1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```yaml
commission:
  trading_fee_rate: 0.0010  # 0.10% –Ω–∞ –∫—Ä—É–≥ (0.05% –æ—Ç–∫—Ä—ã—Ç–∏–µ + 0.05% –∑–∞–∫—Ä—ã—Ç–∏–µ –¥–ª—è Taker)
  taker_fee_rate: 0.0005    # 0.05% –¥–ª—è Taker –æ—Ä–¥–µ—Ä–æ–≤
```

**‚úÖ –ö–æ–º–∏—Å—Å–∏—è:** 0.10% –Ω–∞ –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª (0.05% –æ—Ç–∫—Ä—ã—Ç–∏–µ + 0.05% –∑–∞–∫—Ä—ã—Ç–∏–µ)

---

### **2. ExitAnalyzer - —Ä–∞—Å—á–µ—Ç PnL —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–∏:**

```python
def _calculate_pnl_percent(self, entry_price, exit_price, side, include_fees=True):
    # Gross profit (–±–µ–∑ –∫–æ–º–∏—Å—Å–∏–∏)
    gross_profit_pct = ...
    
    # Net profit (—Å –∫–æ–º–∏—Å—Å–∏–µ–π) ‚úÖ
    if include_fees:
        trading_fee_rate = 0.0010  # 0.10% –Ω–∞ –∫—Ä—É–≥
        net_profit_pct = gross_profit_pct - trading_fee_rate
```

**‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–µ–∑–¥–µ —Å `include_fees=True`** - –∫–æ–º–∏—Å—Å–∏—è –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ø—Ä–∏–±—ã–ª–∏!

---

### **3. TrailingStopLoss - —Ä–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª–∏ —Å –∫–æ–º–∏—Å—Å–∏–µ–π:**

```python
def get_profit_pct(self, current_price, include_fees=True):
    # Gross profit
    gross_profit_pct = ...
    
    # Net profit (—Å –∫–æ–º–∏—Å—Å–∏–µ–π) ‚úÖ
    if include_fees:
        net_profit_pct = gross_profit_pct - self.trading_fee_rate
        # trading_fee_rate = 0.0010 (0.10% –Ω–∞ –∫—Ä—É–≥)
```

**‚úÖ –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å `include_fees=True`** - –∫–æ–º–∏—Å—Å–∏—è —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è!

---

### **4. –ì–¥–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–∏—Å—Å–∏—è:**

‚úÖ **ExitAnalyzer:**
- `_calculate_pnl_percent(..., include_fees=True)` - –∫–æ–º–∏—Å—Å–∏—è –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è

‚úÖ **TrailingStopLoss:**
- `get_profit_pct(..., include_fees=True)` - –∫–æ–º–∏—Å—Å–∏—è –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ TP/SL

‚úÖ **PositionManager:**
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏—é –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ TP (min_profit + –∫–æ–º–∏—Å—Å–∏—è + slippage)

‚úÖ **TP/SL —Ä–∞—Å—á–µ—Ç—ã:**
- –í—Å–µ–≥–¥–∞ —É—á–∏—Ç—ã–≤–∞—é—Ç –∫–æ–º–∏—Å—Å–∏—é 0.10% –Ω–∞ –∫—Ä—É–≥

---

## üìä –ü–†–ò–ú–ï–† –†–ê–°–ß–ï–¢–ê

### **BTC-USDT –ø–æ–∑–∏—Ü–∏—è:**
- **Entry price:** 87,157.90 USDT
- **Notional:** 244 USDT
- **–ö–æ–º–∏—Å—Å–∏—è –æ—Ç–∫—Ä—ã—Ç–∏–µ:** 0.05% = 0.122 USDT ‚úÖ (–∫–∞–∫ –≤ –ª–æ–≥–∞—Ö)
- **–ö–æ–º–∏—Å—Å–∏—è –∑–∞–∫—Ä—ã—Ç–∏–µ (–±—É–¥–µ—Ç):** 0.05% ‚âà 0.122 USDT
- **–û–±—â–∞—è –∫–æ–º–∏—Å—Å–∏—è:** 0.10% ‚âà 0.244 USDT

### **–†–∞—Å—á–µ—Ç –ø—Ä–∏–±—ã–ª–∏:**
```
Gross profit = (exit_price - entry_price) / entry_price * 100%
Net profit = Gross profit - 0.10% (–∫–æ–º–∏—Å—Å–∏—è)
```

**‚úÖ –ö–æ–º–∏—Å—Å–∏—è –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ø—Ä–∏–±—ã–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!**

---

## ‚úÖ –í–´–í–û–î

### **–í—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ:**

1. ‚úÖ **–ö–æ–º–∏—Å—Å–∏—è 0.05% Taker –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ** - —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
2. ‚úÖ **–ö–æ–º–∏—Å—Å–∏—è 0.05% Taker –Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏–µ** - —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è (–±—É–¥–µ—Ç –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏)
3. ‚úÖ **–û–±—â–∞—è –∫–æ–º–∏—Å—Å–∏—è 0.10% –Ω–∞ –∫—Ä—É–≥** - –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –ø—Ä–∏–±—ã–ª–∏
4. ‚úÖ **–í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –ø—Ä–∏–±—ã–ª–∏** –∏—Å–ø–æ–ª—å–∑—É—é—Ç `include_fees=True`
5. ‚úÖ **TP/SL —Ä–∞—Å—á–µ—Ç—ã** —É—á–∏—Ç—ã–≤–∞—é—Ç –∫–æ–º–∏—Å—Å–∏—é

---

## üí° –†–ï–®–ï–ù–ò–ï

**‚úÖ –ü—Ä–∏–Ω–∏–º–∞–µ–º —Ç–µ–∫—É—â—É—é –∫–æ–º–∏—Å—Å–∏—é 0.05% Taker:**

- –≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è OKX –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- –ë–æ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤–æ –≤—Å–µ—Ö —Ä–∞—Å—á–µ—Ç–∞—Ö
- –ù–µ —Å—Ç–æ–∏—Ç —Ç–µ—Ä—è—Ç—å –º–æ–º–µ–Ω—Ç—ã, —Å—Ç–∞–≤—è –ª–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –¥–∞–ª—å—à–µ –æ—Ç —Ü–µ–Ω—ã
- –ü—Ä–æ—Å—Ç–æ –ø—Ä–∏–Ω–∏–º–∞–µ–º, —á—Ç–æ –∫–æ–º–∏—Å—Å–∏—è –±—É–¥–µ—Ç Taker (0.05% –æ—Ç–∫—Ä—ã—Ç–∏–µ + 0.05% –∑–∞–∫—Ä—ã—Ç–∏–µ = 0.10% –Ω–∞ –∫—Ä—É–≥)

---

**‚úÖ –í–°–ï –ü–†–ê–í–ò–õ–¨–ù–û! –ö–û–ú–ò–°–°–ò–Ø –£–ß–ò–¢–´–í–ê–ï–¢–°–Ø!**






