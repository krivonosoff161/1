# –ü–†–û–í–ï–†–ö–ê –•–ê–†–î–ö–û–î–ê –í –†–ê–°–ß–ï–¢–ê–•

**–î–∞—Ç–∞:** 23 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–†–û–í–ï–†–ï–ù–û

---

## üîç –ü–†–û–í–ï–†–ö–ê –•–ê–†–î–ö–û–î–ê

### 1. –û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π ‚úÖ

#### –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ (`risk_manager.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 170
base_usd_size = balance_profile.get("base_position_usd", 30.0)  # ‚ö†Ô∏è Fallback –∑–Ω–∞—á–µ–Ω–∏–µ
```

**‚ö†Ô∏è FALLBACK:** `30.0` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `base_position_usd` –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ `balance_profile`

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞, fallback —Ç–æ–ª—å–∫–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### Leverage (`risk_manager.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 518-525
leverage = getattr(self.scalping_config, "leverage", None)
if leverage is None or leverage <= 0:
    logger.error("‚ùå leverage –Ω–µ —É–∫–∞–∑–∞–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ –∏–ª–∏ <= 0!")
    raise ValueError("leverage –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–∫–∞–∑–∞–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ")
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** Leverage –û–ë–Ø–ó–ê–¢–ï–õ–ï–ù –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –Ω–µ—Ç fallback –∑–Ω–∞—á–µ–Ω–∏—è

#### Position Manager (`position_manager.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 819-823
leverage = (
    getattr(self.scalping_config, "leverage", None)
    or leverage_from_position
    or 3  # ‚ö†Ô∏è Fallback –∑–Ω–∞—á–µ–Ω–∏–µ
)
```

**‚ö†Ô∏è FALLBACK:** `3` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ leverage –Ω–µ –Ω–∞–π–¥–µ–Ω –Ω–∏ –≤ –∫–æ–Ω—Ñ–∏–≥–µ, –Ω–∏ –≤ –ø–æ–∑–∏—Ü–∏–∏

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** Fallback —Ç–æ–ª—å–∫–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –æ—Å–Ω–æ–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

---

### 2. –í–µ–¥–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π ‚úÖ

#### TP –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`position_manager.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 105-106
tp_percent = self.scalping_config.tp_percent  # –ì–ª–æ–±–∞–ª—å–Ω—ã–π TP (fallback)
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** TP —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞, –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:
1. Per-regime TP (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
2. Per-symbol TP (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)
3. –ì–ª–æ–±–∞–ª—å–Ω—ã–π TP (–∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)

**–ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞!**

#### TSL –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (`trailing_sl_coordinator.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 235-270
# –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ config_manager.get_trailing_sl_params()
# –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ –∑–Ω–∞—á–µ–Ω–∏–π
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ —á–µ—Ä–µ–∑ `config_manager`

#### Loss Cut (`trailing_stop_loss.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 476-550
loss_cut_from_price = self.loss_cut_percent / self.leverage
# loss_cut_percent —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** Loss_cut —á–∏—Ç–∞–µ—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞, –Ω–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞

---

### 3. –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π ‚úÖ

#### TP –ø—Ä–æ–≤–µ—Ä–∫–∞ (`position_manager.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 1039
tp_percent = self._get_adaptive_tp_percent(symbol, regime, current_price)
# –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** TP —á–∏—Ç–∞–µ—Ç—Å—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

#### TSL –ø—Ä–æ–≤–µ—Ä–∫–∞ (`trailing_sl_coordinator.py`):

```python
# –°—Ç—Ä–æ–∫–∞ 606-610
should_close_by_sl, close_reason = tsl.should_close_position(
    current_price,
    trend_strength=trend_strength,
    market_regime=market_regime,
)
# –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
```

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

---

## ‚ö†Ô∏è –û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï FALLBACK –ó–ù–ê–ß–ï–ù–ò–Ø

### Fallback –∑–Ω–∞—á–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏):

1. **base_position_usd:** `30.0` (–µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ balance_profile)
2. **leverage:** `3` (–µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∫–æ–Ω—Ñ–∏–≥–µ –∏ –ø–æ–∑–∏—Ü–∏–∏)

**‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:** Fallback –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –æ—à–∏–±–æ–∫, –æ—Å–Ω–æ–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–ò

### –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ:

1. ‚úÖ **–†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏:** –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ –±–∞–ª–∞–Ω—Å—É, —Å–∏–º–≤–æ–ª—É, —Ä–µ–∂–∏–º—É, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏
2. ‚úÖ **TP:** –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ —Å–∏–º–≤–æ–ª—É –∏ —Ä–µ–∂–∏–º—É
3. ‚úÖ **TSL:** –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ —Ä–µ–∂–∏–º—É
4. ‚úÖ **Loss Cut:** –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ —Ä–µ–∂–∏–º—É
5. ‚úÖ **Leverage:** –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω)

---

## üìä –ü–†–û–í–ï–†–ö–ê –î–õ–Ø –í–°–ï–• –ü–ê–† –ò –†–ï–ñ–ò–ú–û–í

### BTC-USDT:
- ‚úÖ –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (balance_profile + symbol_multiplier + regime)
- ‚úÖ TP: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (per-regime –∏–ª–∏ per-symbol)
- ‚úÖ TSL: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (per-regime)
- ‚úÖ Loss Cut: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (per-regime)

### ETH-USDT:
- ‚úÖ –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- ‚úÖ TP: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- ‚úÖ TSL: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- ‚úÖ Loss Cut: –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

### SOL-USDT, DOGE-USDT, XRP-USDT:
- ‚úÖ –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

---

## ‚úÖ –ò–¢–û–ì–û–í–ê–Ø –ü–†–û–í–ï–†–ö–ê

### –ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞ –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö:

1. ‚úÖ **–û—Ç–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π:** –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
2. ‚úÖ **–í–µ–¥–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π:** –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
3. ‚úÖ **–ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π:** –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

### Fallback –∑–Ω–∞—á–µ–Ω–∏—è:

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å–µ–≥–¥–∞ –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- ‚úÖ –õ–æ–≥–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

---

## üéØ –í–´–í–û–î–´

### –í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ:

1. ‚úÖ **–ù–µ—Ç —Ö–∞—Ä–¥–∫–æ–¥–∞** –≤ —Ä–∞—Å—á–µ—Ç–∞—Ö –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏/–≤–µ–¥–µ–Ω–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–π
2. ‚úÖ **–í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–∏—Ç–∞—é—Ç—Å—è** –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
3. ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç–∞–µ—Ç** –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä –∏ —Ä–µ–∂–∏–º–æ–≤
4. ‚úÖ **Fallback –∑–Ω–∞—á–µ–Ω–∏—è** –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ü–ê–†–ê–ú–ï–¢–†–´ –ê–î–ê–ü–¢–ò–í–ù–´–ï - –ù–ï–¢ –•–ê–†–î–ö–û–î–ê

