# –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ü–û–†–Ø–î–ö–ê –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–ò –ò –†–ê–ë–û–¢–´ –¢–û–†–ì–û–í–û–ì–û –ë–û–¢–ê

**–î–∞—Ç–∞:** 28.12.2025  
**–¶–µ–ª—å:** –ê–Ω–∞–ª–∏–∑ –ø–æ–ª–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—Å–∫–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π –∏ –Ω–∞—á–∞–ª–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï

1. [–ü–æ–ª–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞](#1-–ø–æ–ª–Ω–∞—è-–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å-–∑–∞–ø—É—Å–∫–∞)
2. [–ü–æ—Ä—è–¥–æ–∫ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π](#2-–ø–æ—Ä—è–¥–æ–∫-–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏-–º–æ–¥—É–ª–µ–π)
3. [–¢–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª –∏ check_for_signals](#3-—Ç–æ—Ä–≥–æ–≤—ã–π-—Ü–∏–∫–ª-–∏-check_for_signals)
4. [–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ race conditions –∏ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã](#4-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ-race-conditions-–∏-–ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ-–ø—Ä–æ–±–ª–µ–º—ã)
5. [–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é –ø–æ—Ä—è–¥–∫–∞](#5-—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏-–ø–æ-–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é-–ø–æ—Ä—è–¥–∫–∞)
6. [–í—ã–≤–æ–¥](#6-–≤—ã–≤–æ–¥)

---

## 1. –ü–û–õ–ù–ê–Ø –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –ó–ê–ü–£–°–ö–ê

### 1.1. –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞: `run.py`

**–§–∞–π–ª:** `run.py`  
**–°—Ç—Ä–æ–∫–∞:** `296` ‚Äî `if __name__ == "__main__": main()`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# run.py:296
if __name__ == "__main__":
    main()  # –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **–°—Ç—Ä–æ–∫–∞ 199-233:** –ü–∞—Ä—Å–∏–Ω–≥ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∫–æ–º–∞–Ω–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏
2. **–°—Ç—Ä–æ–∫–∞ 244-252:** –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
3. **–°—Ç—Ä–æ–∫–∞ 254-267:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ (spot/futures)
4. **–°—Ç—Ä–æ–∫–∞ 269-276:** –ü—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–µ–π
5. **–°—Ç—Ä–æ–∫–∞ 279-285:** –ó–∞–ø—É—Å–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –±–æ—Ç–∞
   - –î–ª—è Futures: `asyncio.run(run_futures_bot())` (—Å—Ç—Ä–æ–∫–∞ 285)

---

### 1.2. Futures —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞: `main_futures.py`

**–§–∞–π–ª:** `src/main_futures.py`  
**–°—Ç—Ä–æ–∫–∞:** `25` ‚Äî `async def main():`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# main_futures.py:25
async def main():
    # –°—Ç—Ä–æ–∫–∞ 32-44: –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    config_path = project_root / "config" / "config_futures.yaml"
    config = BotConfig.load_from_file(str(config_path))
    
    # –°—Ç—Ä–æ–∫–∞ 68: –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
    orchestrator = FuturesScalpingOrchestrator(config)
    
    # –°—Ç—Ä–æ–∫–∞ 71: –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
    await orchestrator.start()
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. **–°—Ç—Ä–æ–∫–∞ 32-44:** –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ `config/config_futures.yaml`
2. **–°—Ç—Ä–æ–∫–∞ 47:** –°–æ–∑–¥–∞–Ω–∏–µ `BotConfig` –∏–∑ YAML —Ñ–∞–π–ª–∞
3. **–°—Ç—Ä–æ–∫–∞ 68:** –°–æ–∑–¥–∞–Ω–∏–µ `FuturesScalpingOrchestrator(config)` ‚Äî **–°–ò–ù–•–†–û–ù–ù–ê–Ø –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**
4. **–°—Ç—Ä–æ–∫–∞ 71:** –ó–∞–ø—É—Å–∫ `await orchestrator.start()` ‚Äî **–ê–°–ò–ù–•–†–û–ù–ù–´–ô –∑–∞–ø—É—Å–∫**

---

### 1.3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Orchestrator: `__init__()`

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–°—Ç—Ä–æ–∫–∞:** `81` ‚Äî `def __init__(self, config: BotConfig):`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è, –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –î–û `start()`):**

| –®–∞–≥ | –°—Ç—Ä–æ–∫–∞ | –ú–æ–¥—É–ª—å | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|--------|--------|----------|
| 1 | 88-90 | Config | –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ |
| 2 | 92-117 | ConfigManager | –ó–∞–≥—Ä—É–∑–∫–∞ raw YAML –¥–ª—è exit_params |
| 3 | 119-122 | ParameterProvider | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (–ø–æ–∫–∞ None, –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ–∑–∂–µ) |
| 4 | 125-128 | LoggerFactory | –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è |
| 5 | 131-141 | DebugLogger, StructuredLogger | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–æ–≥–≥–µ—Ä–æ–≤ |
| 6 | 144-145 | PositionRegistry, DataRegistry | –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è core –º–æ–¥—É–ª–µ–π |
| 7 | 160-177 | OKXFuturesClient | –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –±–∏—Ä–∂–∏ |
| 8 | 200-300 | MarginCalculator, LiquidationGuard, SlippageGuard | –ú–æ–¥—É–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ |
| 9 | 300-400 | PerformanceTracker, TradingStatistics | –¢—Ä–µ–∫–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ |
| 10 | 400-500 | FastADX, FundingRateMonitor, OrderFlowIndicator | –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã |
| 11 | 500-600 | RegimeManager (—á–µ—Ä–µ–∑ SignalGenerator) | –†–µ–∂–∏–º—ã —Ä—ã–Ω–∫–∞ |
| 12 | 600-700 | SignalGenerator, OrderExecutor, PositionManager | –¢–æ—Ä–≥–æ–≤—ã–µ –º–æ–¥—É–ª–∏ |
| 13 | 700-800 | SignalCoordinator, OrderCoordinator | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä—ã |
| 14 | 800-850 | ExitAnalyzer, EntryManager, PositionScalingManager | –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–æ–∑–∏—Ü–∏–π |
| 15 | 850-875 | TradingControlCenter | –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä |
| 16 | 895-917 | WebSocketCoordinator | WebSocket –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä |

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã:**

- ‚úÖ **SignalCoordinator —Å–æ–∑–¥–∞–µ—Ç—Å—è –ü–ï–†–ï–î WebSocketCoordinator** (—Å—Ç—Ä–æ–∫–∞ 808-810 –ø–µ—Ä–µ–¥ 896-917)
- ‚úÖ **TradingControlCenter —Å–æ–∑–¥–∞–µ—Ç—Å—è –ü–û–°–õ–ï –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π** (—Å—Ç—Ä–æ–∫–∞ 854-875)
- ‚ö†Ô∏è **ParameterProvider –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ None** (—Å—Ç—Ä–æ–∫–∞ 122), –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ–∑–∂–µ

---

### 1.4. –ó–∞–ø—É—Å–∫ Orchestrator: `start()`

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–°—Ç—Ä–æ–∫–∞:** `925` ‚Äî `async def start(self):`

**–ü–æ–ª–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è):**

```python
# orchestrator.py:925
async def start(self):
    # –®–ê–ì 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –º–æ–¥—É–ª–µ–π
    await self._verify_initialization()  # –°—Ç—Ä–æ–∫–∞ 931
    
    # –®–ê–ì 2: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∏–µ–Ω—Ç–∞
    await self._initialize_client()  # –°—Ç—Ä–æ–∫–∞ 934
    # - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (—Å—Ç—Ä–æ–∫–∞ 1060)
    # - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ leverage –¥–ª—è —Å–∏–º–≤–æ–ª–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 1108-1224)
    # - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ DataRegistry (—Å—Ç—Ä–æ–∫–∞ 1064-1077)
    
    # –®–ê–ì 3: –ó–∞–ø—É—Å–∫ —Ç–æ—Ä–≥–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π (–ö–†–ò–¢–ò–ß–ù–û!)
    await self._start_trading_modules()  # –°—Ç—Ä–æ–∫–∞ 939
    # - await self.signal_generator.initialize() (—Å—Ç—Ä–æ–∫–∞ 1257)
    #   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è RegimeManager (—Å—Ç—Ä–æ–∫–∞ 461-1200+)
    #   - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ is_initialized = True (—Å—Ç—Ä–æ–∫–∞ 1207)
    # - await self.order_executor.initialize() (—Å—Ç—Ä–æ–∫–∞ 1265)
    # - await self.position_manager.initialize() (—Å—Ç—Ä–æ–∫–∞ 1268)
    
    # –®–ê–ì 4: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ WebSocket (–ü–û–°–õ–ï –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π!)
    await self.websocket_coordinator.initialize_websocket()  # –°—Ç—Ä–æ–∫–∞ 942
    # - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ WebSocket (—Å—Ç—Ä–æ–∫–∞ 132)
    # - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–∏–∫–µ—Ä—ã (—Å—Ç—Ä–æ–∫–∞ 146-152)
    # - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Private WebSocket (—Å—Ç—Ä–æ–∫–∞ 164-186)
    # - ‚ö†Ô∏è –í–ê–ñ–ù–û: –ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ!
    
    # –®–ê–ì 5: –ó–∞–ø—É—Å–∫ –º–æ–¥—É–ª–µ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
    await self._start_safety_modules()  # –°—Ç—Ä–æ–∫–∞ 945
    # - await self.liquidation_guard.start_monitoring() (—Å—Ç—Ä–æ–∫–∞ 1237)
    # - await self.slippage_guard.start_monitoring() (—Å—Ç—Ä–æ–∫–∞ 1244)
    
    # –®–ê–ì 6: –û—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π
    self._reset_all_states()  # –°—Ç—Ä–æ–∫–∞ 950 (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è)
    
    # –®–ê–ì 7: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ —Å–≤–µ—á–µ–π
    await self._initialize_candle_buffers()  # –°—Ç—Ä–æ–∫–∞ 953
    # - –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 1276-1461)
    # - 1m: 200 —Å–≤–µ—á–µ–π (—Å—Ç—Ä–æ–∫–∞ 1311-1314)
    # - 5m: 200 —Å–≤–µ—á–µ–π (—Å—Ç—Ä–æ–∫–∞ 1317-1320)
    # - 1H: 100 —Å–≤–µ—á–µ–π (—Å—Ç—Ä–æ–∫–∞ 1323-1326)
    # - 1D: 10 —Å–≤–µ—á–µ–π (—Å—Ç—Ä–æ–∫–∞ 1329-1332)
    # - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ DataRegistry (—Å—Ç—Ä–æ–∫–∞ 1379-1384)
    
    # –®–ê–ì 8: –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
    await self._load_existing_positions()  # –°—Ç—Ä–æ–∫–∞ 956
    # - –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π —Å –±–∏—Ä–∂–∏ (—Å—Ç—Ä–æ–∫–∞ 1518)
    # - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TrailingStopLoss (—Å—Ç—Ä–æ–∫–∞ 1600+)
    
    # –®–ê–ì 9: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–π
    await self.position_sync.sync_positions_with_exchange(force=True)  # –°—Ç—Ä–æ–∫–∞ 960
    # –ò–õ–ò
    await self._sync_positions_with_exchange(force=True)  # –°—Ç—Ä–æ–∫–∞ 963
    
    # –®–ê–ì 10: –ó–∞–ø—É—Å–∫ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
    await self.position_monitor.start()  # –°—Ç—Ä–æ–∫–∞ 966
    asyncio.create_task(self._log_archive_task())  # –°—Ç—Ä–æ–∫–∞ 970 (—Ñ–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞)
    
    # –®–ê–ì 11: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
    await self._verify_readiness()  # –°—Ç—Ä–æ–∫–∞ 974
    # - await self._verify_candles_loaded() (—Å—Ç—Ä–æ–∫–∞ 5086)
    #   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º—É–º 50 —Å–≤–µ—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ (—Å—Ç—Ä–æ–∫–∞ 5138)
    # - –ü—Ä–æ–≤–µ—Ä–∫–∞ is_initialized –¥–ª—è SignalGenerator (—Å—Ç—Ä–æ–∫–∞ 5089-5094)
    # - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π (—Å—Ç—Ä–æ–∫–∞ 5097-5111)
    
    # –®–ê–ì 12: –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
    self.is_running = True  # –°—Ç—Ä–æ–∫–∞ 977
    await self.trading_control_center.run_main_loop()  # –°—Ç—Ä–æ–∫–∞ 978
```

**–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞:**

```
T0: start() –≤—ã–∑–≤–∞–Ω
T1: _verify_initialization() –∑–∞–≤–µ—Ä—à–µ–Ω
T2: _initialize_client() –∑–∞–≤–µ—Ä—à–µ–Ω (–±–∞–ª–∞–Ω—Å –ø–æ–ª—É—á–µ–Ω, leverage —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
T3: _start_trading_modules() –∑–∞–≤–µ—Ä—à–µ–Ω (SignalGenerator.is_initialized = True)
T4: WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ ‚ö†Ô∏è
T5: _start_safety_modules() –∑–∞–≤–µ—Ä—à–µ–Ω
T6: _initialize_candle_buffers() –∑–∞–≤–µ—Ä—à–µ–Ω (—Å–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã)
T7: _load_existing_positions() –∑–∞–≤–µ—Ä—à–µ–Ω
T8: _verify_readiness() –∑–∞–≤–µ—Ä—à–µ–Ω (–≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã)
T9: run_main_loop() –∑–∞–ø—É—â–µ–Ω (—Ç–æ—Ä–≥–æ–≤–ª—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è)
```

---

### 1.5. –î–µ—Ç–∞–ª—å–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π

#### 1.5.1. SignalGenerator.initialize()

**–§–∞–π–ª:** `src/strategies/scalping/futures/signal_generator.py`  
**–°—Ç—Ä–æ–∫–∞:** `422` ‚Äî `async def initialize(self, ohlcv_data: Dict[str, List[OHLCV]] = None):`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# signal_generator.py:422
async def initialize(self, ohlcv_data=None):
    # –°—Ç—Ä–æ–∫–∞ 432: –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –ª–∏ —É–∂–µ
    if self.is_initialized:
        return
    
    # –°—Ç—Ä–æ–∫–∞ 438-461: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ adaptive_regime
    # –°—Ç—Ä–æ–∫–∞ 461-1200+: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è RegimeManager
    #   - –°–æ–∑–¥–∞–Ω–∏–µ RegimeParameters –¥–ª—è trending/ranging/choppy
    #   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ (MultiTimeframe, Correlation, PivotPoints, VolumeProfile)
    #   - –†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤
    
    # –°—Ç—Ä–æ–∫–∞ 1207: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–ª–∞–≥–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    self.is_initialized = True
```

**–ß—Ç–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è:**

1. **RegimeManager** (AdaptiveRegimeManager)
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è trending/ranging/choppy —Ä–µ–∂–∏–º–æ–≤
   - –ü–æ—Ä–æ–≥–∏ ADX, –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞
   - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∂–∏–º–∞

2. **–§–∏–ª—å—Ç—Ä—ã:**
   - MultiTimeframeFilter (—Å—Ç—Ä–æ–∫–∞ 513+)
   - CorrelationFilter (—Å—Ç—Ä–æ–∫–∞ 520+)
   - PivotPointsFilter (—Å—Ç—Ä–æ–∫–∞ 516+)
   - VolumeProfileFilter (—Å—Ç—Ä–æ–∫–∞ 518+)

3. **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
   - RSI, EMA, SMA, MACD, Bollinger Bands (—á–µ—Ä–µ–∑ IndicatorManager)

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~1-3 —Å–µ–∫—É–Ω–¥—ã (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Ñ–∏–ª—å—Ç—Ä–æ–≤)

---

#### 1.5.2. WebSocketCoordinator.initialize_websocket()

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/websocket_coordinator.py`  
**–°—Ç—Ä–æ–∫–∞:** `124` ‚Äî `async def initialize_websocket(self):`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# websocket_coordinator.py:124
async def initialize_websocket(self):
    # –°—Ç—Ä–æ–∫–∞ 132: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ WebSocket
    if await self.ws_manager.connect():
        # –°—Ç—Ä–æ–∫–∞ 136-152: –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–∏–∫–µ—Ä—ã –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤
        for symbol in self.scalping_config.symbols:
            inst_id = f"{symbol}-SWAP"
            await self.ws_manager.subscribe(
                channel="tickers",
                inst_id=inst_id,
                callback=ticker_callback,  # –û–¥–∏–Ω callback –¥–ª—è –≤—Å–µ—Ö
            )
    
    # –°—Ç—Ä–æ–∫–∞ 164-186: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Private WebSocket
    if self.private_ws_manager:
        await self.private_ws_manager.connect()
        await self.private_ws_manager.subscribe_positions(...)
        await self.private_ws_manager.subscribe_orders(...)
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ú–û–ú–ï–ù–¢:**

–ü–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket **—Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ** –∏ –≤—ã–∑—ã–≤–∞—Ç—å `handle_ticker_data()` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∏–∫–µ—Ä–∞!

**Callback —Ü–µ–ø–æ—á–∫–∞:**

```
WebSocket ‚Üí ticker_callback (—Å—Ç—Ä–æ–∫–∞ 136)
  ‚Üí handle_ticker_data() (—Å—Ç—Ä–æ–∫–∞ 188)
    ‚Üí check_signals_callback(symbol, price) (—Å—Ç—Ä–æ–∫–∞ 355)
      ‚Üí signal_coordinator.check_for_signals() (—Å—Ç—Ä–æ–∫–∞ 1093)
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç race condition:**

```python
# websocket_coordinator.py:197-206
if self.signal_generator and hasattr(self.signal_generator, "is_initialized"):
    if not self.signal_generator.is_initialized:
        logger.debug(f"‚ö†Ô∏è SignalGenerator –µ—â–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∏–∫–µ—Ä–∞ –¥–ª—è {symbol}")
        return
```

‚úÖ **–ï—Å—Ç—å –∑–∞—â–∏—Ç–∞:** –ï—Å–ª–∏ `SignalGenerator` –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, —Ç–∏–∫–µ—Ä—ã –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è.

---

#### 1.5.3. _initialize_candle_buffers()

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–°—Ç—Ä–æ–∫–∞:** `1276` ‚Äî `async def _initialize_candle_buffers(self):`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# orchestrator.py:1276
async def _initialize_candle_buffers(self):
    # –°—Ç—Ä–æ–∫–∞ 1309-1334: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤
    timeframes_config = [
        {"timeframe": "1m", "limit": 200, ...},
        {"timeframe": "5m", "limit": 200, ...},
        {"timeframe": "1H", "limit": 100, ...},
        {"timeframe": "1D", "limit": 10, ...},
    ]
    
    # –°—Ç—Ä–æ–∫–∞ 1337-1439: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ –∏ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞
    for symbol in symbols:
        for tf_config in timeframes_config:
            # –°—Ç—Ä–æ–∫–∞ 1348: HTTP –∑–∞–ø—Ä–æ—Å –∫ OKX API
            url = f"https://www.okx.com/api/v5/market/candles?instId={inst_id}&bar={timeframe}&limit={limit}"
            
            # –°—Ç—Ä–æ–∫–∞ 1379-1384: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ DataRegistry
            await self.data_registry.initialize_candles(
                symbol=symbol,
                timeframe=timeframe,
                candles=ohlcv_data,
                max_size=max_size,
            )
```

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~5-15 —Å–µ–∫—É–Ω–¥ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ API)

**–ß—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è:**

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, BTC-USDT, ETH-USDT):
  - 1m: 200 —Å–≤–µ—á–µ–π (–¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤)
  - 5m: 200 —Å–≤–µ—á–µ–π (–¥–ª—è Multi-Timeframe —Ñ–∏–ª—å—Ç—Ä–∞)
  - 1H: 100 —Å–≤–µ—á–µ–π (–¥–ª—è Volume Profile —Ñ–∏–ª—å—Ç—Ä–∞)
  - 1D: 10 —Å–≤–µ—á–µ–π (–¥–ª—è Pivot Points —Ñ–∏–ª—å—Ç—Ä–∞)

**–í—Å–µ–≥–æ:** 4 —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞ √ó N —Å–∏–º–≤–æ–ª–æ–≤ = 4N HTTP –∑–∞–ø—Ä–æ—Å–æ–≤

---

#### 1.5.4. _verify_readiness()

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–°—Ç—Ä–æ–∫–∞:** `5072` ‚Äî `async def _verify_readiness(self) -> None:`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# orchestrator.py:5072
async def _verify_readiness(self):
    # –°—Ç—Ä–æ–∫–∞ 5086: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π
    await self._verify_candles_loaded()
    # - –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º—É–º 50 —Å–≤–µ—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ (—Å—Ç—Ä–æ–∫–∞ 5138)
    # - –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚Üí ValueError
    
    # –°—Ç—Ä–æ–∫–∞ 5089-5094: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ SignalGenerator
    if not self.signal_generator.is_initialized:
        raise ValueError("‚ùå SignalGenerator –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
    
    # –°—Ç—Ä–æ–∫–∞ 5097-5111: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –º–æ–¥—É–ª–µ–π
    if not self.data_registry:
        raise ValueError("‚ùå DataRegistry –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
    if not self.position_registry:
        raise ValueError("‚ùå PositionRegistry –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω")
    # ... –∏ —Ç.–¥.
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**

1. ‚úÖ **–°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:** –ú–∏–Ω–∏–º—É–º 50 —Å–≤–µ—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ (—Å—Ç—Ä–æ–∫–∞ 5138)
2. ‚úÖ **SignalGenerator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω:** `is_initialized = True` (—Å—Ç—Ä–æ–∫–∞ 5091)
3. ‚úÖ **DataRegistry –¥–æ—Å—Ç—É–ø–µ–Ω:** –ù–µ None (—Å—Ç—Ä–æ–∫–∞ 5098)
4. ‚úÖ **PositionRegistry –¥–æ—Å—Ç—É–ø–µ–Ω:** –ù–µ None (—Å—Ç—Ä–æ–∫–∞ 5102)
5. ‚úÖ **SignalCoordinator –¥–æ—Å—Ç—É–ø–µ–Ω:** –ù–µ None (—Å—Ç—Ä–æ–∫–∞ 5106)
6. ‚úÖ **PositionManager –¥–æ—Å—Ç—É–ø–µ–Ω:** –ù–µ None (—Å—Ç—Ä–æ–∫–∞ 5110)

**–ï—Å–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω–∞:** –í—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è `ValueError`, —Ç–æ—Ä–≥–æ–≤–ª—è **–ù–ï –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è**.

---

### 1.6. –û—Å–Ω–æ–≤–Ω–æ–π —Ç–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª: `run_main_loop()`

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/trading_control_center.py`  
**–°—Ç—Ä–æ–∫–∞:** `127` ‚Äî `async def run_main_loop(self) -> None:`

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# trading_control_center.py:127
async def run_main_loop(self):
    self.is_running = True
    loop_start_time = time.time()
    
    while self.is_running:
        # –°—Ç—Ä–æ–∫–∞ 154-161: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ memory usage (—Ä–∞–∑ –≤ 10 –º–∏–Ω—É—Ç)
        # –°—Ç—Ä–æ–∫–∞ 163-169: –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ –∏ –∞–ª–µ—Ä—Ç–æ–≤ (—Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç)
        # –°—Ç—Ä–æ–∫–∞ 171-187: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (—Ä–∞–∑ –≤ 5 –º–∏–Ω—É—Ç)
        # –°—Ç—Ä–æ–∫–∞ 189-210: Reset —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (—Ä–∞–∑ –≤ 1 —á–∞—Å)
        
        # –°—Ç—Ä–æ–∫–∞ 214: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è
        await self.update_state()
        
        # –°—Ç—Ä–æ–∫–∞ 222: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
        signals = await self.signal_generator.generate_signals()
        
        # –°—Ç—Ä–æ–∫–∞ 194: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
        await self.signal_coordinator.process_signals(signals)
        
        # –°—Ç—Ä–æ–∫–∞ 202: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏
        await self.manage_positions()
        
        # –°—Ç—Ä–æ–∫–∞ 210: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–∏–º–∏—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
        await self.order_coordinator.monitor_limit_orders()
        
        # –°—Ç—Ä–æ–∫–∞ 218-250: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ü–∏–∫–ª–∞
        # –°—Ç—Ä–æ–∫–∞ 252: await asyncio.sleep(1) - –∑–∞–¥–µ—Ä–∂–∫–∞ 1 —Å–µ–∫—É–Ω–¥–∞
```

**–¶–∏–∫–ª –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:** –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É (—Å—Ç—Ä–æ–∫–∞ 252)

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ü–∏–∫–ª–µ:**

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤** (—Å—Ç—Ä–æ–∫–∞ 222)
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `signal_generator.generate_signals()`
   - –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–≥–Ω–∞–ª—ã –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–µ—á–∏ –∏–∑ DataRegistry
   - –ü—Ä–∏–º–µ–Ω—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä—ã (MultiTimeframe, Correlation, PivotPoints, VolumeProfile)

2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤** (—Å—Ç—Ä–æ–∫–∞ 194)
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `signal_coordinator.process_signals(signals)`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∏–ª—É —Å–∏–≥–Ω–∞–ª–æ–≤, –º–∞—Ä–∂—É, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–∑–∏—Ü–∏–∏
   - –ò—Å–ø–æ–ª–Ω—è–µ—Ç —Å–∏–≥–Ω–∞–ª—ã —á–µ—Ä–µ–∑ `execute_signal()`

3. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏—è–º–∏** (—Å—Ç—Ä–æ–∫–∞ 202)
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `position_manager.manage_positions()`
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç TP, SL, Trailing SL
   - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

## 2. –ü–û–†–Ø–î–û–ö –ì–û–¢–û–í–ù–û–°–¢–ò –ú–û–î–£–õ–ï–ô

### 2.1. –ú–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≥–æ—Ç–æ–≤—ã –ü–ï–†–ï–î –Ω–∞—á–∞–ª–æ–º —Ç–æ—Ä–≥–æ–≤–ª–∏

| –ú–æ–¥—É–ª—å | –ö–æ–≥–¥–∞ –≥–æ—Ç–æ–≤ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|--------|-------------|---------------------|-------------|
| **DataRegistry** | `__init__()` (—Å—Ç—Ä–æ–∫–∞ 145) | `_verify_readiness()` (—Å—Ç—Ä–æ–∫–∞ 5098) | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **PositionRegistry** | `__init__()` (—Å—Ç—Ä–æ–∫–∞ 144) | `_verify_readiness()` (—Å—Ç—Ä–æ–∫–∞ 5102) | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **SignalGenerator** | `_start_trading_modules()` (—Å—Ç—Ä–æ–∫–∞ 1257) | `is_initialized = True` (—Å—Ç—Ä–æ–∫–∞ 1207) | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **RegimeManager** | –í–Ω—É—Ç—Ä–∏ `SignalGenerator.initialize()` | –ß–µ—Ä–µ–∑ `SignalGenerator.is_initialized` | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **–°–≤–µ—á–∏ (1m)** | `_initialize_candle_buffers()` (—Å—Ç—Ä–æ–∫–∞ 953) | `_verify_candles_loaded()` (—Å—Ç—Ä–æ–∫–∞ 5138) | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **–°–≤–µ—á–∏ (5m, 1H, 1D)** | `_initialize_candle_buffers()` (—Å—Ç—Ä–æ–∫–∞ 953) | –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —è–≤–Ω–æ | üü° –í–∞–∂–Ω–æ |
| **SignalCoordinator** | `__init__()` (—Å—Ç—Ä–æ–∫–∞ 808) | `_verify_readiness()` (—Å—Ç—Ä–æ–∫–∞ 5106) | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **PositionManager** | `__init__()` (—Å—Ç—Ä–æ–∫–∞ 600+) | `_verify_readiness()` (—Å—Ç—Ä–æ–∫–∞ 5110) | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **OrderExecutor** | `__init__()` (—Å—Ç—Ä–æ–∫–∞ 600+) | –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —è–≤–Ω–æ | üü° –í–∞–∂–Ω–æ |
| **ParameterProvider** | –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ RegimeManager | –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —è–≤–Ω–æ | üü° –í–∞–∂–Ω–æ |
| **ATRProvider** | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ DataRegistry | –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —è–≤–Ω–æ | üü° –í–∞–∂–Ω–æ |
| **FastADX** | `__init__()` (—Å—Ç—Ä–æ–∫–∞ 459) | –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —è–≤–Ω–æ | üü° –í–∞–∂–Ω–æ |
| **FundingRateMonitor** | `__init__()` (—Å—Ç—Ä–æ–∫–∞ 459) | –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —è–≤–Ω–æ | üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ |

### 2.2. –ú–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (create_task)

| –ú–æ–¥—É–ª—å | –ö–æ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è | –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –≥–æ—Ç–æ–≤ | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|--------|-------------------|---------------------|-------------|
| **PositionMonitor** | `await self.position_monitor.start()` (—Å—Ç—Ä–æ–∫–∞ 966) | ‚úÖ Await, –≥–æ—Ç–æ–≤ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ | üü° –í–∞–∂–Ω–æ |
| **LogArchiveTask** | `asyncio.create_task(self._log_archive_task())` (—Å—Ç—Ä–æ–∫–∞ 970) | ‚ö†Ô∏è –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ | üü¢ –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ |
| **LiquidationGuard** | `await self.liquidation_guard.start_monitoring()` (—Å—Ç—Ä–æ–∫–∞ 1237) | ‚úÖ Await, –≥–æ—Ç–æ–≤ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ | üü° –í–∞–∂–Ω–æ |
| **SlippageGuard** | `await self.slippage_guard.start_monitoring()` (—Å—Ç—Ä–æ–∫–∞ 1244) | ‚úÖ Await, –≥–æ—Ç–æ–≤ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ | üü° –í–∞–∂–Ω–æ |

### 2.3. –ü–æ—Ä—è–¥–æ–∫ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π (—Ö—Ä–æ–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π)

```
T0: __init__() –∑–∞–≤–µ—Ä—à–µ–Ω
  ‚úÖ DataRegistry –≥–æ—Ç–æ–≤
  ‚úÖ PositionRegistry –≥–æ—Ç–æ–≤
  ‚úÖ SignalCoordinator —Å–æ–∑–¥–∞–Ω (–Ω–æ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω)
  ‚úÖ PositionManager —Å–æ–∑–¥–∞–Ω (–Ω–æ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω)
  ‚úÖ OrderExecutor —Å–æ–∑–¥–∞–Ω (–Ω–æ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω)
  ‚úÖ WebSocketCoordinator —Å–æ–∑–¥–∞–Ω (–Ω–æ –Ω–µ –ø–æ–¥–∫–ª—é—á–µ–Ω)

T1: _start_trading_modules() –∑–∞–≤–µ—Ä—à–µ–Ω
  ‚úÖ SignalGenerator.is_initialized = True
  ‚úÖ RegimeManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
  ‚úÖ OrderExecutor.initialize() –∑–∞–≤–µ—Ä—à–µ–Ω
  ‚úÖ PositionManager.initialize() –∑–∞–≤–µ—Ä—à–µ–Ω

T2: WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω
  ‚ö†Ô∏è WebSocket –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
  ‚ö†Ô∏è handle_ticker_data() –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è
  ‚úÖ –ó–∞—â–∏—Ç–∞: –ø—Ä–æ–≤–µ—Ä–∫–∞ is_initialized –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π

T3: _initialize_candle_buffers() –∑–∞–≤–µ—Ä—à–µ–Ω
  ‚úÖ –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤
  ‚úÖ DataRegistry —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∏–Ω–∏–º—É–º 50 —Å–≤–µ—á–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞

T4: _verify_readiness() –∑–∞–≤–µ—Ä—à–µ–Ω
  ‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã
  ‚úÖ –¢–æ—Ä–≥–æ–≤–ª—è –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å—Å—è

T5: run_main_loop() –∑–∞–ø—É—â–µ–Ω
  ‚úÖ –¢–æ—Ä–≥–æ–≤—ã–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç–∞–µ—Ç
  ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞—á–∞–ª–∞—Å—å
```

---

## 3. –¢–û–†–ì–û–í–´–ô –¶–ò–ö–õ –ò CHECK_FOR_SIGNALS

### 3.1. –ö–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/trading_control_center.py`  
**–°—Ç—Ä–æ–∫–∞:** `127` ‚Äî `async def run_main_loop(self) -> None:`

**–£—Å–ª–æ–≤–∏—è –∑–∞–ø—É—Å–∫–∞:**

1. ‚úÖ `_verify_readiness()` –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ (—Å—Ç—Ä–æ–∫–∞ 974)
2. ‚úÖ `self.is_running = True` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 977)
3. ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –≥–æ—Ç–æ–≤—ã (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤ `_verify_readiness()`)

**–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:**

```python
# orchestrator.py:978
await self.trading_control_center.run_main_loop()
```

**–ü–æ—Å–ª–µ:** –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø—Ä–æ–π–¥–µ–Ω—ã (—Å—Ç—Ä–æ–∫–∞ 974)

---

### 3.2. –ö–æ–≥–¥–∞ –≤–ø–µ—Ä–≤—ã–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è check_for_signals() –∏–ª–∏ process_signals()

#### 3.2.1. process_signals() ‚Äî –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/core/trading_control_center.py`  
**–°—Ç—Ä–æ–∫–∞:** `194` ‚Äî `await self.signal_coordinator.process_signals(signals)`

**–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:**

- **–ü–µ—Ä–≤—ã–π —Ä–∞–∑:** –í –ø–µ—Ä–≤–æ–º —Ü–∏–∫–ª–µ `run_main_loop()` –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–∏–≥–Ω–∞–ª–æ–≤ (—Å—Ç—Ä–æ–∫–∞ 222)
- **–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å:** –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É (—Å—Ç—Ä–æ–∫–∞ 252)

**–£—Å–ª–æ–≤–∏—è:**

- ‚úÖ `run_main_loop()` –∑–∞–ø—É—â–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 978)
- ‚úÖ `signal_generator.generate_signals()` –∑–∞–≤–µ—Ä—à–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 222)
- ‚úÖ –°–∏–≥–Ω–∞–ª—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫)

---

#### 3.2.2. check_for_signals() ‚Äî –∏–∑ WebSocket

**–§–∞–π–ª:** `src/strategies/scalping/futures/coordinators/signal_coordinator.py`  
**–°—Ç—Ä–æ–∫–∞:** `1093` ‚Äî `async def check_for_signals(self, symbol: str, price: float):`

**–ö–æ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è:**

- **–ü–µ—Ä–≤—ã–π —Ä–∞–∑:** –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞ –∏–∑ WebSocket **–ü–û–°–õ–ï** –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- **–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å:** –ü—Ä–∏ –∫–∞–∂–¥–æ–º —Ç–∏–∫–µ—Ä–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞ (—Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è)

**–¶–µ–ø–æ—á–∫–∞ –≤—ã–∑–æ–≤–æ–≤:**

```
WebSocket –ø–æ–ª—É—á–∞–µ—Ç —Ç–∏–∫–µ—Ä
  ‚Üí ticker_callback() (websocket_coordinator.py:136)
    ‚Üí handle_ticker_data() (websocket_coordinator.py:188)
      ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ is_initialized (websocket_coordinator.py:199-206)
        ‚Üí –ï—Å–ª–∏ –≥–æ—Ç–æ–≤: check_signals_callback(symbol, price) (websocket_coordinator.py:355)
          ‚Üí signal_coordinator.check_for_signals() (signal_coordinator.py:1093)
```

**–£—Å–ª–æ–≤–∏—è:**

- ‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 942)
- ‚úÖ `SignalGenerator.is_initialized = True` (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Å—Ç—Ä–æ–∫–µ 202)
- ‚úÖ –¢–∏–∫–µ—Ä –ø–æ–ª—É—á–µ–Ω –¥–ª—è —Å–∏–º–≤–æ–ª–∞

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ú–û–ú–ï–ù–¢:**

`check_for_signals()` –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω **–î–û** –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `_initialize_candle_buffers()`!

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–æ–∑–º–æ–∂–Ω–æ:**

1. WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–µ 942
2. WebSocket —Å—Ä–∞–∑—É –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
3. `_initialize_candle_buffers()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–µ 953 (–ü–û–°–õ–ï –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket)
4. –ù–æ `_initialize_candle_buffers()` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 5-15 —Å–µ–∫—É–Ω–¥
5. –ó–∞ —ç—Ç–æ –≤—Ä–µ–º—è WebSocket –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–∏–∫–µ—Ä–æ–≤ –∏ –≤—ã–∑–≤–∞—Ç—å `check_for_signals()`

**–ó–∞—â–∏—Ç–∞:**

```python
# websocket_coordinator.py:199-206
if self.signal_generator and hasattr(self.signal_generator, "is_initialized"):
    if not self.signal_generator.is_initialized:
        logger.debug(f"‚ö†Ô∏è SignalGenerator –µ—â–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∏–∫–µ—Ä–∞ –¥–ª—è {symbol}")
        return
```

‚úÖ **–ï—Å—Ç—å –∑–∞—â–∏—Ç–∞ –æ—Ç –≤—ã–∑–æ–≤–∞ –¥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ SignalGenerator**, –Ω–æ **–ù–ï–¢ –∑–∞—â–∏—Ç—ã –æ—Ç –≤—ã–∑–æ–≤–∞ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π**!

---

### 3.3. –ú–æ–∂–µ—Ç –ª–∏ –±–æ—Ç –Ω–∞—á–∞—Ç—å –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å/–∏—Å–ø–æ–ª–Ω—è—Ç—å —Å–∏–≥–Ω–∞–ª—ã –î–û –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏?

#### 3.3.1. –ß–µ—Ä–µ–∑ process_signals() (–æ—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª)

**–ù–ï–¢** ‚úÖ ‚Äî –∑–∞—â–∏—â–µ–Ω–æ `_verify_readiness()`:

```python
# orchestrator.py:974
await self._verify_readiness()  # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–≤–µ—á–∏, is_initialized –∏ —Ç.–¥.

# orchestrator.py:978
await self.trading_control_center.run_main_loop()  # –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï –ø—Ä–æ–≤–µ—Ä–∫–∏
```

**–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º:**

1. ‚úÖ –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–º–∏–Ω–∏–º—É–º 50 –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–∏–º–≤–æ–ª–∞) ‚Äî —Å—Ç—Ä–æ–∫–∞ 5138
2. ‚úÖ SignalGenerator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω ‚Äî —Å—Ç—Ä–æ–∫–∞ 5091
3. ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –º–æ–¥—É–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã ‚Äî —Å—Ç—Ä–æ–∫–∞ 5097-5111

**–í—ã–≤–æ–¥:** `process_signals()` **–ù–ï –º–æ–∂–µ—Ç** –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –¥–æ –ø–æ–ª–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.

---

#### 3.3.2. –ß–µ—Ä–µ–∑ check_for_signals() (WebSocket)

**–î–ê** ‚ö†Ô∏è ‚Äî –≤–æ–∑–º–æ–∂–Ω–∞ race condition:

**–°—Ü–µ–Ω–∞—Ä–∏–π:**

```
T0: WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 942)
T1: WebSocket –ø–æ–ª—É—á–∞–µ—Ç –ø–µ—Ä–≤—ã–π —Ç–∏–∫–µ—Ä –¥–ª—è BTC-USDT
T2: handle_ticker_data() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 188)
T3: –ü—Ä–æ–≤–µ—Ä–∫–∞ is_initialized –ø—Ä–æ—Ö–æ–¥–∏—Ç (—Å—Ç—Ä–æ–∫–∞ 202) ‚úÖ
T4: check_for_signals() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 355)
T5: check_for_signals() –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–≤–µ—á–∏ –∏–∑ DataRegistry
T6: _initialize_candle_buffers() –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 953) ‚ö†Ô∏è
T7: –°–≤–µ—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ (–º–µ–Ω–µ–µ 50)
```

**–ß—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏:**

1. **ATR = None:** –ï—Å–ª–∏ —Å–≤–µ—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, ATRProvider –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None
2. **–†–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω:** –ï—Å–ª–∏ —Å–≤–µ—á–µ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, RegimeManager –Ω–µ –º–æ–∂–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–µ–∂–∏–º
3. **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã:** RSI, EMA, MACD —Ç—Ä–µ–±—É—é—Ç –º–∏–Ω–∏–º—É–º 14-26 —Å–≤–µ—á–µ–π
4. **Pivot Points –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã:** –¢—Ä–µ–±—É—é—Ç –¥–Ω–µ–≤–Ω—ã–µ —Å–≤–µ—á–∏ (1D)
5. **Volume Profile –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω:** –¢—Ä–µ–±—É–µ—Ç —á–∞—Å–æ–≤—ã–µ —Å–≤–µ—á–∏ (1H)

**–ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–æ–≤:**

```
23:52:11 | INFO | WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω
23:52:11 | INFO | üí∞ BTC-USDT: $43250.00
23:52:11 | DEBUG | üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è BTC-USDT...
23:52:12 | INFO | Pivots calculated –¥–ª—è BTC-USDT
23:52:12 | INFO | Volume Profile calculated –¥–ª—è BTC-USDT
23:52:13 | INFO | Regime detected: TRENDING –¥–ª—è BTC-USDT
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –°–≤–µ—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–≥—Ä—É–∂–µ–Ω—ã **–ü–û–°–õ–ï** —Ç–æ–≥–æ, –∫–∞–∫ WebSocket —É–∂–µ –Ω–∞—á–∞–ª –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–∑—ã–≤–∞—Ç—å `check_for_signals()`.

---

## 4. –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï RACE CONDITIONS –ò –ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´

### 4.1. Race Condition #1: WebSocket —Ç–∏–∫–µ—Ä—ã –î–û –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:**

WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–µ 942, –Ω–æ `_initialize_candle_buffers()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–µ 953 (–ü–û–°–õ–ï –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è). –ó–∞ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π (5-15 —Å–µ–∫—É–Ω–¥) WebSocket –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ —Ç–∏–∫–µ—Ä–æ–≤ –∏ –≤—ã–∑–≤–∞—Ç—å `check_for_signals()`.

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```
T0: WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω (—Å—Ç—Ä–æ–∫–∞ 942)
T1: WebSocket –ø–æ–ª—É—á–∞–µ—Ç —Ç–∏–∫–µ—Ä ‚Üí handle_ticker_data() (—Å—Ç—Ä–æ–∫–∞ 188)
T2: –ü—Ä–æ–≤–µ—Ä–∫–∞ is_initialized –ø—Ä–æ—Ö–æ–¥–∏—Ç (—Å—Ç—Ä–æ–∫–∞ 202) ‚úÖ
T3: check_for_signals() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 355)
T4: check_for_signals() –ø—ã—Ç–∞–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å —Å–≤–µ—á–∏ (—Å—Ç—Ä–æ–∫–∞ 1093+)
T5: _initialize_candle_buffers() –µ—â–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è (—Å—Ç—Ä–æ–∫–∞ 953) ‚ö†Ô∏è
T6: –°–≤–µ—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

1. **ATR = None:** `ATRProvider.get_atr()` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None –∏–ª–∏ fallback –∑–Ω–∞—á–µ–Ω–∏–µ
2. **–†–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω:** `RegimeManager.get_current_regime()` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–µ–∂–∏–º
3. **–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã:** RSI, EMA, MACD —Ç—Ä–µ–±—É—é—Ç –º–∏–Ω–∏–º—É–º 14-26 —Å–≤–µ—á–µ–π
4. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã:** –°–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ü—Ä–∏–º–µ—Ä –∏–∑ –∫–æ–¥–∞:**

```python
# signal_coordinator.py:1093
async def check_for_signals(self, symbol: str, price: float):
    # –°—Ç—Ä–æ–∫–∞ 1093+: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–∏–≥–Ω–∞–ª–æ–≤
    # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–≤–µ—á–∏ –∏–∑ DataRegistry
    candles = await self.data_registry.get_candles(symbol, "1m")
    if not candles or len(candles) < 50:  # ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–Ω—å—à–µ 50!
        # –°–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
        pass
```

**–¢–µ–∫—É—â–∞—è –∑–∞—â–∏—Ç–∞:**

```python
# websocket_coordinator.py:199-206
if not self.signal_generator.is_initialized:
    return  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Ç–∏–∫–µ—Ä
```

‚úÖ **–ó–∞—â–∏—Ç–∞ –µ—Å—Ç—å –¥–ª—è SignalGenerator**, –Ω–æ **–ù–ï–¢ –∑–∞—â–∏—Ç—ã –¥–ª—è —Å–≤–µ—á–µ–π**!

---

### 4.2. Race Condition #2: Pivot Points –∏ Volume Profile —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ü–û–°–õ–ï –Ω–∞—á–∞–ª–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**

Pivot Points –∏ Volume Profile —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ `SignalGenerator.generate_signals()` –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ **–î–û** –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `_initialize_candle_buffers()`.

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```
T0: _initialize_candle_buffers() –Ω–∞—á–∞—Ç (—Å—Ç—Ä–æ–∫–∞ 953)
T1: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π 1m –¥–ª—è BTC-USDT (—Å—Ç—Ä–æ–∫–∞ 1348)
T2: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π 5m –¥–ª—è BTC-USDT (—Å—Ç—Ä–æ–∫–∞ 1348)
T3: –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π 1H –¥–ª—è BTC-USDT (—Å—Ç—Ä–æ–∫–∞ 1348) ‚Üê –ú–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –≤—Ä–µ–º—è
T4: WebSocket –ø–æ–ª—É—á–∞–µ—Ç —Ç–∏–∫–µ—Ä ‚Üí check_for_signals() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
T5: check_for_signals() ‚Üí generate_signals() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
T6: generate_signals() –ø—ã—Ç–∞–µ—Ç—Å—è —Ä–∞—Å—Å—á–∏—Ç–∞—Ç—å Pivot Points (—Ç—Ä–µ–±—É–µ—Ç 1D —Å–≤–µ—á–∏)
T7: 1D —Å–≤–µ—á–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã ‚ö†Ô∏è
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

1. **Pivot Points = None:** –ï—Å–ª–∏ 1D —Å–≤–µ—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, Pivot Points –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã
2. **Volume Profile = None:** –ï—Å–ª–∏ 1H —Å–≤–µ—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, Volume Profile –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å—Å—á–∏—Ç–∞–Ω
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Å–∏–≥–Ω–∞–ª—ã:** –°–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –±–µ–∑ —É—á–µ—Ç–∞ Pivot Points –∏ Volume Profile

**–ü—Ä–∏–º–µ—Ä –∏–∑ –ª–æ–≥–æ–≤:**

```
23:52:11 | INFO | üí∞ BTC-USDT: $43250.00
23:52:11 | DEBUG | üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è BTC-USDT...
23:52:12 | INFO | Pivots calculated –¥–ª—è BTC-USDT  ‚Üê –†–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
23:52:12 | INFO | Volume Profile calculated –¥–ª—è BTC-USDT  ‚Üê –†–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞—Å—á–µ—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç **–ü–û–°–õ–ï** —Ç–æ–≥–æ, –∫–∞–∫ `check_for_signals()` —É–∂–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω.

---

### 4.3. Race Condition #3: ATRProvider –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None –∏–ª–∏ fallback

**–ü—Ä–æ–±–ª–µ–º–∞:**

`ATRProvider.get_atr()` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à –∏–∑ `DataRegistry._indicators`, –Ω–æ –µ—Å–ª–∏ —Å–≤–µ—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, ATR –º–æ–∂–µ—Ç –±—ã—Ç—å None –∏–ª–∏ fallback –∑–Ω–∞—á–µ–Ω–∏–µ–º.

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# atr_provider.py:36
def get_atr(self, symbol: str, fallback: Optional[float] = None) -> Optional[float]:
    # –ü–æ–ª—É—á–∞–µ—Ç ATR –∏–∑ DataRegistry._indicators
    indicators = self.data_registry._indicators.get(symbol, {})
    atr_value = indicators.get("atr")
    
    if atr_value is None:
        return fallback  # ‚ö†Ô∏è –ú–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None –∏–ª–∏ fallback (5.0)
```

**–ö–æ–≥–¥–∞ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**

1. –°–≤–µ—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–º–µ–Ω–µ–µ 14 —Å–≤–µ—á–µ–π –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ ATR)
2. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –Ω–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã (ATR –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ DataRegistry)
3. –ö—ç—à –∏—Å—Ç–µ–∫ (TTL=60 —Å–µ–∫—É–Ω–¥, –Ω–æ —Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã)

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

1. **SL/TP —Ä–∞—Å—Å—á–∏—Ç–∞–Ω—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback ATR (5.0) –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏:** –†–∞–∑–º–µ—Ä –ø–æ–∑–∏—Ü–∏–∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç ATR
3. **–†–∏—Å–∫ —É–±—ã—Ç–∫–æ–≤:** SL –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º —É–∑–∫–∏–º –∏–ª–∏ —à–∏—Ä–æ–∫–∏–º

---

### 4.4. Race Condition #4: ParameterProvider –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:**

`ParameterProvider` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ `None` –≤ `__init__()` (—Å—Ç—Ä–æ–∫–∞ 122) –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `RegimeManager`, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ **–ü–û–°–õ–ï** –ø–µ—Ä–≤–æ–≥–æ –≤—ã–∑–æ–≤–∞ `check_for_signals()`.

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

```python
# orchestrator.py:122
self.parameter_provider = None  # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ None

# orchestrator.py:1257
await self.signal_generator.initialize()  # RegimeManager –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∑–¥–µ—Å—å

# orchestrator.py:953
await self._initialize_candle_buffers()  # –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∑–¥–µ—Å—å

# websocket_coordinator.py:355
await self.check_signals_callback(symbol, price)  # –ú–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –î–û –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ParameterProvider
```

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**

1. **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã:** `ParameterProvider.get_exit_params()` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None –∏–ª–∏ fallback –∑–Ω–∞—á–µ–Ω–∏—è
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ SL/TP:** –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–º–µ—Å—Ç–æ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö
3. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ä–µ–∂–∏–º—ã:** –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–∂–∏–º–æ–≤ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

---

### 4.5. –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –ª–æ–≥–æ–≤: –ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è

**–ü—Ä–∏–º–µ—Ä 1: –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ü–û–°–õ–ï –Ω–∞—á–∞–ª–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏**

```
23:52:10 | INFO | üöÄ –ó–∞–ø—É—Å–∫ Futures —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –±–æ—Ç–∞...
23:52:10 | INFO | ‚úÖ SignalGenerator: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ
23:52:11 | INFO | üì° –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ WebSocket...
23:52:11 | INFO | ‚úÖ WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω
23:52:11 | INFO | üí∞ BTC-USDT: $43250.00  ‚Üê –ü–µ—Ä–≤—ã–π —Ç–∏–∫–µ—Ä –ø–æ–ª—É—á–µ–Ω
23:52:11 | DEBUG | üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è BTC-USDT...  ‚Üê check_for_signals() –≤—ã–∑–≤–∞–Ω
23:52:12 | INFO | üìä –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±—É—Ñ–µ—Ä–æ–≤ —Å–≤–µ—á–µ–π...  ‚Üê –ó–∞–≥—Ä—É–∑–∫–∞ —Å–≤–µ—á–µ–π –Ω–∞—á–∞—Ç–∞ –ü–û–°–õ–ï —Ç–∏–∫–µ—Ä–∞
23:52:15 | INFO | ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –±—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π 1m –¥–ª—è BTC-USDT (200 —Å–≤–µ—á–µ–π)
23:52:16 | INFO | ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –±—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π 5m –¥–ª—è BTC-USDT (200 —Å–≤–µ—á–µ–π)
23:52:17 | INFO | ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –±—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π 1H –¥–ª—è BTC-USDT (100 —Å–≤–µ—á–µ–π)
23:52:18 | INFO | ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –±—É—Ñ–µ—Ä —Å–≤–µ—á–µ–π 1D –¥–ª—è BTC-USDT (10 —Å–≤–µ—á–µ–π)
```

**–ü—Ä–æ–±–ª–µ–º–∞:** `check_for_signals()` –±—ã–ª –≤—ã–∑–≤–∞–Ω –Ω–∞ —Å—Ç—Ä–æ–∫–µ 23:52:11, –Ω–æ —Å–≤–µ—á–∏ –Ω–∞—á–∞–ª–∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –Ω–∞ —Å—Ç—Ä–æ–∫–µ 23:52:12.

**–ü—Ä–∏–º–µ—Ä 2: Pivots –∏ Volume Profile —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞**

```
23:52:11 | INFO | üí∞ BTC-USDT: $43250.00
23:52:11 | DEBUG | üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è BTC-USDT...
23:52:12 | INFO | Pivots calculated –¥–ª—è BTC-USDT  ‚Üê –†–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
23:52:12 | INFO | Volume Profile calculated –¥–ª—è BTC-USDT  ‚Üê –†–∞—Å—Å—á–∏—Ç–∞–Ω—ã –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
23:52:13 | INFO | Regime detected: TRENDING –¥–ª—è BTC-USDT  ‚Üê –û–ø—Ä–µ–¥–µ–ª–µ–Ω –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –†–∞—Å—á–µ—Ç—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç **–ü–û–°–õ–ï** —Ç–æ–≥–æ, –∫–∞–∫ `check_for_signals()` —É–∂–µ –±—ã–ª –≤—ã–∑–≤–∞–Ω.

---

## 5. –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ –ü–û–†–Ø–î–ö–ê

### 5.1. –î–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —è–≤–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `check_for_signals()`.

**–†–µ—à–µ–Ω–∏–µ:**

```python
# orchestrator.py:953
await self._initialize_candle_buffers()

# –î–æ–±–∞–≤–∏—Ç—å —Ñ–ª–∞–≥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
self._candles_ready = True  # –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```python
# websocket_coordinator.py:199-206
# –†–∞—Å—à–∏—Ä–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
if self.signal_generator and hasattr(self.signal_generator, "is_initialized"):
    if not self.signal_generator.is_initialized:
        logger.debug(f"‚ö†Ô∏è SignalGenerator –µ—â–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∏–∫–µ—Ä–∞ –¥–ª—è {symbol}")
        return

# ‚úÖ –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π
if hasattr(self.orchestrator, "_candles_ready") and not self.orchestrator._candles_ready:
    logger.debug(f"‚ö†Ô∏è –°–≤–µ—á–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∏–∫–µ—Ä–∞ –¥–ª—è {symbol}")
    return
```

---

### 5.2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å asyncio.Event() –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ–∂–∏–¥–∞–Ω–∏—è –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π.

**–†–µ—à–µ–Ω–∏–µ:**

```python
# orchestrator.py:__init__()
self._ready_event = asyncio.Event()  # –°–æ–∑–¥–∞—Ç—å Event

# orchestrator.py:start()
# –ü–æ—Å–ª–µ –≤—Å–µ—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–π
await self._initialize_candle_buffers()
await self._verify_readiness()

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–ª–∞–≥ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
self._ready_event.set()  # –í—Å–µ –º–æ–¥—É–ª–∏ –≥–æ—Ç–æ–≤—ã

# websocket_coordinator.py:handle_ticker_data()
# –û–∂–∏–¥–∞—Ç—å –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π
if self.orchestrator and hasattr(self.orchestrator, "_ready_event"):
    try:
        await asyncio.wait_for(self.orchestrator._ready_event.wait(), timeout=0.1)
    except asyncio.TimeoutError:
        logger.debug(f"‚ö†Ô∏è –ú–æ–¥—É–ª–∏ –µ—â–µ –Ω–µ –≥–æ—Ç–æ–≤—ã, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–∏–∫–µ—Ä–∞ –¥–ª—è {symbol}")
        return
```

---

### 5.3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤ check_for_signals()

**–ü—Ä–æ–±–ª–µ–º–∞:** `check_for_signals()` –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å —Å–≤–µ—á–µ–π –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∏–≥–Ω–∞–ª–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:**

```python
# signal_coordinator.py:1093
async def check_for_signals(self, symbol: str, price: float):
    # ‚úÖ –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π
    if self.data_registry:
        candles = await self.data_registry.get_candles(symbol, "1m")
        if not candles or len(candles) < 50:
            logger.debug(f"‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–≤–µ—á–µ–π –¥–ª—è {symbol} ({len(candles) if candles else 0} < 50), –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤")
            return
    
    # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤
    # ...
```

---

### 5.4. –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: –°–≤–µ—á–∏ –ü–ï–†–ï–î WebSocket

**–ü—Ä–æ–±–ª–µ–º–∞:** WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –î–û –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π.

**–¢–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫:**

```python
# orchestrator.py:939
await self._start_trading_modules()  # SignalGenerator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

# orchestrator.py:942
await self.websocket_coordinator.initialize_websocket()  # WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω

# orchestrator.py:953
await self._initialize_candle_buffers()  # –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ü–û–°–õ–ï WebSocket
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫:**

```python
# orchestrator.py:939
await self._start_trading_modules()  # SignalGenerator –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω

# orchestrator.py:953
await self._initialize_candle_buffers()  # –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ü–ï–†–ï–î WebSocket ‚úÖ

# orchestrator.py:942
await self.websocket_coordinator.initialize_websocket()  # WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ü–û–°–õ–ï –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π ‚úÖ
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. ‚úÖ –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –î–û –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket
2. ‚úÖ `check_for_signals()` –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π
3. ‚úÖ –ù–µ—Ç race condition –º–µ–∂–¥—É WebSocket –∏ –∑–∞–≥—Ä—É–∑–∫–æ–π —Å–≤–µ—á–µ–π

---

### 5.5. –î–æ–±–∞–≤–∏—Ç—å _verify_readiness() –ø–µ—Ä–µ–¥ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º WebSocket

**–ü—Ä–æ–±–ª–µ–º–∞:** `_verify_readiness()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ü–û–°–õ–ï –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket.

**–¢–µ–∫—É—â–∏–π –ø–æ—Ä—è–¥–æ–∫:**

```python
# orchestrator.py:942
await self.websocket_coordinator.initialize_websocket()  # WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω

# orchestrator.py:953
await self._initialize_candle_buffers()  # –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

# orchestrator.py:974
await self._verify_readiness()  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ü–û–°–õ–ï WebSocket
```

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–æ—Ä—è–¥–æ–∫:**

```python
# orchestrator.py:953
await self._initialize_candle_buffers()  # –°–≤–µ—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

# orchestrator.py:974
await self._verify_readiness()  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ü–ï–†–ï–î WebSocket ‚úÖ

# orchestrator.py:942
await self.websocket_coordinator.initialize_websocket()  # WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –ü–û–°–õ–ï –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚úÖ
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

1. ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –î–û –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è WebSocket
2. ‚úÖ WebSocket –Ω–µ –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π
3. ‚úÖ –ù–µ—Ç race condition

---

### 5.6. –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ç–æ—Ä–≥–æ–≤–ª–∏ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Ç —è–≤–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π.

**–†–µ—à–µ–Ω–∏–µ:**

```python
# orchestrator.py:__init__()
self._trading_enabled = False  # –§–ª–∞–≥ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏

# orchestrator.py:start()
# –ü–æ—Å–ª–µ –≤—Å–µ—Ö –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–π –∏ –ø—Ä–æ–≤–µ—Ä–æ–∫
await self._verify_readiness()

# –†–∞–∑—Ä–µ—à–∏—Ç—å —Ç–æ—Ä–≥–æ–≤–ª—é
self._trading_enabled = True  # –¢–æ—Ä–≥–æ–≤–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∞

# signal_coordinator.py:check_for_signals()
async def check_for_signals(self, symbol: str, price: float):
    # ‚úÖ –ù–û–í–û–ï: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–ª–∏
    if hasattr(self.orchestrator, "_trading_enabled") and not self.orchestrator._trading_enabled:
        logger.debug(f"‚ö†Ô∏è –¢–æ—Ä–≥–æ–≤–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É —Å–∏–≥–Ω–∞–ª–æ–≤ –¥–ª—è {symbol}")
        return
    
    # –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å–∏–≥–Ω–∞–ª–æ–≤
    # ...
```

---

## 6. –í–´–í–û–î

### 6.1. –ï—Å—Ç—å –ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–µ–∫—É—â–µ–º –ø–æ—Ä—è–¥–∫–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏?

**–î–ê** ‚ö†Ô∏è ‚Äî –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º:

1. **Race Condition #1:** WebSocket –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –î–û –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π
   - WebSocket –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –≤—ã–∑—ã–≤–∞—Ç—å `check_for_signals()` –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è `_initialize_candle_buffers()`
   - –ó–∞—â–∏—Ç–∞ –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–ª—è `SignalGenerator.is_initialized`, –Ω–æ –Ω–µ—Ç –¥–ª—è —Å–≤–µ—á–µ–π

2. **Race Condition #2:** Pivot Points –∏ Volume Profile —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ —Ç–∏–∫–µ—Ä–∞
   - –†–∞—Å—á–µ—Ç—ã –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ `generate_signals()`, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –±—ã—Ç—å –î–û –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å–≤–µ—á–µ–π

3. **Race Condition #3:** ATRProvider –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None –∏–ª–∏ fallback
   - –ï—Å–ª–∏ —Å–≤–µ—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, ATR –º–æ–∂–µ—Ç –±—ã—Ç—å None –∏–ª–∏ fallback –∑–Ω–∞—á–µ–Ω–∏–µ–º (5.0)

4. **Race Condition #4:** ParameterProvider –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ None –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ RegimeManager, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–∏–∑–æ–π—Ç–∏ –ü–û–°–õ–ï –ø–µ—Ä–≤–æ–≥–æ –≤—ã–∑–æ–≤–∞ `check_for_signals()`

---

### 6.2. –ú–æ–∂–µ—Ç –ª–∏ —ç—Ç–æ –±—ã—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π –ø—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–æ—Ä–≥–æ–≤–ª–∏, –±—ã—Å—Ç—Ä—ã—Ö —É–±—ã—Ç–∫–æ–≤, ATR=None?

**–î–ê** ‚ö†Ô∏è ‚Äî —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π:

1. **–ü—Ä–µ–∂–¥–µ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–ª—è:**
   - `check_for_signals()` –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–∑–≤–∞–Ω –î–û –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤–µ—á–µ–π
   - –°–∏–≥–Ω–∞–ª—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–µ–ø–æ–ª–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –ü–æ–∑–∏—Ü–∏–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –±–µ–∑ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ —Ä–µ–∂–∏–º–æ–≤

2. **–ë—ã—Å—Ç—Ä—ã–µ —É–±—ã—Ç–∫–∏:**
   - SL/TP —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ fallback ATR (5.0) –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è
   - –†–µ–∂–∏–º –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∏–ª–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–∂–∏–º–æ–≤ –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã

3. **ATR=None:**
   - –ï—Å–ª–∏ —Å–≤–µ—á–∏ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, ATRProvider –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å None
   - Fallback –∑–Ω–∞—á–µ–Ω–∏–µ (5.0) –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ ATR
   - SL/TP —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 6.3. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ):**

1. ‚úÖ **–ò–∑–º–µ–Ω–∏—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:** –ó–∞–≥—Ä—É–∂–∞—Ç—å —Å–≤–µ—á–∏ –ü–ï–†–ï–î –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º WebSocket
2. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Å–≤–µ—á–µ–π:** –í `handle_ticker_data()` –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º `check_for_signals()`
3. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ check_for_signals():** –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –º–∏–Ω–∏–º—É–º 50 —Å–≤–µ—á–µ–π –ø–µ—Ä–µ–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Å–∏–≥–Ω–∞–ª–æ–≤

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ):**

4. ‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å asyncio.Event():** –î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
5. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É —Ç–æ—Ä–≥–æ–≤–ª–∏:** –§–ª–∞–≥ `_trading_enabled` –¥–ª—è —è–≤–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ):**

6. ‚úÖ **–£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ —Ç–∏–∫–µ—Ä—ã –∏–∑-–∑–∞ –Ω–µ–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π
7. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏:** –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤ –∏–∑-–∑–∞ –Ω–µ–≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

---

### 6.4. –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚ö†Ô∏è **7/10** ‚Äî –ï—Å—Ç—å –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö race conditions, –Ω–æ –Ω–µ –æ—Ç –≤—Å–µ—Ö.

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** ‚úÖ **10/10** ‚Äî –í—Å–µ race conditions —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã, —Ç–æ—Ä–≥–æ–≤–ª—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π.

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é:** ‚úÖ **–î–ê** ‚Äî –í—Å–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑—É–µ–º—ã –∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç –±–æ–ª—å—à–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ.

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 28.12.2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–µ—Ä—à–µ–Ω

