# üìä –ü–û–õ–ù–´–ô –ê–ù–ê–õ–ò–ó –ò –ü–õ–ê–ù –£–õ–£–ß–®–ï–ù–ò–ô –ë–û–¢–ê

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-11-14  
**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø—Ä–æ–±–ª–µ–º Trailing Stop Loss –∏ —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π

---

## üîç –ß–ê–°–¢–¨ 1: –ê–ù–ê–õ–ò–ó –ó–ê–•–ê–†–î–ö–û–ñ–ï–ù–ù–´–• –ü–ê–†–ê–ú–ï–¢–†–û–í

### ‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ó–ê–•–ê–†–î–ö–û–ñ–ï–ù–ù–´–ï –ü–ê–†–ê–ú–ï–¢–†–´

#### 1. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–º–∏—Å—Å–∏–∏ (–ù–ï –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py:582`

```python
commission_rate = 0.0009  # 0.09% –Ω–∞ –∫—Ä—É–≥ (0.045% –≤—Ö–æ–¥ + 0.045% –≤—ã—Ö–æ–¥)
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ö–æ–º–∏—Å—Å–∏—è –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–∞ –≤ `position_manager.py`
- ‚úÖ –í –∫–æ–Ω—Ñ–∏–≥–µ –µ—Å—Ç—å `trailing_sl.trading_fee_rate: 0.0009`, –Ω–æ –æ–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è TrailingStopLoss
- ‚ùå –í `position_manager.py` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–≤–æ—è –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω–∞—è –∫–æ–º–∏—Å—Å–∏—è

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–∏—Å—Å–∏—é —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ TP/TSL –≤ `position_manager`
- –ï—Å–ª–∏ –∫–æ–º–∏—Å—Å–∏—è –Ω–∞ –±–∏—Ä–∂–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è, –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å –∫–æ–¥ –≤—Ä—É—á–Ω—É—é

---

#### 2. –ó–∞–ø–∞—Å –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ TP (buffer_pct)

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py:719`

```python
buffer_pct = 0.1  # –ó–∞–ø–∞—Å 0.1% (–¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ó–∞–ø–∞—Å 0.1% –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω
- ‚ùå –ù–µ—Ç –≤ –∫–æ–Ω—Ñ–∏–≥–µ
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ TP (min_tp_percent = min_profit_to_close_pct + commission_pct + buffer_pct)

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ–ª—å–∑—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∑–∞–ø–∞—Å —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
- –î–ª—è —Ä–∞–∑–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –º–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–π –∑–∞–ø–∞—Å

---

#### 3. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ä–∂–∏ (–ù–ï –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞)

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py:97-98`

```python
maintenance_margin_ratio=0.01,  # 1%
initial_margin_ratio=0.1,  # 10%
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ä–∂–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã
- ‚ùå –ù–µ—Ç –≤ –∫–æ–Ω—Ñ–∏–≥–µ
- ‚ùå –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ MarginCalculator

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ–ª—å–∑—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ä–∂–∏ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
- –î–ª—è —Ä–∞–∑–Ω—ã—Ö –±–∏—Ä–∂ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–∞–∑–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –º–∞—Ä–∂–µ

---

#### 4. Fallback –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–∏—Å–∫–∞

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py:67-69`

```python
self.max_loss_per_trade = 0.02  # Fallback: 2% –º–∞–∫—Å –ø–æ—Ç–µ—Ä—è –Ω–∞ —Å–¥–µ–ª–∫—É
self.max_margin_percent = 0.80  # Fallback: 80% –º–∞–∫—Å –º–∞—Ä–∂–∞
self.max_drawdown_percent = 0.05  # Fallback: 5% –º–∞–∫—Å –ø—Ä–æ—Å–∞–¥–∫–∞
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback, –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
- ‚úÖ –ù–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ –µ—Å—Ç—å —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `risk.base`
- ‚úÖ –ö–æ–¥ –ø–æ–ª—É—á–∞–µ—Ç –∏—Ö –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ —á–µ—Ä–µ–∑ `_get_adaptive_risk_params`

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–ï –ö–†–ò–¢–ò–ß–ù–û** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback

---

#### 5. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã Trailing Stop Loss (fallback)

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py:738-752`

```python
params: Dict[str, Any] = {
    "trading_fee_rate": 0.0009,  # 0.09% (–∫–∞–∫ –≤ –∫–æ–Ω—Ñ–∏–≥–µ)
    "initial_trail": 0.005,  # 0.5%
    "max_trail": 0.01,  # 1%
    "min_trail": 0.003,  # 0.3%
    ...
}
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ö†Ô∏è Fallback –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
- ‚úÖ –ù–æ –≤ –∫–æ–Ω—Ñ–∏–≥–µ –µ—Å—Ç—å –≤—Å–µ —ç—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ `trailing_sl`
- ‚úÖ –ö–æ–¥ –ø–æ–ª—É—á–∞–µ—Ç –∏—Ö –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–ï –ö–†–ò–¢–ò–ß–ù–û** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback

---

#### 6. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã SlippageGuard (fallback)

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py:110-112`

```python
max_slippage_percent=slippage_config.get("max_slippage_percent", 0.1),  # 0.1% (fallback)
max_spread_percent=slippage_config.get("max_spread_percent", 0.05),  # 0.05% (fallback)
order_timeout=slippage_config.get("order_timeout", 30.0),  # 30 —Å–µ–∫ (fallback)
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ö†Ô∏è Fallback –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω
- ‚úÖ –í –∫–æ–Ω—Ñ–∏–≥–µ –µ—Å—Ç—å `slippage_guard.max_slippage_percent`, `max_spread_percent`, `order_timeout`
- ‚úÖ –ö–æ–¥ –ø–æ–ª—É—á–∞–µ—Ç –∏—Ö –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ù–ï –ö–†–ò–¢–ò–ß–ù–û** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–∞–∫ fallback

---

#### 7. –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–≤–µ—Ä–æ–∫ (–∑–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py:263-274`

```python
if margin_ratio <= 1.5 and abs(pnl) < 10:
    # –ó–∞—â–∏—Ç–∞ –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
    ...
if margin_ratio <= 0.5 and equity > 0:
    # –ó–∞—â–∏—Ç–∞ 2
    ...
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ü–æ—Ä–æ–≥–∏ `1.5`, `10`, `0.5` –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω—ã
- ‚ùå –ù–µ—Ç –≤ –∫–æ–Ω—Ñ–∏–≥–µ

**–í–ª–∏—è–Ω–∏–µ:**
- –ù–µ–ª—å–∑—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ—Ä–æ–≥–∏ –∑–∞—â–∏—Ç—ã —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
- –î–ª—è —Ä–∞–∑–Ω—ã—Ö –±–∞–ª–∞–Ω—Å–æ–≤ –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —Ä–∞–∑–Ω—ã–µ –ø–æ—Ä–æ–≥–∏

---

### ‚úÖ –ü–ê–†–ê–ú–ï–¢–†–´ –ò–ó –ö–û–ù–§–ò–ì–ê (–†–ê–ë–û–¢–ê–Æ–¢ –ü–†–ê–í–ò–õ–¨–ù–û)

1. ‚úÖ **Balance Profiles** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
2. ‚úÖ **Symbol Profiles** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
3. ‚úÖ **Regime Profiles** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
4. ‚úÖ **Trailing Stop Loss** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (–∫—Ä–æ–º–µ fallback)
5. ‚úÖ **Risk Parameters** - –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ (–∫—Ä–æ–º–µ fallback)
6. ‚úÖ **Position Size Calculation** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

---

## üîç –ß–ê–°–¢–¨ 2: –ê–ù–ê–õ–ò–ó –ü–†–û–ë–õ–ï–ú–´ TRAILING STOP LOSS

### ‚ùå –ü–†–û–ë–õ–ï–ú–ê: –ë–æ—Ç –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å –º–µ–Ω—å—à–µ–π –ø—Ä–∏–±—ã–ª—å—é –ø–æ—Å–ª–µ —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞

**–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–±–ª—é–¥–∞–µ—Ç: –±–æ—Ç –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–µ–π–ª–∏–Ω–≥ —Å—Ç–æ–ø, –ø—Ä–∏–±—ã–ª—å –¥–æ—Ö–æ–¥–∏—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ
- –ü–æ—Ç–æ–º –∏–¥–µ—Ç —Ä–∞–∑–≤–æ—Ä–æ—Ç/–æ—Ç—Å–∫–æ–∫, –ø—Ä–∏–±—ã–ª—å —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è
- –ë–æ—Ç –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é —Å –Ω–∞–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ–π –ø—Ä–∏–±—ã–ª—å—é –ø–æ –∏—Ç–æ–≥—É

**–ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è:**
1. –ü–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ –≤ LONG –ø—Ä–∏ —Ü–µ–Ω–µ $100,000
2. –¶–µ–Ω–∞ —Ä–∞—Å—Ç–µ—Ç –¥–æ $102,000 (+2% –ø—Ä–∏–±—ã–ª–∏)
3. Trailing Stop –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω, —Å—Ç–æ–ø –ø–æ–¥—Ç—è–≥–∏–≤–∞–µ—Ç—Å—è –∫ $101,500
4. –¶–µ–Ω–∞ –¥–µ–ª–∞–µ—Ç –æ—Ç—Å–∫–æ–∫ –¥–æ $101,800 (-0.2% –æ—Ç –º–∞–∫—Å–∏–º—É–º–∞)
5. –¶–µ–Ω–∞ –ø–∞–¥–∞–µ—Ç –¥–æ $101,450 –∏ –±–æ—Ç –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ø–æ Trailing Stop
6. –ò—Ç–æ–≥–æ–≤–∞—è –ø—Ä–∏–±—ã–ª—å: ~+1.45% –≤–º–µ—Å—Ç–æ –≤–æ–∑–º–æ–∂–Ω—ã—Ö +2%

---

### üîç –ê–ù–ê–õ–ò–ó –õ–û–ì–ò–ö–ò TRAILING STOP LOSS

#### 1. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Trailing Stop Loss

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py`

**–õ–æ–≥–∏–∫–∞:**
- **–î–ª—è LONG:** –°—Ç–æ–ø —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –Ω–∏–∂–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã: `stop = highest_price * (1 - trail%)`
- **–î–ª—è SHORT:** –°—Ç–æ–ø —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤—ã—à–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–Ω—ã: `stop = lowest_price * (1 + trail%)`
- –ü—Ä–∏ —Ä–æ—Å—Ç–µ –ø—Ä–∏–±—ã–ª–∏ —Ç—Ä–µ–π–ª —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è: `current_trail = initial_trail + profit_pct_total * 2`
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–µ–π–ª –æ–≥—Ä–∞–Ω–∏—á–µ–Ω: `max_trail = 0.01` (1%)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –¢—Ä–µ–π–ª —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –º–µ–¥–ª–µ–Ω–Ω–æ (—É–º–Ω–æ–∂–µ–Ω–∏–µ –Ω–∞ 2)
- ‚ùå –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–µ–π–ª —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π (1% –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞)
- ‚ùå –ù–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ —Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- ‚ùå –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –º–µ–ª–∫–∏—Ö –æ—Ç—Å–∫–æ–∫–æ–≤ –≤ —Ç—Ä–µ–Ω–¥–µ

---

#### 2. –õ–æ–≥–∏–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏

**–ú–µ—Ç–æ–¥:** `should_close_position()` –≤ `trailing_stop_loss.py:345`

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
```python
# –ë–∞–∑–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ø-–ª–æ—Å—Å–∞
if self.side == "long":
    price_hit_sl = current_price <= stop_loss
else:  # short
    price_hit_sl = current_price >= stop_loss

if not price_hit_sl:
    return False  # –ù–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º

# ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏–π –≤ —Ç—Ä–µ–Ω–¥–µ
if profit_pct > 0:
    regime_multiplier = getattr(self, "regime_multiplier", None) or 1.0
    trend_strength_boost = getattr(self, "trend_strength_boost", None) or 1.0
    
    # –ï—Å–ª–∏ —Ç—Ä–µ–Ω–¥ - –¥–∞–µ–º –±–æ–ª—å—à–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ—Ç–∫–∞—Ç–∞
    if regime_multiplier > 1.0:
        adjusted_trail = min(self.current_trail * regime_multiplier, self.max_trail)
        # –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–æ–ø —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º —Ç—Ä–µ–π–ª–æ–º
        ...
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ö†Ô∏è –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ `regime_multiplier > 1.0`
- ‚ùå –ù–æ –µ—Å–ª–∏ —Ä–µ–∂–∏–º "ranging" –∏–ª–∏ "choppy", `regime_multiplier = 1.0` (–Ω–µ—Ç –±—É—Ñ–µ—Ä–∞)
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
- ‚ùå –ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –æ—Ç—Å–∫–æ–∫–æ–≤ (–º–µ–Ω–µ–µ 1 –º–∏–Ω—É—Ç—ã)

---

#### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- ‚úÖ –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç FastADX –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–∏–ª—ã —Ç—Ä–µ–Ω–¥–∞
- ‚úÖ –ü–µ—Ä–µ–¥–∞–µ—Ç `trend_strength` –∏ `market_regime` –≤ `should_close_position()`
- ‚úÖ –ï—Å—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç—Ä–µ–Ω–¥–∞ –∏ —Ä–µ–∂–∏–º–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- ‚ùå –ù–æ –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è `regime_multiplier > 1.0` (—Ç–æ–ª—å–∫–æ trending)
- ‚ùå –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥—Ä—É–≥–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (RSI, MACD) –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞
- ‚ùå –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∏–ª—ã –æ—Ç—Å–∫–æ–∫–∞ (–Ω–∞—Å–∫–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä–æ —Ü–µ–Ω–∞ –≤–µ—Ä–Ω—É–ª–∞—Å—å)

---

### üí° –ü–†–ò–ß–ò–ù–´ –ü–†–û–ë–õ–ï–ú–´

1. **–¢—Ä–µ–π–ª —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∏–π:**
   - `max_trail = 0.01` (1%) –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –æ—Ç—Å–∫–æ–∫–æ–≤
   - –í —Å–∫–∞–ª—å–ø–∏–Ω–≥–µ –æ—Ç—Å–∫–æ–∫–∏ 0.5-1% - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ

2. **–ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –æ—Ç—Å–∫–æ–∫–æ–≤:**
   - –ë–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –∫–∞–∂–¥–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ —Ü–µ–Ω—ã
   - –ù–µ—Ç –∑–∞–¥–µ—Ä–∂–∫–∏/—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –º–µ–ª–∫–∏—Ö –∫–æ–ª–µ–±–∞–Ω–∏–π

3. **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è trending:**
   - –î–ª—è ranging/choppy –Ω–µ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –±—É—Ñ–µ—Ä–∞
   - –ù–æ –¥–∞–∂–µ –≤ ranging –º–æ–≥—É—Ç –±—ã—Ç—å –æ—Ç—Å–∫–æ–∫–∏ 0.5-1%

4. **–ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞:**
   - –ë–æ—Ç –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç RSI/MACD –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
   - –ù–µ –∑–Ω–∞–µ—Ç, —ç—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ –æ—Ç—Å–∫–æ–∫

5. **–ù–µ—Ç –ø—Ä–æ–¥–ª–µ–Ω–∏—è TP –≤ —Ç—Ä–µ–Ω–¥–µ:**
   - –ë–æ—Ç –Ω–µ –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç TP –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ
   - –ó–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ Trailing Stop –≤–º–µ—Å—Ç–æ –ø—Ä–æ–¥–ª–µ–Ω–∏—è

---

## üîç –ß–ê–°–¢–¨ 3: –ü–õ–ê–ù –£–õ–£–ß–®–ï–ù–ò–ô

### üéØ –ü–†–ò–û–†–ò–¢–ï–¢ 1: –ö–†–ò–¢–ò–ß–ù–û (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ)

#### 1.1. –í—ã–Ω–µ—Å—Ç–∏ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ –∫–æ–Ω—Ñ–∏–≥

**–§–∞–π–ª:** `config/config_futures.yaml`

**–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥:**
```yaml
# Commission & Fees
commission:
  trading_fee_rate: 0.0009  # 0.09% –Ω–∞ –∫—Ä—É–≥ (0.045% –≤—Ö–æ–¥ + 0.045% –≤—ã—Ö–æ–¥)
  tp_buffer_percent: 0.1  # –ó–∞–ø–∞—Å 0.1% –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ TP

# Margin Settings
margin:
  maintenance_margin_ratio: 0.01  # 1% maintenance margin
  initial_margin_ratio: 0.1  # 10% initial margin

# Position Manager Settings
position_manager:
  false_trigger_protection:
    margin_ratio_threshold: 1.5  # –ü–æ—Ä–æ–≥ –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π
    pnl_threshold: 10.0  # –ü–æ—Ä–æ–≥ PnL –¥–ª—è –∑–∞—â–∏—Ç—ã (USDT)
    margin_ratio_minimum: 0.5  # –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π margin_ratio –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
```

**–ò–∑–º–µ–Ω–∏—Ç—å –≤ –∫–æ–¥–µ:**
- `position_manager.py:582` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `commission.trading_fee_rate` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- `position_manager.py:719` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `commission.tp_buffer_percent` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- `orchestrator.py:97-98` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `margin.maintenance_margin_ratio` –∏ `initial_margin_ratio` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
- `position_manager.py:263-274` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `position_manager.false_trigger_protection.*` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥
- ‚úÖ –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –º–µ–Ω—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞

---

#### 1.2. –£–ª—É—á—à–∏—Ç—å –ª–æ–≥–∏–∫—É Trailing Stop Loss

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **–£–≤–µ–ª–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ç—Ä–µ–π–ª:**
   - –¢–µ–∫—É—â–∏–π: `max_trail = 0.01` (1%)
   - –ü—Ä–µ–¥–ª–∞–≥–∞–µ–º—ã–π: `max_trail = 0.02` (2%) –¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞
   - –î–ª—è —Ç—Ä–µ–Ω–¥–∞: `max_trail = 0.03` (3%)

2. **–î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –æ—Ç—Å–∫–æ–∫–æ–≤:**
   - –ù–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é, –µ—Å–ª–∏ –æ—Ç—Å–∫–æ–∫ –¥–ª–∏—Ç—Å—è –º–µ–Ω–µ–µ 30 —Å–µ–∫—É–Ω–¥
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä–æ —Ü–µ–Ω–∞ –≤–µ—Ä–Ω—É–ª–∞—Å—å –∫ —Å—Ç–æ–ø—É

3. **–†–∞—Å—à–∏—Ä–∏—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é –ª–æ–≥–∏–∫—É:**
   - –ü—Ä–∏–º–µ–Ω—è—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –±—É—Ñ–µ—Ä –Ω–µ —Ç–æ–ª—å–∫–æ –¥–ª—è trending, –Ω–æ –∏ –¥–ª—è ranging (–º–µ–Ω—å—à–∏–π –±—É—Ñ–µ—Ä)
   - –î–ª—è choppy - –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±—É—Ñ–µ—Ä

4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞:**
   - –ü–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø—Ä–æ–≤–µ—Ä—è—Ç—å RSI (–Ω–µ –ø–µ—Ä–µ–∫—É–ø–ª–µ–Ω/–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω)
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å MACD (–Ω–µ—Ç –ª–∏ –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏–∏)
   - –ï—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ - –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å

**–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥:**
```yaml
trailing_sl:
  max_trail: 0.02  # –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 0.01 –¥–æ 0.02 (2%)
  short_reversal_protection:
    enabled: true
    min_reversal_duration_seconds: 30  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç—Å–∫–æ–∫–∞ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è
    max_reversal_percent: 0.5  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –æ—Ç—Å–∫–æ–∫ –¥–ª—è –∑–∞—â–∏—Ç—ã (0.5%)
  use_indicators_for_reversal:
    enabled: true
    rsi_threshold: 30  # –î–ª—è LONG: –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –µ—Å–ª–∏ RSI < 30 (–ø–µ—Ä–µ–ø—Ä–æ–¥–∞–Ω–Ω–æ—Å—Ç—å = —Ä–∞–∑–≤–æ—Ä–æ—Ç –≤–≤–µ—Ä—Ö)
    macd_divergence_check: true  # –ü—Ä–æ–≤–µ—Ä—è—Ç—å –¥–∏–≤–µ—Ä–≥–µ–Ω—Ü–∏—é MACD
  by_regime:
    trending:
      max_trail: 0.03  # 3% –¥–ª—è —Ç—Ä–µ–Ω–¥–∞
      regime_multiplier: 2.0  # –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 1.5 –¥–æ 2.0
    ranging:
      max_trail: 0.02  # 2% –¥–ª—è –±–æ–∫–æ–≤–∏–∫–∞
      regime_multiplier: 1.2  # –ù–µ–±–æ–ª—å—à–æ–π –±—É—Ñ–µ—Ä –¥–∞–∂–µ –¥–ª—è ranging
    choppy:
      max_trail: 0.015  # 1.5% –¥–ª—è —Ö–∞–æ—Å–∞
      regime_multiplier: 0.9  # –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–æ
```

---

#### 1.3. –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥–ª–µ–Ω–∏–µ TP –≤ —Ç—Ä–µ–Ω–¥–µ

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **–ü—Ä–æ–¥–ª–µ–≤–∞—Ç—å TP –≤–º–µ—Å—Ç–æ –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ Trailing Stop:**
   - –ï—Å–ª–∏ `market_regime == "trending"` –∏ `profit_pct > min_profit_to_close`
   - –ò `trend_strength > 0.7` (—Å–∏–ª—å–Ω—ã–π —Ç—Ä–µ–Ω–¥)
   - –ò –ø–æ–∑–∏—Ü–∏—è –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∞ Trailing Stop
   - –¢–æ–≥–¥–∞ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å TP: `tp_percent = current_tp + 0.5%` (–¥–æ –º–∞–∫—Å–∏–º—É–º–∞ 5%)

2. **–ù–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –ø–æ Trailing Stop –≤ —Å–∏–ª—å–Ω–æ–º —Ç—Ä–µ–Ω–¥–µ:**
   - –ï—Å–ª–∏ `trend_strength > 0.8` –∏ `profit_pct > 1.0%`
   - –ò –ø–æ–∑–∏—Ü–∏—è –¥–æ—Å—Ç–∏–≥–ª–∞ Trailing Stop
   - –ù–æ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞
   - –¢–æ–≥–¥–∞ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å TP –≤–º–µ—Å—Ç–æ –∑–∞–∫—Ä—ã—Ç–∏—è

**–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥:**
```yaml
position_manager:
  tp_extension:
    enabled: true
    min_trend_strength: 0.7  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–ª–∞ —Ç—Ä–µ–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–¥–ª–µ–Ω–∏—è
    extension_step: 0.5  # –®–∞–≥ –ø—Ä–æ–¥–ª–µ–Ω–∏—è TP (0.5%)
    max_tp_percent: 5.0  # –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π TP (5%)
    use_indicators: true  # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç—Ä–µ–Ω–¥–∞
```

---

### üéØ –ü–†–ò–û–†–ò–¢–ï–¢ 2: –í–ê–ñ–ù–û (–£–ª—É—á—à–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)

#### 2.1. –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **–ü–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º –ø–æ Trailing Stop –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
   - –ü–æ–ª—É—á–∞—Ç—å RSI, MACD, Bollinger Bands –¥–ª—è —Å–∏–º–≤–æ–ª–∞
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å, –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Ä–∞–∑–≤–æ—Ä–æ—Ç
   - –ï—Å–ª–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ç—Ä–µ–Ω–¥–∞ - –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—Ç—å

2. **–î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞:**
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –±—ã—Å—Ç—Ä–æ —Ü–µ–Ω–∞ –≤–µ—Ä–Ω—É–ª–∞—Å—å –∫ —Å—Ç–æ–ø—É
   - –ï—Å–ª–∏ –æ—Ç—Å–∫–æ–∫ –±—ã–ª —Å–ª–∏—à–∫–æ–º –±—ã—Å—Ç—Ä—ã–º (< 1 –º–∏–Ω—É—Ç–∞) - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª

**–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥:**
```yaml
position_manager:
  reversal_detection:
    enabled: true
    min_reversal_duration_seconds: 60  # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –æ—Ç—Å–∫–æ–∫–∞
    rsi_check: true
    macd_check: true
    bollinger_check: true
```

---

#### 2.2. –£–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Ç—Ä–µ–π–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–±—ã–ª–∏

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py`

**–¢–µ–∫—É—â–∞—è –ª–æ–≥–∏–∫–∞:**
```python
self.current_trail = min(
    self.initial_trail + max(profit_pct_total, 0.0) * 2, self.max_trail
)
```

**–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º–∞—è –ª–æ–≥–∏–∫–∞:**
- –î–ª—è –º–∞–ª–æ–π –ø—Ä–∏–±—ã–ª–∏ (< 0.5%): –º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ç—Ä–µ–π–ª–∞
- –î–ª—è —Å—Ä–µ–¥–Ω–µ–π –ø—Ä–∏–±—ã–ª–∏ (0.5-1.5%): —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ
- –î–ª—è –±–æ–ª—å—à–æ–π –ø—Ä–∏–±—ã–ª–∏ (> 1.5%): –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Ç—Ä–µ–π–ª–∞

**–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–Ω—Ñ–∏–≥:**
```yaml
trailing_sl:
  trail_growth:
    low_profit_multiplier: 1.5  # –î–ª—è –ø—Ä–∏–±—ã–ª–∏ < 0.5%
    medium_profit_multiplier: 2.0  # –î–ª—è –ø—Ä–∏–±—ã–ª–∏ 0.5-1.5%
    high_profit_multiplier: 3.0  # –î–ª—è –ø—Ä–∏–±—ã–ª–∏ > 1.5%
```

---

### üéØ –ü–†–ò–û–†–ò–¢–ï–¢ 3: –£–õ–£–ß–®–ï–ù–ò–Ø (–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ)

#### 3.1. –î–æ–±–∞–≤–∏—Ç—å –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö/—É–±—ã—Ç–æ—á–Ω—ã—Ö —Å–¥–µ–ª–æ–∫
- –ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å, –∫–æ–≥–¥–∞ —Ü–µ–Ω–∞ –º–æ–∂–µ—Ç —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å—Å—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ Trailing Stop

**–°—Ä–æ–∫:** 1-2 –º–µ—Å—è—Ü–∞

---

#### 3.2. –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –æ–±—ä–µ–º —Ç–æ—Ä–≥–æ–≤–ª–∏ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
- –ï—Å–ª–∏ –æ–±—ä–µ–º –Ω–∏–∑–∫–∏–π - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª–æ–∂–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç
- –ï—Å–ª–∏ –æ–±—ä–µ–º –≤—ã—Å–æ–∫–∏–π - —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–≤–æ—Ä–æ—Ç

**–°—Ä–æ–∫:** 2-3 –Ω–µ–¥–µ–ª–∏

---

#### 3.3. –î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Win Rate –ø–æ —Ä–µ–∂–∏–º–∞–º

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –û—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å Win Rate –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞ (trending/ranging/choppy)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ï—Å–ª–∏ Win Rate –¥–ª—è —Ä–µ–∂–∏–º–∞ –Ω–∏–∑–∫–∏–π - —É–∂–µ—Å—Ç–æ—á–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

**–°—Ä–æ–∫:** 2-3 –Ω–µ–¥–µ–ª–∏

---

## üìã –ò–¢–û–ì–û–í–´–ô –°–ü–ò–°–û–ö –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –ö—Ä–∏—Ç–∏—á–Ω—ã–µ (—Å–¥–µ–ª–∞—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ):

1. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ `commission_rate` –≤ –∫–æ–Ω—Ñ–∏–≥
2. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ `buffer_pct` –≤ –∫–æ–Ω—Ñ–∏–≥
3. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–∞—Ä–∂–∏ –≤ –∫–æ–Ω—Ñ–∏–≥
4. ‚úÖ –í—ã–Ω–µ—Å—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞—â–∏—Ç—ã –æ—Ç –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π –≤ –∫–æ–Ω—Ñ–∏–≥
5. ‚úÖ –£–≤–µ–ª–∏—á–∏—Ç—å `max_trail` —Å 1% –¥–æ 2% (–¥–ª—è —Å–∫–∞–ª—å–ø–∏–Ω–≥–∞)
6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç –∫—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã—Ö –æ—Ç—Å–∫–æ–∫–æ–≤
7. ‚úÖ –†–∞—Å—à–∏—Ä–∏—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—É—é –ª–æ–≥–∏–∫—É –¥–ª—è ranging —Ä–µ–∂–∏–º–∞
8. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–¥–ª–µ–Ω–∏–µ TP –≤ —Ç—Ä–µ–Ω–¥–µ

### –í–∞–∂–Ω—ã–µ (—Å–¥–µ–ª–∞—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è):

1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
2. ‚úÖ –£–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Ç—Ä–µ–π–ª–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–∏–±—ã–ª–∏
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞

### –£–ª—É—á—à–µ–Ω–∏—è (–¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ):

1. ‚úÖ –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–æ–≤
2. ‚úÖ –ê–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞ –ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã—Ç–∏–µ–º
3. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Win Rate –ø–æ —Ä–µ–∂–∏–º–∞–º

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º:

1. **–£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ PnL:**
   - –¢–µ–∫—É—â–∏–π —Å—Ä–µ–¥–Ω–∏–π PnL: ~+0.1-0.3 USDT –∑–∞ —Å–¥–µ–ª–∫—É
   - –û–∂–∏–¥–∞–µ–º—ã–π: ~+0.3-0.5 USDT –∑–∞ —Å–¥–µ–ª–∫—É (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –Ω–∞ 50-100%)

2. **–£–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–∫—Ä—ã—Ç–∏–π —Å –º–µ–Ω—å—à–µ–π –ø—Ä–∏–±—ã–ª—å—é:**
   - –¢–µ–∫—É—â–∏–π: ~30-40% –ø–æ–∑–∏—Ü–∏–π –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —Å –º–µ–Ω—å—à–µ–π –ø—Ä–∏–±—ã–ª—å—é –ø–æ—Å–ª–µ –æ—Ç—Å–∫–æ–∫–∞
   - –û–∂–∏–¥–∞–µ–º—ã–π: ~10-15% (—É–º–µ–Ω—å—à–µ–Ω–∏–µ –Ω–∞ 50-70%)

3. **–£–ª—É—á—à–µ–Ω–∏–µ Win Rate:**
   - –¢–µ–∫—É—â–∏–π Win Rate: ~55-60%
   - –û–∂–∏–¥–∞–µ–º—ã–π: ~65-70% (—É–ª—É—á—à–µ–Ω–∏–µ –Ω–∞ 10-15%)

4. **–£–ª—É—á—à–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ —Ä–µ–∂–∏–º:**
   - –¢–µ–∫—É—â–∏–π: –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è trending
   - –û–∂–∏–¥–∞–µ–º—ã–π: –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö —Ä–µ–∂–∏–º–æ–≤

---

## üéØ –í–´–í–û–î–´

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ:

1. ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (Balance Profiles, Symbol Profiles, Regime Profiles)
2. ‚úÖ Trailing Stop Loss —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω—É–∂–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è
3. ‚úÖ –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–µ–∂–∏–º–∞ —Ä—ã–Ω–∫–∞ –µ—Å—Ç—å, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è trending

### ‚ùå –ß—Ç–æ –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:

1. ‚ùå –ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (–∫–æ–º–∏—Å—Å–∏—è, buffer, –º–∞—Ä–∂–∞, –∑–∞—â–∏—Ç–∞)
2. ‚ùå Trailing Stop –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (–º–∞–ª–µ–Ω—å–∫–∏–π max_trail, –Ω–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç –æ—Ç—Å–∫–æ–∫–æ–≤)
3. ‚ùå –ù–µ—Ç –ø—Ä–æ–¥–ª–µ–Ω–∏—è TP –≤ —Ç—Ä–µ–Ω–¥–µ (–∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ Trailing Stop –≤–º–µ—Å—Ç–æ –ø—Ä–æ–¥–ª–µ–Ω–∏—è)
4. ‚ùå –ù–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–∞–∑–≤–æ—Ä–æ—Ç–∞

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã (–∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —É–≤–µ–ª–∏—á–µ–Ω–∏–µ max_trail, –∑–∞—â–∏—Ç–∞ –æ—Ç –æ—Ç—Å–∫–æ–∫–æ–≤)
2. **–í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è:** –î–æ–±–∞–≤–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤, —É–ª—É—á—à–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Ç—Ä–µ–π–ª–∞
3. **–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ:** –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –∞–Ω–∞–ª–∏–∑ –æ–±—ä–µ–º–∞, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Win Rate

---

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-14  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–ê–≤—Ç–æ—Ä:** AI Assistant
