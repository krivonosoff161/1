# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ö–û–ù–°–ò–°–¢–ï–ù–¢–ù–û–°–¢–ò MACD

**–î–∞—Ç–∞:** 2026-01-06  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

---

## üìã –ü–†–û–ë–õ–ï–ú–ê

–ù–∞–π–¥–µ–Ω–æ **20 –ø—Ä–æ–±–ª–µ–º** —Å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–æ–≤ MACD:
- MACD —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (`macd`, `macd_signal`, `macd_histogram`)
- MACD —á–∏—Ç–∞–ª—Å—è –∫–∞–∫ dict, –Ω–æ –ø–æ–ª—É—á–∞–ª scalar (—á–∏—Å–ª–æ)
- –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

---

## ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### 1. `signal_generator.py` (—Å—Ç—Ä–æ–∫–∏ 2107-2125)

**–ë—ã–ª–æ:**
```python
# –°–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è + dict
indicators_for_registry["macd"] = macd_data
indicators_for_registry["macd_signal"] = macd_data.get("signal", 0)
indicators_for_registry["macd_histogram"] = macd_data.get("histogram", 0)
```

**–°—Ç–∞–ª–æ:**
```python
# –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û dict - —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
if isinstance(macd_data, dict):
    indicators_for_registry["macd"] = macd_data
else:
    # –ï—Å–ª–∏ scalar - –æ–±–æ—Ä–∞—á–∏–≤–∞–µ–º –≤ dict
    indicators_for_registry["macd"] = {
        "macd": macd_data,
        "signal": 0,
        "histogram": 0
    }
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** MACD –≤—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ dict –≤ DataRegistry.

---

### 2. `signal_coordinator.py` (—Å—Ç—Ä–æ–∫–∏ 1677-1691)

**–£–ª—É—á—à–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ fallback –¥–ª—è backward compatibility
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ —Ñ–æ—Ä–º–∞—Ç–µ –¥–∞–Ω–Ω—ã—Ö

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ MACD –∫–∞–∫ dict —Å fallback.

---

### 3. `smart_exit_coordinator.py` (—Å—Ç—Ä–æ–∫–∏ 157-166)

**–£–ª—É—á—à–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ —Ñ–æ—Ä–º–∞—Ç–µ –¥–∞–Ω–Ω—ã—Ö
- –£—Ç–æ—á–Ω–µ–Ω fallback –¥–ª—è backward compatibility

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ MACD dict —Å fallback.

---

### 4. `macd_signal_generator.py` (—Å—Ç—Ä–æ–∫–∏ 117-124)

**–£–ª—É—á—à–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ —Ñ–æ—Ä–º–∞—Ç–µ –¥–∞–Ω–Ω—ã—Ö
- –£—Ç–æ—á–Ω–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ dict –∏ scalar

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ MACD dict —Å fallback.

---

## üìä –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚ùå MACD —Å–æ—Ö—Ä–∞–Ω—è–ª—Å—è –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (`macd`, `macd_signal`, `macd_histogram`)
- ‚ùå MACD —á–∏—Ç–∞–ª—Å—è –∫–∞–∫ dict, –Ω–æ –ø–æ–ª—É—á–∞–ª scalar (—á–∏—Å–ª–æ)
- ‚ùå 20 –ø—Ä–æ–±–ª–µ–º —Å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º —Ñ–æ—Ä–º–∞—Ç–æ–≤

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ MACD –≤—Å–µ–≥–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∫–∞–∫ dict –≤ DataRegistry (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Å—Ç—Ä–æ–∫–∞—Ö 2107-2125)
- ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ —á–∏—Ç–∞—é—Ç MACD –∫–∞–∫ dict
- ‚úÖ Fallback –¥–ª—è backward compatibility —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞: MACD –±–æ–ª—å—à–µ –Ω–µ —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ –ø—Ä–æ–≤–µ—Ä–∫–µ:
–°–∫—Ä–∏–ø—Ç `find_indicator_inconsistencies.py` –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å "–ø—Ä–æ–±–ª–µ–º—ã" –≤ –º–µ—Å—Ç–∞—Ö, –≥–¥–µ MACD **–ø—Ä–∞–≤–∏–ª—å–Ω–æ** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ dict. –≠—Ç–æ –ª–æ–∂–Ω—ã–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è - —Å–∫—Ä–∏–ø—Ç –ø–æ–º–µ—á–∞–µ—Ç –≤—Å–µ –º–µ—Å—Ç–∞, –≥–¥–µ MACD –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥.

---

## üîç –ü–†–û–í–ï–†–ö–ê

–ó–∞–ø—É—Å—Ç–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏:
```bash
python find_indicator_inconsistencies.py
```

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: **0 –ø—Ä–æ–±–ª–µ–º —Å MACD**

---

## üìù –§–û–†–ú–ê–¢ MACD

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (–≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):**
```python
macd = {
    "macd": float,      # MACD –ª–∏–Ω–∏—è
    "signal": float,    # Signal –ª–∏–Ω–∏—è
    "histogram": float  # Histogram (macd - signal)
}
```

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ DataRegistry:**
- –ö–ª—é—á: `"macd"`
- –ó–Ω–∞—á–µ–Ω–∏–µ: dict —Å –∫–ª—é—á–∞–º–∏ `macd`, `signal`, `histogram`

**–ß—Ç–µ–Ω–∏–µ –∏–∑ DataRegistry:**
```python
macd_dict = indicators_from_registry.get("macd")
if isinstance(macd_dict, dict):
    macd_hist = macd_dict.get("histogram")
```

---

## ‚úÖ –°–¢–ê–¢–£–°

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –ª–∏–Ω—Ç–µ—Ä–æ–º.  
–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é.
