# üìã –°–ü–ò–°–û–ö –ü–†–ê–í–û–ö –ü–û –ê–ù–ê–õ–ò–ó–£

**–î–∞—Ç–∞:** 22.11.2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ  
**–ò—Å—Ç–æ—á–Ω–∏–∫–∏:**
- –ê–Ω–∞–ª–∏–∑ –∑–∞–∫—Ä—ã—Ç–∏—è 3 –ø–æ–∑–∏—Ü–∏–π (Partial TP –æ–±—Ö–æ–¥–∏—Ç min_holding)
- –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º –∏–∑ –ª–æ–≥–æ–≤ (4 –ø—Ä–æ–±–ª–µ–º—ã)

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ê–í–ö–ò (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–º)

### ‚úÖ –ü–†–ê–í–ö–ê #1: Partial TP –æ–±—Ö–æ–¥–∏—Ç min_holding –∑–∞—â–∏—Ç—É

**–§–∞–π–ª:** `src/strategies/scalping/futures/position_manager.py`  
**–ú–µ—Ç–æ–¥:** `_check_tp_only()`  
**–°—Ç—Ä–æ–∫–∞:** ~1358-1406

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Partial TP –∑–∞–∫—Ä—ã–≤–∞–µ—Ç –ø–æ–∑–∏—Ü–∏—é –ë–ï–ó –ø—Ä–æ–≤–µ—Ä–∫–∏ min_holding
- –ü–æ–∑–∏—Ü–∏–∏ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ 55 —Å–µ–∫ - 2 –º–∏–Ω –≤–º–µ—Å—Ç–æ 40+ –º–∏–Ω—É—Ç

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
```python
# –ü–ï–†–ï–î —Å—Ç—Ä–æ–∫–æ–π 1364 (–ø–µ—Ä–µ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏–µ–º Partial TP –æ—Ä–¥–µ—Ä–∞)
if (
    ptp_enabled
    and not partial_done
    and size > 0
    and pnl_percent > 0
    and pnl_percent >= ptp_trigger
):
    # ‚úÖ –î–û–ë–ê–í–ò–¢–¨: –ü—Ä–æ–≤–µ—Ä–∫–∞ min_holding –ü–ï–†–ï–î Partial TP
    if hasattr(self, "orchestrator") and self.orchestrator:
        tsl = self.orchestrator.trailing_sl_by_symbol.get(symbol)
        if tsl and tsl.min_holding_minutes:
            minutes_in_position = (time.time() - tsl.entry_timestamp) / 60.0
            if minutes_in_position < tsl.min_holding_minutes:
                logger.debug(
                    f"‚è±Ô∏è Partial TP –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω: –ø–æ–∑–∏—Ü–∏—è –¥–µ—Ä–∂–∏—Ç—Å—è "
                    f"{minutes_in_position:.2f} –º–∏–Ω < {tsl.min_holding_minutes:.2f} –º–∏–Ω "
                    f"(min_holding –∑–∞—â–∏—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞)"
                )
                return  # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ Partial TP!
    
    # –¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ min_holding - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å Partial TP
    # ... –æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û  
**–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –¥–µ—Ä–∂–∞—Ç—å—Å—è 40+ –º–∏–Ω—É—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ

---

### ‚úÖ –ü–†–ê–í–ö–ê #2: Loss-cut –æ–±—Ö–æ–¥–∏—Ç min_holding –∑–∞—â–∏—Ç—É

**–§–∞–π–ª:** `src/strategies/scalping/futures/indicators/trailing_stop_loss.py`  
**–ú–µ—Ç–æ–¥:** `should_close_position()`  
**–°—Ç—Ä–æ–∫–∞:** ~459-581

**–ü—Ä–æ–±–ª–µ–º–∞:**
- Loss-cut –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –î–û min_holding
- –ü–æ—Å–ª–µ 30 —Å–µ–∫—É–Ω–¥ loss_cut –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å –ø–æ–∑–∏—Ü–∏—é
- min_holding (40 –º–∏–Ω—É—Ç) –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è loss_cut

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
```python
# –ü–ï–†–ï–î —Å—Ç—Ä–æ–∫–æ–π 568 (–ø—Ä–æ–≤–µ—Ä–∫–∞ loss_cut)
# ‚úÖ –ü–ï–†–ï–ú–ï–°–¢–ò–¢–¨ –ø—Ä–æ–≤–µ—Ä–∫—É min_holding –ü–ï–†–ï–î loss_cut

# ‚úÖ –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –ü—Ä–æ–≤–µ—Ä—è–µ–º min_holding –ü–ï–†–ï–î loss_cut
effective_min_holding = self.min_holding_minutes
if (
    self.extend_time_on_profit
    and profit_pct > 0
    and effective_min_holding is not None
):
    effective_min_holding = effective_min_holding * self.extend_time_multiplier

# ‚úÖ –ü–†–û–í–ï–†–ö–ê min_holding –ü–ï–†–ï–î loss_cut (–∫—Ä–æ–º–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É–±—ã—Ç–∫–æ–≤)
if (
    effective_min_holding is not None
    and minutes_in_position < effective_min_holding
):
    # ‚úÖ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π 2x loss_cut –∑–∞–∫—Ä—ã–≤–∞–µ–º –ù–ï–ú–ï–î–õ–ï–ù–ù–û (–∑–∞—â–∏—Ç–∞ –æ—Ç –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ)
    if self.loss_cut_percent is not None:
        loss_cut_from_price = self.loss_cut_percent / self.leverage
        critical_loss_cut_from_price = (self.loss_cut_percent * 2.0) / self.leverage
        
        # –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —É–±—ã—Ç–æ–∫ (2x) - –∑–∞–∫—Ä—ã–≤–∞–µ–º –ù–ï–ú–ï–î–õ–ï–ù–ù–û
        if profit_pct <= -critical_loss_cut_from_price:
            loss_from_margin = abs(profit_pct) * self.leverage
            logger.warning(
                f"üö® Loss-cut –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô (2x) –ù–ï–ú–ï–î–õ–ï–ù–ù–û: –ø—Ä–∏–±—ã–ª—å {profit_pct:.2%} –æ—Ç —Ü–µ–Ω—ã "
                f"({loss_from_margin:.2%} –æ—Ç –º–∞—Ä–∂–∏) <= -{critical_loss_cut_from_price:.2%} –æ—Ç —Ü–µ–Ω—ã "
                f"(-{self.loss_cut_percent * 2.0:.2%} –æ—Ç –º–∞—Ä–∂–∏, leverage={self.leverage}x), "
                f"–ø–æ–∑–∏—Ü–∏—è –±—É–¥–µ—Ç –∑–∞–∫—Ä—ã—Ç–∞ –ù–ï–ú–ï–î–õ–ï–ù–ù–û (time_in_position={minutes_in_position:.2f} –º–∏–Ω, "
                f"entry_time={entry_iso}, branch=critical_loss_cut_immediate_override)"
            )
            return True  # –ó–∞–∫—Ä—ã–≤–∞–µ–º –ø–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–º—É loss_cut –ù–ï–ú–ï–î–õ–ï–ù–ù–û
        
        # ‚úÖ –û–±—ã—á–Ω—ã–π loss_cut - –ë–õ–û–ö–ò–†–£–ï–ú –¥–æ min_holding
        if profit_pct <= -loss_cut_from_price:
            loss_from_margin = abs(profit_pct) * self.leverage
            logger.debug(
                f"‚è±Ô∏è Loss-cut –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (min_holding –∑–∞—â–∏—Ç–∞): –ø—Ä–∏–±—ã–ª—å {profit_pct:.2%} –æ—Ç —Ü–µ–Ω—ã "
                f"({loss_from_margin:.2%} –æ—Ç –º–∞—Ä–∂–∏) <= -{loss_cut_from_price:.2%} –æ—Ç —Ü–µ–Ω—ã, "
                f"–Ω–æ –ø–æ–∑–∏—Ü–∏—è –¥–µ—Ä–∂–∏—Ç—Å—è {minutes_in_position:.2f} –º–∏–Ω < {effective_min_holding:.2f} –º–∏–Ω, "
                f"–Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º (entry_time={entry_iso}, branch=min_holding_loss_cut_block)"
            )
            # ‚úÖ DEBUG LOGGER: –õ–æ–≥–∏—Ä—É–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É loss_cut
            if self.debug_logger:
                self.debug_logger.log_tsl_loss_cut_check(
                    symbol=getattr(self, '_symbol', 'UNKNOWN'),
                    profit_pct=profit_pct,
                    loss_cut_from_price=loss_cut_from_price,
                    will_close=False  # –ë–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ min_holding
                )
            return False  # –ù–ï –∑–∞–∫—Ä—ã–≤–∞–µ–º - min_holding –∑–∞—â–∏—Ç–∞ –∞–∫—Ç–∏–≤–Ω–∞!
    
    # –ï—Å–ª–∏ –Ω–µ loss_cut - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É min_holding
    logger.debug(
        f"‚è±Ô∏è –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–¥–µ—Ä–∂–∞–Ω–∏—è: –ø–æ–∑–∏—Ü–∏—è –¥–µ—Ä–∂–∏—Ç—Å—è {minutes_in_position:.2f} –º–∏–Ω < {effective_min_holding:.2f} –º–∏–Ω, "
        f"–Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ–º (profit={profit_pct:.2%}, entry_time={entry_iso}, branch=min_holding)"
    )
    # ‚úÖ DEBUG LOGGER: –õ–æ–≥–∏—Ä—É–µ–º –±–ª–æ–∫–∏—Ä–æ–≤–∫—É min_holding
    if self.debug_logger:
        self.debug_logger.log_tsl_min_holding_block(
            symbol=getattr(self, '_symbol', 'UNKNOWN'),
            minutes_in_position=minutes_in_position,
            min_holding=effective_min_holding,
            profit_pct=profit_pct
        )
    return False

# ‚úÖ –¢–û–õ–¨–ö–û –ü–û–°–õ–ï min_holding - –ø—Ä–æ–≤–µ—Ä—è–µ–º loss_cut
# (–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ loss_cut —Å—é–¥–∞, –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ min_holding)
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö–†–ò–¢–ò–ß–ù–û  
**–í–ª–∏—è–Ω–∏–µ:** –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –¥–µ—Ä–∂–∞—Ç—å—Å—è 40+ –º–∏–Ω—É—Ç –¥–∞–∂–µ –ø—Ä–∏ —É–±—ã—Ç–∫–µ (–∫—Ä–æ–º–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö)

---

## üü° –í–ê–ñ–ù–´–ï –ü–†–ê–í–ö–ò (–∏—Å–ø—Ä–∞–≤–∏—Ç—å –≤—Ç–æ—Ä—ã–º)

### ‚úÖ –ü–†–ê–í–ö–ê #3: –õ–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –ø–æ—Å–ª–µ —Ä–∞–∑–º–µ—â–µ–Ω–∏—è

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–ú–µ—Ç–æ–¥:** `_execute_signal_from_price()`  
**–°—Ç—Ä–æ–∫–∞:** ~3251-3264

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ 3-4 —Å–µ–∫—É–Ω–¥—ã —Å—á–∏—Ç–∞–µ—Ç –æ—Ä–¥–µ—Ä –ø—Ä–æ–≤–∞–ª–∏–≤—à–∏–º—Å—è
- –õ–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç—å—Å—è –ø–æ–∑–∂–µ
- –ë–æ—Ç –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
```python
# –í–ú–ï–°–¢–û —Å—Ç—Ä–æ–∫–∏ 3251-3264
if not position_opened:
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ù–µ —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–≤–∞–ª–æ–º –µ—Å–ª–∏ –æ—Ä–¥–µ—Ä –≤ —Å—Ç–∞—Ç—É—Å–µ pending
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å –æ—Ä–¥–µ—Ä–∞
    try:
        active_orders = await self.client.get_active_orders(symbol)
        order_found = False
        order_state = None
        
        for order in active_orders:
            if str(order.get("ordId", "")) == str(order_id):
                order_found = True
                order_state = order.get("state", "").lower()
                break
        
        if order_found and order_state in ["live", "pending", "partially_filled"]:
            # ‚úÖ –û—Ä–¥–µ—Ä –µ—â–µ –∞–∫—Ç–∏–≤–µ–Ω - –ù–ï —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–≤–∞–ª–æ–º
            logger.info(
                f"‚è≥ –õ–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä {order_id} –¥–ª—è {symbol} –µ—â–µ –∞–∫—Ç–∏–≤–µ–Ω (state={order_state}), "
                f"–æ–∂–∏–¥–∞–µ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è. –ü–æ–∑–∏—Ü–∏—è –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–∏."
            )
            # –û–±–Ω–æ–≤–ª—è–µ–º –∫—ç—à —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "pending"
            self.last_orders_cache[normalized_symbol] = {
                "order_id": order_id,
                "timestamp": current_time,
                "status": "pending",
                "order_type": order_type,
                "side": signal.get("side", "unknown"),
            }
            # ‚úÖ –ù–ï –≤–æ–∑–≤—Ä–∞—â–∞–µ–º False - –æ—Ä–¥–µ—Ä –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª–Ω–∏—Ç—å—Å—è –ø–æ–∑–∂–µ
            # –ü–æ–∑–∏—Ü–∏—è –±—É–¥–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ WebSocket –∏–ª–∏ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –ø—Ä–æ–≤–µ—Ä–∫–µ
            return True  # –°—á–∏—Ç–∞–µ–º —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—É—â–µ–Ω, –∂–¥–µ–º –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
        else:
            # –û—Ä–¥–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –æ—Ç–º–µ–Ω–µ–Ω - —Å—á–∏—Ç–∞–µ–º –ø—Ä–æ–≤–∞–ª–æ–º
            logger.warning(
                f"‚ö†Ô∏è –õ–∏–º–∏—Ç–Ω—ã–π –æ—Ä–¥–µ—Ä {order_id} —Ä–∞–∑–º–µ—â–µ–Ω –¥–ª—è {symbol}, –Ω–æ –ø–æ–∑–∏—Ü–∏—è –ù–ï –æ—Ç–∫—Ä—ã–ª–∞—Å—å "
                f"–∏ –æ—Ä–¥–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∞–∫—Ç–∏–≤–Ω—ã—Ö (state={order_state or 'unknown'}). "
                f"–ù–ï —Å—á–∏—Ç–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –æ—Ç–∫—Ä—ã—Ç–æ–π!"
            )
            return False
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –æ—Ä–¥–µ—Ä–∞ {order_id}: {e}")
        return False
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–û  
**–í–ª–∏—è–Ω–∏–µ:** –õ–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –±—É–¥—É—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å—Å—è

---

### ‚úÖ –ü–†–ê–í–ö–ê #4: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TSL –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–ú–µ—Ç–æ–¥:** `_update_trailing_stop_loss()`  
**–°—Ç—Ä–æ–∫–∞:** ~4940-4947

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–∑–∏—Ü–∏—è –Ω–∞–π–¥–µ–Ω–∞, –Ω–æ TSL –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
- –ö–æ–¥ —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É–µ—Ç, –Ω–æ –Ω–µ –∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
```python
# –í–ú–ï–°–¢–û —Å—Ç—Ä–æ–∫–∏ 4940-4947
if symbol not in self.trailing_sl_by_symbol:
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º TSL –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–∑–∏—Ü–∏–π
    logger.warning(
        f"‚ö†Ô∏è TrailingStopLoss –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è {symbol} "
        f"(–ø–æ–∑–∏—Ü–∏—è –Ω–∞–π–¥–µ–Ω–∞ –≤ active_positions, –Ω–æ –Ω–µ—Ç –≤ trailing_sl_by_symbol). "
        f"–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º TSL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏..."
    )
    
    try:
        # –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
        position = self.active_positions.get(symbol)
        if position:
            entry_price = float(position.get("avgPx", position.get("markPx", 0)))
            side = position.get("posSide", "long")
            size = float(position.get("pos", "0"))
            
            if entry_price > 0 and abs(size) > 0:
                # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º TSL
                tsl = await self._initialize_trailing_stop(
                    symbol=symbol,
                    entry_price=entry_price,
                    side=side,
                    current_price=current_price,
                    signal=None  # –ù–µ—Ç —Å–∏–≥–Ω–∞–ª–∞ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –ø–æ–∑–∏—Ü–∏–∏
                )
                
                if tsl:
                    logger.info(
                        f"‚úÖ TrailingStopLoss –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è {symbol} "
                        f"(entry={entry_price}, side={side})"
                    )
                else:
                    logger.error(
                        f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å TSL –¥–ª—è {symbol}"
                    )
            else:
                logger.warning(
                    f"‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL –¥–ª—è {symbol}: "
                    f"entry_price={entry_price}, size={size}"
                )
        else:
            logger.warning(
                f"‚ö†Ô∏è –ü–æ–∑–∏—Ü–∏—è {symbol} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ active_positions –¥–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL"
            )
    except Exception as e:
        logger.error(
            f"‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ TSL –¥–ª—è {symbol}: {e}"
        )
    
    # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å - –≤—ã—Ö–æ–¥–∏–º
    if symbol not in self.trailing_sl_by_symbol:
        return
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–û  
**–í–ª–∏—è–Ω–∏–µ:** –í—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞—â–∏—â–µ–Ω—ã TSL

---

### ‚úÖ –ü–†–ê–í–ö–ê #5: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∑–∞–º–µ–Ω—ã –ª–∏–º–∏—Ç–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞ –Ω–∞ —Ä—ã–Ω–æ—á–Ω—ã–π

**–§–∞–π–ª:** `src/strategies/scalping/futures/orchestrator.py`  
**–ú–µ—Ç–æ–¥:** `_monitor_limit_orders()`  
**–°—Ç—Ä–æ–∫–∞:** ~2168-2230

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ó–∞–º–µ–Ω–∞ –Ω–∞ —Ä—ã–Ω–æ—á–Ω—ã–π –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
- –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, –±—ã–ª –ª–∏ —Ä–∞–∑–º–µ—â–µ–Ω —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä

**–ß—Ç–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**
```python
# –ü–û–°–õ–ï —Å—Ç—Ä–æ–∫–∏ 2215 (—Ä–∞–∑–º–µ—â–µ–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω–æ–≥–æ –æ—Ä–¥–µ—Ä–∞)
result = await self.order_executor._place_market_order(
    symbol, side, size_in_coins
)
if result.get("success"):
    logger.info(
        f"‚úÖ –†—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω –≤–º–µ—Å—Ç–æ –ª–∏–º–∏—Ç–Ω–æ–≥–æ: {result.get('order_id')}"
    )
    # ‚úÖ –î–û–ë–ê–í–ò–¢–¨: –õ–æ–≥–∏—Ä—É–µ–º –¥–µ—Ç–∞–ª–∏
    logger.info(
        f"üìä –ó–∞–º–µ–Ω–∞ –æ—Ä–¥–µ—Ä–∞: {symbol} {side} {size_in_coins:.6f} –º–æ–Ω–µ—Ç "
        f"(–±—ã–ª–æ {size_in_contracts:.6f} –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤, –ª–∏–º–∏—Ç –≤–∏—Å–µ–ª {wait_time:.0f} —Å–µ–∫)"
    )
else:
    # ‚úÖ –î–û–ë–ê–í–ò–¢–¨: –õ–æ–≥–∏—Ä—É–µ–º –æ—à–∏–±–∫—É
    logger.error(
        f"‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä –≤–º–µ—Å—Ç–æ –ª–∏–º–∏—Ç–Ω–æ–≥–æ –¥–ª—è {symbol}: "
        f"{result.get('error', 'unknown error')}"
    )
    logger.error(
        f"üìä –î–µ—Ç–∞–ª–∏: side={side}, size={size_in_coins:.6f}, "
        f"–ª–∏–º–∏—Ç –≤–∏—Å–µ–ª {wait_time:.0f} —Å–µ–∫, –ø—Ä–∏—á–∏–Ω–∞ –æ—Ç–º–µ–Ω—ã: timeout"
    )
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –í–ê–ñ–ù–û  
**–í–ª–∏—è–Ω–∏–µ:** –ë—É–¥–µ—Ç –≤–∏–¥–Ω–æ, —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –∑–∞–º–µ–Ω–∞ –Ω–∞ —Ä—ã–Ω–æ—á–Ω—ã–π

---

## üìä –ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê –ü–†–ê–í–û–ö

| # | –ü—Ä–∞–≤–∫–∞ | –§–∞–π–ª | –ú–µ—Ç–æ–¥ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –í–ª–∏—è–Ω–∏–µ |
|---|--------|------|-------|-----------|---------|
| 1 | Partial TP –æ–±—Ö–æ–¥–∏—Ç min_holding | `position_manager.py` | `_check_tp_only()` | üî¥ –ö–†–ò–¢–ò–ß–ù–û | –ü–æ–∑–∏—Ü–∏–∏ –¥–µ—Ä–∂–∞—Ç—Å—è 40+ –º–∏–Ω |
| 2 | Loss-cut –æ–±—Ö–æ–¥–∏—Ç min_holding | `trailing_stop_loss.py` | `should_close_position()` | üî¥ –ö–†–ò–¢–ò–ß–ù–û | –ü–æ–∑–∏—Ü–∏–∏ –¥–µ—Ä–∂–∞—Ç—Å—è 40+ –º–∏–Ω |
| 3 | –õ–∏–º–∏—Ç–Ω—ã–µ –æ—Ä–¥–µ—Ä–∞ –Ω–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è | `orchestrator.py` | `_execute_signal_from_price()` | üü° –í–ê–ñ–ù–û | –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ |
| 4 | TSL –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω | `orchestrator.py` | `_update_trailing_stop_loss()` | üü° –í–ê–ñ–ù–û | –í—Å–µ –ø–æ–∑–∏—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã |
| 5 | –ó–∞–º–µ–Ω–∞ –Ω–∞ —Ä—ã–Ω–æ—á–Ω—ã–π –Ω–µ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è | `orchestrator.py` | `_monitor_limit_orders()` | üü° –í–ê–ñ–ù–û | –í–∏–¥–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–º–µ–Ω—ã |

---

## üéØ –ü–õ–ê–ù –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –≠–¢–ê–ü 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∫–∏ (—Å–Ω–∞—á–∞–ª–∞)

1. **–ü—Ä–∞–≤–∫–∞ #1:** Partial TP + min_holding
2. **–ü—Ä–∞–≤–∫–∞ #2:** Loss-cut + min_holding

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–∑–∏—Ü–∏–∏ –±—É–¥—É—Ç –¥–µ—Ä–∂–∞—Ç—å—Å—è 40+ –º–∏–Ω—É—Ç –∫–∞–∫ –∑–∞–¥—É–º–∞–Ω–æ

---

### –≠–¢–ê–ü 2: –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∫–∏ (–ø–æ—Ç–æ–º)

3. **–ü—Ä–∞–≤–∫–∞ #3:** –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤
4. **–ü—Ä–∞–≤–∫–∞ #4:** –ê–≤—Ç–æ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TSL
5. **–ü—Ä–∞–≤–∫–∞ #5:** –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–º–µ–Ω—ã –æ—Ä–¥–µ—Ä–æ–≤

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–ª—É—á—à–µ–Ω–Ω–∞—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ü–†–û–í–ï–†–ö–ò

–ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –ø—Ä–∞–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

- [ ] –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ
- [ ] Edge cases –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

## üöÄ –ì–û–¢–û–í–û –ö –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ

**–í—Å–µ –ø—Ä–∞–≤–∫–∏ –æ–ø–∏—Å–∞–Ω—ã –¥–µ—Ç–∞–ª—å–Ω–æ:**
- ‚úÖ –¢–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –º–µ—Ç–æ–¥—ã
- ‚úÖ –ù–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫
- ‚úÖ –ö–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã
- ‚úÖ –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Å–∏—Å—Ç–µ–º—É

**–ú–æ–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è!** üéØ


