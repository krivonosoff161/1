# ‚úÖ –ü–û–õ–ù–´–ô –û–¢–ß–ï–¢ –û –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –ö–†–ò–¢–ò–ß–ï–°–ö–ò–• –ë–ê–ì–û–í –ò –î–û–ë–ê–í–õ–ï–ù–ò–ò –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø
**–î–∞—Ç–∞:** 6 —è–Ω–≤–∞—Ä—è 2026  
**–í–µ—Ä—Å–∏—è:** Scalping Strategy v2 - LOGGING PACKAGE  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –ì–û–¢–û–í–´ –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ

---

## üìã –°–û–î–ï–†–ñ–ê–ù–ò–ï
1. [–†–µ–∑—é–º–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π](#—Ä–µ–∑—é–º–µ-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. [–ë–∞–≥ #1: Executed Flag](#–±–∞–≥-1-executed-flag-–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π)
3. [–ë–∞–≥ #2: ATR Fallback](#–±–∞–≥-2-atr-fallback)
4. [–ë–∞–≥ #3: ATR Inconsistency](#–±–∞–≥-3-atr-inconsistency)
5. [–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–∫–µ—Ç](#–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ-–ø–∞–∫–µ—Ç)
6. [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É](#–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏-–ø–æ-–∑–∞–ø—É—Å–∫—É)
7. [–ß—Ç–æ –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å](#—á—Ç–æ-–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å-–≤-–ª–æ–≥–∞—Ö)

---

## üéØ –†–ï–ó–Æ–ú–ï –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –ò–°–ü–†–ê–í–õ–ï–ù–û:
‚úÖ **executed Flag Bug** - –°–∏–≥–Ω–∞–ª—ã —Ç–µ–ø–µ—Ä—å –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ CSV —Å executed=True –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –ø–æ–∑–∏—Ü–∏–∏  
‚úÖ **Logging –¥–ª—è RAW —Å–∏–≥–Ω–∞–ª–æ–≤** - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ –ø–µ—Ä–µ–¥ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏  
‚úÖ **Logging –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤** - –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–Ω—è—Ç—ã—Ö/–æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤  
‚úÖ **Logging –¥–ª—è ATR/SL/TP** - –î–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞—Å—á–µ—Ç–æ–≤ –≤ order_executor.py  
‚úÖ **–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ª–æ–≥–æ–≤** - –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ CSV —Å –≤—ã–≤–æ–¥–æ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏  

### –í –†–ê–ë–û–¢–ï:
üîÑ **per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä—ã** - –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –Ω–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ  
üîÑ **Regime detection** - –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –Ω–æ–≤–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ  
üîÑ **Filter statistics** - –ë—É–¥–µ—Ç –≤–∏–¥–Ω–æ –≤ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –ª–æ–≥–∞—Ö  

---

## üêõ –ë–ê–ì #1: EXECUTED FLAG (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)

### –ü—Ä–æ–±–ª–µ–º–∞
–í —Ñ–∞–π–ª–µ `src/strategies/scalping/futures/signal_generator.py` (—Å—Ç—Ä–æ–∫–∞ 1608) —Å–∏–≥–Ω–∞–ª –∑–∞–ø–∏—Å—ã–≤–∞–ª—Å—è –≤ CSV —Å —Ñ–ª–∞–≥–æ–º `executed=False`, –∫–æ—Ç–æ—Ä—ã–π **–Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª—Å—è** –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å–∏–≥–Ω–∞–ª –±—ã–ª –∏—Å–ø–æ–ª–Ω–µ–Ω.

**–ü—Ä–æ—è–≤–ª–µ–Ω–∏–µ:**
- CSV —Å–æ–¥–µ—Ä–∂–∞–ª 311 —Å–∏–≥–Ω–∞–ª–æ–≤, –í–°–ï —Å executed=0
- –ù–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –±—ã–ª–æ 27 —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –±—ã–ª–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∫–∞–∫–∏–µ —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–∏–≤–µ–ª–∏ –∫ —Å–¥–µ–ª–∫–∞–º

**–ü—Ä–∏—á–∏–Ω–∞:**
```python
# signal_generator.py, —Å—Ç—Ä–æ–∫–∞ 1608 - –ë–´–õ–û:
self.performance_tracker.record_signal(
    ...
    executed=False,  # ‚Üê –ù–ò–ö–û–ì–î–ê –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å!
    order_id=None,   # ‚Üê –í–°–ï–ì–î–ê None
)
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/entry_manager.py` (—Å—Ç—Ä–æ–∫–∞ 675-695)

```python
# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –û–±–Ω–æ–≤–ª—è–µ–º —Å–∏–≥–Ω–∞–ª –≤ CSV –∫–∞–∫ –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã–π
if self.performance_tracker:
    try:
        signal_filters = signal.get("filters_passed", [])
        if isinstance(signal_filters, str):
            signal_filters = signal_filters.split(",") if signal_filters else []
        
        logger.info(f"[SIGNAL_EXECUTED] {symbol}: Recording executed signal in CSV")
        
        self.performance_tracker.record_signal(
            symbol=symbol,
            side=signal.get("side", ""),
            price=signal.get("price", 0.0),
            strength=signal.get("strength", 0.0),
            regime=final_regime or signal.get("regime"),
            filters_passed=signal_filters,
            executed=True,  # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –¢–µ–ø–µ—Ä—å True –¥–ª—è –∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö —Å–∏–≥–Ω–∞–ª–æ–≤!
            order_id=order_result.get("order_id"),
        )
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ CSV –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
```
311 signals total
‚îú‚îÄ 27 —Å executed=1 (–∏—Å–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ - —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –æ—Ç–∫—Ä—ã—Ç—ã–º –ø–æ–∑–∏—Ü–∏—è–º)
‚îî‚îÄ 284 —Å executed=0 (–æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏)
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
CSV: signals where executed=1 
‚Üí –î–æ–ª–∂–Ω—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å 27 –æ—Ç–∫—Ä—ã—Ç—ã–º –ø–æ–∑–∏—Ü–∏—è–º
‚Üí –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–≤—è–∑–∞–Ω—ã —Å order_id
```

---

## üêõ –ë–ê–ì #2: ATR FALLBACK (–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô)

### –ü—Ä–æ–±–ª–µ–º–∞
**–§–∞–π–ª:** `src/strategies/scalping/futures/order_executor.py` (—Å—Ç—Ä–æ–∫–∞ 2231)

```python
# –ë–´–õ–û - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è 1% –∫–∞–∫ fallback ATR:
fallback_atr = price * 0.01
# –î–ª—è DOGE @ 0.1526: fallback_atr = 0.001526 (–º–∏–∫—Ä–æ!)
# –ü–æ—Ç–æ–º: SL = entry - 0.2 * 0.001526 = entry - 0.0003 (entry‚âàstop!)
```

**–ü—Ä–æ—è–≤–ª–µ–Ω–∏–µ:**
- –î–ª—è –ø–∞—Ä —Å –º–∞–ª–æ–π —Ü–µ–Ω–æ–π (DOGE, SUI, etc) ATR fallback = ~1% –æ—Ç —Ü–µ–Ω—ã
- –≠—Ç–æ –¥–∞–µ—Ç –º–∏–∫—Ä–æ—Å–∫–æ–ø–∏—á–Ω—ã–π SL
- –°–¥–µ–ª–∫–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ stop-loss –±—É–∫–≤–∞–ª—å–Ω–æ —Å—Ä–∞–∑—É
- –í –ª–æ–≥–∞—Ö: entry ‚âà sl_price (–æ–Ω–∏ –ø–æ—á—Ç–∏ —Ä–∞–≤–Ω—ã)

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
**–ü–æ–∫–∞ —Å—Ç–∞—Ç—É—Å:** –¢—Ä–µ–±—É–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

–î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `order_executor.py` (—Å—Ç—Ä–æ–∫–∏ 2020-2030):

```python
# ‚úÖ –ù–û–í–û–ï: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã—Å–æ–∫–æ–π –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏ (>5% –∑–∞ –ø–µ—Ä–∏–æ–¥)
atr_percent = (atr / entry_price) * 100 if entry_price > 0 else 0
if atr_percent > 5.0:  # > 5% –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å
    logger.warning(
        f"‚ö†Ô∏è –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª—è {symbol}: "
        f"ATR={atr_percent:.2f}%, entry_price={entry_price:.2f}, "
        f"ATR_abs={atr:.2f}"
    )
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø—Ä–æ–±–ª–µ–º–∞:**
- –î–ª—è DOGE: ATR —á–∞—Å—Ç–æ < 0.1% –≤ —Å–ø–æ–∫–æ–π–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã
- Fallback 1% = –≤ 10 —Ä–∞–∑ –±–æ–ª—å—à–µ —á–µ–º —Ä–µ–∞–ª—å–Ω–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å!
- –ú–æ–∂–Ω–æ –ª–∏ —É–≤–µ–ª–∏—á–∏—Ç—å fallback? –ù–µ—Ç - –Ω–∞—Ä—É—à–∏—Ç –∫—Ä—É–ø–Ω—ã–µ –ø–∞—Ä—ã (BTC, ETH)

**–†–µ—à–µ–Ω–∏–µ** (—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):
1. –í—ã—á–∏—Å–ª–∏—Ç—å ATR –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ
2. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π fallback: `fallback_atr = max(price * 0.001, price * 0.005)` (0.1-0.5%)
3. –ò–ª–∏ –∑–∞–ø—Ä–æ—Å–∏—Ç—å ATR –≤—Å–µ–≥–¥–∞ —á–µ—Ä–µ–∑ API, –±–µ–∑ fallback

---

## üêõ –ë–ê–ì #3: ATR INCONSISTENCY

### –ü—Ä–æ–±–ª–µ–º–∞
SignalGenerator –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ATR –∏–∑ `IndicatorManager`  
OrderExecutor –∏—Å–ø–æ–ª—å–∑—É–µ—Ç ATR –∏–∑ —Å–≤–µ–∂–µ–≥–æ API –≤—ã–∑–æ–≤–∞  
–≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –≤ 2-3 —Ä–∞–∑–∞!

### –ü—Ä–æ—è–≤–ª–µ–Ω–∏–µ
- Signal —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å: TP/SL –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR_A
- –û—Ä–¥–µ—Ä —Ä–∞–∑–º–µ—â–µ–Ω —Å: TP/SL –Ω–∞ –æ—Å–Ω–æ–≤–µ ATR_B
- –†–µ–∑—É–ª—å—Ç–∞—Ç: –û—Ä–¥–µ—Ä –º–æ–∂–µ—Ç –∑–∞–∫—Ä—ã—Ç—å—Å—è –≤–Ω–µ —Ü–µ–ª–µ–≤—ã—Ö –∑–æ–Ω

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
**–°—Ç–∞—Ç—É—Å:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

–í `order_executor.py` (—Å—Ç—Ä–æ–∫–∏ 2070-2090):

```python
# üéØ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL –¥–ª—è {symbol}: 
# regime={regime}, ATR={atr:.2f}, 
# TP={tp_distance/entry_price*100:.2f}%, 
# SL={sl_distance/entry_price*100:.2f}%, 
# entry={entry_price:.2f}, tp_price={tp_price:.2f}, sl_price={sl_price:.2f}
```

**–¢—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏:**
–°—Ä–∞–≤–Ω–∏—Ç—å –≤ –ª–æ–≥–∞—Ö ATR –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ signal_generator vs –≤ order_executor –¥–ª—è –æ–¥–Ω–æ–≥–æ —Å–∏–º–≤–æ–ª–∞

---

## üì¶ –õ–û–ì–ò–†–û–í–ê–ù–ò–ï –ü–ê–ö–ï–¢

### 1. Signal Generation Logging
**–§–∞–π–ª:** `src/strategies/scalping/futures/signal_generator.py` (—Å—Ç—Ä–æ–∫–∞ 1442-1470)

```python
# ‚úÖ –õ–û–ì–ò–†–û–í–ê–ù–ò–ï: –í—Ö–æ–¥—è—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã –ø–µ—Ä–µ–¥ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
logger.info(f"[FILTER_INPUT] {symbol}: {len(signals)} signals entering filters")
for idx, sig in enumerate(signals[:5]):
    logger.debug(f"  RAW_SIGNAL #{idx+1}: {sig.get('side')} @ {sig.get('price'):.6f}")

# ‚úÖ –õ–û–ì–ò–†–û–í–ê–ù–ò–ï: –í—ã—Ö–æ–¥—è—â–∏–µ —Å–∏–≥–Ω–∞–ª—ã –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
logger.info(f"[FILTER_OUTPUT] {symbol}: {len(filtered)} signals after filters")
```

**–ß—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞ –≤—Ö–æ–¥–µ
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–≥–Ω–∞–ª–æ–≤ –Ω–∞ –≤—ã—Ö–æ–¥–µ
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (%)

### 2. ATR/SL/TP Logging
**–§–∞–π–ª:** `src/strategies/scalping/futures/order_executor.py` (—Å—Ç—Ä–æ–∫–∞ 2070-2140)

```python
# ‚úÖ –†–ê–°–ß–ï–¢ ATR
logger.info(f"üéØ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ TP/SL –¥–ª—è {symbol}: "
    f"regime={regime}, ATR={atr:.2f}, "
    f"TP={tp_percent:.2f}%, SL={sl_percent:.2f}%")

# ‚úÖ FALLBACK –ü–†–û–í–ï–†–ö–ê
logger.info(f"‚ö†Ô∏è ATR-based SL —Å–ª–∏—à–∫–æ–º –º–∞–ª ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º sl_percent fallback")
```

**–ß—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç:**
- ATR –∑–Ω–∞—á–µ–Ω–∏–µ (—Ä–µ–∞–ª—å–Ω–æ–µ –∏–ª–∏ fallback)
- –†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (trending, ranging, choppy)
- TP/SL –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö –∏ –∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö —á–∏—Å–ª–∞—Ö
- –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback

### 3. Signal Execution Logging
**–§–∞–π–ª:** `src/strategies/scalping/futures/positions/entry_manager.py` (—Å—Ç—Ä–æ–∫–∞ 675-695)

```python
logger.info(f"[SIGNAL_EXECUTED] {symbol}: Recording executed signal in CSV")
logger.debug(f"  Entry price: {entry_price:.6f}")
logger.debug(f"  Order ID: {order_result.get('order_id')}")
logger.debug(f"  Filters passed: {signal_filters}")

# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ CSV —Å executed=True
self.performance_tracker.record_signal(
    ...,
    executed=True,  # ‚Üê –¢–µ–ø–µ—Ä—å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è!
    order_id=order_result.get("order_id"),
)
```

**–ß—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç:**
- –°–∏–≥–Ω–∞–ª—ã —Å executed=True (–±—ã–ª–∏ –∏—Å–ø–æ–ª–Ω–µ–Ω—ã)
- –°–∏–≥–Ω–∞–ª—ã —Å executed=False (–±—ã–ª–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω—ã)
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –º–µ–∂–¥—É —Å–∏–≥–Ω–∞–ª–∞–º–∏ –∏ order_id

### 4. Regime & Per-Symbol Params Logging
**–°—Ç–∞—Ç—É—Å:** –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `order_executor.py` (—Å—Ç—Ä–æ–∫–∏ 2038-2048)

```python
# ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞
logger.info(f"‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π sl_percent={sl_percent_value:.2f}% "
    f"–¥–ª—è {symbol} (regime={regime})")

# ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ fallback –Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥
logger.warning(f"‚ö†Ô∏è FALLBACK: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–π sl_percent={sl_percent_value:.2f}%")
```

**–ß—Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º (trending/ranging/choppy)
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ä–µ–∂–∏–º–∞ vs –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback

---

## üöÄ –ò–ù–°–¢–†–£–ö–¶–ò–ò –ü–û –ó–ê–ü–£–°–ö–£

### –®–∞–≥ 1: –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ñ–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
1. src/strategies/scalping/futures/signal_generator.py - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤
2. src/strategies/scalping/futures/order_executor.py - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ATR/SL/TP
3. src/strategies/scalping/futures/positions/entry_manager.py - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ executed=True
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
```bash
python run.py --mode futures
# –∏–ª–∏ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ
python run.py
```

### –®–∞–≥ 3: –°–æ–±–∏—Ä–∞–π—Ç–µ –ª–æ–≥–∏
–í–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã –ª–æ–≥–∏ –±—É–¥—É—Ç –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –≤:
```
logs/futures/
  ‚îú‚îÄ main_YYYY-MM-DD.log (–æ–±—â–∏–µ –ª–æ–≥–∏)
  ‚îú‚îÄ all_signals.csv (—Å–∏–≥–Ω–∞–ª—ã —Å executed —Ñ–ª–∞–≥–æ–º)
  ‚îú‚îÄ all_positions.csv (–æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏)
  ‚îî‚îÄ all_trades.csv (–∑–∞–∫—Ä—ã—Ç—ã–µ —Å–¥–µ–ª–∫–∏)
```

### –®–∞–≥ 4: –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–π –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä
python analyze_with_detailed_logging.py
```

–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:
```
log/analysis/
  ‚îî‚îÄ analysis_detailed_YYYY-MM-DD_HH-MM-SS.log
```

---

## üîç –ß–¢–û –ê–ù–ê–õ–ò–ó–ò–†–û–í–ê–¢–¨ –í –õ–û–ì–ê–•

### 1. –ö–æ–Ω–≤–µ—Ä—Å–∏—è –°–∏–≥–Ω–∞–ª–æ–≤
**–ü–æ–∏—Å–∫ –≤ –ª–æ–≥–∞—Ö:**
```
[FILTER_INPUT] BTC-USDT: 55 signals entering filters
[FILTER_OUTPUT] BTC-USDT: 0 signals after filters
```

**–í–æ–ø—Ä–æ—Å:** –ö—É–¥–∞ –¥–µ–ª–∏—Å—å 55 —Å–∏–≥–Ω–∞–ª–æ–≤?
- –û—Ç–∫–ª–æ–Ω–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä–∞–º–∏? –ö–∞–∫–∏–º–∏?
- –ù–µ –ø—Ä–æ—à–ª–∏ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å? MTF? –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—é?

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –î–õ–Ø –ö–ê–ñ–î–û–ì–û —Ñ–∏–ª—å—Ç—Ä–∞!

### 2. ATR Fallback Usage
**–ü–æ–∏—Å–∫ –≤ –ª–æ–≥–∞—Ö:**
```
‚ö†Ô∏è –í—ã—Å–æ–∫–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å –¥–ª—è DOGE: ATR=0.15%, entry_price=0.1526, ATR_abs=0.000229
‚ö†Ô∏è ATR-based SL —Å–ª–∏—à–∫–æ–º –º–∞–ª (0.05%) ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ–º sl_percent fallback (1.20%)
```

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è fallback?
- –ï—Å–ª–∏ —á–∞—Å—Ç–æ (>50% –æ—Ä–¥–µ—Ä–æ–≤) - –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å strategy
- –ï—Å–ª–∏ —Ä–µ–¥–∫–æ (<10%) - –Ω–æ—Ä–º–∞–ª—å–Ω–æ

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å % –æ—Ä–¥–µ—Ä–æ–≤ —Å fallback SL –≤ –ª–æ–≥–∞—Ö

### 3. Executed Signals –≤ CSV
**–ß—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å:**
```
all_signals.csv:
- –§–∏–ª—å—Ç—Ä –ø–æ executed=1
- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å 27 –∑–∞–ø–∏—Å–µ–π (–∫–∞–∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π)
- –ö–∞–∂–¥–∞—è –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å order_id

- –§–∏–ª—å—Ç—Ä –ø–æ executed=0
- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å 284 –∑–∞–ø–∏—Å–∏ (311-27)
- –≠—Ç–æ —Å–∏–≥–Ω–∞–ª—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
```

### 4. Regime Detection
**–ü–æ–∏—Å–∫ –≤ –ª–æ–≥–∞—Ö:**
```
‚úÖ [REGIME] BTC-USDT: –†–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: trending
‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π sl_percent=0.45% –¥–ª—è BTC (regime=trending)
```

**–í–æ–ø—Ä–æ—Å:** –ö–∞–∫–æ–π —Ä–µ–∂–∏–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã?
- BTC: trending? (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å)
- ETH: ranging? (–º–æ–∂–µ—Ç –±—ã—Ç—å)
- DOGE: choppy? (—á–∞—â–µ –≤—Å–µ–≥–æ)

---

## üìä –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ 2 —á–∞—Å–æ–≤ —Ç–æ—Ä–≥–æ–≤–ª–∏ —Å –Ω–æ–≤—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**CSV —Å–∫–∞–∂–µ—Ç:**
```
‚úÖ –°–∏–≥–Ω–∞–ª–æ–≤: 311
   - –ò—Å–ø–æ–ª–Ω–µ–Ω–æ: 27 (8.7%) ‚Üê –¶–ï–õ–ï–í–û–ô 8-10% ‚úì
   - –û—Ç–∫–ª–æ–Ω–µ–Ω–æ: 284 (91.3%)

‚úÖ –ü–æ–∑–∏—Ü–∏–π: 27
   - –ó–∞–∫—Ä—ã—Ç–æ: 27 (100%)
   - P&L: ?

‚úÖ –°–¥–µ–ª–æ–∫: 27
   - –í—ã–∏–≥—Ä—ã—à–∏: ? (—Ü–µ–ª–µ–≤–æ–π 40%+)
   - –ü—Ä–æ–∏–≥—Ä—ã—à–∏: ? (—Ü–µ–ª–µ–≤–æ–π <60%)
```

**–õ–æ–≥–∏ —Å–∫–∞–∂—É—Ç:**
```
‚ùì –ö–∞–∫–æ–π —Ñ–∏–ª—å—Ç—Ä –æ—Ç–∫–ª–æ–Ω—è–µ—Ç 91% —Å–∏–≥–Ω–∞–ª–æ–≤?
‚ùì –ö–∞–∫ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ATR fallback?
‚ùì –ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ä–µ–∂–∏–º?
‚ùì –ö–∞–∫–∏–µ per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è?
```

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑
–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—Å–µ –µ—â–µ BAD (-6 USD, 18% win rate):
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∫–æ–π —Ñ–∏–ª—å—Ç—Ä "—É–±–∏–≤–∞–µ—Ç" —Ç–æ—Ä–≥–æ–≤–ª—é
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ATR fallback - –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å regime detection - –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä—ã - –º–æ–≥—É—Ç –Ω–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å—Å—è

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –î–õ–Ø –ù–ï–ú–ï–î–õ–ï–ù–ù–û–ì–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:
1. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ —Å –Ω–æ–≤—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º
2. ‚úÖ –î–∞—Ç—å –µ–º—É —Å–æ–±—Ä–∞—Ç—å –ª–æ–≥–∏ 2 —á–∞—Å–∞
3. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç—å `analyze_with_detailed_logging.py`
4. ‚úÖ –ü—Ä–æ—á–∏—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞
5. ‚úÖ –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ì–õ–ê–í–ù–´–ô —Ñ–∏–ª—å—Ç—Ä, –æ—Ç–∫–ª–æ–Ω—è—é—â–∏–π 91%

### –ï–°–õ–ò –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ü–õ–û–•–ò–ï:
1. –î–æ–±–∞–≤–∏—Ç—å per-filter –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–ø—Ä–∏—á–∏–Ω—ã –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è)
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ç–æ—Ä–∞—è —Ñ–∏–ª—å—Ç—Ä–∞ –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –±–æ–ª—å—à–µ –≤—Å–µ—Ö
3. –û—Ç–∫–ª—é—á–∏—Ç—å —ç—Ç—É —Ñ–∏–ª—å—Ç—Ä—É –∏–ª–∏ –º–µ–Ω—è—Ç—å –µ—ë –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
4. –ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å —Ç–µ—Å—Ç—ã

### –ï–°–õ–ò –†–ï–ó–£–õ–¨–¢–ê–¢–´ –•–û–†–û–®–ò–ï:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å 24 —á–∞—Å–∞ –±–æ—Ç–∞
2. –°–æ–±—Ä–∞—Ç—å –ø–æ–ª–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üìù –õ–ò–°–¢ –ü–†–û–í–ï–†–ö–ò

- [ ] –§–∞–π–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã:
  - [ ] signal_generator.py (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞ —Ñ–∏–ª—å—Ç—Ä–æ–≤)
  - [ ] order_executor.py (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ATR/SL/TP)  
  - [ ] entry_manager.py (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ executed=True)

- [ ] –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–Ω:
  - [ ] analyze_with_detailed_logging.py —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É

- [ ] –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω:
  - [ ] `python run.py --mode futures` –∏–ª–∏ `python run.py`
  - [ ] –õ–æ–≥–∏ —Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ logs/futures/

- [ ] –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—É—â–µ–Ω:
  - [ ] `python analyze_with_detailed_logging.py` –ø–æ—Å–ª–µ —á–∞—Å–∞ —Ç–æ—Ä–≥–æ–≤–ª–∏

- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã:
  - [ ] executed=True –≤ CSV —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –ø–æ–∑–∏—Ü–∏—è–º–∏
  - [ ] ATR fallback –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∏–¥–Ω–æ
  - [ ] –†–µ–∂–∏–º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
  - [ ] Per-symbol –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

---

**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 6 —è–Ω–≤–∞—Ä—è 2026  
**–í–µ—Ä—Å–∏—è:** 1.0 - –ü–û–õ–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ò –õ–û–ì–ò–†–û–í–ê–ù–ò–ï  
**–°—Ç–∞—Ç—É—Å:** –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ ‚úÖ
